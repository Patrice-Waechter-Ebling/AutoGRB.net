Option Strict Off
Option Explicit On
Imports VB = Microsoft.VisualBasic
Friend Class FrmProjSoumMec
	Inherits System.Windows.Forms.Form
	
	'Index des colonnes de lvwSoumission
	Private Const I_COL_SOUM_QUANTITE As Short = 0
	Private Const I_COL_SOUM_PIECE As Short = 1
	Private Const I_COL_SOUM_DESCR As Short = 2
	Private Const I_COL_SOUM_MANUFACT As Short = 3
	Private Const I_COL_SOUM_PRIX_LIST As Short = 4
	Private Const I_COL_SOUM_ESCOMPTE As Short = 5
	Private Const I_COL_SOUM_PRIX_NET As Short = 6
	Private Const I_COL_SOUM_DISTRIB As Short = 7
	Private Const I_COL_SOUM_TOTAL As Short = 8
	Private Const I_COL_SOUM_PROFIT As Short = 9
	Private Const I_COL_SOUM_COMMENTAIRE As Short = 10
	Private Const I_COL_SOUM_FACTURATION As Short = 11
	Private Const I_COL_SOUM_DATE_COMMANDE As Short = 12
	Private Const I_COL_SOUM_DATE_REQUISE As Short = 13
	Private Const I_COL_SOUM_NOM_COMMANDE As Short = 14
	Private Const I_COL_SOUM_NO_SEQUENTIEL As Short = 15
	Private Const I_COL_SOUM_PROVENANCE As Short = 16
	
	Private Const I_COL_SOUMISSION_PROV As Short = 11
	
	'Index des colonnes de lvwSoumission si les colonnes contenant
	'des prix ne sont pas là. (SP est pour Sans Prix)
	Private Const I_COL_SOUM_SP_QUANTITE As Short = 0
	Private Const I_COL_SOUM_SP_PIECE As Short = 1
	Private Const I_COL_SOUM_SP_DESCR As Short = 2
	Private Const I_COL_SOUM_SP_MANUFACT As Short = 3
	Private Const I_COL_SOUM_SP_DISTRIB As Short = 4
	Private Const I_COL_SOUM_SP_COMMENTAIRE As Short = 5
	Private Const I_COL_SOUM_SP_DATE_COMMANDE As Short = 6
	Private Const I_COL_SOUM_SP_DATE_REQUISE As Short = 7
	Private Const I_COL_SOUM_SP_NOM_COMMANDE As Short = 8
	Private Const I_COL_SOUM_SP_NO_SEQUENTIEL As Short = 9
	Private Const I_COL_SOUM_SP_PROVENANCE As Short = 10
	
	Private Const I_COL_SOUMISSION_SP_PROV As Short = 6
	
	'Index des colonnes de lvwPieces
	Private Const I_COL_PIECES_PIECE_GRB As Short = 0
	Private Const I_COL_PIECES_NO_ITEM As Short = 1
	Private Const I_COL_PIECES_MANUFACT As Short = 2
	Private Const I_COL_PIECES_DESCR_FR As Short = 3
	Private Const I_COL_PIECES_DESCR_EN As Short = 4
	
	'Index des colonnes de lvwPieceTrouve
	Private Const I_COL_RECH_PIECE_GRB As Short = 0
	Private Const I_COL_RECH_NO_ITEM As Short = 1
	Private Const I_COL_RECH_CATEGORIE As Short = 2
	Private Const I_COL_RECH_MANUFACT As Short = 3
	Private Const I_COL_RECH_DESCR_FR As Short = 4
	Private Const I_COL_RECH_DESCR_EN As Short = 5
	
	'Index des colonnes de lvwFournisseur
	Private Const I_COL_FRS_FRS As Short = 0
	Private Const I_COL_FRS_PERS_RESS As Short = 1
	Private Const I_COL_FRS_DATE As Short = 2
	Private Const I_COL_FRS_ENTRER_PAR As Short = 3
	Private Const I_COL_FRS_VALIDE As Short = 4
	Private Const I_COL_FRS_PRIX_LIST As Short = 5
	Private Const I_COL_FRS_ESCOMPTE As Short = 6
	Private Const I_COL_FRS_PRIX_NET As Short = 7
	Private Const I_COL_FRS_PRIX_SP As Short = 8
	Private Const I_COL_FRS_QUOTER As Short = 9
	Private Const I_COL_FRS_STOCK As Short = 10
	
	'Index des colonnes de lvwModification
	Private Const I_COL_MODIF_EMPLOYE As Short = 0
	Private Const I_COL_MODIF_DATE As Short = 1
	Private Const I_COL_MODIF_HEURE As Short = 2
	Private Const I_COL_MODIF_MONTANT As Short = 3
	
	'Index des colonnes de lvwBavard
	Private Const I_COL_SUPP_EMPLOYE As Short = 0
	Private Const I_COL_SUPP_DATE As Short = 1
	Private Const I_COL_SUPP_HEURE As Short = 2
	Private Const I_COL_SUPP_QTE As Short = 3
	Private Const I_COL_SUPP_NO_ITEM As Short = 4
	
	'Index de cmbChoix
	Private Const I_IDX_SOUMISSION As Short = 0
	Private Const I_IDX_PROJET As Short = 1
	
	'Index de cmbOuvertFerme
	Private Const I_CMB_OUVERT As Short = 0
	Private Const I_CMB_TOUS As Short = 1
	
	'Constante s'il n'y a pas de sous-sections
	Private Const S_PAS_SOUS_SECTION As String = "PAS DE SOUS-SECTION"
	
	'Valeur servant au resize du lvwSoumission si le form est agrandi
	Private Const I_TOP_AFFICHAGE As Short = 3000
	Private Const I_HEIGHT_AFFICHAGE As Short = 3930
	
	'Index de cmbTri
	Private Const I_CMB_PIECE_GRB As Short = 0
	Private Const I_CMB_PIECE As Short = 1
	Private Const I_CMB_FABRICANT As Short = 2
	Private Const I_CMB_DESCR_FR As Short = 3
	Private Const I_CMB_DESCR_EN As Short = 4
	
	'Énumeration servant à savoir si c'est l'affichage des soumissions ou des projets
	Private Enum enumType
		TYPE_PROJET = 0
		TYPE_SOUMISSION = 1
	End Enum
	
	'Énumération servant à savoir si le form est en mode modif/ajout ou en mode
	'inactif (affichage seulement)
	Private Enum enumMode
		MODE_AJOUT_MODIF = 0
		MODE_INACTIF = 1
	End Enum
	
	'Énumération servant à savoir si le form est en anglais ou en francais
	Private Enum enumLangage
		FRANCAIS = 0
		ANGLAIS = 1
	End Enum
	
	Private Structure tyCopiePiece
		Dim bChecked As Boolean
		Dim sQuantite As String
		Dim sPiece As String
		Dim sDescr As String
		Dim sManufact As String
		Dim sPrixList As String
		Dim sEscompte As String
		Dim sPrixNet As String
		Dim sFRS As String
		Dim sTotal As String
		Dim sProfit As String
		Dim sDescrTag As String
		Dim sPrixListTag As String
		Dim sFRSTag As String
		Dim lColor As Integer
		Dim iNoLigne As Short
	End Structure
	
	'Variables pour le temps
	Public m_bTempsProjLock As Boolean
	
	Public m_sTempsDessin As String
	Public m_sTempsCoupe As String
	Public m_sTempsMachinage As String
	Public m_sTempsSoudure As String
	Public m_sTempsAssemblage As String
	Public m_sTempsPeinture As String
	Public m_sTempsTest As String
	Public m_sTempsInstallation As String
	Public m_sTempsFormation As String
	Public m_sTempsGestion As String
	Public m_sTempsShipping As String
	
	Public m_sTempsDessinProj As String
	Public m_sTempsCoupeProj As String
	Public m_sTempsMachinageProj As String
	Public m_sTempsSoudureProj As String
	Public m_sTempsAssemblageProj As String
	Public m_sTempsPeintureProj As String
	Public m_sTempsTestProj As String
	Public m_sTempsInstallationProj As String
	Public m_sTempsFormationProj As String
	Public m_sTempsGestionProj As String
	Public m_sTempsShippingProj As String
	Public m_sTempsPrototypeProj As String
	
	Public m_sTempsDessinConc As String
	Public m_sTempsCoupeConc As String
	Public m_sTempsMachinageConc As String
	Public m_sTempsSoudureConc As String
	Public m_sTempsAssemblageConc As String
	Public m_sTempsPeintureConc As String
	Public m_sTempsTestConc As String
	Public m_sTempsInstallationConc As String
	Public m_sTempsFormationConc As String
	Public m_sTempsGestionConc As String
	Public m_sTempsShippingConc As String
	Public m_sTempsPrototypeConc As String
	
	Public m_sNbrePersonne As String
	Public m_sTempsHebergement As String
	Public m_sTempsRepas As String
	Public m_sTempsTransport As String
	Public m_sTempsUniteMobile As String
	Public m_sPrixEmballage As String
	
	Public m_sTauxHebergement1 As String
	Public m_sTauxHebergement2 As String
	Public m_sTauxRepas As String
	Public m_sTauxTransport As String
	Public m_sTauxUniteMobile As String
	
	Public m_sTauxDessin As String
	Public m_sTauxCoupe As String
	Public m_sTauxMachinage As String
	Public m_sTauxSoudure As String
	Public m_sTauxAssemblage As String
	Public m_sTauxPeinture As String
	Public m_sTauxTest As String
	Public m_sTauxInstallation As String
	Public m_sTauxFormation As String
	Public m_sTauxGestion As String
	Public m_sTauxShipping As String
	
	'Pour savoir si l'écran des temps a déjà été ouvert
	Public m_bTempsDejaOuvert As Boolean
	
	'Pour savoir si le form a déjà été sur l'événement resize
	Private m_bResize As Boolean
	
	'Variables pour la configurations
	Private m_sProfit As String
	Private m_sCommission As String
	Private m_sImprevue As String
	
	'Modes du form
	Private m_bModeAjout As Boolean
	Private m_bModeAffichage As Boolean
	
	'Pour avoir une sous-section par défaut
	Private m_sSousSection As String
	
	'Pour le tri de lvwPieces
	Private m_sTri As String
	
	'Pour savoir quelle colonne trier
	Private m_iCol As Short
	
	'Pour savoir si le form affiche les projets ou les soumissions
	Private m_eType As enumType
	Private m_eMode As enumMode
	
	'Pour savoir si les prix sont cachés ou non
	Public m_bDroitPrix As Boolean
	
	'Pour ne pas être obligé d'ouvrir le recordset à chaque fois
	Private m_bModifProj As Boolean
	Private m_bModifSoum As Boolean
	Private m_bModifBonCommande As Boolean
	
	'Variable pour savoir si l'utilisateur a le droit de voir le combo ou non
	Private m_bComboChoix As Boolean
	
	'Pour faire afficher le dernier enregitrement visionné après un ajout ou une
	'modification
	Private m_sAncienProjSoum As String
	
	'Pour savoir si c'est en francais ou en anglais
	Private m_eLangage As enumLangage
	
	'Pour savoir si l'utilisateur a le droit de supprimer des projets
	Private m_bSupprimer As Boolean
	
	Private m_bPieceInutile As Boolean
	
	Public m_bAnnulerChemin As Boolean
	
	Public m_sChemin As String
	
	Private m_bRecherchePiece As Boolean
	
	Private m_bExtra As Boolean
	
	'Pour ne pas resetter le langage après un enregistrement
	Private m_bEnregistrement As Boolean
	
	Private m_bMauvaisPrix As Boolean
	
	Private m_collDateSupp As Collection
	Private m_collHeureSupp As Collection
	Private m_collQteSupp As Collection
	Private m_collNoItemSupp As Collection
	
	Private m_bChangementFRS As Boolean
	
	Private m_sTexteRecherche As String
	
	Private m_arr_tyCopie() As tyCopiePiece
	
	Private m_iNbreCopie As Short
	
	Public m_bModifFournisseurBC As Boolean
	
	Private m_sLiaison As String
	Private m_bMonthViewHasFocus As Boolean
	
	Public m_bTransfertJobCancel As Boolean
	
	Private m_bChangementChoix As Boolean 'Pour empêcher l'événement cmbOuvertFerme_Click quand cmbChoix change
	
	Public m_bValide As Boolean 'Résultat de frmValiderSuppression
	Public intdummie As Short 'va servir à annuler l'impression des rapports dans la sub ImprimerProjSoum
	Public bTrigger As Boolean
	'**********************************************************************************************************
	'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
	'**********************************************************************************************************
	Public bFlag As Boolean 'pour garder en mémoire si on désir achiffer les dates de réception et de commande
	'**********************************************************************************************************
	
	Public Function PeutFermer() As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If m_eMode = enumMode.MODE_INACTIF Then
15: PeutFermer = True
20: Else
25: PeutFermer = False
30: End If
		
35: Exit Function
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "PeutFermer", Err, Erl())
	End Function
	
	Private Sub InitialiserVariables(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Initialisation des variables comprises dans la configuration
10: Dim rstConfig As ADODB.Recordset
15: Dim rstProjSoum As ADODB.Recordset
		
20: rstConfig = New ADODB.Recordset
25: rstProjSoum = New ADODB.Recordset
		
30: Call rstConfig.Open("SELECT * FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
35: If m_eType = enumType.TYPE_PROJET Then
40: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: Else
50: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
55: End If
		
60: If Not rstProjSoum.EOF Then
65: m_sProfit = rstProjSoum.Fields("Profit").Value
70: m_sCommission = rstProjSoum.Fields("Commission").Value
75: m_sImprevue = rstProjSoum.Fields("Imprevue").Value
80: Else
85: m_sProfit = rstConfig.Fields("ProfitMec").Value
90: m_sCommission = rstConfig.Fields("Commission").Value
95: m_sImprevue = rstConfig.Fields("Imprévus").Value
100: End If
		
105: Call rstConfig.Close()
110: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
115: Call rstProjSoum.Close()
120: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
125: Exit Sub
		
AfficherErreur: 
		
130: Call AfficherErreur("frmProjSoumMec", "InitialiserVariables", Err, Erl())
	End Sub
	
	Private Sub ActiverBoutonsGroupe()
		
5: On Error GoTo AfficherErreur
		
		'Activation des boutons d'après le groupe
10: Dim bModif As Boolean
		
		'Si l'utilisateur a le droit d'affichage sur les projets et les soumissions
15: If g_bAffichageProjetsMec = True And g_bAffichageSoumissionsMec = True Then
			'On affiche cmbChoix
20: cmbChoix.Visible = True
			
			'Cette variable sert à savoir si l'utilisateur a le droit de voir le combo
25: m_bComboChoix = True
			
			'Type d'affichage
30: m_eType = enumType.TYPE_PROJET
			
			'Champs pour la modification
35: bModif = g_bModificationProjetsMec
40: Else
			'On cache cmbChoix
45: cmbChoix.Visible = False
			
			'Cette variable sert à savoir si l'utilisateur a le droit de voir le combo
50: m_bComboChoix = False
			
			'Si l'utilisateur a le droit d'affichage sur les projets
55: If g_bAffichageProjetsMec = True Then
				'Le seul choix possible est Projet
60: txtChoix.Text = "Projet"
				
				'Le type d'affichage
80: m_eType = enumType.TYPE_PROJET
				
				'Champs pour la modification
85: bModif = g_bModificationProjetsMec
90: Else
				'Le seul choix possible est Soumission
95: txtChoix.Text = "Soumission"
				
				'Type d'affichage
100: m_eType = enumType.TYPE_SOUMISSION
				
				'Champs pour la modification
105: bModif = g_bModificationSoumissionsMec
110: End If
115: End If
		
120: m_bModifProj = g_bModificationProjetsMec
125: m_bModifSoum = g_bModificationSoumissionsMec
130: m_bModifBonCommande = g_bModificationBC
135: m_bSupprimer = g_bSuppressionProjets
		
140: Cmdajouter.Enabled = bModif
145: cmdsupprimer.Enabled = bModif
150: cmdModifier.Enabled = bModif
155: cmdCopier.Enabled = bModif
160: cmdCreerProjet.Enabled = bModif
165: cmdBonCommande.Enabled = m_bModifBonCommande
170: cmdImprimer.Enabled = bModif
175: cmdDemande.Enabled = bModif
180: cmdAnglaisFrancais.Enabled = bModif
185: cmdExtra.Enabled = bModif
190: cmdSupprimerFRS.Visible = g_bModificationCatalogueMec
195: cmdRetour.Enabled = g_bModificationRetourMarchandise
200: cmdReception.Enabled = g_bModificationReception
		
205: Exit Sub
		
AfficherErreur: 
		
210: Call AfficherErreur("frmProjSoumMec", "ActiverBoutonsGroupe", Err, Erl())
	End Sub
	
	Private Sub AfficherProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
10: m_bPieceInutile = False
15: m_bChangementFRS = False
20: m_bRecherchePiece = False
		
		'Remet en mode affichage le projet ou la soumission voulue
25: m_bModeAffichage = True
		
		'Vide les champs
30: Call ViderChamps()
		
		'Rempli le combo
35: Call RemplirComboProjSoum(sNoProjSoum)
		
		'Barre les champs
40: Call BarrerChamps(True)
		
45: lvwSoumission.Top = VB6.TwipsToPixelsY(I_TOP_AFFICHAGE)
50: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - I_HEIGHT_AFFICHAGE)
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumMec", "AfficherProjSoum", Err, Erl())
	End Sub
	
	Private Sub AfficherControles(ByVal eMode As enumMode)
		
5: On Error GoTo AfficherErreur
		
		'Affichage des boutons selon si c'est un ajout/modif ou un affichage
10: Dim bAjouter As Boolean
15: Dim bModifier As Boolean
20: Dim bSupprimer As Boolean
25: Dim bEnregistrer As Boolean
30: Dim bAnnuler As Boolean
35: Dim bFermer As Boolean
40: Dim bImprimer As Boolean
45: Dim bCmbClient As Boolean
50: Dim bCmbContact As Boolean
55: Dim bCmbProjSoum As Boolean
60: Dim bCmbTransport As Boolean
65: Dim bCmbChoix As Boolean
70: Dim bCmbOuvertFerme As Boolean
75: Dim bSection As Boolean
80: Dim bPieces As Boolean
85: Dim bTexte As Boolean
90: Dim bCreerProjet As Boolean
95: Dim bHistorique As Boolean
100: Dim bCopier As Boolean
105: Dim bBonCommande As Boolean
110: Dim bTri As Boolean
115: Dim bDemande As Boolean
120: Dim bExtra As Boolean
125: Dim bCatalogue As Boolean
130: Dim bBrowseChemin As Boolean
135: Dim bInutile As Boolean
140: Dim bMauvaisPrix As Boolean
145: Dim bRapportFact As Boolean
150: Dim bDateFacture As Boolean
155: Dim bSortiMagasin As Boolean
160: Dim bRetour As Boolean
165: Dim bForfait As Boolean
170: Dim bExport As Boolean
175: Dim bReception As Boolean
180: Dim bAnglaisFrancais As Boolean
185: Dim bRechercheClient As Boolean
		
190: m_eMode = eMode
		
195: Select Case eMode
			Case enumMode.MODE_AJOUT_MODIF
200: bEnregistrer = True
205: bAnnuler = True
210: bSection = True
215: bPieces = True
220: bTexte = True
225: bTri = True
				
230: If (m_eType = enumType.TYPE_SOUMISSION) Or (m_eType = enumType.TYPE_PROJET And Mid(txtNoProjSoum.Text, 3, 1) <> "3") Then
235: bCmbClient = True
240: bCmbContact = True
245: bRechercheClient = True
250: End If
				
255: bCmbTransport = True
260: bCatalogue = True
265: bBrowseChemin = True
270: bMauvaisPrix = True
275: bForfait = True
				
280: If m_eType = enumType.TYPE_PROJET Then
285: bInutile = True
					
290: If g_bModificationReception = True Then
295: bSortiMagasin = True
300: End If
					
305: If g_bModificationFacturation = True Then
310: bDateFacture = True
315: End If
320: End If
				
325: Case enumMode.MODE_INACTIF
330: bModifier = True
335: bFermer = True
340: bImprimer = True
345: bCmbProjSoum = True
350: bCmbChoix = True
355: bCmbOuvertFerme = True
360: bHistorique = True
365: bDemande = True
370: bExport = True
375: bAnglaisFrancais = True
380: bAjouter = True
				
385: If m_eType = enumType.TYPE_PROJET Then
390: bBonCommande = True
395: bExtra = True
					
400: If g_bModificationRetourMarchandise = True Then
405: bRetour = True
410: End If
					
415: If g_bModificationFacturation = True Then
420: bRapportFact = True
425: End If
					
430: If g_bModificationReception = True Then
435: bReception = True
440: End If
					
445: If m_bSupprimer = True Then
450: bSupprimer = True
455: End If
460: Else
465: bSupprimer = True
470: bCopier = True
					
475: If VerifierSiDejaProjet = False Then
480: bCreerProjet = True
485: End If
490: End If
495: End Select
		
500: Cmdajouter.Visible = bAjouter
505: cmdModifier.Visible = bModifier
510: cmdsupprimer.Visible = bSupprimer
515: cmdEnregistrer.Visible = bEnregistrer
520: cmdAnnuler.Visible = bAnnuler
525: Cmdfermer.Visible = bFermer
530: cmdImprimer.Visible = bImprimer
535: cmdRapportFACT.Visible = bRapportFact
540: cmdTexte.Visible = bTexte
545: cmdHistorique.Visible = bHistorique
550: cmdCopier.Visible = bCopier
555: cmdBonCommande.Visible = bBonCommande
560: cmdDemande.Visible = bDemande
565: cmdCreerProjet.Visible = bCreerProjet
570: cmdExtra.Visible = bExtra
575: cmdCatalogue.Visible = bCatalogue
580: cmdBrowse.Visible = bBrowseChemin
585: cmdMaterielInutile.Visible = bInutile
590: cmdMauvaisPrix.Visible = bMauvaisPrix
595: cmdSortieMagasin.Visible = bSortiMagasin
600: cmdRetour.Visible = bRetour
605: cmdForfait.Visible = bForfait
610: cmdEffacerForfait.Visible = bForfait
615: cmdExport.Visible = bExport
620: cmdReception.Visible = bReception
625: cmdAnglaisFrancais.Visible = bAnglaisFrancais
		
630: lblDateFacturation.Visible = bDateFacture
635: txtDateFacturation.Visible = bDateFacture
640: cmdDateFacturation.Visible = bDateFacture
		
645: cmbclient.Visible = bCmbClient
650: txtClient.Visible = Not bCmbClient
		
655: cmbContact.Visible = bCmbContact
660: txtcontact.Visible = Not bCmbContact
		
		'Si on a le droit d'affiche le combo
665: If m_bComboChoix = True Then
670: cmbChoix.Visible = bCmbChoix
675: txtChoix.Visible = Not bCmbChoix
680: End If
		
685: cmbOuvertFerme.Visible = bCmbOuvertFerme
		
690: cmbProjSoum.Visible = bCmbProjSoum
695: txtNoProjSoum.Visible = Not bCmbProjSoum
		
700: lblSections.Visible = bSection
705: cmbSections.Visible = bSection
710: cmdAjouterSection.Visible = bSection
		
715: lblPiece.Visible = bPieces
720: cmbPieces.Visible = bPieces
725: lvwPieces.Visible = bPieces
		
730: lblTri.Visible = bTri
735: cmbTri.Visible = bTri
740: cmdTri.Visible = bTri
745: cmdRafraichir.Visible = bTri
		
750: lblPrixTotal.Visible = m_bDroitPrix
755: lblCommission.Visible = m_bDroitPrix
760: lblProfit.Visible = m_bDroitPrix
765: lblImprevus.Visible = m_bDroitPrix
770: lblTotalPieces.Visible = m_bDroitPrix
775: lblTotalTemps.Visible = m_bDroitPrix
		
780: txtPrixTotal.Visible = m_bDroitPrix
785: txtCommission.Visible = m_bDroitPrix
790: txtProfit.Visible = m_bDroitPrix
795: txtImprevus.Visible = m_bDroitPrix
800: txtTotalPieces.Visible = m_bDroitPrix
805: txtTotalTemps.Visible = m_bDroitPrix
		
810: cmdRechercherClient.Visible = bRechercheClient
		
815: Exit Sub
		
AfficherErreur: 
		
820: Call AfficherErreur("frmProjSoumMec", "AfficherControles", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbChoix.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbChoix_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbChoix.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
10: Dim bModif As Boolean
15: Dim iCmbOuvertFerme As Short
		
20: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
25: txtChoix.Text = cmbChoix.Text
		
		'Met les CheckBoxes sur le ListView
30: lvwSoumission.CheckBoxes = True
		
35: If cmbChoix.SelectedIndex = I_IDX_SOUMISSION Then
			'Change le type
40: m_eType = enumType.TYPE_SOUMISSION
			
45: m_bChangementChoix = True
			
50: iCmbOuvertFerme = cmbOuvertFerme.SelectedIndex
			
55: Call cmbOuvertFerme.Items.Clear()
			
60: Call cmbOuvertFerme.Items.Add("Ouvertes")
65: Call cmbOuvertFerme.Items.Add("Toutes")
			
70: cmbOuvertFerme.SelectedIndex = iCmbOuvertFerme
			
75: m_bChangementChoix = False
			
80: bModif = m_bModifSoum
			
			'Cache la soumission
85: lblNoSoumission.Visible = False
90: txtNoSoumission.Visible = False
			
			'Cache Prix Réception
95: lblPrixReception.Visible = False
100: txtPrixReception.Visible = False
			
			'Cache Prix Soumission
105: lblPrixSoumission.Visible = False
110: txtPrixSoumission.Visible = False
115: Else
			'Change le type
120: m_eType = enumType.TYPE_PROJET
			
125: m_bChangementChoix = True
			
130: iCmbOuvertFerme = cmbOuvertFerme.SelectedIndex
			
135: Call cmbOuvertFerme.Items.Clear()
			
140: Call cmbOuvertFerme.Items.Add("Ouverts")
145: Call cmbOuvertFerme.Items.Add("Tous")
			
150: cmbOuvertFerme.SelectedIndex = iCmbOuvertFerme
			
155: m_bChangementChoix = False
			
160: bModif = m_bModifProj
			
			'Affiche la soumission
165: lblNoSoumission.Visible = True
170: txtNoSoumission.Visible = True
			
			'Affiche Prix Réception
175: lblPrixReception.Visible = True
180: txtPrixReception.Visible = True
			
			'Affiche Prix Soumission
185: lblPrixSoumission.Visible = True
190: txtPrixSoumission.Visible = True
			
195: txtDateFacturation.Text = ConvertDate(Today)
200: End If
		
		'Active ou désactive les boutons de modification selon
		'le groupe auquel l'utilisateur appartient
205: cmdModifier.Enabled = bModif
210: cmdsupprimer.Enabled = bModif
215: Cmdajouter.Enabled = bModif
220: cmdCopier.Enabled = bModif
225: cmdCreerProjet.Enabled = bModif
230: cmdBonCommande.Enabled = m_bModifBonCommande
235: cmdImprimer.Enabled = bModif
240: cmdDemande.Enabled = bModif
245: cmdAnglaisFrancais.Enabled = bModif
250: cmdExtra.Enabled = bModif
		
		'Ajoute les colonnes selon le groupe
255: Call RemplirColonnes()
		
260: m_bModeAffichage = True
		
		'Vide les champs
265: Call ViderChamps()
		
		'Barre les champs
270: Call BarrerChamps(True)
		
		'Rempli le combo
275: Call RemplirComboProjSoum(vbNullString)
		
		'Affiche les controles pour le mode inactif
280: Call AfficherControles(enumMode.MODE_INACTIF)
		
285: Call PositionnerBoutons()
		
290: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
295: Exit Sub
		
AfficherErreur: 
		
300: Call AfficherErreur("frmProjSoumMec", "cmbChoix_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbclient.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbclient_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbclient.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
		'Rempli le combo des contacts selon le client choisi
10: Call RemplirComboContacts()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmbclient_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbOuvertFerme.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbOuvertFerme_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbOuvertFerme.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
10: If cmbChoix.SelectedIndex <> -1 Then
15: If m_bChangementChoix = False Then
20: Call RemplirComboProjSoum("")
25: End If
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("FrmProjSoumElec", "cmbOuvertFerme_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbPieces.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbPieces_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbPieces.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
		'Rempli lvwPieces selon la catégorie de pièce choisie
10: Call RemplirListViewPieces()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmbPieces_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbProjSoum.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbProjSoum_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbProjSoum.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstOuvert As ADODB.Recordset
20: Dim iCompteur As Short
25: Dim sNomClient As String
30: Dim sNomContact As String
35: Dim sNumero As String
40: Dim bTrouve As Boolean
		
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
50: If cmbProjSoum.Text <> "" Then
55: sNumero = txtNoProjSoum.Text
			
60: txtNoProjSoum.Text = cmbProjSoum.Text
			
65: Call InitialiserVariables(txtNoProjSoum.Text)
			
70: If m_bEnregistrement = False Then
75: m_eLangage = enumLangage.FRANCAIS
				
80: cmdAnglaisFrancais.Text = "Anglais"
85: End If
			
90: rstProjSoum = New ADODB.Recordset
			
95: If m_eType = enumType.TYPE_PROJET Then
100: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
105: Else
110: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
115: End If
			
120: If rstProjSoum.Fields("Modification").Value = True And rstProjSoum.Fields("Par").Value = g_sEmploye Then
125: cmdReset.Visible = True
130: End If
			
135: Call InitialiserTempsTaux(False)
			
140: If m_eType = enumType.TYPE_SOUMISSION Then
				'Si la soumission n'est pas assigné à un projet
145: If VerifierSiDejaProjet = False Then
					'On affiche le bouton cmdCreerProjet
150: cmdCreerProjet.Visible = True
155: Else
160: cmdCreerProjet.Visible = False
165: End If
170: End If
			
			'Rempli les valeurs de la soumission ou du projet sélectionné
175: Call RemplirProjSoum()
			
			'Le temps calculé dans le projet est le temps réel, c'est pourquoi il faut le recalculer
			'puisque le temps varie souvent
180: If m_eType = enumType.TYPE_PROJET Then
185: rstOuvert = New ADODB.Recordset
				
190: Call rstOuvert.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
195: If rstOuvert.Fields("Ouvert").Value = True Then
200: m_bModeAffichage = False
					
205: Call CalculerPrix()
					
210: m_bModeAffichage = True
					
215: rstProjSoum.Fields("total_Commission").Value = txtCommission.Text
220: rstProjSoum.Fields("Total_Profit").Value = txtProfit.Text
225: rstProjSoum.Fields("PrixTotal").Value = txtPrixTotal.Text
230: rstProjSoum.Fields("Total_piece").Value = txtTotalPieces.Text
235: rstProjSoum.Fields("total_imprevue").Value = txtImprevus.Text
240: rstProjSoum.Fields("Total_Temps").Value = txtTotalTemps.Text
					
245: Call rstProjSoum.Update()
250: End If
255: End If
			
260: Call rstProjSoum.Close()
			
265: sNomClient = txtClient.Text
270: sNomContact = txtcontact.Text
			
			'Pour choisir le bon client dans le combo des clients
275: For iCompteur = 0 To cmbclient.Items.Count - 1
280: If VB6.GetItemString(cmbclient, iCompteur) = sNomClient Then
285: cmbclient.SelectedIndex = iCompteur
					
290: bTrouve = True
					
295: Exit For
300: End If
305: Next 
			
310: If bTrouve = False Then
315: Call RemplirComboClients(vbNullString)
				
320: For iCompteur = 0 To cmbclient.Items.Count - 1
325: If VB6.GetItemString(cmbclient, iCompteur) = sNomClient Then
330: cmbclient.SelectedIndex = iCompteur
						
335: Exit For
340: End If
345: Next 
350: End If
			
			'Pour choisir le bon contact dans le combo des contacts
355: For iCompteur = 0 To cmbContact.Items.Count - 1
360: If VB6.GetItemString(cmbContact, iCompteur) = sNomContact Then
365: cmbContact.SelectedIndex = iCompteur
					
370: Exit For
375: End If
380: Next 
385: End If
		
390: Call CalculerPrixReception()
		
395: If m_eType = enumType.TYPE_PROJET Then
400: Call rstProjSoum.Open("SELECT PrixRéception FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
405: rstProjSoum.Fields("PrixRéception").Value = txtPrixReception.Text
			
410: Call rstProjSoum.Update()
			
415: Call rstProjSoum.Close()
420: End If
		
425: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
430: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
435: Exit Sub
		
AfficherErreur: 
		
440: Call AfficherErreur("frmProjSoumMec", "cmbProjSoum_Click", Err, Erl(), txtNoProjSoum.Text)
	End Sub
	
	Private Sub InitialiserTempsTaux(ByVal bEmpty As Boolean)
		
5: On Error GoTo AfficherErreur
		
		'Pour initialiser les temps et les taux horaires
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sTable As String
20: Dim sChamps As String
		
25: m_bTempsDejaOuvert = False
		
30: If bEmpty = True Then
35: m_sTempsDessin = "0"
40: m_sTempsCoupe = "0"
45: m_sTempsMachinage = "0"
50: m_sTempsSoudure = "0"
55: m_sTempsAssemblage = "0"
60: m_sTempsPeinture = "0"
65: m_sTempsTest = "0"
70: m_sTempsInstallation = "0"
75: m_sTempsFormation = "0"
80: m_sTempsGestion = "0"
85: m_sTempsShipping = "0"
			
90: m_sNbrePersonne = "0"
95: m_sTempsHebergement = "0"
100: m_sTempsRepas = "0"
105: m_sTempsTransport = "0"
110: m_sTempsUniteMobile = "0"
115: m_sPrixEmballage = "0"
			
120: m_sTauxDessin = "0"
125: m_sTauxCoupe = "0"
130: m_sTauxMachinage = "0"
135: m_sTauxSoudure = "0"
140: m_sTauxAssemblage = "0"
145: m_sTauxPeinture = "0"
150: m_sTauxTest = "0"
155: m_sTauxInstallation = "0"
160: m_sTauxFormation = "0"
165: m_sTauxGestion = "0"
170: m_sTauxShipping = "0"
			
175: m_sTauxHebergement1 = "0"
180: m_sTauxHebergement2 = "0"
185: m_sTauxRepas = "0"
190: m_sTauxTransport = "0"
195: m_sTauxUniteMobile = "0"
			
200: m_bTempsProjLock = False
205: Else
210: If m_eType = enumType.TYPE_PROJET Then
215: sTable = "GRB_ProjetMec"
220: sChamps = "IDProjet"
225: Else
230: sTable = "GRB_SoumissionMec"
235: sChamps = "IDSoumission"
240: End If
			
245: rstProjSoum = New ADODB.Recordset
			
250: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
255: If m_eType = enumType.TYPE_SOUMISSION Then
260: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
265: m_sTempsDessin = rstProjSoum.Fields("TempsDessin").Value
270: Else
275: m_sTempsDessin = "0"
280: End If
				
285: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupe").Value) Then
290: m_sTempsCoupe = rstProjSoum.Fields("TempsCoupe").Value
295: Else
300: m_sTempsCoupe = "0"
305: End If
				
310: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinage").Value) Then
315: m_sTempsMachinage = rstProjSoum.Fields("TempsMachinage").Value
320: Else
325: m_sTempsMachinage = "0"
330: End If
				
335: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudure").Value) Then
340: m_sTempsSoudure = rstProjSoum.Fields("TempsSoudure").Value
345: Else
350: m_sTempsSoudure = "0"
355: End If
				
360: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
365: m_sTempsAssemblage = rstProjSoum.Fields("TempsAssemblage").Value
370: Else
375: m_sTempsAssemblage = "0"
380: End If
				
385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeinture").Value) Then
390: m_sTempsPeinture = rstProjSoum.Fields("TempsPeinture").Value
395: Else
400: m_sTempsPeinture = "0"
405: End If
				
410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
415: m_sTempsTest = rstProjSoum.Fields("TempsTest").Value
420: Else
425: m_sTempsTest = "0"
430: End If
				
435: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
440: m_sTempsInstallation = rstProjSoum.Fields("TempsInstallation").Value
445: Else
450: m_sTempsInstallation = "0"
455: End If
				
460: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
465: m_sTempsFormation = rstProjSoum.Fields("TempsFormation").Value
470: Else
475: m_sTempsFormation = "0"
480: End If
				
485: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
490: m_sTempsGestion = rstProjSoum.Fields("TempsGestion").Value
495: Else
500: m_sTempsGestion = "0"
505: End If
				
510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
515: m_sTempsShipping = rstProjSoum.Fields("TempsShipping").Value
520: Else
525: m_sTempsShipping = "0"
530: End If
535: Else
540: Call InitialiserTempsReel()
				
545: m_bTempsProjLock = rstProjSoum.Fields("TempsProjBarré").Value
				
550: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessinProj").Value) Then
555: m_sTempsDessinProj = rstProjSoum.Fields("TempsDessinProj").Value
560: Else
565: m_sTempsDessinProj = "0"
570: End If
				
575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupeProj").Value) Then
580: m_sTempsCoupeProj = rstProjSoum.Fields("TempsCoupeProj").Value
585: Else
590: m_sTempsCoupeProj = "0"
595: End If
				
600: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinageProj").Value) Then
605: m_sTempsMachinageProj = rstProjSoum.Fields("TempsMachinageProj").Value
610: Else
615: m_sTempsMachinageProj = "0"
620: End If
				
625: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudureProj").Value) Then
630: m_sTempsSoudureProj = rstProjSoum.Fields("TempsSoudureProj").Value
635: Else
640: m_sTempsSoudureProj = "0"
645: End If
				
650: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
655: m_sTempsAssemblageProj = rstProjSoum.Fields("TempsAssemblageProj").Value
660: Else
665: m_sTempsAssemblageProj = "0"
670: End If
				
675: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeintureProj").Value) Then
680: m_sTempsPeintureProj = rstProjSoum.Fields("TempsPeintureProj").Value
685: Else
690: m_sTempsPeintureProj = "0"
695: End If
				
700: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTestProj").Value) Then
705: m_sTempsTestProj = rstProjSoum.Fields("TempsTestProj").Value
710: Else
715: m_sTempsTestProj = "0"
720: End If
				
725: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallationProj").Value) Then
730: m_sTempsInstallationProj = rstProjSoum.Fields("TempsInstallationProj").Value
735: Else
740: m_sTempsInstallationProj = "0"
745: End If
				
750: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormationProj").Value) Then
755: m_sTempsFormationProj = rstProjSoum.Fields("TempsFormationProj").Value
760: Else
765: m_sTempsFormationProj = "0"
770: End If
				
775: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestionProj").Value) Then
780: m_sTempsGestionProj = rstProjSoum.Fields("TempsGestionProj").Value
785: Else
790: m_sTempsGestionProj = "0"
795: End If
				
800: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShippingProj").Value) Then
805: m_sTempsShippingProj = rstProjSoum.Fields("TempsShippingProj").Value
810: Else
815: m_sTempsShippingProj = "0"
820: End If
				
825: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessinConc").Value) Then
830: m_sTempsDessinConc = rstProjSoum.Fields("TempsDessinConc").Value
835: Else
840: m_sTempsDessinConc = "0"
845: End If
				
850: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupeConc").Value) Then
855: m_sTempsCoupeConc = rstProjSoum.Fields("TempsCoupeConc").Value
860: Else
865: m_sTempsCoupeConc = "0"
870: End If
				
875: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinageConc").Value) Then
880: m_sTempsMachinageConc = rstProjSoum.Fields("TempsMachinageConc").Value
885: Else
890: m_sTempsMachinageConc = "0"
895: End If
				
900: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudureConc").Value) Then
905: m_sTempsSoudureConc = rstProjSoum.Fields("TempsSoudureConc").Value
910: Else
915: m_sTempsSoudureConc = "0"
920: End If
				
925: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
930: m_sTempsAssemblageConc = rstProjSoum.Fields("TempsAssemblageConc").Value
935: Else
940: m_sTempsAssemblageConc = "0"
945: End If
				
950: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeintureConc").Value) Then
955: m_sTempsPeintureConc = rstProjSoum.Fields("TempsPeintureConc").Value
960: Else
965: m_sTempsPeintureConc = "0"
970: End If
				
975: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTestConc").Value) Then
980: m_sTempsTestConc = rstProjSoum.Fields("TempsTestConc").Value
985: Else
990: m_sTempsTestConc = "0"
995: End If
				
1000: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallationConc").Value) Then
1005: m_sTempsInstallationConc = rstProjSoum.Fields("TempsInstallationConc").Value
1010: Else
1015: m_sTempsInstallationConc = "0"
1020: End If
				
1025: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormationConc").Value) Then
1030: m_sTempsFormationConc = rstProjSoum.Fields("TempsFormationConc").Value
1035: Else
1040: m_sTempsFormationConc = "0"
1045: End If
				
1050: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestionConc").Value) Then
1055: m_sTempsGestionConc = rstProjSoum.Fields("TempsGestionConc").Value
1060: Else
1065: m_sTempsGestionConc = "0"
1070: End If
				
1075: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShippingConc").Value) Then
1080: m_sTempsShippingConc = rstProjSoum.Fields("TempsShippingConc").Value
1085: Else
1090: m_sTempsShippingConc = "0"
1095: End If
1100: End If
			
1105: If m_eType = enumType.TYPE_PROJET Then
1110: m_sNbrePersonne = "0"
1115: m_sTempsHebergement = "0"
1120: m_sTempsRepas = "0"
1125: m_sTempsTransport = "0"
1130: m_sTempsUniteMobile = "0"
1135: Else
1140: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
1145: m_sNbrePersonne = rstProjSoum.Fields("NbrePersonne").Value
1150: Else
1155: m_sNbrePersonne = "0"
1160: End If
				
1165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
1170: m_sTempsHebergement = rstProjSoum.Fields("TempsHebergement").Value
1175: Else
1180: m_sTempsHebergement = "0"
1185: End If
				
1190: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
1195: m_sTempsRepas = rstProjSoum.Fields("TempsRepas").Value
1200: Else
1205: m_sTempsRepas = "0"
1210: End If
				
1215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
1220: m_sTempsTransport = rstProjSoum.Fields("TempsTransport").Value
1225: Else
1230: m_sTempsTransport = "0"
1235: End If
				
1240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
1245: m_sTempsUniteMobile = rstProjSoum.Fields("TempsUniteMobile").Value
1250: Else
1255: m_sTempsUniteMobile = "0"
1260: End If
1265: End If
			
1270: m_sPrixEmballage = rstProjSoum.Fields("PrixEmballage").Value
			
1275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
1280: m_sTauxDessin = rstProjSoum.Fields("TauxDessin").Value
1285: Else
1290: m_sTauxDessin = "0"
1295: End If
			
1300: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
1305: m_sTauxCoupe = rstProjSoum.Fields("TauxCoupe").Value
1310: Else
1315: m_sTauxCoupe = "0"
1320: End If
			
1325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
1330: m_sTauxMachinage = rstProjSoum.Fields("TauxMachinage").Value
1335: Else
1340: m_sTauxMachinage = "0"
1345: End If
			
1350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
1355: m_sTauxSoudure = rstProjSoum.Fields("TauxSoudure").Value
1360: Else
1365: m_sTauxSoudure = "0"
1370: End If
			
1375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
1380: m_sTauxAssemblage = rstProjSoum.Fields("TauxAssemblage").Value
1385: Else
1390: m_sTauxAssemblage = "0"
1395: End If
			
1400: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
1405: m_sTauxPeinture = rstProjSoum.Fields("TauxPeinture").Value
1410: Else
1415: m_sTauxPeinture = "0"
1420: End If
			
1425: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
1430: m_sTauxTest = rstProjSoum.Fields("TauxTest").Value
1435: Else
1440: m_sTauxTest = "0"
1445: End If
			
1450: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
1455: m_sTauxInstallation = rstProjSoum.Fields("TauxInstallation").Value
1460: Else
1465: m_sTauxInstallation = "0"
1470: End If
			
1475: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
1480: m_sTauxFormation = rstProjSoum.Fields("TauxFormation").Value
1485: Else
1490: m_sTauxFormation = "0"
1495: End If
			
1500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
1505: m_sTauxGestion = rstProjSoum.Fields("TauxGestion").Value
1510: Else
1515: m_sTauxGestion = "0"
1520: End If
			
1525: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1530: m_sTauxShipping = rstProjSoum.Fields("TauxShipping").Value
1535: Else
1540: m_sTauxShipping = "0"
1545: End If
			
1550: If m_eType = enumType.TYPE_PROJET Then
1555: m_sTauxHebergement1 = "0"
1560: m_sTauxHebergement2 = "0"
1565: m_sTauxRepas = "0"
1570: m_sTauxTransport = "0"
1575: m_sTauxUniteMobile = "0"
1580: Else
1585: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
1590: m_sTauxHebergement1 = rstProjSoum.Fields("TauxHebergement1").Value
1595: Else
1600: m_sTauxHebergement1 = "0"
1605: End If
				
1610: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
1615: m_sTauxHebergement2 = rstProjSoum.Fields("TauxHebergement2").Value
1620: Else
1625: m_sTauxHebergement2 = "0"
1630: End If
				
1635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
1640: m_sTauxRepas = rstProjSoum.Fields("TauxRepas").Value
1645: Else
1650: m_sTauxRepas = "0"
1655: End If
				
1660: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
1665: m_sTauxTransport = rstProjSoum.Fields("TauxTransport").Value
1670: Else
1675: m_sTauxTransport = "0"
1680: End If
				
1685: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
1690: m_sTauxUniteMobile = rstProjSoum.Fields("TauxUniteMobile").Value
1695: Else
1700: m_sTauxUniteMobile = "0"
1705: End If
1710: End If
			
1715: Call rstProjSoum.Close()
1720: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
1725: End If
		
1730: Exit Sub
		
AfficherErreur: 
		
1735: Call AfficherErreur("frmProjSoumMec", "InitialiserTempsTaux", Err, Erl())
	End Sub
	
	Private Sub InitialiserTempsReel()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPunch As ADODB.Recordset
15: Dim sDateDebut As String
20: Dim sDateFin As String
25: Dim sTotal As String
30: Dim sFilterNoProjet As String
		
35: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
40: sFilterNoProjet = "LEFT(NoProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "'"
45: Else
50: sFilterNoProjet = "NoProjet = '" & txtNoProjSoum.Text & "'"
55: End If
		
60: sDateDebut = "TIMESERIAL(Left(GRB_Punch.HeureDébut,2),RIGHT(GRB_Punch.HeureDébut,2),0)"
		
65: sDateFin = "TIMESERIAL(Left(GRB_Punch.HeureFin,2),RIGHT(GRB_Punch.HeureFin,2),0)"
		
70: sTotal = "(SUM(" & sDateFin & " - " & sDateDebut & ")* 24) As Total"
		
75: rstPunch = New ADODB.Recordset
		
80: Call rstPunch.Open("SELECT Type, " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null GROUP BY Type", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
85: m_sTempsDessin = "0"
90: m_sTempsCoupe = "0"
95: m_sTempsMachinage = "0"
100: m_sTempsSoudure = "0"
105: m_sTempsAssemblage = "0"
110: m_sTempsPeinture = "0"
115: m_sTempsTest = "0"
120: m_sTempsInstallation = "0"
125: m_sTempsFormation = "0"
130: m_sTempsGestion = "0"
135: m_sTempsShipping = "0"
		
140: Do While Not rstPunch.EOF
145: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPunch.Fields("Total").Value) Then
150: Select Case rstPunch.Fields("Type").Value
					Case "Dessin" : m_sTempsDessin = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
155: Case "Coupe" : m_sTempsCoupe = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
160: Case "Machinage" : m_sTempsMachinage = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
165: Case "Soudure" : m_sTempsSoudure = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
170: Case "Assemblage" : m_sTempsAssemblage = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
175: Case "Peinture" : m_sTempsPeinture = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
180: Case "Test" : m_sTempsTest = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
185: Case "Installation" : m_sTempsInstallation = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
190: Case "Formation" : m_sTempsFormation = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
195: Case "Gestion" : m_sTempsGestion = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
200: Case "Shipping" : m_sTempsShipping = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
205: End Select
210: End If
			
215: Call rstPunch.MoveNext()
220: Loop 
		
225: Call rstPunch.Close()
230: 'UPGRADE_NOTE: Object rstPunch may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPunch = Nothing
		
235: Exit Sub
		
AfficherErreur: 
		
240: Call AfficherErreur("frmChoixDateImpressionFacturation", "RemplirTempsReelsElec", Err, Erl())
	End Sub
	
	Private Sub cmbProjSoum_KeyUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles cmbProjSoum.KeyUp
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: For iCompteur = 0 To cmbProjSoum.Items.Count - 1
20: If UCase(VB6.GetItemString(cmbProjSoum, iCompteur)) = UCase(cmbProjSoum.Text) Then
25: cmbProjSoum.SelectedIndex = iCompteur
				
30: Exit For
35: End If
40: Next 
		
45: Exit Sub
		
AfficherErreur: 
		
50: Call AfficherErreur("frmProjSoumMec", "cmbProjSoum_KeyUp", Err, Erl())
	End Sub
	
	Private Sub cmdAjouterSection_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAjouterSection.Click
		
5: On Error GoTo AfficherErreur
		
		'Affiche le form frmSoumissionSection
10: Call OuvrirForm(frmSoumissionSectionMec, True)
		
		'Après que l'utilisateur a refermé le form, on rafraichi le
		'contenu du combo
15: Call RemplirComboSections()
		
		'On change l'ordre si elle a été changée
20: Call UpdateOrdre()
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "cmdAjouterSection_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnglaisFrancais_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnglaisFrancais.Click
		
5: On Error GoTo AfficherErreur
		
10: If cmdAnglaisFrancais.Text = "Anglais" Then
15: m_eLangage = enumLangage.ANGLAIS
			
20: cmdAnglaisFrancais.Text = "Français"
25: Else
30: m_eLangage = enumLangage.FRANCAIS
			
35: cmdAnglaisFrancais.Text = "Anglais"
40: End If
		
45: Call UpdateDescription()
		
50: Call RemplirComboSections()
		
55: Call UpdateOrdre()
		
60: Exit Sub
		
AfficherErreur: 
		
65: Call AfficherErreur("frmProjSoumMec", "cmdAnglaisFrancais_Click", Err, Erl())
	End Sub
	
	Private Sub UpdateDescription()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstPieceMec As ADODB.Recordset
		
20: rstProjSoum = New ADODB.Recordset
25: rstPieceMec = New ADODB.Recordset
		
30: If m_eType = enumType.TYPE_PROJET Then
35: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
40: Else
45: Call rstProjSoum.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: End If
		
55: Do While Not rstProjSoum.EOF
60: Call rstPieceMec.Open("SELECT * FROM GRB_CatalogueMec WHERE PIECE = '" & rstProjSoum.Fields("NumItem").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: rstProjSoum.Fields("Desc_FR").Value = rstPieceMec.Fields("DESC_FR").Value
70: rstProjSoum.Fields("Desc_EN").Value = rstPieceMec.Fields("DESC_EN").Value
			
75: Call rstProjSoum.Update()
			
80: Call rstPieceMec.Close()
			
85: Call rstProjSoum.MoveNext()
90: Loop 
		
95: 'UPGRADE_NOTE: Object rstPieceMec may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceMec = Nothing
		
100: Call rstProjSoum.Close()
105: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
110: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
115: Exit Sub
		
AfficherErreur: 
		
120: Call AfficherErreur("frmProjSoumMec", "UpdateDescription", Err, Erl())
	End Sub
	
	Private Sub cmdAnnuler_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnuler.Click
		
5: On Error GoTo AfficherErreur
		
10: frafournisseur.Visible = False
15: fraPieceTrouve.Visible = False
20: fraCommentaire.Visible = False
25: fraDateRequise.Visible = False
		
30: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
35: Call OuvrirProjSoum(False)
		
		'Remet en mode inactif
40: Call AfficherControles(enumMode.MODE_INACTIF)
		
45: m_bEnregistrement = True
		
		'Affiche l'enregistrement qui était actif avant
50: Call AfficherProjSoum(m_sAncienProjSoum)
		
55: m_bEnregistrement = False
		
60: m_bModeAjout = False
		
65: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
70: Exit Sub
		
AfficherErreur: 
		
75: Call AfficherErreur("frmProjSoumMec", "cmdAnnuler_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerCommentaire_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerCommentaire.Click
		
5: On Error GoTo AfficherErreur
		
10: fraCommentaire.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdAnnulerCommentaire_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerDateRequise_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerDateRequise.Click
		
5: On Error GoTo AfficherErreur
		
10: fraDateRequise.Visible = False
		
15: m_bMonthViewHasFocus = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "cmdAnnulerDateRequise_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerDateRequise_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles cmdAnnulerDateRequise.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.PixelsToTwipsX(eventArgs.X)
		Dim Y As Single = VB6.PixelsToTwipsY(eventArgs.Y)
		
5: On Error GoTo AfficherErreur
		
10: If m_bMonthViewHasFocus = True Then
15: Call cmdAnnulerDateRequise_Click(cmdAnnulerDateRequise, New System.EventArgs())
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "cmdAnnulerDateRequise_MouseUp", Err, Erl())
	End Sub
	
	Private Sub cmdExport_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdExport.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
		
15: rstProjSoum = New ADODB.Recordset
		
20: Call g_connData.Execute("DELETE * FROM GRB_impression_listepiece")
		
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
		
50: Call ExporterListePieces(rstProjSoum)
		
55: Call rstProjSoum.Close()
60: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumMec", "cmdExport_Click", Err, Erl())
	End Sub
	
	Private Sub ExporterListePieces(ByVal rstProjSoum As ADODB.Recordset)
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de soumission
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpListePiece As ADODB.Recordset
25: Dim iCompteurPiece As Short
30: Dim sSousSection As String
35: Dim sSection As String
40: Dim sNoProjet As String
45: Dim sNoSoumission As String
50: Dim bAjouterSection As Boolean
55: Dim bAjouterSousSection As Boolean
60: Dim bAjouterPiece As Boolean
65: Dim xlsApp As Excel.Application
70: Dim xlsWorkBook As Excel.Workbook
75: Dim iCompteur As Short
80: Dim sSaveAsFileName As String
		
85: rstPiece = New ADODB.Recordset
90: rstTemp = New ADODB.Recordset
95: rstImpListePiece = New ADODB.Recordset
		
100: iCompteurPiece = 1
		
105: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
110: If m_eType = enumType.TYPE_PROJET Then
115: sNoProjet = rstProjSoum.Fields("IDProjet").Value
120: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
125: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' And Type = 'M'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
130: Else
135: sNoProjet = vbNullString
140: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
145: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoSoumission & "' And Type = 'M'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
150: End If
		
155: Do While Not rstPiece.EOF
160: If rstPiece.Fields("Visible").Value = True Then
165: bAjouterSection = True
170: bAjouterSousSection = True
175: bAjouterPiece = True
				
180: rstImpListePiece.CursorLocation = ADODB.CursorLocationEnum.adUseClient
				
185: rstImpListePiece.Filter = ""
				
190: Call rstImpListePiece.Open("SELECT * FROM GRB_Impression_ListePiece WHERE IDSection = '" & rstPiece.Fields("IDSection").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
195: If Not rstImpListePiece.EOF Then
200: bAjouterSection = False
					
205: Do While Not rstImpListePiece.EOF
210: If rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value Then
215: bAjouterSousSection = False
							
220: If rstPiece.Fields("NumItem").Value <> "Texte" And rstPiece.Fields("NumItem").Value <> "Text" Then
225: If rstImpListePiece.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value Then
230: bAjouterPiece = False
									
235: rstImpListePiece.Fields("Qté").Value = CDbl(Replace(rstImpListePiece.Fields("Qté").Value, ".", ",")) + CDbl(rstPiece.Fields("Qté").Value)
									
240: Call rstImpListePiece.Update()
									
245: If rstImpListePiece.Fields("Qté").Value = 0 Then
250: Call rstImpListePiece.Delete()
										
255: rstImpListePiece.Filter = "NomSousSection = '" & Replace(rstPiece.Fields("SousSection").Value, "'", "''") & "'"
										
260: If rstImpListePiece.RecordCount = 1 Then
265: Call rstImpListePiece.Delete()
											
270: rstImpListePiece.Filter = "IDSection = '" & rstPiece.Fields("IDSection").Value & "'"
											
275: If rstImpListePiece.RecordCount = 1 Then
280: Call rstImpListePiece.Delete()
285: End If
290: End If
295: End If
300: End If
305: Else
310: Exit Do
315: End If
320: End If
						
325: Call rstImpListePiece.MoveNext()
330: Loop 
335: End If
				
340: If bAjouterSection = True Then
345: If m_eLangage = enumLangage.ANGLAIS Then
350: sSection = "NomSectionEN"
355: Else
360: sSection = "NomSectionFR"
365: End If
					
370: Call rstTemp.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
375: Call rstImpListePiece.AddNew()
					
380: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
385: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
					
390: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstTemp.Fields(sSection).Value) Then
395: rstImpListePiece.Fields("Section").Value = rstTemp.Fields(sSection).Value
400: Else
405: rstImpListePiece.Fields("Section").Value = " "
410: End If
					
415: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
420: Call rstImpListePiece.Update()
					
425: iCompteurPiece = iCompteurPiece + 1
					
430: Call rstTemp.Close()
435: End If
				
440: If bAjouterSousSection = True Then
445: sSousSection = rstPiece.Fields("SousSection").Value
					
450: If sSousSection = S_PAS_SOUS_SECTION Then
455: sSousSection = " "
460: End If
					
465: Call rstImpListePiece.AddNew()
					
470: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
475: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
480: rstImpListePiece.Fields("SousSection").Value = sSousSection
485: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
490: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
495: Call rstImpListePiece.Update()
					
500: iCompteurPiece = iCompteurPiece + 1
505: End If
				
510: If bAjouterPiece = True Then
					'ajoute une piece dans la liste de pièce
515: Call rstImpListePiece.AddNew()
					
520: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
525: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
530: rstImpListePiece.Fields("numitem").Value = rstPiece.Fields("numitem").Value
535: rstImpListePiece.Fields("qté").Value = rstPiece.Fields("qté").Value
					
540: If m_eLangage = enumLangage.ANGLAIS Then
545: rstImpListePiece.Fields("description").Value = rstPiece.Fields("DESC_EN").Value
550: Else
555: rstImpListePiece.Fields("description").Value = rstPiece.Fields("DESC_FR").Value
560: End If
					
565: rstImpListePiece.Fields("manufact").Value = rstPiece.Fields("manufact").Value
					
570: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
575: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
580: Call rstImpListePiece.Update()
					
585: iCompteurPiece = iCompteurPiece + 1
590: End If
				
595: Call rstImpListePiece.Close()
600: End If
			
605: Call rstPiece.MoveNext()
610: Loop 
		
		''''''''''''''''''''''''''''''''''''''''''''''''''
		' rapport liste piece, met dans l'ordre de ligne '
		''''''''''''''''''''''''''''''''''''''''''''''''''
615: rstImpListePiece.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
620: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_Listepiece WHERE IDSoumission = '" & sNoSoumission & "' ORDER BY NoLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
625: xlsApp = New Excel.Application
		
630: xlsWorkBook = xlsApp.Workbooks.Add
		
635: xlsApp.Range("A1")._Default = "Liste de matériel ( " & txtNoProjSoum.Text & " ) "
640: xlsApp.Range("A1").Font.Bold = True
645: xlsApp.Range("A1").Font.Underline = Excel.XlUnderlineStyle.xlUnderlineStyleSingle
650: xlsApp.Range("A1").HorizontalAlignment = Excel.Constants.xlCenter
655: xlsApp.Range("A1").Font.Size = 14
		
660: Call xlsApp.Range("A1:D1").Merge()
		
665: xlsApp.Range("A4")._Default = "Qté"
670: xlsApp.Range("A4").Font.Bold = True
675: xlsApp.Range("A4").HorizontalAlignment = Excel.Constants.xlCenter
		
680: xlsApp.Range("B4")._Default = "No. Item"
685: xlsApp.Range("B4").Font.Bold = True
690: xlsApp.Range("B4").HorizontalAlignment = Excel.Constants.xlCenter
		
695: xlsApp.Range("C4")._Default = "Description"
700: xlsApp.Range("C4").Font.Bold = True
705: xlsApp.Range("C4").HorizontalAlignment = Excel.Constants.xlCenter
		
710: xlsApp.Range("D4")._Default = "Manufacturier"
715: xlsApp.Range("D4").Font.Bold = True
720: xlsApp.Range("D4").HorizontalAlignment = Excel.Constants.xlCenter
		
725: xlsApp.Range("A4:D4").Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlContinuous
730: xlsApp.Range("A4:D4").Borders(Excel.XlBordersIndex.xlEdgeBottom).Weight = Excel.XlBorderWeight.xlMedium
735: xlsApp.Range("A4:D4").Borders(Excel.XlBordersIndex.xlEdgeBottom).ColorIndex = Excel.Constants.xlAutomatic
		
740: xlsApp.Range("A4:D4").Borders(Excel.XlBordersIndex.xlInsideVertical).LineStyle = Excel.XlLineStyle.xlContinuous
745: xlsApp.Range("A4:D4").Borders(Excel.XlBordersIndex.xlInsideVertical).Weight = Excel.XlBorderWeight.xlMedium
750: xlsApp.Range("A4:D4").Borders(Excel.XlBordersIndex.xlInsideVertical).ColorIndex = Excel.Constants.xlAutomatic
		
755: iCompteur = 5
		
760: Do While Not rstImpListePiece.EOF
765: xlsApp.Range("A" & iCompteur)._Default = rstImpListePiece.Fields("Qté").Value
			
770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If IsDbNull(rstImpListePiece.Fields("Section").Value) Then
775: xlsApp.Range("B" & iCompteur)._Default = rstImpListePiece.Fields("NumItem").Value
780: Else
785: xlsApp.Range("B" & iCompteur)._Default = rstImpListePiece.Fields("Section").Value
790: xlsApp.Range("B" & iCompteur).Font.Bold = True
795: End If
			
800: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If IsDbNull(rstImpListePiece.Fields("SousSection").Value) Then
805: xlsApp.Range("C" & iCompteur)._Default = rstImpListePiece.Fields("Description").Value
810: Else
815: xlsApp.Range("C" & iCompteur)._Default = rstImpListePiece.Fields("SousSection").Value
820: xlsApp.Range("C" & iCompteur).Font.Bold = True
825: End If
			
830: xlsApp.Range("D" & iCompteur)._Default = rstImpListePiece.Fields("Manufact").Value
			
835: xlsApp.Range("A" & iCompteur & ":D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlContinuous
840: xlsApp.Range("A" & iCompteur & ":D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).Weight = Excel.XlBorderWeight.xlThin
845: xlsApp.Range("A" & iCompteur & ":D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).ColorIndex = Excel.Constants.xlAutomatic
			
850: xlsApp.Range("A" & iCompteur & ":D" & iCompteur).Borders(Excel.XlBordersIndex.xlInsideVertical).LineStyle = Excel.XlLineStyle.xlContinuous
855: xlsApp.Range("A" & iCompteur & ":D" & iCompteur).Borders(Excel.XlBordersIndex.xlInsideVertical).Weight = Excel.XlBorderWeight.xlThin
860: xlsApp.Range("A" & iCompteur & ":D" & iCompteur).Borders(Excel.XlBordersIndex.xlInsideVertical).ColorIndex = Excel.Constants.xlAutomatic
			
865: Call rstImpListePiece.MoveNext()
			
870: iCompteur = iCompteur + 1
875: Loop 
		
880: iCompteur = iCompteur - 1
		
885: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlContinuous
890: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).Weight = Excel.XlBorderWeight.xlMedium
895: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).ColorIndex = Excel.Constants.xlAutomatic
		
900: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeTop).LineStyle = Excel.XlLineStyle.xlContinuous
905: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeTop).Weight = Excel.XlBorderWeight.xlMedium
910: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeTop).ColorIndex = Excel.Constants.xlAutomatic
		
915: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeLeft).LineStyle = Excel.XlLineStyle.xlContinuous
920: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeLeft).Weight = Excel.XlBorderWeight.xlMedium
925: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeLeft).ColorIndex = Excel.Constants.xlAutomatic
		
930: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeRight).LineStyle = Excel.XlLineStyle.xlContinuous
935: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeRight).Weight = Excel.XlBorderWeight.xlMedium
940: xlsApp.Range("A4:D" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeRight).ColorIndex = Excel.Constants.xlAutomatic
		
945: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("A:A").EntireColumn.AutoFit()
950: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("B:B").EntireColumn.AutoFit()
955: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("C:C").EntireColumn.AutoFit()
960: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("D:D").EntireColumn.AutoFit()
		
965: Call rstImpListePiece.Close()
970: 'UPGRADE_NOTE: Object rstImpListePiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpListePiece = Nothing
		
975: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
980: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.GetSaveAsFilename(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sSaveAsFileName = xlsApp.GetSaveAsFilename(txtNoProjSoum.Text & ".xls", "Fichiers Excel (*.xlx), *.xls")
		
985: If sSaveAsFileName <> "Faux" Then
990: Call xlsWorkBook.SaveAs(sSaveAsFileName)
995: End If
		
1000: xlsWorkBook.Saved = True
		
1005: Call xlsWorkBook.Close()
		
1010: 'UPGRADE_NOTE: Object xlsWorkBook may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		xlsWorkBook = Nothing
		
1015: Call xlsApp.Quit()
		
1020: 'UPGRADE_NOTE: Object xlsApp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		xlsApp = Nothing
		
1025: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
1030: Exit Sub
		
AfficherErreur: 
		
1035: Call AfficherErreur("frmProjSoumMec", "ExporterListePieces", Err, Erl())
	End Sub
	
	Private Sub cmdOKCommentaire_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKCommentaire.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
			lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_COMMENTAIRE).Text = txtcommentaire.Text
		Else
			lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, txtcommentaire.Text))
		End If
		
15: fraCommentaire.Visible = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "cmdOKCommentaire_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKDateRequise_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKDateRequise.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim datDate As Date
		
15: datDate = DateSerial(mvwDateRequise.Year, mvwDateRequise.Month, mvwDateRequise.Day)
		
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
			lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text = ConvertDate(datDate)
		Else
			lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ConvertDate(datDate)))
		End If
		
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_ORANGE)
		
30: fraDateRequise.Visible = False
		
35: m_bMonthViewHasFocus = False
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumMec", "cmdOKDateRequise_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKDateRequise_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles cmdOKDateRequise.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.PixelsToTwipsX(eventArgs.X)
		Dim Y As Single = VB6.PixelsToTwipsY(eventArgs.Y)
		
5: On Error GoTo AfficherErreur
		
10: If m_bMonthViewHasFocus = True Then
15: Call cmdOKDateRequise_Click(cmdOKDateRequise, New System.EventArgs())
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "cmdOKDateRequise_MouseUp", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerFRS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerFRS.Click
		
5: On Error GoTo AfficherErreur
		
10: frafournisseur.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdAnnulerFRS_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: fraPrix.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdAnnulerPrix_Click", Err, Erl())
	End Sub
	
	Private Sub cmdBavards_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdBavards.Click
		
5: On Error GoTo AfficherErreur
		
10: Call RemplirListViewSuppression()
		
15: lvwBavard.Visible = True
		
20: Call lvwBavard.Focus()
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "cmdBavards_Click", Err, Erl())
	End Sub
	
	Private Sub cmdBonCommande_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdBonCommande.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
25: Call MsgBox("Vous ne pouvez pas commander de pièce à partir de ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
30: Exit Sub
35: End If
		
40: rstProjSoum = New ADODB.Recordset
		
45: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
50: If rstProjSoum.Fields("Ouvert").Value = True And rstProjSoum.Fields("Verrouillé").Value = False Then
55: If VerifierSiOuvert(sUser) = False Then
60: If lvwSoumission.Items.Count > 0 Then
65: Call frmChoixBonCommande.Afficher(txtNoProjSoum.Text, Me, m_eLangage)
70: Else
75: Call MsgBox("Il n'y a pas de pièces à commander pour ce projet!", MsgBoxStyle.OKOnly, "Erreur")
80: End If
85: Else
90: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
95: End If
100: Else
105: If rstProjSoum.Fields("Ouvert").Value = False Then
110: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
115: Else
120: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
125: End If
130: End If
		
135: Call rstProjSoum.Close()
140: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
145: If m_bModifFournisseurBC = True Then
150: Call cmbProjSoum_SelectedIndexChanged(cmbProjSoum, New System.EventArgs())
155: End If
		
160: Exit Sub
		
AfficherErreur: 
		
165: Call AfficherErreur("frmProjSoumMec", "cmdBonCommande_Click", Err, Erl())
	End Sub
	
	Public Sub Commande()
		Dim DR_Commande As Object
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjet As ADODB.Recordset
15: Dim rstPiece As ADODB.Recordset
20: Dim rstBCPiece As ADODB.Recordset
25: Dim rstBC As ADODB.Recordset
30: Dim rstFRS As ADODB.Recordset
35: Dim iIDFRS As Short
40: Dim sFRS As String
45: Dim sNoBC As String
50: Dim sWhere As String
55: Dim sDateRequise As String
60: Dim sNoLigne As String
65: Dim bPremier As Boolean
		
70: rstProjet = New ADODB.Recordset
		
75: Call rstProjet.Open("SELECT ProchaineCommande FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
80: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjet.Fields("ProchaineCommande").Value) Then
85: rstProjet.Fields("ProchaineCommande").Value = rstProjet.Fields("ProchaineCommande").Value + 1
			
90: Call rstProjet.Update()
95: End If
		
100: Call rstProjet.Close()
105: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Commande.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sFRS = DR_Commande.Sections("Section2").Controls("lblFournisseur").Caption
115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Commande.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sNoBC = DR_Commande.Sections("Section2").Controls("lblNoBC").Caption
		
120: rstBC = New ADODB.Recordset
125: rstFRS = New ADODB.Recordset
		
130: Call rstBC.Open("SELECT * FROM GRB_BonsCommandes WHERE NoBonCommande = '" & sNoBC & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
135: Do While Not rstBC.EOF
140: Call rstFRS.Open("SELECT IDFRS, NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstBC.Fields("NoFournisseur").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
145: If rstFRS.Fields("NomFournisseur").Value = sFRS Then
150: iIDFRS = rstFRS.Fields("IDFRS").Value
				
155: sDateRequise = rstBC.Fields("DateRequise").Value
				
160: Call rstFRS.Close()
				
165: Exit Do
170: End If
			
175: Call rstFRS.Close()
			
180: Call rstBC.MoveNext()
185: Loop 
		
190: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
		
195: Call rstBC.Close()
200: 'UPGRADE_NOTE: Object rstBC may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBC = Nothing
		
		'Ouverture du recordset du Bon de commande pour savoir quelles pièces
		'ont été commandées
205: rstBCPiece = New ADODB.Recordset
		
210: Call rstBCPiece.Open("SELECT NoItem, NuméroLigne FROM GRB_BonsCommandes_Pieces WHERE NoFournisseur = " & iIDFRS & " AND NoBonCommande = '" & sNoBC & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Tant que ce n'est pas la fin des enregistrements
215: Do While Not rstBCPiece.EOF
220: bPremier = True
			
225: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstBCPiece.Fields("NoItem").Value) Then
230: sNoLigne = rstBCPiece.Fields("NuméroLigne").Value
				
235: If sWhere = vbNullString Then
240: sWhere = "(IDProjet = '" & txtNoProjSoum.Text & "')"
					
245: If InStr(1, sNoLigne, ",") = 0 Then
250: sWhere = sWhere & " AND ((NumItem = '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "' AND NuméroLigne = " & rstBCPiece.Fields("NuméroLigne").Value & ")"
255: Else
260: Do While InStr(1, sNoLigne, ",") > 0
265: If bPremier = True Then
270: sWhere = sWhere & " AND ((NumItem = '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "' AND NuméroLigne = " & VB.Left(sNoLigne, InStr(1, sNoLigne, ",") - 1) & ")"
								
275: bPremier = False
280: Else
285: sWhere = sWhere & " OR (NumItem = '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "' AND NuméroLigne = " & VB.Left(sNoLigne, InStr(1, sNoLigne, ",") - 1) & ")"
290: End If
							
295: sNoLigne = VB.Right(sNoLigne, Len(sNoLigne) - (InStr(1, sNoLigne, ",") + 1))
300: Loop 
						
305: If Trim(sNoLigne) <> "" Then
310: sWhere = sWhere & " OR (NumItem = '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "' AND NuméroLigne = " & sNoLigne & ")"
315: End If
320: End If
325: Else
330: If InStr(1, sNoLigne, ",") = 0 Then
335: sWhere = sWhere & " OR (NumItem = '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "' AND NuméroLigne = " & rstBCPiece.Fields("NuméroLigne").Value & ")"
340: Else
345: Do While InStr(1, sNoLigne, ",") > 0
350: sWhere = sWhere & " OR (NumItem = '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "' AND NuméroLigne = " & VB.Left(sNoLigne, InStr(1, sNoLigne, ",") - 1) & ")"
							
355: sNoLigne = VB.Right(sNoLigne, Len(sNoLigne) - (InStr(1, sNoLigne, ",") + 1))
360: Loop 
						
365: If Trim(sNoLigne) <> "" Then
370: sWhere = sWhere & " OR (NumItem = '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "' AND NuméroLigne = " & sNoLigne & ")"
375: End If
380: End If
385: End If
390: End If
			
395: Call rstBCPiece.MoveNext()
400: Loop 
		
405: sWhere = sWhere & ")"
		
410: Call rstBCPiece.Close()
415: 'UPGRADE_NOTE: Object rstBCPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBCPiece = Nothing
		
420: rstPiece = New ADODB.Recordset
		
425: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE " & sWhere, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
430: Do While Not rstPiece.EOF
435: rstPiece.Fields("Commandé").Value = True
			
440: rstPiece.Fields("DateCommande").Value = ConvertDate(Today)
			
445: rstPiece.Fields("DateRequise").Value = sDateRequise
			
450: rstPiece.Fields("NomCommande").Value = g_sEmploye
			
455: rstPiece.Fields("NoSéquentiel").Value = VB.Right(sNoBC, 3)
			
460: Call rstPiece.Update()
			
465: Call rstPiece.MoveNext()
470: Loop 
		
475: Call rstPiece.Close()
480: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
485: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
490: Exit Sub
		
AfficherErreur: 
		
495: Call AfficherErreur("frmProjSoumMec", "Commande", Err, Erl())
	End Sub
	
	Private Sub cmdCatalogue_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdCatalogue.Click
		
5: On Error GoTo AfficherErreur
		
		'Pour ouvrir le catalogue mécanique
10: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
15: Call FrmCatalogueMec.AfficherForm(cmbPieces.Text, "", "")
		
20: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "cmdCatalogue_Click", Err, Erl())
	End Sub
	
	Private Sub cmdMauvaisPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdMauvaisPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MauvaisPrix()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdMauvaisPrix_Click", Err, Erl())
	End Sub
	
	Private Sub MauvaisPrix()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: If lvwSoumission.Items.Count > 0 Then
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
				'Si ce n'est pas une section
25: If lvwSoumission.FocusedItem.Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
						'Si ce n'est pas du texte
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la quantité est plus grande que 0
40: If CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) > 0 Then
45: Call ViderChamps_frs()
								
50: Call RemplirComboFournisseur()
								
55: For iCompteur = 0 To cmbfrs.Items.Count - 1
60: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If VB6.GetItemData(cmbfrs, iCompteur) = lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).Tag Then
65: cmbfrs.SelectedIndex = iCompteur
										
70: Exit For
75: End If
80: Next 
								
85: 'UPGRADE_ISSUE: ComboBox property cmbfrs.Locked was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
								cmbfrs.Locked = True
								
90: fraPrix.Tag = lvwSoumission.FocusedItem.Index
								
95: m_bMauvaisPrix = True
								
100: fraPrix.Visible = True
								
105: Call txtPrixList.Focus()
110: Else
115: Call MsgBox("La quantité est déjà dans le négatif!", MsgBoxStyle.OKOnly, "Erreur")
120: End If
125: End If
130: End If
135: End If
140: Else
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
150: End If
155: End If
		
160: Exit Sub
		
AfficherErreur: 
		
165: Call AfficherErreur("frmProjSoumMec", "MauvaisPrix", Err, Erl())
	End Sub
	
	Private Sub cmdMaterielInutile_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdMaterielInutile.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MaterielInutile()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdMaterielInutile_Click", Err, Erl())
	End Sub
	
	Private Sub MaterielInutile()
		
5: On Error GoTo AfficherErreur
		
10: Dim itmProjet As System.Windows.Forms.ListViewItem
		
15: If lvwSoumission.Items.Count > 0 Then
20: itmProjet = lvwSoumission.FocusedItem
			
25: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_ROSE And System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BLEU Then
				'Si ce n'est pas une section
30: If itmProjet.Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
35: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
						'Si ce n'est pas du texte
40: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la quantité est plus grande que 0
45: If CDbl(Replace(itmProjet.Text, "*", vbNullString)) > 0 Then
50: m_bPieceInutile = True
55: m_bRecherchePiece = False
60: m_bChangementFRS = False
								
65: Call AfficherListeFournisseurs()
								
70: If lvwfournisseur.Items.Count = 0 Then
75: Call MsgBox("Il n'y a aucun fournisseur pour cette pièce!", MsgBoxStyle.OKOnly, "Erreur")
									
80: Exit Sub
85: Else
90: frafournisseur.Visible = True
95: End If
100: Else
105: Call MsgBox("La quantité est déjà dans le négatif!", MsgBoxStyle.OKOnly, "Erreur")
110: End If
115: End If
120: End If
125: End If
130: Else
135: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Cette commande doit être faite dans le projet " & itmProjet.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
140: End If
145: End If
		
150: Exit Sub
		
AfficherErreur: 
		
155: Call AfficherErreur("frmProjSoumMec", "MaterielInutile", Err, Erl())
	End Sub
	
	Private Sub cmdCopier_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdCopier.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sNoProjSoum As String
20: Dim sUser As String
25: Dim bExiste As Boolean
30: Dim bVariables As Boolean
35: Dim bTauxHoraire As Boolean
40: Dim bPrixPieces As Boolean
45: Dim bNoValide As Boolean
		
		'Si le combo n'est pas vide
50: If cmbProjSoum.Items.Count > 0 Then
55: If VerifierSiOuvert(sUser) = False Then
				'Demande du numéro
60: sNoProjSoum = InputBox("Quel est le numéro de la soumission?")
				
65: If Trim(sNoProjSoum) <> vbNullString Then
70: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
					
75: bNoValide = True
					
80: If ValiderFormatNumeroProjSoum(sNoProjSoum) = False Then
85: bNoValide = False
90: End If
					
95: If bNoValide = True Then
100: If ValiderFormatMecanique(sNoProjSoum) = False Then
105: bNoValide = False
110: End If
115: End If
					
120: If bNoValide = True Then
125: If ValiderFormatSoumission(sNoProjSoum) = False Then
130: bNoValide = False
135: End If
140: End If
					
145: If bNoValide = False Then
150: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
155: Exit Sub
160: End If
					
165: sNoProjSoum = UCase(sNoProjSoum)
					
170: rstProjSoum = New ADODB.Recordset
					
175: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
180: If rstProjSoum.EOF Then
185: bExiste = False
190: Else
195: bExiste = True
						
200: Call MsgBox("Ce numéro existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
205: End If
					
210: Call rstProjSoum.Close()
					
215: If bExiste = False Then
220: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
225: If rstProjSoum.EOF Then
230: bExiste = False
235: Else
240: bExiste = True
							
245: Call MsgBox("Ce numéro existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
250: End If
						
255: Call rstProjSoum.Close()
260: End If
					
265: If bExiste = False Then
270: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
275: If rstProjSoum.EOF Then
280: bExiste = False
285: Else
290: bExiste = True
							
295: Call MsgBox("Ce numéro existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
300: End If
						
305: Call rstProjSoum.Close()
310: End If
					
315: If bExiste = False Then
320: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
325: If rstProjSoum.EOF Then
330: bExiste = False
335: Else
340: bExiste = True
							
345: Call MsgBox("Ce numéro existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
350: End If
						
355: Call rstProjSoum.Close()
360: End If
					
					'Si il n'existe pas, on l'ajoute
365: If bExiste = False Then
370: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
375: If Not rstProjSoum.EOF Then
380: If rstProjSoum.Fields("Ouvert").Value = False Then
385: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
								
390: Call rstProjSoum.Close()
395: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
								rstProjSoum = Nothing
								
400: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
								System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
								
405: Exit Sub
410: End If
415: End If
						
420: Call rstProjSoum.Close()
425: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
430: If MsgBox("Voulez-vous mettre à jour les variables systèmes?" & vbNewLine & "-  % Profit" & vbNewLine & "-  % Commission" & vbNewLine & "-  % Imprévu", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
435: bVariables = True
440: Else
445: bVariables = False
450: End If
						
455: If MsgBox("Voulez-vous mettre à jour les taux horaires?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
460: bTauxHoraire = True
465: Else
470: bTauxHoraire = False
475: End If
						
480: If MsgBox("Voulez-vous mettre à jour le prix des pièces?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
485: bPrixPieces = True
490: Else
495: bPrixPieces = False
500: End If
						
505: m_bModeAjout = True
510: m_bModeAffichage = False
						
515: m_bTempsDejaOuvert = True
						
520: If bVariables = True Then
							'On ré-initialise les variables
525: Call InitialiserVariables(sNoProjSoum)
530: End If
						
535: If bTauxHoraire = True Then
540: Call InitialiserNouveauxTaux()
545: End If
						
						'Rapetisse le listview de la soumission pour afficher le lvwPiece
550: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
555: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
						
						'On met en mode modif
560: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
						
565: If bPrixPieces = True Then
							'On recalcul le prix des pièces
570: Call UpdatePieces()
575: End If
						
580: Call UpdateOrdre()
						
585: If bVariables = True Or bTauxHoraire = True Or bPrixPieces = True Then
							'On recalcul le prix total
590: Call CalculerPrix()
595: End If
						
600: Call BarrerChamps(False)
						
605: txtNoProjSoum.Text = sNoProjSoum
610: txtNoSoumission.Text = vbNullString
615: End If
					
620: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
625: End If
630: Else
635: If m_eType = enumType.TYPE_PROJET Then
640: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
645: Else
650: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
655: End If
660: End If
665: End If
		
670: Exit Sub
		
AfficherErreur: 
		
675: Call AfficherErreur("frmProjSoumMec", "cmdCopier_Click", Err, Erl())
	End Sub
	
	Private Sub UpdateOrdre()
		
5: On Error GoTo AfficherErreur
		
		'Cette procédure sert à changer l'ordre des sections dans la soumission
10: Dim rstOrdre As ADODB.Recordset
15: Dim rstCount As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim iCompteur2 As Short
35: Dim iIndexCopie As Short
40: Dim iSection As Short
45: Dim iIndex As Short
50: Dim iNbreSection As Short
55: Dim bPremier As Boolean
60: Dim itmProjSoum As System.Windows.Forms.ListViewItem
65: Dim sSection As String
		
		'Boucle pour changer la valeur de l'ordre dans le ListItem
70: rstOrdre = New ADODB.Recordset
		
75: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si ce n'est pas une section
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstOrdre.Open("SELECT Ordre FROM GRB_SoumProjSectionMec WHERE IDSection = " & lvwSoumission.Items.Item(iCompteur).Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_MANUFACT).Tag = rstOrdre.Fields("ordre").Value
				
95: Call rstOrdre.Close()
100: End If
105: Next 
		
110: 'UPGRADE_NOTE: Object rstOrdre may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstOrdre = Nothing
		
115: rstCount = New ADODB.Recordset
		
120: Call rstCount.Open("SELECT COUNT(IDSection) as NbreSection FROM GRB_SoumProjSectionMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
125: iNbreSection = rstCount.Fields("NbreSection").Value
		
130: Call rstCount.Close()
135: 'UPGRADE_NOTE: Object rstCount may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstCount = Nothing
		
		'Il faut enlever les sections car ils n'ont pas d'ordre et il ne font
		'que nuire
140: For iCompteur = 1 To lvwSoumission.Items.Count
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur - iSection).Tag = vbNullString Then
150: Call lvwSoumission.Items.RemoveAt(iCompteur - iSection)
				
155: iSection = iSection + 1
160: End If
165: Next 
		
170: iIndex = 1
		
175: rstSection = New ADODB.Recordset
		
		'Boucle pour replacer le ListItem à la bonne place
180: For iCompteur = 1 To iNbreSection
185: bPremier = True
			
190: iCompteur2 = iIndex
			
195: Do While iCompteur2 <= lvwSoumission.Items.Count
				'Si le tag est la premiere ordre
200: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur2).SubItems.Item(I_COL_SOUM_MANUFACT).Tag = iCompteur Then
					'Si la première fois qu'on trouve cette ordre
205: If bPremier = True Then
						'on ajoute la section
210: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum = lvwSoumission.Items.Insert(iIndex, "")
						
215: Call ValeurParDefaut(itmProjSoum)
						
220: If m_eLangage = enumLangage.ANGLAIS Then
225: sSection = "NomSectionEN"
230: Else
235: sSection = "NomSectionFR"
240: End If
						
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & lvwSoumission.Items.Item(iCompteur2 + 1).Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
250: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
						If Not IsDbNull(rstSection.Fields(sSection).Value) Then
255: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
								itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
							End If
260: Else
265: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
								itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
270: End If
						
275: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
						
280: Call rstSection.Close()
						
285: iIndex = iIndex + 1
290: iCompteur2 = iCompteur2 + 1
						
295: bPremier = False
300: End If
					
					'On ajoute la pièce
305: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum = lvwSoumission.Items.Insert(iIndex, "")
					
310: iIndexCopie = iCompteur2 + 1
					
315: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Checked = lvwSoumission.Items.Item(iIndexCopie).Checked
					
320: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Text = lvwSoumission.Items.Item(iIndexCopie).Text
					
325: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.ForeColor = lvwSoumission.Items.Item(iIndexCopie).ForeColor
					
330: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Tag = lvwSoumission.Items.Item(iIndexCopie).Tag
					
335: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, lvwSoumission.Items.Item(iIndexCopie).Font.Bold)
					
340: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PIECE).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PIECE).Text))
					End If
345: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PIECE).Tag
					
350: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PIECE).ForeColor
					
355: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PIECE).Font.Bold)
					
360: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DESCR).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DESCR).Text))
					End If
365: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DESCR).Tag
					
370: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DESCR).ForeColor
					
375: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DESCR).Font.Bold = True)
					
380: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
						itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_MANUFACT).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_MANUFACT).Text))
					End If
385: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
					
390: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor
					
395: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MANUFACT).Font.Bold)
					
400: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_LIST).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_LIST).Text))
					End If
405: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
					
410: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor
					
415: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_LIST).Font.Bold)
					
420: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_ESCOMPTE).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_ESCOMPTE).Text))
					End If
					
425: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor
					
430: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_ESCOMPTE).Font.Bold)
					
435: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_NET).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_NET).Text))
					End If
					
440: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor
					
445: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_LIST).Font.Bold)
					
450: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
					
455: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
						itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_TOTAL).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_TOTAL).Text))
					End If
					
460: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_TOTAL).ForeColor
					
465: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_TOTAL).Font.Bold)
					
470: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROFIT).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROFIT).Text))
					End If
					
475: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROFIT).ForeColor
					
480: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROFIT).Font.Bold)
					
485: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROFIT).Tag
					
490: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DISTRIB).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DISTRIB).Text))
					End If
495: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DISTRIB).Tag
					
500: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor
					
505: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DISTRIB).Font.Bold)
					
510: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_COMMENTAIRE).Text) <> "" Then
						
515: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
							itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_COMMENTAIRE).Text
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_COMMENTAIRE).Text))
						End If
520: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor
						
525: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font.Bold)
530: Else
535: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
							itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = ""
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
						End If
540: End If
					
545: If m_eType = enumType.TYPE_PROJET Then
550: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
555: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text))
							End If
							
560: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text = "" Then
565: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.Items.Item(iIndexCopie).SubItems.Count > I_COL_SOUM_FACTURATION Then
									lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text = " "
								Else
									lvwSoumission.Items.Item(iIndexCopie).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
								End If
570: End If
							
575: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text))
							End If
							
580: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_FACTURATION).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_FACTURATION).Tag
							
585: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_COMMANDE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_COMMANDE).Text))
							End If
							
590: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text <> "" Then
595: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor
600: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font.Bold)
605: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag
610: End If
							
615: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_REQUISE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_REQUISE).Text))
							End If
							
620: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text <> "" Then
625: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor
630: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font.Bold)
635: End If
							
640: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NOM_COMMANDE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NOM_COMMANDE).Text))
							End If
							
645: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor
							
650: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font.Bold)
							
655: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
								itmProjSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text))
							End If
							
660: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor
							
665: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font.Bold)
							
670: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROVENANCE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROVENANCE).Text))
							End If
							
675: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor
							
680: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROVENANCE).Font.Bold)
685: End If
690: Else
695: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
700: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUMISSION_PROV).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUMISSION_PROV).Text))
							End If
							
705: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = vbNullString Then
710: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
									itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = " "
								Else
									itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
								End If
715: End If
							
720: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUMISSION_PROV).ForeColor
							
725: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUMISSION_PROV).Font.Bold)
730: End If
735: End If
					
740: Call lvwSoumission.Items.RemoveAt(iIndexCopie)
					
745: iIndex = iIndex + 1
750: End If
				
755: iCompteur2 = iCompteur2 + 1
760: Loop 
765: Next 
		
770: If lvwSoumission.Items.Count > 0 Then
775: Call Deselect()
			
780: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.Items.Item(1).Selected = True
785: End If
		
790: Exit Sub
		
AfficherErreur: 
		
795: Call AfficherErreur("frmProjSoumMec", "UpdateOrdre", Err, Erl())
	End Sub
	
	Private Function BackupPieces(ByVal sNoProjSoum As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstProjSoumBackup As ADODB.Recordset
20: Dim sDateCopie As String
		
25: rstProjSoum = New ADODB.Recordset
30: rstProjSoumBackup = New ADODB.Recordset
		
35: If m_eType = enumType.TYPE_PROJET Then
40: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
45: Call rstProjSoumBackup.Open("SELECT * FROM GRB_Projet_Pieces_Tampon", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: Else
55: Call rstProjSoum.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
60: Call rstProjSoumBackup.Open("SELECT * FROM GRB_Soumission_Pieces_Tampon", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
65: End If
		
70: sDateCopie = ConvertDate(Today) & " " & TimeOfDay
		
75: Do While Not rstProjSoum.EOF
80: Call rstProjSoumBackup.AddNew()
			
85: rstProjSoumBackup.Fields("DateCopie").Value = sDateCopie
			
90: If m_eType = enumType.TYPE_PROJET Then
95: rstProjSoumBackup.Fields("IDProjet").Value = rstProjSoum.Fields("IDProjet").Value
100: Else
105: rstProjSoumBackup.Fields("IDSoumission").Value = rstProjSoum.Fields("IDSoumission").Value
110: End If
			
115: rstProjSoumBackup.Fields("Initiales").Value = g_sInitiale
120: rstProjSoumBackup.Fields("IDSection").Value = rstProjSoum.Fields("IDSection").Value
125: rstProjSoumBackup.Fields("NumItem").Value = rstProjSoum.Fields("NumItem").Value
130: rstProjSoumBackup.Fields("Qté").Value = rstProjSoum.Fields("Qté").Value
135: rstProjSoumBackup.Fields("Desc_FR").Value = rstProjSoum.Fields("Desc_FR").Value
140: rstProjSoumBackup.Fields("Desc_EN").Value = rstProjSoum.Fields("Desc_EN").Value
145: rstProjSoumBackup.Fields("Manufact").Value = rstProjSoum.Fields("Manufact").Value
150: rstProjSoumBackup.Fields("Prix_list").Value = rstProjSoum.Fields("Prix_list").Value
155: rstProjSoumBackup.Fields("Escompte").Value = rstProjSoum.Fields("Escompte").Value
160: rstProjSoumBackup.Fields("Prix_net").Value = rstProjSoum.Fields("Prix_net").Value
165: rstProjSoumBackup.Fields("IDFRS").Value = rstProjSoum.Fields("IDFRS").Value
170: rstProjSoumBackup.Fields("Temps").Value = rstProjSoum.Fields("Temps").Value
175: rstProjSoumBackup.Fields("Temps_total").Value = rstProjSoum.Fields("Temps_total").Value
180: rstProjSoumBackup.Fields("Prix_total").Value = rstProjSoum.Fields("Prix_total").Value
185: rstProjSoumBackup.Fields("Profit_Argent").Value = rstProjSoum.Fields("Profit_Argent").Value
190: rstProjSoumBackup.Fields("SousSection").Value = rstProjSoum.Fields("sousSection").Value
195: rstProjSoumBackup.Fields("OrdreSection").Value = rstProjSoum.Fields("OrdreSection").Value
200: rstProjSoumBackup.Fields("NuméroLigne").Value = rstProjSoum.Fields("NuméroLigne").Value
205: rstProjSoumBackup.Fields("PrixOrigine").Value = rstProjSoum.Fields("PrixOrigine").Value
210: rstProjSoumBackup.Fields("Type").Value = rstProjSoum.Fields("Type").Value
215: rstProjSoumBackup.Fields("Visible").Value = rstProjSoum.Fields("Visible").Value
220: rstProjSoumBackup.Fields("Commandé").Value = rstProjSoum.Fields("Commandé").Value
225: rstProjSoumBackup.Fields("Quoté").Value = rstProjSoum.Fields("Quoté").Value
230: rstProjSoumBackup.Fields("Recu").Value = rstProjSoum.Fields("Recu").Value
235: rstProjSoumBackup.Fields("Retour").Value = rstProjSoum.Fields("Retour").Value
240: rstProjSoumBackup.Fields("CommandeAnnulée").Value = rstProjSoum.Fields("CommandeAnnulée").Value
245: rstProjSoumBackup.Fields("ID").Value = rstProjSoum.Fields("ID").Value
250: rstProjSoumBackup.Fields("PieceExtra").Value = rstProjSoum.Fields("PieceExtra").Value
255: rstProjSoumBackup.Fields("PieceExtraChargeable").Value = rstProjSoum.Fields("PieceExtraChargeable").Value
260: rstProjSoumBackup.Fields("PieceExtraNonChargeable").Value = rstProjSoum.Fields("PieceExtraNonChargeable").Value
265: rstProjSoumBackup.Fields("MatérielInutile").Value = rstProjSoum.Fields("MatérielInutile").Value
270: rstProjSoumBackup.Fields("Commentaire").Value = rstProjSoum.Fields("Commentaire").Value
275: rstProjSoumBackup.Fields("Devise").Value = rstProjSoum.Fields("Devise").Value
			
280: If m_eType = enumType.TYPE_PROJET Then
285: rstProjSoumBackup.Fields("NoRetour").Value = rstProjSoum.Fields("NoRetour").Value
290: rstProjSoumBackup.Fields("DateRéception").Value = rstProjSoum.Fields("DateRéception").Value
295: rstProjSoumBackup.Fields("QuantitéRecue").Value = rstProjSoum.Fields("QuantitéRecue").Value
300: rstProjSoumBackup.Fields("Facturation").Value = rstProjSoum.Fields("Facturation").Value
305: rstProjSoumBackup.Fields("DateCommande").Value = rstProjSoum.Fields("DateCommande").Value
310: rstProjSoumBackup.Fields("DateRequise").Value = rstProjSoum.Fields("DateRequise").Value
315: rstProjSoumBackup.Fields("NomCommande").Value = rstProjSoum.Fields("NomCommande").Value
320: rstProjSoumBackup.Fields("NoSéquentiel").Value = rstProjSoum.Fields("NoSéquentiel").Value
325: rstProjSoumBackup.Fields("DateRetour").Value = rstProjSoum.Fields("DateRetour").Value
330: End If
			
335: rstProjSoumBackup.Fields("Provenance").Value = rstProjSoum.Fields("Provenance").Value
			
340: Call rstProjSoumBackup.Update()
			
345: Call rstProjSoum.MoveNext()
350: Loop 
		
355: Call rstProjSoum.Close()
360: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
365: Call rstProjSoumBackup.Close()
370: 'UPGRADE_NOTE: Object rstProjSoumBackup may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoumBackup = Nothing
		
375: BackupPieces = True
		
380: Exit Function
		
AfficherErreur: 
		
385: Call AfficherErreur("frmProjSoumMec", "BackupPieces", Err, Erl())
	End Function
	
	Private Sub UpdatePieces()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPieceFRS As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim itmPiece As System.Windows.Forms.ListViewItem
25: Dim iCompteur As Short
30: Dim sTauxUSA As String
35: Dim sTauxSPA As String
		
40: rstPieceFRS = New ADODB.Recordset
		
45: rstConfig = New ADODB.Recordset
		
50: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
55: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
60: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
65: Call rstConfig.Close()
70: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
75: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si ce n'est pas une section
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
				'Si ce n'est pas une sous-section
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmPiece = lvwSoumission.Items.Item(iCompteur)
					
95: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
100: Call ValeurParDefaut(itmPiece)
						
105: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						Call rstPieceFRS.Open("SELECT PRIX_LIST, PRIX_SP, PRIX_NET, ESCOMPTE, DeviseMonétaire FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(itmPiece.SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' AND IDFRS = " & itmPiece.SubItems.Item(I_COL_SOUM_DISTRIB).Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
110: If Not rstPieceFRS.EOF Then
115: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
							If Not IsDbNull(rstPieceFRS.Fields("PRIX_LIST").Value) Then
120: If Trim(rstPieceFRS.Fields("PRIX_LIST").Value) <> "" Then
125: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
130: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
											itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
										Else
											itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
										End If
135: Else
140: If rstPieceFRS.Fields("DeviseMonétaire").Value = "SPA" Then
145: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
												itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
											Else
												itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
											End If
150: Else
155: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
												itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(rstPieceFRS.Fields("PRIX_LIST"), ModuleMain.enumConvert.MODE_ARGENT, 4)
											Else
												itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("PRIX_LIST"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
											End If
160: End If
165: End If
170: Else
175: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
180: End If
185: Else
190: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
195: End If
							
200: If Trim(rstPieceFRS.Fields("PRIX_NET").Value) <> vbNullString Then
205: If rstPieceFRS.Fields("ESCOMPTE").Value <> vbNullString Then
210: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
										itmPiece.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(rstPieceFRS.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)))
									End If
215: End If
								
220: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstPieceFRS.Fields("PRIX_NET"), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("PRIX_NET"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
225: Else
230: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstPieceFRS.Fields("PRIX_SP"), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("PRIX_SP"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
235: End If
							
240: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
245: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
250: Else
255: If rstPieceFRS.Fields("DeviseMonétaire").Value = "SPA" Then
260: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
265: Else
270: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
275: End If
280: End If
							
							'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
285: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_TOTAL Then
								itmPiece.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmPiece.Text, "*", "")) * CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmPiece.Text, "*", "")) * CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
							End If
							
							'Pour le profit, c'est le prix total - (prix net * quantité)
290: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_PROFIT Then
								itmPiece.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmPiece.Text, "*", ""))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmPiece.Text, "*", ""))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
							End If
							
							'Pour garder en mémoire le prix d'origine, je le mets dans le
							'tag de la colonne Prix Listé
295: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = vbNullString Then
300: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
								End If
305: End If
							
310: If rstPieceFRS.Fields("PRIX_NET").Value <> vbNullString Then
315: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstPieceFRS.Fields("PRIX_LIST").Value
320: Else
325: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstPieceFRS.Fields("PRIX_SP").Value
330: End If
335: Else
340: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							Call MsgBox("Il n'y a pas de prix du fournisseur " & itmPiece.SubItems(I_COL_SOUM_DISTRIB).Text & " pour la pièce " & itmPiece.SubItems(I_COL_SOUM_PIECE).Text & " ou la pièce n'existe plus!", MsgBoxStyle.OKOnly, "Erreur")
345: End If
						
350: Call rstPieceFRS.Close()
355: End If
360: End If
365: End If
370: Next 
		
375: 'UPGRADE_NOTE: Object rstPieceFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceFRS = Nothing
		
380: Exit Sub
		
AfficherErreur: 
		
385: Call AfficherErreur("frmProjSoumMec", "UpdatePieces", Err, Erl())
	End Sub
	
	Private Sub cmdCreerProjet_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdCreerProjet.Click
		
5: On Error GoTo AfficherErreur
		
		'Créé un projet à partir d'une soumission
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sNoProjet As String
20: Dim sUser As String
25: Dim iCompteur As Short
30: Dim bExiste As Boolean
35: Dim bNoValide As Boolean
40: Dim sLiaison As String
		
45: If cmbProjSoum.Items.Count > 0 Then
50: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
55: Call MsgBox("Impossible de créer un projet à partir de cette soumission!", MsgBoxStyle.OKOnly, "Erreur")
				
60: Exit Sub
65: End If
			
70: rstProjSoum = New ADODB.Recordset
			
75: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
80: If rstProjSoum.Fields("Ouvert").Value = False Or rstProjSoum.Fields("Verrouillé").Value = True Then
85: If rstProjSoum.Fields("Ouvert").Value = False Then
90: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly)
95: Else
100: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly)
105: End If
				
110: Call rstProjSoum.Close()
115: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
120: Exit Sub
125: End If
			
130: Call rstProjSoum.Close()
			
135: If VerifierSiOuvert(sUser) = False Then
				'Demande du numéro de projet
140: sNoProjet = InputBox("Quel est le numéro du projet?")
				
145: If sNoProjet <> vbNullString Then
150: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
					
155: bNoValide = True
					
160: If ValiderFormatNumeroProjSoum(sNoProjet) = False Then
165: bNoValide = False
170: End If
					
175: If bNoValide = True Then
180: If ValiderFormatMecanique(sNoProjet) = False Then
185: bNoValide = False
190: End If
195: End If
					
200: If bNoValide = True Then
205: If ValiderFormatJobAvecSoum(sNoProjet) = False Then
210: bNoValide = False
215: End If
220: End If
					
225: If bNoValide = False Then
230: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
235: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
240: Exit Sub
245: End If
					
250: sNoProjet = UCase(sNoProjet)
					
255: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
260: If rstProjSoum.EOF Then
265: bExiste = False
270: Else
275: bExiste = True
						
280: Call MsgBox("Ce numéro existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
285: End If
					
290: Call rstProjSoum.Close()
					
295: If bExiste = False Then
300: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
305: If rstProjSoum.EOF Then
310: bExiste = False
315: Else
320: bExiste = True
							
325: Call MsgBox("Ce numéro existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
330: End If
						
335: Call rstProjSoum.Close()
340: End If
					
345: If bExiste = False Then
350: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
355: If rstProjSoum.EOF Then
360: bExiste = False
365: Else
370: bExiste = True
							
375: Call MsgBox("Ce numéro existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
380: End If
						
385: Call rstProjSoum.Close()
390: End If
					
395: If bExiste = False Then
400: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
405: If rstProjSoum.EOF Then
410: bExiste = False
415: Else
420: bExiste = True
							
425: Call MsgBox("Ce numéro existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
430: End If
						
435: Call rstProjSoum.Close()
440: End If
					
445: If bExiste = True Then
450: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
455: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
460: Exit Sub
465: End If
					
470: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
475: If Not rstProjSoum.EOF Then
480: If rstProjSoum.Fields("Ouvert").Value = False Then
485: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
							
490: Call rstProjSoum.Close()
495: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
							rstProjSoum = Nothing
							
500: Exit Sub
505: End If
510: End If
					
515: Call rstProjSoum.Close()
520: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjSoum = Nothing
					
525: If CDbl(VB.Right(sNoProjet, 2)) >= 60 And CDbl(VB.Right(sNoProjet, 2)) <= 98 Then
530: sLiaison = InputBox("Quelle est l'extention du projet " & VB.Left(sNoProjet, 6) & " auquel ce projet sera lié?")
535: End If
					
540: Call frmChoixTransfertJob.Afficher(txtNoProjSoum.Text, "M")
					
545: If m_bTransfertJobCancel = False Then
						'Appel de la méthode pour créer le projet
550: Call TransfererSoumDansProjet(sNoProjet, sLiaison)
						
						'On affiche le projet qui vient d'être créé
555: If m_bComboChoix = True Then
560: cmbChoix.SelectedIndex = I_IDX_PROJET
							
565: For iCompteur = 0 To cmbProjSoum.Items.Count - 1
570: If VB6.GetItemString(cmbProjSoum, iCompteur) = sNoProjet Then
575: cmbProjSoum.SelectedIndex = iCompteur
									
580: Exit For
585: End If
590: Next 
							
595: If sLiaison <> "" Then
600: For iCompteur = 1 To lvwSoumission.Items.Count
									'Si pas une section
605: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.Items.Item(iCompteur).Tag <> "" Then
										'Si pas une sous-section
610: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "" Then
615: If CDbl(VB.Right(sNoProjet, 2)) >= 60 And CDbl(VB.Right(sNoProjet, 2)) <= 79 Then
620: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												Call AjouterPiecesExtraChargeableDansJob(lvwSoumission.Items.Item(iCompteur), sLiaison)
625: Else
630: If CDbl(VB.Right(sNoProjet, 2)) >= 80 And CDbl(VB.Right(sNoProjet, 2)) <= 98 Then
635: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
													Call AjouterPiecesExtraDansJob(lvwSoumission.Items.Item(iCompteur), sLiaison)
640: End If
645: End If
650: End If
655: End If
									
660: Call CalculerTotalRecordset(sNoProjet)
665: Next 
670: End If
							
675: Call AjouterProjetAuCumulatif()
680: End If
						
						'Il faut enlever le bouton puisqu'on ne peut pas créer plus
						'd'un projet avec une soumission
685: cmdCreerProjet.Visible = False
690: End If
					
695: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
700: Else
705: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjSoum = Nothing
					
710: Exit Sub
715: End If
720: Else
725: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
730: End If
735: End If
		
740: Exit Sub
		
AfficherErreur: 
		
745: Call AfficherErreur("frmProjSoumMec", "cmdCreerProjet_Click", Err, Erl())
	End Sub
	
	Private Function VerifierSiDejaProjet() As Boolean
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui sert à vérifier si une soumission est déjà assignée à un projet
10: Dim rstProjet As ADODB.Recordset
		
15: If txtNoProjSoum.Text = vbNullString Then
20: VerifierSiDejaProjet = True
			
25: Exit Function
30: End If
		
35: rstProjet = New ADODB.Recordset
		
40: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
45: If Not rstProjet.EOF Then
50: VerifierSiDejaProjet = True
55: End If
		
60: Call rstProjet.Close()
65: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
70: Exit Function
		
AfficherErreur: 
		
75: Call AfficherErreur("frmProjSoumMec", "VerifierSiDejaProjet", Err, Erl())
	End Function
	
	Private Sub TransfererSoumDansProjet(ByVal sNoProjet As String, ByVal sLiaison As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui transfère les données de la soumission dans les tables
		'GRB_Projet et GRB_pièces
10: Dim rstSoum As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSoumPiece As ADODB.Recordset
25: Dim rstProjetPiece As ADODB.Recordset
30: Dim rstEmploye As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim rstConfig As ADODB.Recordset
45: Dim iCompteur As Short
		
50: rstSoum = New ADODB.Recordset
55: rstSoumPiece = New ADODB.Recordset
		
		'Ouverture de la soumission
60: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
65: Call rstSoumPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "' AND Type = 'M' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
70: rstProjet = New ADODB.Recordset
75: rstProjetPiece = New ADODB.Recordset
		
		'Ouverture du projet
80: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
85: Call rstProjetPiece.Open("SELECT * FROM GRB_Projet_Pieces", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
90: rstProjSoum = New ADODB.Recordset
		
95: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
100: If rstProjSoum.EOF Then
105: Call rstProjSoum.AddNew()
			
110: rstProjSoum.Fields("IDProjSoum").Value = sNoProjet
115: rstProjSoum.Fields("NoClient").Value = rstSoum.Fields("IDClient").Value
120: rstProjSoum.Fields("Description").Value = rstSoum.Fields("Description").Value
125: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
130: rstProjSoum.Fields("Ouvert").Value = True
135: rstProjSoum.Fields("Type").Value = "P"
			
140: Call rstProjSoum.Update()
145: End If
		
150: Call rstProjSoum.Close()
		
155: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
160: rstProjSoum.Fields("Ouvert").Value = False
		
165: Call rstProjSoum.Update()
		
170: Call rstProjSoum.Close()
175: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'On l'ajoute
180: Call rstProjet.AddNew()
		
185: rstProjet.Fields("IDProjet").Value = sNoProjet
190: rstProjet.Fields("IDSoumission").Value = rstSoum.Fields("IDSoumission").Value
195: rstProjet.Fields("IDClient").Value = rstSoum.Fields("IDClient").Value
200: rstProjet.Fields("IDContact").Value = rstSoum.Fields("IDContact").Value
205: rstProjet.Fields("Description").Value = rstSoum.Fields("Description").Value
210: rstProjet.Fields("manuel").Value = rstSoum.Fields("manuel").Value
215: rstProjet.Fields("Creer").Value = ConvertDate(Today)
220: rstProjet.Fields("CheminPhotos").Value = rstSoum.Fields("CheminPhotos").Value
		
225: If sLiaison <> "" Then
230: rstProjet.Fields("LiaisonChargeable").Value = sLiaison
235: End If
		
240: rstEmploye = New ADODB.Recordset
		
245: Call rstEmploye.Open("SELECT NoEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
250: rstProjet.Fields("Creer_Par").Value = rstEmploye.Fields("noEmploye").Value
		
255: Call rstEmploye.Close()
260: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
265: rstProjet.Fields("imprevue").Value = rstSoum.Fields("imprevue").Value
270: rstProjet.Fields("commission").Value = rstSoum.Fields("commission").Value
275: rstProjet.Fields("Profit").Value = rstSoum.Fields("Profit").Value
280: rstProjet.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
285: rstProjet.Fields("total_commission").Value = rstSoum.Fields("total_Commission").Value
290: rstProjet.Fields("total_profit").Value = rstSoum.Fields("Total_Profit").Value
295: rstProjet.Fields("PrixTotal").Value = rstSoum.Fields("PrixTotal").Value
300: rstProjet.Fields("total_piece").Value = rstSoum.Fields("Total_piece").Value
305: rstProjet.Fields("total_imprevue").Value = rstSoum.Fields("total_imprevue").Value
310: rstProjet.Fields("total_temps").Value = rstSoum.Fields("total_temps").Value
		
315: rstProjet.Fields("TempsDessinProj").Value = rstSoum.Fields("TempsDessin").Value
320: rstProjet.Fields("TempsCoupeProj").Value = rstSoum.Fields("TempsCoupe").Value
325: rstProjet.Fields("TempsMachinageProj").Value = rstSoum.Fields("TempsMachinage").Value
330: rstProjet.Fields("TempsSoudureProj").Value = rstSoum.Fields("TempsSoudure").Value
335: rstProjet.Fields("TempsAssemblageProj").Value = rstSoum.Fields("TempsAssemblage").Value
340: rstProjet.Fields("TempsPeintureProj").Value = rstSoum.Fields("TempsPeinture").Value
345: rstProjet.Fields("TempsTestProj").Value = rstSoum.Fields("TempsTest").Value
350: rstProjet.Fields("TempsInstallationProj").Value = 0
355: rstProjet.Fields("TempsFormationProj").Value = rstSoum.Fields("TempsFormation").Value
360: rstProjet.Fields("TempsGestionProj").Value = rstSoum.Fields("TempsGestion").Value
365: rstProjet.Fields("TempsShippingProj").Value = rstSoum.Fields("TempsShipping").Value
		
370: rstProjet.Fields("TempsDessinConc").Value = vbNullString
375: rstProjet.Fields("TempsCoupeConc").Value = vbNullString
380: rstProjet.Fields("TempsMachinageConc").Value = vbNullString
385: rstProjet.Fields("TempsSoudureConc").Value = vbNullString
390: rstProjet.Fields("TempsAssemblageConc").Value = vbNullString
395: rstProjet.Fields("TempsPeintureConc").Value = vbNullString
400: rstProjet.Fields("TempsTestConc").Value = vbNullString
405: rstProjet.Fields("TempsInstallationConc").Value = vbNullString
410: rstProjet.Fields("TempsFormationConc").Value = vbNullString
415: rstProjet.Fields("TempsGestionConc").Value = vbNullString
420: rstProjet.Fields("TempsShippingConc").Value = vbNullString
		
425: rstProjet.Fields("PrixEmballage").Value = rstSoum.Fields("PrixEmballage").Value
		
430: rstConfig = New ADODB.Recordset
		
435: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxDessin").Value) Then
440: rstProjet.Fields("TauxDessin").Value = rstSoum.Fields("TauxDessin").Value
445: Else
450: Call rstConfig.Open("SELECT TauxDessinMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
455: rstProjet.Fields("TauxDessin").Value = rstConfig.Fields("TauxDessinMec").Value
			
460: Call rstConfig.Close()
465: End If
		
470: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxCoupe").Value) Then
475: rstProjet.Fields("TauxCoupe").Value = rstSoum.Fields("TauxCoupe").Value
480: Else
485: Call rstConfig.Open("SELECT TauxCoupe FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
490: rstProjet.Fields("TauxCoupe").Value = rstConfig.Fields("TauxCoupe").Value
			
495: Call rstConfig.Close()
500: End If
		
505: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxMachinage").Value) Then
510: rstProjet.Fields("TauxMachinage").Value = rstSoum.Fields("TauxMachinage").Value
515: Else
520: Call rstConfig.Open("SELECT TauxMachinage FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
525: rstProjet.Fields("TauxMachinage").Value = rstConfig.Fields("TauxMachinage").Value
			
530: Call rstConfig.Close()
535: End If
		
540: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxSoudure").Value) Then
545: rstProjet.Fields("TauxSoudure").Value = rstSoum.Fields("TauxSoudure").Value
550: Else
555: Call rstConfig.Open("SELECT TauxSoudure FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
560: rstProjet.Fields("TauxSoudure").Value = rstConfig.Fields("TauxSoudure").Value
			
565: Call rstConfig.Close()
570: End If
		
575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxAssemblage").Value) Then
580: rstProjet.Fields("TauxAssemblage").Value = rstSoum.Fields("TauxAssemblage").Value
585: Else
590: Call rstConfig.Open("SELECT TauxAssemblageMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
595: rstProjet.Fields("TauxAssemblage").Value = rstConfig.Fields("TauxAssemblageMec").Value
			
600: Call rstConfig.Close()
605: End If
		
610: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxPeinture").Value) Then
615: rstProjet.Fields("TauxPeinture").Value = rstSoum.Fields("TauxPeinture").Value
620: Else
625: Call rstConfig.Open("SELECT TauxPeinture FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
630: rstProjet.Fields("TauxPeinture").Value = rstConfig.Fields("TauxPeinture").Value
			
635: Call rstConfig.Close()
640: End If
		
645: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxTest").Value) Then
650: rstProjet.Fields("TauxTest").Value = rstSoum.Fields("TauxTest").Value
655: Else
660: Call rstConfig.Open("SELECT TauxTestMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
665: rstProjet.Fields("TauxTest").Value = rstConfig.Fields("TauxTestMec").Value
			
670: Call rstConfig.Close()
675: End If
		
680: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxInstallation").Value) Then
685: rstProjet.Fields("TauxInstallation").Value = rstSoum.Fields("TauxInstallation").Value
690: Else
695: Call rstConfig.Open("SELECT TauxInstallationMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
700: rstProjet.Fields("TauxInstallation").Value = rstConfig.Fields("TauxInstallationMec").Value
			
705: Call rstConfig.Close()
710: End If
		
715: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxFormation").Value) Then
720: rstProjet.Fields("TauxFormation").Value = rstSoum.Fields("TauxFormation").Value
725: Else
730: Call rstConfig.Open("SELECT TauxFormationMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
735: rstProjet.Fields("TauxFormation").Value = rstConfig.Fields("TauxFormationMec").Value
			
740: Call rstConfig.Close()
745: End If
		
750: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxGestion").Value) Then
755: rstProjet.Fields("TauxGestion").Value = rstSoum.Fields("TauxGestion").Value
760: Else
765: Call rstConfig.Open("SELECT TauxGestionProjetsMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
770: rstProjet.Fields("TauxGestion").Value = rstConfig.Fields("TauxGestionProjetsMec").Value
			
775: Call rstConfig.Close()
780: End If
		
785: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxShipping").Value) Then
790: rstProjet.Fields("TauxShipping").Value = rstSoum.Fields("TauxShipping").Value
795: Else
800: Call rstConfig.Open("SELECT TauxShippingMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
805: rstProjet.Fields("TauxShipping").Value = rstConfig.Fields("TauxShippingMec").Value
			
810: Call rstConfig.Close()
815: End If
		
820: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
825: rstProjet.Fields("MontantForfait").Value = rstSoum.Fields("MontantForfait").Value
830: rstProjet.Fields("InitialeForfait").Value = rstSoum.Fields("InitialeForfait").Value
835: rstProjet.Fields("ProchaineCommande").Value = 1
		
840: Call rstProjet.Update()
		
		'Ajout des pièces
845: Do While Not rstSoumPiece.EOF
850: If rstSoumPiece.Fields("TransfertJob").Value = True Then
855: Call rstProjetPiece.AddNew()
				
860: rstProjetPiece.Fields("IDProjet").Value = sNoProjet
865: rstProjetPiece.Fields("IDSection").Value = rstSoumPiece.Fields("IDSection").Value
870: rstProjetPiece.Fields("NumItem").Value = rstSoumPiece.Fields("NumItem").Value
875: rstProjetPiece.Fields("Qté").Value = rstSoumPiece.Fields("Qté").Value
880: rstProjetPiece.Fields("Desc_FR").Value = rstSoumPiece.Fields("Desc_FR").Value
885: rstProjetPiece.Fields("Desc_EN").Value = rstSoumPiece.Fields("Desc_EN").Value
890: rstProjetPiece.Fields("Manufact").Value = rstSoumPiece.Fields("Manufact").Value
895: rstProjetPiece.Fields("Prix_List").Value = rstSoumPiece.Fields("Prix_list").Value
900: rstProjetPiece.Fields("Escompte").Value = rstSoumPiece.Fields("Escompte").Value
905: rstProjetPiece.Fields("Prix_net").Value = rstSoumPiece.Fields("Prix_net").Value
910: rstProjetPiece.Fields("OrdreSection").Value = rstSoumPiece.Fields("OrdreSection").Value
915: rstProjetPiece.Fields("NuméroLigne").Value = rstSoumPiece.Fields("NuméroLigne").Value
920: rstProjetPiece.Fields("IDFRS").Value = rstSoumPiece.Fields("IDFRS").Value
925: rstProjetPiece.Fields("Prix_total").Value = rstSoumPiece.Fields("Prix_Total").Value
930: rstProjetPiece.Fields("Profit_argent").Value = rstSoumPiece.Fields("Profit_argent").Value
935: rstProjetPiece.Fields("SousSection").Value = rstSoumPiece.Fields("SousSection").Value
940: rstProjetPiece.Fields("PrixOrigine").Value = rstSoumPiece.Fields("PrixOrigine").Value
945: rstProjetPiece.Fields("Visible").Value = rstSoumPiece.Fields("Visible").Value
950: rstProjetPiece.Fields("Commentaire").Value = rstSoumPiece.Fields("Commentaire").Value
955: rstProjetPiece.Fields("Quoté").Value = rstSoumPiece.Fields("Quoté").Value
				
960: rstProjetPiece.Fields("Type").Value = rstSoumPiece.Fields("Type").Value
				
965: Call rstProjetPiece.Update()
970: End If
			
975: Call rstSoumPiece.MoveNext()
980: Loop 
		
985: m_eType = enumType.TYPE_PROJET
		
990: If CDbl(rstSoum.Fields("TempsInstallation").Value) > 0 Then
995: Call CreerProjetInstallation(VB.Left(sNoProjet, 7) & "51")
1000: End If
		
1005: Call rstSoum.Close()
1010: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoum = Nothing
		
1015: Call rstProjet.Close()
1020: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
1025: Call rstSoumPiece.Close()
1030: 'UPGRADE_NOTE: Object rstSoumPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoumPiece = Nothing
		
1035: Call rstProjetPiece.Close()
1040: 'UPGRADE_NOTE: Object rstProjetPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjetPiece = Nothing
		
1045: Call CalculerTotalRecordset(sNoProjet)
		
1050: Exit Sub
		
AfficherErreur: 
		
1055: Call AfficherErreur("frmProjSoumMec", "TransfererSoumDansProjet", Err, Erl())
	End Sub
	
	Private Sub CreerProjetInstallation(ByVal sNoProjet As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstSoum As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstEmploye As ADODB.Recordset
25: Dim rstProjSoum As ADODB.Recordset
30: Dim rstConfig As ADODB.Recordset
35: Dim iCompteur As Short
		
40: rstSoum = New ADODB.Recordset
		
		'Ouverture de la soumission
45: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
50: rstProjet = New ADODB.Recordset
		
		'Ouverture du projet
55: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
60: If rstProjet.EOF Then
65: rstProjSoum = New ADODB.Recordset
			
70: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
75: If rstProjSoum.EOF Then
80: Call rstProjSoum.AddNew()
				
85: rstProjSoum.Fields("IDProjSoum").Value = sNoProjet
90: rstProjSoum.Fields("NoClient").Value = rstSoum.Fields("IDClient").Value
95: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
100: rstProjSoum.Fields("Description").Value = rstSoum.Fields("Description").Value
105: rstProjSoum.Fields("Ouvert").Value = True
110: rstProjSoum.Fields("Type").Value = "P"
				
115: Call rstProjSoum.Update()
120: End If
			
125: Call rstProjSoum.Close()
130: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
			'On l'ajoute
135: Call rstProjet.AddNew()
			
140: rstProjet.Fields("IDProjet").Value = sNoProjet
145: rstProjet.Fields("IDSoumission").Value = vbNullString
150: rstProjet.Fields("IDClient").Value = rstSoum.Fields("IDClient").Value
155: rstProjet.Fields("IDContact").Value = rstSoum.Fields("IDContact").Value
160: rstProjet.Fields("Description").Value = rstSoum.Fields("Description").Value
165: rstProjet.Fields("Creer").Value = ConvertDate(Today)
170: rstProjet.Fields("CheminPhotos").Value = rstSoum.Fields("CheminPhotos").Value
			
175: rstEmploye = New ADODB.Recordset
			
180: Call rstEmploye.Open("SELECT NoEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
185: rstProjet.Fields("Creer_Par").Value = rstEmploye.Fields("noEmploye").Value
			
190: Call rstEmploye.Close()
195: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstEmploye = Nothing
			
200: rstProjet.Fields("imprevue").Value = rstSoum.Fields("imprevue").Value
205: rstProjet.Fields("commission").Value = rstSoum.Fields("commission").Value
210: rstProjet.Fields("Profit").Value = rstSoum.Fields("Profit").Value
215: rstProjet.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
220: rstProjet.Fields("total_commission").Value = rstSoum.Fields("total_Commission").Value
225: rstProjet.Fields("total_profit").Value = rstSoum.Fields("Total_Profit").Value
230: rstProjet.Fields("PrixTotal").Value = rstSoum.Fields("PrixTotal").Value
235: rstProjet.Fields("total_piece").Value = rstSoum.Fields("Total_piece").Value
240: rstProjet.Fields("total_imprevue").Value = rstSoum.Fields("total_imprevue").Value
245: rstProjet.Fields("total_temps").Value = rstSoum.Fields("total_temps").Value
			
250: rstProjet.Fields("TempsDessinProj").Value = 0
255: rstProjet.Fields("TempsCoupeProj").Value = 0
260: rstProjet.Fields("TempsMachinageProj").Value = 0
265: rstProjet.Fields("TempsSoudureProj").Value = 0
270: rstProjet.Fields("TempsAssemblageProj").Value = 0
275: rstProjet.Fields("TempsPeintureProj").Value = 0
280: rstProjet.Fields("TempsTestProj").Value = 0
285: rstProjet.Fields("TempsInstallationProj").Value = rstSoum.Fields("TempsInstallation").Value
290: rstProjet.Fields("TempsFormationProj").Value = 0
295: rstProjet.Fields("TempsGestionProj").Value = 0
300: rstProjet.Fields("TempsShippingProj").Value = 0
			
305: rstProjet.Fields("TempsDessinConc").Value = vbNullString
310: rstProjet.Fields("TempsCoupeConc").Value = vbNullString
315: rstProjet.Fields("TempsMachinageConc").Value = vbNullString
320: rstProjet.Fields("TempsSoudureConc").Value = vbNullString
325: rstProjet.Fields("TempsAssemblageConc").Value = vbNullString
330: rstProjet.Fields("TempsPeintureConc").Value = vbNullString
335: rstProjet.Fields("TempsTestConc").Value = vbNullString
340: rstProjet.Fields("TempsInstallationConc").Value = vbNullString
345: rstProjet.Fields("TempsFormationConc").Value = vbNullString
350: rstProjet.Fields("TempsGestionConc").Value = vbNullString
355: rstProjet.Fields("TempsShippingConc").Value = vbNullString
			
360: rstProjet.Fields("PrixEmballage").Value = 0
			
365: rstConfig = New ADODB.Recordset
			
370: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxDessin").Value) Then
375: rstProjet.Fields("TauxDessin").Value = rstSoum.Fields("TauxDessin").Value
380: Else
385: Call rstConfig.Open("SELECT TauxDessinMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
390: rstProjet.Fields("TauxDessin").Value = rstConfig.Fields("TauxDessinMec").Value
				
395: Call rstConfig.Close()
400: End If
			
405: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxCoupe").Value) Then
410: rstProjet.Fields("TauxCoupe").Value = rstSoum.Fields("TauxCoupe").Value
415: Else
420: Call rstConfig.Open("SELECT TauxCoupe FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
425: rstProjet.Fields("TauxCoupe").Value = rstConfig.Fields("TauxCoupe").Value
				
430: Call rstConfig.Close()
435: End If
			
440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxMachinage").Value) Then
445: rstProjet.Fields("TauxMachinage").Value = rstSoum.Fields("TauxMachinage").Value
450: Else
455: Call rstConfig.Open("SELECT TauxMachinage FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
460: rstProjet.Fields("TauxMachinage").Value = rstConfig.Fields("TauxMachinage").Value
				
465: Call rstConfig.Close()
470: End If
			
475: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxSoudure").Value) Then
480: rstProjet.Fields("TauxSoudure").Value = rstSoum.Fields("TauxSoudure").Value
485: Else
490: Call rstConfig.Open("SELECT TauxSoudure FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
495: rstProjet.Fields("TauxSoudure").Value = rstConfig.Fields("TauxSoudure").Value
				
500: Call rstConfig.Close()
505: End If
			
510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxAssemblage").Value) Then
515: rstProjet.Fields("TauxAssemblage").Value = rstSoum.Fields("TauxAssemblage").Value
520: Else
525: Call rstConfig.Open("SELECT TauxAssemblageMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
530: rstProjet.Fields("TauxAssemblage").Value = rstConfig.Fields("TauxAssemblageMec").Value
				
535: Call rstConfig.Close()
540: End If
			
545: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxPeinture").Value) Then
550: rstProjet.Fields("TauxPeinture").Value = rstSoum.Fields("TauxPeinture").Value
555: Else
560: Call rstConfig.Open("SELECT TauxPeinture FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
565: rstProjet.Fields("TauxPeinture").Value = rstConfig.Fields("TauxPeinture").Value
				
570: Call rstConfig.Close()
575: End If
			
580: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxTest").Value) Then
585: rstProjet.Fields("TauxTest").Value = rstSoum.Fields("TauxTest").Value
590: Else
595: Call rstConfig.Open("SELECT TauxTestMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
600: rstProjet.Fields("TauxTest").Value = rstConfig.Fields("TauxTestMec").Value
				
605: Call rstConfig.Close()
610: End If
			
615: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxInstallation").Value) Then
620: rstProjet.Fields("TauxInstallation").Value = rstSoum.Fields("TauxInstallation").Value
625: Else
630: Call rstConfig.Open("SELECT TauxInstallationMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
635: rstProjet.Fields("TauxInstallation").Value = rstConfig.Fields("TauxInstallationMec").Value
				
640: Call rstConfig.Close()
645: End If
			
650: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxFormation").Value) Then
655: rstProjet.Fields("TauxFormation").Value = rstSoum.Fields("TauxFormation").Value
660: Else
665: Call rstConfig.Open("SELECT TauxFormationMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
670: rstProjet.Fields("TauxFormation").Value = rstConfig.Fields("TauxFormationMec").Value
				
675: Call rstConfig.Close()
680: End If
			
685: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxGestion").Value) Then
690: rstProjet.Fields("TauxGestion").Value = rstSoum.Fields("TauxGestion").Value
695: Else
700: Call rstConfig.Open("SELECT TauxGestionProjetsMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
705: rstProjet.Fields("TauxGestion").Value = rstConfig.Fields("TauxGestionProjetsMec").Value
				
710: Call rstConfig.Close()
715: End If
			
720: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxShipping").Value) Then
725: rstProjet.Fields("TauxShipping").Value = rstSoum.Fields("TauxShipping").Value
730: Else
735: Call rstConfig.Open("SELECT TauxShippingMec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
740: rstProjet.Fields("TauxShipping").Value = rstConfig.Fields("TauxShippingMec").Value
				
745: Call rstConfig.Close()
750: End If
			
755: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstConfig = Nothing
			
760: rstProjet.Fields("ProchaineCommande").Value = 1
			
765: Call rstProjet.Update()
770: End If
		
775: Call rstSoum.Close()
780: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoum = Nothing
		
785: Call rstProjet.Close()
790: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
795: Call CalculerTotalRecordset(sNoProjet)
		
800: Exit Sub
		
AfficherErreur: 
		
805: Call AfficherErreur("frmProjSoumMec", "CreerProjetInstallation", Err, Erl())
	End Sub
	
	Private Sub cmdDateFacturation_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdDateFacturation.Click
		
5: On Error GoTo AfficherErreur
		
		'Ouverture du calendrier
10: If txtDateFacturation.Text <> vbNullString Then
15: mvwDateFacturation.Value = CDate(txtDateFacturation.Text)
20: Else
25: mvwDateFacturation.Value = Today
35: End If
		
40: mvwDateFacturation.Visible = True
		
45: Call mvwDateFacturation.Focus()
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumMec", "cmdDateFacturation_Click", Err, Erl())
	End Sub
	
	Private Sub cmdDemande_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdDemande.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
25: Call MsgBox("Vous ne pouvez pas commander de pièce à partir de ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
30: Exit Sub
35: End If
		
40: rstProjSoum = New ADODB.Recordset
		
45: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
50: If rstProjSoum.Fields("Ouvert").Value = True And rstProjSoum.Fields("Verrouillé").Value = False Then
55: If VerifierSiOuvert(sUser) = False Then
60: Call frmChoixDemande.AfficherProjetSoumission(txtNoProjSoum.Text, ModuleMain.enumCatalogue.MECANIQUE, frmChoixDemande.enumModeDemande.MODE_PIECE, m_eType)
65: Else
70: If m_eType = enumType.TYPE_PROJET Then
75: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
80: Else
85: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
90: End If
95: End If
100: Else
105: If rstProjSoum.Fields("Ouvert").Value = False Then
110: If m_eType = enumType.TYPE_PROJET Then
115: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
120: Else
125: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly, "Erreur")
130: End If
135: Else
140: If m_eType = enumType.TYPE_PROJET Then
145: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
150: Else
155: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly, "Erreur")
160: End If
165: End If
170: End If
		
175: Call rstProjSoum.Close()
180: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
185: Exit Sub
		
AfficherErreur: 
		
190: Call AfficherErreur("frmProjSoumMec", "cmdDemande_Click", Err, Erl())
	End Sub
	
	Private Sub cmdHistorique_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdHistorique.Click
		
5: On Error GoTo AfficherErreur
		
		'Ouverture de l'historique des modifications
10: If cmbProjSoum.Items.Count > 0 Then
15: Call RemplirListViewModifications()
			
20: lvwHistorique.Visible = True
			
25: Call lvwHistorique.Focus()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "cmdHistorique_Click", Err, Erl())
	End Sub
	
	Private Sub cmdLegende_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdLegende.Click
		
5: On Error GoTo AfficherErreur
		
10: Call OuvrirForm(frmLegende, True)
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdLegende_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKFRS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKFRS.Click
		
5: On Error GoTo AfficherErreur
		
10: If m_bPieceInutile = True Or m_bChangementFRS = True Then
15: Call ChoisirFournisseurMateriel()
20: Else
25: Call ChoisirFournisseur()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "cmdOKFRS_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKPrix.Click
		'Écrit les prix dans le ListView
5: On Error GoTo AfficherErreur
		
10: Dim rstConfig As ADODB.Recordset
15: Dim itmSoum As System.Windows.Forms.ListViewItem
20: Dim itmAvant As System.Windows.Forms.ListViewItem
25: Dim bPrixSpecial As Boolean
30: Dim iCompteur As Short
35: Dim lColor As Integer
40: Dim sPiece As String
45: Dim sQuantite As String
50: Dim sTauxUSA As String
55: Dim sTauxSPA As String
		
60: rstConfig = New ADODB.Recordset
		
65: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
70: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
75: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
80: Call rstConfig.Close()
85: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
90: If m_bMauvaisPrix = False Then
95: If cmbfrs.SelectedIndex = -1 Then
100: Call MsgBox("Vous devez choisir un fournisseur!", MsgBoxStyle.OKOnly, "Erreur")
				
105: Exit Sub
110: End If
115: End If
		
120: If Trim(txtPrixList.Text) = vbNullString Then
125: If Trim(txtPrixSpecial.Text) = vbNullString Then
130: Call MsgBox("Vous devez remplir le prix listé!", MsgBoxStyle.OKOnly, "Erreur")
				
135: Exit Sub
140: End If
145: End If
		
150: If Trim(txtPrixNet.Text) = vbNullString And Trim(txtPrixSpecial.Text) = vbNullString Then
155: Call MsgBox("Vous devez choisir un prix!", MsgBoxStyle.OKOnly, "Erreur")
			
160: Exit Sub
165: Else
170: If Trim(txtPrixNet.Text) <> "" Then
175: bPrixSpecial = False
180: Else
185: bPrixSpecial = True
190: End If
195: End If
		
200: If m_bMauvaisPrix = True Then
205: sQuantite = InputBox("Quelle est la quantité!")
			
210: If sQuantite <> "" Then
215: If Not IsNumeric(sQuantite) Then
220: Exit Sub
225: End If
230: Else
235: Exit Sub
240: End If
			
245: itmAvant = lvwSoumission.FocusedItem
250: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Insert(CShort(fraPrix.Tag) + 1, "")
			
255: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lColor = System.Drawing.ColorTranslator.ToOle(itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor)
			
260: itmSoum.Checked = itmAvant.Checked
			
			'Quantité
265: itmSoum.Text = "-" & itmAvant.Text
			
			'On met l'id de la section dans le tag du listItem
270: itmSoum.Tag = itmAvant.Tag
			
			'No d'item
275: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = itmAvant.SubItems(I_COL_SOUM_PIECE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PIECE).Text))
			End If
			
			'On met le nom de la sous-section dans le tag du no d'item
280: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
			'On met la description en francais dans la colonne et la description en anglais
			'dans le tag
285: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
				itmSoum.SubItems(I_COL_SOUM_DESCR).Text = itmAvant.SubItems(I_COL_SOUM_DESCR).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DESCR).Text))
			End If
290: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Tag
			
			'On met le nom du fabricant dans la col-nne et l'ordre de la section dans le tag
295: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text))
			End If
300: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
			
			'Prix listé
305: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text))
			End If
			
310: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
			
315: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text))
			End If
			
320: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text))
			End If
			
325: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
			
			'On met le fournisseur dans la colonne et l'id dans le tag
330: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
				itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text))
			End If
335: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
			
			'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
340: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text))
			End If
			
			'Pour le profit, c'est le prix total - (prix net * quantité)
345: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text))
			End If
			
			'Ajout du nouveau Prix
350: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Insert(CShort(fraPrix.Tag) + 2, "")
			
355: itmSoum.Checked = itmAvant.Checked
			
			'Quantité
360: itmSoum.Text = sQuantite
			
			'On met l'id de la section dans le tag du listItem
365: itmSoum.Tag = itmAvant.Tag
			
			'No d'item
370: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = itmAvant.SubItems(I_COL_SOUM_PIECE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PIECE).Text))
			End If
			
375: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom de la sous-section dans le tag du no d'item
380: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
			'On met la description en francais dans la colonne et la description en anglais
			'dans le tag
385: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
				itmSoum.SubItems(I_COL_SOUM_DESCR).Text = itmAvant.SubItems(I_COL_SOUM_DESCR).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DESCR).Text))
			End If
390: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Tag
			
395: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom du fabricant dans la col-nne et l'ordre de la section dans le tag
400: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text))
			End If
405: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
			
410: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
415: If bPrixSpecial = False Then
420: If optUSA.Checked = True Then
425: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
430: Else
435: If optSpain.Checked = True Then
440: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
445: Else
450: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
455: End If
460: End If
				
465: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
				
470: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
				'Escompte
475: If mskEscompte.Text <> vbNullString Then
480: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)))
					End If
485: Else
490: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
					End If
495: End If
				
500: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
				'Prix net
505: If optUSA.Checked = True Then
510: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
515: Else
520: If optSpain.Checked = True Then
525: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
530: Else
535: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
540: End If
545: End If
				
550: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
				
555: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
560: Else
565: If optUSA.Checked = True Then
570: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
575: Else
580: If optSpain.Checked = True Then
585: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
590: Else
595: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
600: End If
605: End If
				
610: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
				
615: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
620: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
				End If
				
625: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
630: If optUSA.Checked = True Then
635: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
640: Else
645: If optSpain.Checked = True Then
650: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
655: Else
660: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
665: End If
670: End If
				
675: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
				
680: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
685: End If
			
			'On met le fournisseur dans la colonne et l'id dans le tag
690: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
				itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = VB6.GetItemString(cmbfrs, cmbfrs.SelectedIndex)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB6.GetItemString(cmbfrs, cmbfrs.SelectedIndex)))
			End If
695: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex))
			
700: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
705: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
710: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
715: If optUSA.Checked = True Then
720: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "USA"
725: Else
730: If optSpain.Checked = True Then
735: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "SPA"
740: Else
745: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "CAN"
750: End If
755: End If
			
			'Pour le profit, c'est le prix total - (prix net * quantité)
760: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", ""))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", ""))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
765: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
770: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
				itmSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = itmAvant.SubItems(I_COL_SOUM_COMMENTAIRE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_COMMENTAIRE).Text))
			End If
775: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
780: If m_eType = enumType.TYPE_PROJET Then
785: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
					itmSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text))
				End If
790: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
795: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
					itmSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = itmAvant.SubItems(I_COL_SOUM_DATE_REQUISE).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DATE_REQUISE).Text))
				End If
800: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
805: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
					itmSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = itmAvant.SubItems(I_COL_SOUM_NOM_COMMANDE).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_NOM_COMMANDE).Text))
				End If
810: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
815: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
					itmSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = itmAvant.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text))
				End If
820: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
825: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
					itmSoum.SubItems(I_COL_SOUM_FACTURATION).Text = itmAvant.SubItems(I_COL_SOUM_FACTURATION).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_FACTURATION).Text))
				End If
				
830: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems(I_COL_SOUM_FACTURATION).Text <> "" Then
835: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_FACTURATION).Tag = itmAvant.SubItems.Item(I_COL_SOUM_FACTURATION).Tag
840: End If
				
845: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_FACTURATION).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
850: End If
			
855: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmAvant.SubItems(I_COL_SOUM_COMMENTAIRE).Text <> "" Then
860: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor
				
865: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmAvant.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
870: End If
			
875: If m_eType = enumType.TYPE_PROJET Then
880: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text <> "" Then
885: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
890: End If
				
895: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_DATE_REQUISE).Text <> "" Then
900: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
905: End If
				
910: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_NOM_COMMANDE).Text <> "" Then
915: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
920: End If
				
925: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text <> "" Then
930: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
935: End If
				
940: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmAvant.SubItems.Item(I_COL_SOUM_FACTURATION).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
				
945: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_PROVENANCE).Text <> "" Then
950: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
955: End If
960: End If
			
965: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).ForeColor
970: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor
975: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor
980: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor
985: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor
990: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor
995: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor
1000: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor
1005: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor
			
1010: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1015: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1020: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1025: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1030: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1035: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1040: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1045: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1050: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
			
1055: If lvwSoumission.Items.Count > 0 Then
1060: Call Deselect()
				
1065: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(1).Selected = True
1070: End If
			
1075: m_bMauvaisPrix = False
			
1080: 'UPGRADE_ISSUE: ComboBox property cmbfrs.Locked was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			cmbfrs.Locked = False
			
1085: Call lvwSoumission.Refresh()
1090: Else
1095: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			sPiece = lvwSoumission.Items.Item(CShort(fraPrix.Tag)).SubItems(I_COL_SOUM_PIECE).Text
			
1100: For iCompteur = 1 To lvwSoumission.Items.Count
1105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text = sPiece And System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_MAGENTA Then
1110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum = lvwSoumission.Items.Item(iCompteur)
					
1115: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1120: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1125: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1130: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1135: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1140: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1145: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1150: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1155: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
					
1160: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text <> "" Then
1165: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1170: End If
					
1175: Call lvwSoumission.Refresh()
					
1180: If bPrixSpecial = False Then
						'Prix listé
1185: If optUSA.Checked = True Then
1190: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1195: Else
1200: If optSpain.Checked = True Then
1205: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1210: Else
1215: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1220: End If
1225: End If
						
1230: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_DECIMAL, 4)
						
						'Escompte
1235: If mskEscompte.Text <> vbNullString Then
1240: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
								itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)))
							End If
1245: Else
1250: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
								itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
							End If
1255: End If
						
						'Prix net
1260: If optUSA.Checked = True Then
1265: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1270: Else
1275: If optSpain.Checked = True Then
1280: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1285: Else
1290: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1295: End If
1300: End If
1305: Else
						'Prix listé
1310: If optUSA.Checked = True Then
1315: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1320: Else
1325: If optSpain.Checked = True Then
1330: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1335: Else
1340: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1345: End If
1350: End If
						
1355: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_DECIMAL, 4)
						
1360: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
							itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
						End If
						
						'Prix net
1365: If optUSA.Checked = True Then
1370: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1375: Else
1380: If optSpain.Checked = True Then
1385: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1390: Else
1395: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1400: End If
1405: End If
1410: End If
					
					'On met le fournisseur dans la colonne et l'id dans le tag
1415: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = VB6.GetItemString(cmbfrs, cmbfrs.SelectedIndex)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB6.GetItemString(cmbfrs, cmbfrs.SelectedIndex)))
					End If
					
1420: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex))
					
					'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
1425: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
						itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.Text) * CDbl(Conversion_Renamed(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.Text) * CDbl(Conversion_Renamed(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
					
1430: If optUSA.Checked = True Then
1435: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "USA"
1440: Else
1445: If optSpain.Checked = True Then
1450: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "SPA"
1455: Else
1460: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "CAN"
1465: End If
1470: End If
					
					'Pour le profit, c'est le prix total - (prix net * quantité)
1475: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(itmSoum.Text)), 2)), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(itmSoum.Text)), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
1480: End If
1485: Next 
1490: End If
		
1495: Call ModifierPrixCatalogue()
		
1500: fraPrix.Visible = False
		
1505: Call CalculerPrix()
		
1510: Exit Sub
		
AfficherErreur: 
		
1515: Call AfficherErreur("frmProjSoumMec", "cmdOKPrix_Click", Err, Erl())
	End Sub
	
	Private Sub cmdPhotos_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdPhotos.Click
		
5: On Error GoTo AfficherErreur
		
10: If txtCheminPhotos.Text <> vbNullString Then
15: Call frmPhotoProjSoum.Afficher(txtCheminPhotos.Text)
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "cmdPhotos_Click", Err, Erl())
	End Sub
	
	Private Sub cmdReception_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdReception.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
15: Dim bOuvert As Boolean
		
20: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
25: Call MsgBox("Vous ne pouvez pas faire de réception pour ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
30: Exit Sub
35: End If
		
40: For iCompteur = 0 To My.Application.OpenForms.Count - 1
45: If My.Application.OpenForms.Item(iCompteur).Name = "FrmReceptionMec" Then
50: bOuvert = True
				
55: Exit For
60: End If
65: Next 
		
70: If bOuvert = True Then
75: Call FrmReceptionMec.Close()
80: End If
		
85: Call FrmReceptionMec.AfficherProjet(g_sUserID, txtNoProjSoum.Text)
		
90: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
95: Exit Sub
		
AfficherErreur: 
		
100: Call AfficherErreur("frmProjSoumMec", "cmdReception_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRechercherClient_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRechercherClient.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim sRecherche As String
		
15: sRecherche = InputBox("Entrez le texte à rechercher.")
		
20: 'UPGRADE_ISSUE: StrPtr function is not supported. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="367764E5-F3F8-4E43-AC3E-7FE0B5E074E2"'
		If StrPtr(sRecherche) <> 0 Then
25: Call RemplirComboClients(sRecherche)
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "cmdRechercherClient_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRetour_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRetour.Click
		
5: On Error GoTo AfficherErreur
		
10: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
15: Call MsgBox("Vous ne pouvez pas faire de retour dans ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
20: Exit Sub
25: End If
		
30: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
35: Call frmRetourMarchandise.Afficher(txtNoProjSoum.Text, g_sUserID)
		
40: Call cmbProjSoum_SelectedIndexChanged(cmbProjSoum, New System.EventArgs())
		
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumMec", "cmdRetour_Click", Err, Erl())
	End Sub
	
	Private Sub cmdBrowse_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdBrowse.Click
		
5: On Error GoTo AfficherErreur
		
10: Call frmChoixDossier.Afficher(Me)
		
15: If m_bAnnulerChemin = False Then
20: txtCheminPhotos.Text = m_sChemin
25: End If
		
30: Exit Sub
		
AfficherErreur: 
		
35: Call AfficherErreur("frmProjSoumMec", "cmdBrowse_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRafraichir_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRafraichir.Click
		
5: On Error GoTo AfficherErreur
		
10: If m_sTri <> vbNullString Then
15: m_sTri = vbNullString
			
20: Call RemplirListViewPieces()
25: End If
		
30: Exit Sub
		
AfficherErreur: 
		
35: Call AfficherErreur("frmProjSoumMec", "cmdRafraichir_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRapportFACT_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRapportFACT.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
20: Dim sNoFacture As String
		
25: If lvwSoumission.Items.Count > 0 Then
30: If txtNoProjSoum.Text <> vbNullString Then
35: If VerifierSiOuvert(sUser) = False Then
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					sNoFacture = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text
					
45: If VB.Left(sNoFacture, 2) = "F-" Or sNoFacture = "NC" Then
						'Ouvre les tables
50: rstProjSoum = New ADODB.Recordset
						
55: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "' ORDER BY IDProjet", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
						'***********************************************************************************
						'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
						'***********************************************************************************
						If MsgBox("Désirez-vous afficher les dates de réception et de commande?", MsgBoxStyle.YesNo, "Date de réception et de commande") = MsgBoxResult.Yes Then
							bFlag = True
						Else
							bFlag = False
						End If
						'***********************************************************************************
						
60: Call ImprimerProjSoumFacturation(rstProjSoum, sNoFacture)
65: Call ImprimerListePiecesFacturation(rstProjSoum, sNoFacture)
						
70: 'Call rstProjSoum.MoveNext
						
75: Call rstProjSoum.Close()
80: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
85: Else
90: Call MsgBox("La ligne sélectionnée ne contient aucune facture!", MsgBoxStyle.OKOnly, "Erreur")
95: End If
100: Else
105: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
110: End If
115: End If
120: Else
125: Call MsgBox("Ce projet ne contient aucune pièce à imprimer!", MsgBoxStyle.OKOnly, "Erreur")
130: End If
		
135: Exit Sub
		
AfficherErreur: 
		
140: Call AfficherErreur("frmProjSoumMec", "cmdRapportFACT_Click", Err, Erl())
	End Sub
	
	Private Sub cmdSortieMagasin_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdSortieMagasin.Click
		
5: On Error GoTo AfficherErreur
		
10: Call SortieMagasin()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdSortieMagasin_Click", Err, Erl())
	End Sub
	
	Private Sub ChangerQuantite()
		
5: On Error GoTo AfficherErreur
		
10: Dim sQuantite As String
15: Dim itmSoum As System.Windows.Forms.ListViewItem
		
20: sQuantite = Replace(InputBox("Quelle est la nouvelle quantité?"), ".", ",")
		
25: If IsNumeric(sQuantite) Then
30: itmSoum = lvwSoumission.FocusedItem
			
35: itmSoum.Text = sQuantite
			
			'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
40: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
			End If
			
			'Pour le profit, c'est le prix total - (prix net * quantité)
45: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
50: Call CalculerPrix()
55: End If
		
60: Exit Sub
		
AfficherErreur: 
		
65: Call AfficherErreur("frmProjSoumMec", "ChangerQuantite", Err, Erl())
	End Sub
	
	Private Sub SortieMagasin()
		
5: On Error GoTo AfficherErreur
		
10: Dim lColor As Integer
15: Dim sTag As String
		
20: If lvwSoumission.Items.Count > 0 Then
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
				'Si pas une section
30: If lvwSoumission.FocusedItem.Tag <> "" Then
					'Si pas une sous-section
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "" Then
						'Si ce n'est pas du Texte
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la pièce est noire ou gris
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_GRIS Then
								'Si la pièce est noire
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Then
									'On la met grise
55: lColor = COLOR_ORANGE
									
60: sTag = Replace(lvwSoumission.FocusedItem.Text, "*", "")
65: Else
70: lColor = COLOR_NOIR
									
75: sTag = "0"
80: End If
								
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
100: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
								
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text = "" Then
135: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_FACTURATION Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text = " "
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
									End If
140: End If
								
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_FACTURATION).Tag = sTag
								
150: Call lvwSoumission.Refresh()
								
155: Call CalculerPrixReception()
160: End If
165: End If
170: End If
175: End If
180: Else
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
190: End If
195: End If
		
200: Exit Sub
		
AfficherErreur: 
		
205: Call AfficherErreur("frmProjSoumMec", "SortieMagasin", Err, Erl())
	End Sub
	
	Private Sub cmdSupprimerFRS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdSupprimerFRS.Click
		'Permet d'effacer un Fournisseur
5: On Error GoTo AfficherErreur
		
10: Dim sPiece As String
		
		'Si c'est pas Choisir Ultérieurement
15: If lvwfournisseur.FocusedItem.Text <> "CHOISIR ULTÉRIEUREMENT" Then
20: If m_bPieceInutile = True Then
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				sPiece = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text
30: Else
35: If m_bRecherchePiece = True Then
40: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					sPiece = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
45: Else
50: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					sPiece = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
55: End If
60: End If
			
65: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If MsgBox("Voulez-vous vraiment supprimer le fournisseur " & lvwfournisseur.FocusedItem.Text & " pour la pièce " & lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text & "?", MsgBoxStyle.YesNo, "Suppression") = MsgBoxResult.Yes Then
70: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call g_connData.Execute("DELETE * FROM GRB_PiecesFRS WHERE NoEnreg = " & lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_ENTRER_PAR).Tag)
				
75: Call RemplirListViewFournisseur()
				
80: frafournisseur.Visible = True
85: Call lvwfournisseur.Focus()
90: End If
95: End If
		
100: Exit Sub
		
AfficherErreur: 
		
105: Call AfficherErreur("frmProjSoumMec", "cmdSupprimerFRS_Click", Err, Erl())
	End Sub
	
	Private Sub cmdTemps_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdTemps.Click
		
5: On Error GoTo AfficherErreur
		
10: If cmbProjSoum.Items.Count > 0 Then
15: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
20: If m_bModeAjout = True Then
25: If m_bExtra = True Then
30: If m_eType = enumType.TYPE_PROJET Then
35: Call frmProjSoumMecTemps.Afficher(txtNoProjSoum.Text, txtNoSoumission.Text, m_eType, m_eMode, False)
40: Else
45: Call frmProjSoumMecTemps.Afficher("", txtNoProjSoum.Text, m_eType, m_eMode, False)
50: End If
55: Else
60: If m_eType = enumType.TYPE_PROJET Then
65: Call frmProjSoumMecTemps.Afficher(txtNoProjSoum.Text, txtNoSoumission.Text, m_eType, m_eMode, True)
70: Else
75: Call frmProjSoumMecTemps.Afficher("", txtNoProjSoum.Text, m_eType, m_eMode, True)
80: End If
85: End If
90: Else
95: If m_eType = enumType.TYPE_PROJET Then
100: Call frmProjSoumMecTemps.Afficher(txtNoProjSoum.Text, txtNoSoumission.Text, m_eType, m_eMode, False)
105: Else
110: Call frmProjSoumMecTemps.Afficher("", txtNoProjSoum.Text, m_eType, m_eMode, False)
115: End If
120: End If
125: Else
130: If m_eType = enumType.TYPE_PROJET Then
135: Call frmProjSoumMecTemps.Afficher(txtNoProjSoum.Text, txtNoSoumission.Text, m_eType, m_eMode, False)
140: Else
145: Call frmProjSoumMecTemps.Afficher("", txtNoProjSoum.Text, m_eType, m_eMode, False)
150: End If
155: End If
160: End If
		
165: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
170: Call CalculerPrix()
175: End If
		
180: m_bTempsDejaOuvert = True
		
185: Exit Sub
		
AfficherErreur: 
		
190: Call AfficherErreur("frmProjSoumMec", "cmdTemps_Click", Err, Erl())
	End Sub
	
	Private Sub cmdTexte_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdTexte.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim iIndex As Short
15: Dim sSousSection As String
20: Dim sTexte As String
		
		'Ajout de texte dans la soumission
25: If lvwSoumission.Items.Count > 0 Then
30: If lvwSoumission.FocusedItem.Index = 1 Then
35: sSousSection = InputBox("Quelle est la sous-section?")
				
40: If Trim(sSousSection) = "" Then
45: sSousSection = S_PAS_SOUS_SECTION
50: End If
				
55: sTexte = InputBox("Quel est le texte?")
				
60: If Trim(sTexte) <> "" Then
65: If Len(sTexte) > 255 Then
70: Call MsgBox("Le texte ne doit pas dépasser 255 caractères!", MsgBoxStyle.OKOnly, "Erreur")
75: Else
80: iIndex = TrouverIndexSection(sSousSection)
						
85: Call AjouterTexte(iIndex, sTexte, sSousSection)
90: End If
95: End If
100: Else
105: sTexte = InputBox("Quel est le texte?")
				
110: If Trim(sTexte) <> "" Then
115: If Len(sTexte) > 255 Then
120: Call MsgBox("Le texte ne doit pas dépasser 255 caractères!", MsgBoxStyle.OKOnly, "Erreur")
125: Else
130: iIndex = lvwSoumission.FocusedItem.Index
						
135: Call AjouterTexte(iIndex, sTexte, "")
140: End If
145: End If
150: End If
155: End If
		
160: Exit Sub
		
AfficherErreur: 
		
165: Call AfficherErreur("frmProjSoumMec", "cmdTexte_Click", Err, Erl())
	End Sub
	
	Private Sub AjouterTexte(ByVal iIndex As Short, ByVal sTexte As String, ByVal sNomSousSection As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour ajouter le texte
10: Dim sSousSection As String
15: Dim sOrdre As String
20: Dim sIDSection As String
		
		'Si il faut l'ajouter à la fin, on prend les infos du dernier enregistrement
25: If iIndex > lvwSoumission.Items.Count Then
30: If sNomSousSection = "" Then
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSousSection = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
40: Else
45: sSousSection = sNomSousSection
50: End If
			
55: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			sOrdre = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
60: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			sIDSection = lvwSoumission.Items.Item(iIndex - 1).Tag
65: Else
			'Si c'est une section
70: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iIndex).Tag = vbNullString Then
75: If sNomSousSection = "" Then
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sSousSection = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
85: Else
90: sSousSection = sNomSousSection
95: End If
				
100: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sOrdre = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sIDSection = lvwSoumission.Items.Item(iIndex - 1).Tag
110: Else
				'Si c'est une sous-section
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
					'Si c'est pas la première sous-section
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iIndex - 1).Tag <> vbNullString Then
125: If sNomSousSection = "" Then
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							sSousSection = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
135: Else
140: sSousSection = sNomSousSection
145: End If
						
150: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sOrdre = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
155: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sIDSection = lvwSoumission.Items.Item(iIndex).Tag
160: Else
165: Call MsgBox("Vous ne pouvez pas mettre du texte entre une section et une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
						
170: Exit Sub
175: End If
180: Else
185: If sNomSousSection = "" Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sSousSection = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_PIECE).Tag
195: Else
200: sSousSection = sNomSousSection
205: End If
					
210: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sOrdre = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
215: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sIDSection = lvwSoumission.Items.Item(iIndex).Tag
220: End If
225: End If
230: End If
		
235: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call lvwSoumission.Items.Insert(iIndex, "")
		
240: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call ValeurParDefaut(lvwSoumission.Items.Item(iIndex))
		
245: If m_eLangage = enumLangage.ANGLAIS Then
250: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_PIECE Then
				lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text = "Text"
			Else
				lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Text"))
			End If
255: Else
260: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_PIECE Then
				lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text = "Texte"
			Else
				lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Texte"))
			End If
265: End If
		
270: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_DESCR Then
			lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_DESCR).Text = sTexte
		Else
			lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sTexte))
		End If
		
		'ID de la section
275: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.Items.Item(iIndex).Tag = sIDSection
		
		'On ne peut pas écrire dans le tag si c'est vide
280: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_MANUFACT Then
			lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_MANUFACT).Text = " "
		Else
			lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
		End If
		
		'Ordre de la section
285: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_MANUFACT).Tag = sOrdre
		
		'Nom de la sous-section
290: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
		
295: Exit Sub
		
AfficherErreur: 
		
300: Call AfficherErreur("frmProjSoumMec", "AjouterTexte", Err, Erl())
	End Sub
	
	Private Sub cmdTri_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdTri.Click
		
5: On Error GoTo AfficherErreur
		
10: m_sTri = InputBox("Quel est le texte à trier?")
		
15: m_iCol = cmbTri.SelectedIndex
		
20: If m_sTri <> vbNullString Then
25: Call RemplirListViewPieces()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "cmdTri_Click", Err, Erl())
	End Sub
	
	Private Sub FrmProjSoumMec_FormClosing(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
		Dim Cancel As Boolean = eventArgs.Cancel
		Dim UnloadMode As System.Windows.Forms.CloseReason = eventArgs.CloseReason
		
5: On Error GoTo AfficherErreur
		
10: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
15: Call MsgBox("Veuillez enregistrer ou annuler avant de fermer!", MsgBoxStyle.OKOnly, "Erreur")
			
20: Cancel = 1
25: End If
		
30: Exit Sub
		
AfficherErreur: 
		
35: Call AfficherErreur("frmProjSoumMec", "Form_QueryUnload", Err, Erl())
		eventArgs.Cancel = Cancel
	End Sub
	
	'UPGRADE_WARNING: Event FrmProjSoumMec.Resize may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub FrmProjSoumMec_Resize(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles MyBase.Resize
		
5: On Error GoTo AfficherErreur
		
10: If VB6.PixelsToTwipsY(Me.Height) > I_HEIGHT_AFFICHAGE Then
15: If m_eMode = enumMode.MODE_INACTIF Then
20: lvwPieces.Width = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 375)
25: lvwSoumission.Width = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 375)
				
30: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - I_HEIGHT_AFFICHAGE)
35: lvwPieces.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
40: End If
			
45: cmdImprimer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
50: Cmdajouter.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
55: cmdModifier.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
60: cmdsupprimer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
65: Cmdfermer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
70: cmdEnregistrer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
75: cmdAnnuler.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
80: cmdTexte.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
85: cmdCreerProjet.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
90: cmdCopier.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
95: cmdRetour.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
100: cmdBonCommande.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
105: cmdDemande.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
110: cmdAnglaisFrancais.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
115: cmdExtra.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
120: cmdCatalogue.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
125: cmdMaterielInutile.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
130: cmdReset.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
135: cmdMauvaisPrix.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
140: cmdRapportFACT.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
145: cmdSortieMagasin.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
150: cmdReception.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
155: End If
		
160: Call PositionnerBoutons()
		
165: Exit Sub
		
AfficherErreur: 
		
170: Call AfficherErreur("frmProjSoumMec", "Form_Resize", Err, Erl())
	End Sub
	
	Private Sub PositionnerBoutons()
		
5: On Error GoTo AfficherErreur
		
10: Cmdfermer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 1230)
15: cmdModifier.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 2310)
20: cmdAnnuler.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 2310)
25: cmdEnregistrer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
30: cmdCatalogue.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
		
35: If m_eType = enumType.TYPE_PROJET Then
40: cmdMaterielInutile.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
45: cmdMauvaisPrix.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 8790)
50: cmdSortieMagasin.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 9870)
			
55: If m_bSupprimer = True Then
60: cmdsupprimer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
65: Cmdajouter.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 4470)
70: cmdBonCommande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 5550)
75: cmdDemande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
80: cmdExtra.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
85: cmdRetour.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 8790)
90: cmdReception.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 9870)
95: Else
100: Cmdajouter.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
105: cmdBonCommande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 4470)
110: cmdDemande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 5550)
115: cmdExtra.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
120: cmdRetour.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
125: cmdReception.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 8790)
130: End If
135: Else
140: cmdsupprimer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
145: Cmdajouter.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 4470)
150: cmdCopier.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 5550)
155: cmdMauvaisPrix.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
160: cmdDemande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
165: cmdCreerProjet.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
170: End If
		
175: Exit Sub
		
AfficherErreur: 
		
180: Call AfficherErreur("frmProjSoumMec", "PositionnerBoutons", Err, Erl())
	End Sub
	
	Private Sub FrmProjSoumMec_FormClosed(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.FormClosedEventArgs) Handles Me.FormClosed
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_NOTE: Object FrmProjSoumMec may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		Me = Nothing
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "Form_Unload", Err, Erl())
	End Sub
	
	Private Sub lvwfournisseur_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles lvwfournisseur.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		'Permet d'effacer un Fournisseur
5: On Error GoTo AfficherErreur
		
10: Dim sPiece As String
		
15: If KeyCode = System.Windows.Forms.Keys.Delete Then
20: If g_bModificationCatalogueMec = True Then
				'Si c'est pas Choisir ultérieurement
25: If lvwfournisseur.FocusedItem.Text <> "CHOISIR ULTÉRIEUREMENT" Then
30: If m_bPieceInutile = True Then
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						sPiece = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text
40: Else
45: If m_bRecherchePiece = True Then
50: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							sPiece = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
55: Else
60: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							sPiece = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
65: End If
70: End If
					
75: If MsgBox("Voulez-vous vraiment supprimer le fournisseur " & lvwfournisseur.FocusedItem.Text & " pour la pièce " & sPiece & "?", MsgBoxStyle.YesNo, "Suppression") = MsgBoxResult.Yes Then
80: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						Call g_connData.Execute("DELETE * FROM GRB_PiecesFRS WHERE NoEnreg = " & lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_ENTRER_PAR).Tag)
						
85: Call RemplirListViewFournisseur()
						
90: frafournisseur.Visible = True
95: Call lvwfournisseur.Focus()
100: End If
105: End If
110: End If
115: End If
		
120: Exit Sub
		
AfficherErreur: 
		
125: Call AfficherErreur("frmProjSoumMec", "lvwFournisseur_KeyDown", Err, Erl())
	End Sub
	
	Private Sub lvwHistorique_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwHistorique.Leave
		
5: On Error GoTo AfficherErreur
		
		'Lorsque l'historique perd le focus, on l'enlève
10: lvwHistorique.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "lvwHistorique_LostFocus", Err, Erl())
	End Sub
	
	Private Sub lvwPieces_ColumnClick(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.ColumnClickEventArgs) Handles lvwPieces.ColumnClick
		Dim ColumnHeader As System.Windows.Forms.ColumnHeader = lvwPieces.Columns(eventArgs.Column)
		
5: On Error GoTo AfficherErreur
		
10: Dim sTexte As String
		
15: sTexte = InputBox("Quel est le texte à rechercher?")
		
20: If Trim(sTexte) <> vbNullString Then
25: If Len(Trim(sTexte)) >= 2 Then
30: Call RemplirListViewRecherche(ColumnHeader.Index - 1, sTexte)
				
35: If lvwPieceTrouve.Items.Count > 0 Then
40: fraPieceTrouve.Visible = True
45: Else
50: Call MsgBox("Aucun enregistrements trouvés!", MsgBoxStyle.OKOnly, "Erreur")
55: End If
60: Else
65: Call MsgBox("Il faut un minimum de 2 caractères pour rechercher!", MsgBoxStyle.OKOnly, "Erreur")
70: End If
75: End If
		
80: Exit Sub
		
AfficherErreur: 
		
85: Call AfficherErreur("frmProjSoumMec", "lvwPieces_ColumnClick", Err, Erl())
	End Sub
	
	Private Sub cmdEnregistrer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdEnregistrer.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim objControl As Object
15: Dim sMessage As String
		
20: frafournisseur.Visible = False
25: fraPieceTrouve.Visible = False
30: fraCommentaire.Visible = False
35: fraDateRequise.Visible = False
		
		'Vérification des textbox
40: For	Each objControl In Me.Controls
45: If TypeOf objControl Is System.Windows.Forms.TextBox Then
50: 'UPGRADE_WARNING: Couldn't resolve default property of object objControl.Visible. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				If objControl.Visible = True Then
55: 'UPGRADE_WARNING: Couldn't resolve default property of object objControl.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If objControl.Name <> "txtNoSoumission" And objControl.Name <> "txtCheminPhotos" And objControl.Name <> "txtPrixReception" And objControl.Name <> "txtDateFacturation" And objControl.Name <> "txtPrixSoumission" And objControl.Name <> "txtForfait" Then
60: 'UPGRADE_WARNING: Couldn't resolve default property of object objControl.Text. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If Trim(objControl.Text) = vbNullString Then
65: Call MsgBox("Vous devez remplir tous les champs!", MsgBoxStyle.OKOnly, "Erreur")
							
70: Exit Sub
75: End If
80: End If
85: End If
90: Else
95: If TypeOf objControl Is System.Windows.Forms.ComboBox Then
100: 'UPGRADE_WARNING: Couldn't resolve default property of object objControl.Visible. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					If objControl.Visible = True Then
105: 'UPGRADE_WARNING: Couldn't resolve default property of object objControl.ListIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If objControl.ListIndex = -1 Then
110: 'UPGRADE_WARNING: Couldn't resolve default property of object objControl.Name. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							If objControl.Name <> "cmbTri" And objControl.Name <> "cmbSections" And objControl.Name <> "cmbPieces" Then
115: Call MsgBox("Vous devez remplir tous les champs!", MsgBoxStyle.OKOnly, "Erreur")
								
120: Exit Sub
125: End If
130: End If
135: End If
140: End If
145: End If
150: Next objControl
		
155: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
160: If BackupPieces(txtNoProjSoum.Text) = False Then
165: If m_eType = enumType.TYPE_PROJET Then
170: sMessage = "Une erreur est survenue lors de la copie de sauvegarde du projet en cours!"
175: Else
180: sMessage = "Une erreur est survenue lors de la copie de sauvegarde de la soumission en cours!"
185: End If
			
190: sMessage = sMessage & vbNewLine & vbNewLine & "Voulez-vous continuer ?"
			
195: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			
200: If MsgBox(sMessage, MsgBoxStyle.YesNo) = MsgBoxResult.No Then
205: Exit Sub
210: Else
215: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
220: End If
225: End If
		
		'Enregistre la soumission
230: Call EnregistrerProjSoum(txtNoProjSoum.Text)
		
235: Call OuvrirProjSoum(False)
		
		'Remet en mode inactif
240: Call AfficherControles(enumMode.MODE_INACTIF)
		
245: m_bEnregistrement = True
		
		'Affiche la soumission actuel
250: Call AfficherProjSoum(txtNoProjSoum.Text)
		
255: m_bEnregistrement = False
		
260: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
265: Exit Sub
		
AfficherErreur: 
		
270: Call AfficherErreur("frmProjSoumMec", "cmdEnregistrer_Click", Err, Erl())
	End Sub
	
	Private Sub EnregistrerFACT(ByVal sNoProjet As String)
		'Calcul le total de chaque facture dans le projet
5: On Error GoTo AfficherErreur
		
10: Dim rstModif As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim sPrixTotal As String
25: Dim sProfit As String
30: Dim sCommission As String
35: Dim sNoFacture As String
40: Dim sTotalPiece As String
45: Dim sImprevue As String
50: Dim sTotalTemps As String
55: Dim sAutre As String
60: Dim iCompteur As Short
65: Dim iIndexFacture As Short
70: Dim collFacture As Collection
75: Dim bExiste As Boolean
		
80: collFacture = New Collection
		
85: Call g_connData.Execute("DELETE * FROM GRB_Projet_Modif WHERE IDProjet = '" & sNoProjet & "' AND Type = 'M' AND TypeModif = 'FACTURATION'")
		
90: If lvwSoumission.Items.Count > 0 Then
95: For iCompteur = 1 To lvwSoumission.Items.Count
100: bExiste = False
				
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				sNoFacture = lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text
				
110: If sNoFacture <> "" Then
115: For iIndexFacture = 1 To collFacture.Count()
120: 'UPGRADE_WARNING: Couldn't resolve default property of object collFacture(iIndexFacture). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If collFacture.Item(iIndexFacture) = sNoFacture Then
125: bExiste = True
							
130: Exit For
135: End If
140: Next 
					
145: If bExiste = False Then
150: Call collFacture.Add(sNoFacture)
						
155: Call CalculerPrixFacturation(sNoFacture, sCommission, sPrixTotal, sProfit, sTotalPiece, sImprevue, sTotalTemps, sAutre)
						
160: rstModif = New ADODB.Recordset
						
165: Call rstModif.Open("SELECT * FROM GRB_Projet_Modif WHERE Date = '" & Replace(sNoFacture, "F-", "") & "' AND TypeModif = 'FACTURATION'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
170: If rstModif.EOF Then
175: Call rstModif.AddNew()
180: End If
						
185: rstModif.Fields("IDProjet").Value = txtNoProjSoum.Text
						
190: rstEmploye = New ADODB.Recordset
						
195: Call rstEmploye.Open("SELECT * FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
200: rstModif.Fields("NoEmployé").Value = rstEmploye.Fields("NoEmploye").Value
						
205: Call rstEmploye.Close()
210: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstEmploye = Nothing
						
215: rstModif.Fields("Date").Value = Replace(sNoFacture, "F-", "")
220: rstModif.Fields("Heure").Value = " "
225: rstModif.Fields("Type").Value = "M"
230: rstModif.Fields("TypeModif").Value = "FACTURATION"
235: rstModif.Fields("Valeur").Value = sPrixTotal
						
240: Call rstModif.Update()
						
245: Call rstModif.Close()
250: 'UPGRADE_NOTE: Object rstModif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstModif = Nothing
255: End If
260: End If
265: Next 
270: End If
		
275: Exit Sub
		
AfficherErreur: 
		
280: Call AfficherErreur("frmProjSoumMec", "EnregistrerFACT", Err, Erl())
	End Sub
	
	Private Sub EnregistrerProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstPiece As ADODB.Recordset
20: Dim rstEmploye As ADODB.Recordset
25: Dim rstModif As ADODB.Recordset
30: Dim rstOuvert As ADODB.Recordset
35: Dim rstSection As ADODB.Recordset
40: Dim rstPunch As ADODB.Recordset
45: Dim iCompteur As Short
50: Dim itmPiece As System.Windows.Forms.ListViewItem
55: Dim sTable As String
60: Dim sTableModif As String
65: Dim sTablePiece As String
70: Dim sChamps As String
75: Dim sSection As String
80: Dim sExtra As String
85: Dim bCalculExtra As Boolean
90: Dim collExtra As Collection
95: Dim iCompteurExtra As Short
100: Dim bExiste As Boolean
105: Dim bAjoutCommande As Boolean
110: Dim dblNbrePers As Double
115: Dim dblJoursHebergement As Double
120: Dim dblJoursRepas As Double
125: Dim dblHebergement1 As Double
130: Dim dblHebergement2 As Double
135: Dim dblRepas As Double
140: Dim dblTotalHebergement As Double
		
145: rstEmploye = New ADODB.Recordset
		
150: Call rstEmploye.Open("SELECT noEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
155: If m_eType = enumType.TYPE_PROJET Then
160: sTable = "GRB_ProjetMec"
165: sTableModif = "GRB_Projet_Modif"
170: sTablePiece = "GRB_Projet_Pieces"
175: sChamps = "IDProjet"
180: Else
185: sTable = "GRB_SoumissionMec"
190: sTableModif = "GRB_Soumission_Modif"
195: sTablePiece = "GRB_Soumission_Pieces"
200: sChamps = "IDSoumission"
205: End If
		
210: rstProjSoum = New ADODB.Recordset
215: rstOuvert = New ADODB.Recordset
		
220: collExtra = New Collection
		
		'Si c'est un ajout
225: If m_bModeAjout = True Then
			'On ouvre le recordset selon le type
230: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
235: If m_eType = enumType.TYPE_PROJET Then
240: If rstProjSoum.EOF Then
245: bAjoutCommande = True
250: Else
255: bAjoutCommande = False
260: End If
265: Else
270: bAjoutCommande = False
275: End If
			
280: Call rstProjSoum.AddNew()
			
285: If m_eType = enumType.TYPE_PROJET Then
290: rstProjSoum.Fields("LiaisonChargeable").Value = m_sLiaison
295: End If
			
300: rstProjSoum.Fields(sChamps).Value = sNoProjSoum
			
305: rstProjSoum.Fields("Creer").Value = ConvertDate(Today)
310: rstProjSoum.Fields("Creer_Par").Value = rstEmploye.Fields("noEmploye").Value
			
315: If m_eType = enumType.TYPE_PROJET Then
320: rstProjSoum.Fields("IDSoumission").Value = txtNoSoumission.Text
325: End If
			
330: Call rstOuvert.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
335: If rstOuvert.EOF Then
340: Call rstOuvert.AddNew()
				
345: rstOuvert.Fields("IDProjSoum").Value = sNoProjSoum
350: rstOuvert.Fields("NoClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
355: rstOuvert.Fields("Description").Value = txtDescription.Text
360: rstOuvert.Fields("DateOuverture").Value = ConvertDate(Today)
365: rstOuvert.Fields("Ouvert").Value = True
				
370: If m_eType = enumType.TYPE_PROJET Then
375: rstOuvert.Fields("Type").Value = "P"
380: Else
385: rstOuvert.Fields("Type").Value = "S"
390: End If
				
395: Call rstOuvert.Update()
400: End If
			
405: Call rstOuvert.Close()
			
410: m_bModeAjout = False
415: Else
420: Call EnregistrerSuppression()
			
425: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
430: rstModif = New ADODB.Recordset
			
435: Call rstModif.Open("SELECT * FROM " & sTableModif, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
440: Call rstModif.AddNew()
			
445: rstModif.Fields("Type").Value = "M"
450: rstModif.Fields(sChamps).Value = sNoProjSoum
455: rstModif.Fields("noEmployé").Value = rstEmploye.Fields("noEmploye").Value
460: rstModif.Fields("Date").Value = ConvertDate(Today)
465: rstModif.Fields("Heure").Value = TimeOfDay
470: rstModif.Fields("TypeModif").Value = "MODIFICATION"
			
475: Call rstModif.Update()
			
480: Call rstModif.Close()
485: 'UPGRADE_NOTE: Object rstModif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstModif = Nothing
			
490: Call rstOuvert.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
495: If rstOuvert.Fields("NoClient").Value <> VB6.GetItemData(cmbclient, cmbclient.SelectedIndex) Then
500: rstOuvert.Fields("NoClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
				
505: rstPunch = New ADODB.Recordset
				
510: Call rstPunch.Open("SELECT * FROM GRB_Punch WHERE NoProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
515: If Not rstPunch.EOF Then
520: If MsgBox("Le client a été modifié, voulez-vous changer les punch de ce projet ?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
						
525: Do While Not rstPunch.EOF
530: rstPunch.Fields("NoClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
							
535: Call rstPunch.Update()
							
540: Call rstPunch.MoveNext()
545: Loop 
550: End If
555: End If
				
560: Call rstPunch.Close()
565: 'UPGRADE_NOTE: Object rstPunch may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstPunch = Nothing
570: End If
			
575: rstOuvert.Fields("Description").Value = txtDescription.Text
			
580: Call rstOuvert.Update()
			
585: Call rstOuvert.Close()
590: 'UPGRADE_NOTE: Object rstOuvert may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstOuvert = Nothing
			
			'Si c'est une modification, il faut effacer les pieces et remplir les nouvelles
595: Call g_connData.Execute("DELETE * FROM " & sTablePiece & " WHERE " & sChamps & " = '" & sNoProjSoum & "' AND Type = 'M'")
			
600: If m_eType = enumType.TYPE_PROJET Then
605: If CDbl(VB.Right(sNoProjSoum, 2)) >= 60 And CDbl(VB.Right(sNoProjSoum, 2)) <= 98 Then
610: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(sNoProjSoum, Len(sNoProjSoum) - 3) & "-" & rstProjSoum.Fields("LiaisonChargeable").Value & "' AND Type = 'M' AND (PieceExtraChargeable = True OR PieceExtraNonChargeable = True) AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
615: End If
620: End If
625: End If
		
630: 'UPGRADE_NOTE: Object rstOuvert may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstOuvert = Nothing
		
		'Enregistrement de la soumission
635: rstProjSoum.Fields("IDClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
640: rstProjSoum.Fields("IDContact").Value = VB6.GetItemData(cmbContact, cmbContact.SelectedIndex)
645: rstProjSoum.Fields("Description").Value = txtDescription.Text
650: rstProjSoum.Fields("Imprevue").Value = m_sImprevue
655: rstProjSoum.Fields("Commission").Value = m_sCommission
660: rstProjSoum.Fields("Profit").Value = m_sProfit
		
665: If IsNumeric(txtNbreManuel.Text) Then
670: rstProjSoum.Fields("Manuel").Value = txtNbreManuel.Text
675: Else
680: rstProjSoum.Fields("Manuel").Value = "0"
685: End If
		
690: If IsNumeric(txtPrixManuel.Text) Then
695: rstProjSoum.Fields("Total_Manuel").Value = txtPrixManuel.Text
700: Else
705: rstProjSoum.Fields("Total_Manuel").Value = "0"
710: End If
		
715: rstProjSoum.Fields("total_Commission").Value = txtCommission.Text
720: rstProjSoum.Fields("Total_Profit").Value = txtProfit.Text
725: rstProjSoum.Fields("PrixTotal").Value = txtPrixTotal.Text
730: rstProjSoum.Fields("Total_piece").Value = txtTotalPieces.Text
735: rstProjSoum.Fields("total_imprevue").Value = txtImprevus.Text
		
740: If m_eType = enumType.TYPE_SOUMISSION Then
745: rstProjSoum.Fields("TempsDessin").Value = m_sTempsDessin
750: rstProjSoum.Fields("TempsCoupe").Value = m_sTempsCoupe
755: rstProjSoum.Fields("TempsMachinage").Value = m_sTempsMachinage
760: rstProjSoum.Fields("TempsSoudure").Value = m_sTempsSoudure
765: rstProjSoum.Fields("TempsAssemblage").Value = m_sTempsAssemblage
770: rstProjSoum.Fields("TempsPeinture").Value = m_sTempsPeinture
775: rstProjSoum.Fields("TempsTest").Value = m_sTempsTest
780: rstProjSoum.Fields("TempsInstallation").Value = m_sTempsInstallation
785: rstProjSoum.Fields("TempsFormation").Value = m_sTempsFormation
790: rstProjSoum.Fields("TempsGestion").Value = m_sTempsGestion
795: rstProjSoum.Fields("TempsShipping").Value = m_sTempsShipping
800: Else
805: rstProjSoum.Fields("TempsProjBarré").Value = m_bTempsProjLock
			
810: rstProjSoum.Fields("TempsDessinProj").Value = m_sTempsDessinProj
815: rstProjSoum.Fields("TempsCoupeProj").Value = m_sTempsCoupeProj
820: rstProjSoum.Fields("TempsMachinageProj").Value = m_sTempsMachinageProj
825: rstProjSoum.Fields("TempsSoudureProj").Value = m_sTempsSoudureProj
830: rstProjSoum.Fields("TempsAssemblageProj").Value = m_sTempsAssemblageProj
835: rstProjSoum.Fields("TempsPeintureProj").Value = m_sTempsPeintureProj
840: rstProjSoum.Fields("TempsTestProj").Value = m_sTempsTestProj
845: rstProjSoum.Fields("TempsInstallationProj").Value = m_sTempsInstallationProj
850: rstProjSoum.Fields("TempsFormationProj").Value = m_sTempsFormationProj
855: rstProjSoum.Fields("TempsGestionProj").Value = m_sTempsGestionProj
860: rstProjSoum.Fields("TempsShippingProj").Value = m_sTempsShippingProj
			
865: rstProjSoum.Fields("TempsDessinConc").Value = m_sTempsDessinConc
870: rstProjSoum.Fields("TempsCoupeConc").Value = m_sTempsCoupeConc
875: rstProjSoum.Fields("TempsMachinageConc").Value = m_sTempsMachinageConc
880: rstProjSoum.Fields("TempsSoudureConc").Value = m_sTempsSoudureConc
885: rstProjSoum.Fields("TempsAssemblageConc").Value = m_sTempsAssemblageConc
890: rstProjSoum.Fields("TempsPeintureConc").Value = m_sTempsPeintureConc
895: rstProjSoum.Fields("TempsTestConc").Value = m_sTempsTestConc
900: rstProjSoum.Fields("TempsInstallationConc").Value = m_sTempsInstallationConc
905: rstProjSoum.Fields("TempsFormationConc").Value = m_sTempsFormationConc
910: rstProjSoum.Fields("TempsGestionConc").Value = m_sTempsGestionConc
915: rstProjSoum.Fields("TempsShippingConc").Value = m_sTempsShippingConc
920: End If
		
925: rstProjSoum.Fields("NbrePersonne").Value = m_sNbrePersonne
930: rstProjSoum.Fields("TempsHebergement").Value = m_sTempsHebergement
935: rstProjSoum.Fields("TempsRepas").Value = m_sTempsRepas
940: rstProjSoum.Fields("TempsTransport").Value = m_sTempsTransport
945: rstProjSoum.Fields("TempsUniteMobile").Value = m_sTempsUniteMobile
950: rstProjSoum.Fields("PrixEmballage").Value = m_sPrixEmballage
		
955: rstProjSoum.Fields("TauxHebergement1").Value = m_sTauxHebergement1
960: rstProjSoum.Fields("TauxHebergement2").Value = m_sTauxHebergement2
965: rstProjSoum.Fields("TauxRepas").Value = m_sTauxRepas
970: rstProjSoum.Fields("TauxTransport").Value = m_sTauxTransport
975: rstProjSoum.Fields("TauxUniteMobile").Value = m_sTauxUniteMobile
		
980: rstProjSoum.Fields("TauxDessin").Value = m_sTauxDessin
985: rstProjSoum.Fields("TauxCoupe").Value = m_sTauxCoupe
990: rstProjSoum.Fields("TauxMachinage").Value = m_sTauxMachinage
995: rstProjSoum.Fields("TauxSoudure").Value = m_sTauxSoudure
1000: rstProjSoum.Fields("TauxAssemblage").Value = m_sTauxAssemblage
1005: rstProjSoum.Fields("TauxPeinture").Value = m_sTauxPeinture
1010: rstProjSoum.Fields("TauxTest").Value = m_sTauxTest
1015: rstProjSoum.Fields("TauxInstallation").Value = m_sTauxInstallation
1020: rstProjSoum.Fields("TauxFormation").Value = m_sTauxFormation
1025: rstProjSoum.Fields("TauxGestion").Value = m_sTauxGestion
1030: rstProjSoum.Fields("TauxShipping").Value = m_sTauxShipping
		
1035: rstProjSoum.Fields("CheminPhotos").Value = txtCheminPhotos.Text
1040: rstProjSoum.Fields("MontantForfait").Value = txtForfait.Text
1045: rstProjSoum.Fields("InitialeForfait").Value = lblForfaitInitiale.Text
		
1050: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
1055: dblNbrePers = CDbl(rstProjSoum.Fields("NbrePersonne").Value)
1060: Else
1065: dblNbrePers = 0
1070: End If
		
1075: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
1080: dblJoursHebergement = CDbl(rstProjSoum.Fields("TempsHebergement").Value)
1085: Else
1090: dblJoursHebergement = 0
1095: End If
		
1100: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
1105: dblJoursRepas = CDbl(rstProjSoum.Fields("TempsRepas").Value)
1110: Else
1115: dblJoursRepas = 0
1120: End If
		
1125: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
1130: dblHebergement1 = CDbl(rstProjSoum.Fields("TauxHebergement1").Value)
1135: Else
1140: dblHebergement1 = 0
1145: End If
		
1150: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
1155: dblHebergement2 = CDbl(rstProjSoum.Fields("TauxHebergement2").Value)
1160: Else
1165: dblHebergement2 = 0
1170: End If
		
1175: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
1180: dblRepas = CDbl(rstProjSoum.Fields("TauxRepas").Value)
1185: Else
1190: dblRepas = 0
1195: End If
		
1200: rstProjSoum.Fields("TotalRepas").Value = dblNbrePers * dblJoursRepas * dblRepas
		
1205: dblTotalHebergement = 0
		
1210: Do While dblNbrePers > 0
1215: If dblNbrePers >= 2 Then
1220: dblTotalHebergement = dblTotalHebergement + (dblJoursHebergement * dblHebergement2)
				
1225: dblNbrePers = dblNbrePers - 2
1230: Else
1235: dblTotalHebergement = dblTotalHebergement + (dblJoursHebergement * dblHebergement1)
				
1240: dblNbrePers = dblNbrePers - 1
1245: End If
1250: Loop 
		
1255: rstProjSoum.Fields("TotalHebergement").Value = dblTotalHebergement
		
1260: If bAjoutCommande = True Then
1265: rstProjSoum.Fields("ProchaineCommande").Value = 1
1270: End If
		
1275: If m_eType = enumType.TYPE_PROJET Then
1280: rstProjSoum.Fields("PrixRéception").Value = txtPrixReception.Text
1285: End If
		
		'Total des temps
1290: rstProjSoum.Fields("Total_Temps").Value = txtTotalTemps.Text
		
1295: rstPiece = New ADODB.Recordset
		
1300: If m_eType = enumType.TYPE_PROJET Then
1305: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
1310: Else
1315: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
1320: End If
		
1325: If m_eType = enumType.TYPE_PROJET Then
1330: If g_bModificationFacturation = True Then
1335: Call EnregistrerFACT(sNoProjSoum)
1340: End If
1345: End If
		
		'Enregistrement des pièces
1350: For iCompteur = 1 To lvwSoumission.Items.Count
1355: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
1360: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
1365: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmPiece = lvwSoumission.Items.Item(iCompteur)
					
1370: Call rstPiece.AddNew()
					
1375: If m_eType = enumType.TYPE_PROJET Then
1380: rstPiece.Fields("IDProjet").Value = sNoProjSoum
1385: Else
1390: rstPiece.Fields("IDSoumission").Value = sNoProjSoum
1395: End If
					
1400: rstPiece.Fields("Type").Value = "M"
					
1405: If itmPiece.Checked = True Then
1410: rstPiece.Fields("Visible").Value = True
1415: Else
1420: rstPiece.Fields("Visible").Value = False
1425: End If
					
1430: If m_eType = enumType.TYPE_PROJET Then
1435: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("Facturation").Value = itmPiece.SubItems(I_COL_SOUM_FACTURATION).Text
						
1440: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_FACTURATION).Text = "" Then
1445: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmPiece.SubItems(I_COL_SOUM_FACTURATION).Text = " "
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1450: End If
						
1455: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = "" Then
1460: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmPiece.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1465: End If
						
1470: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("NoRetour").Value = itmPiece.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag
1475: End If
					
1480: 'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rstPiece.Fields("IDSection").Value = itmPiece.Tag
1485: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("NumItem").Value = itmPiece.SubItems(I_COL_SOUM_PIECE).Text
1490: rstPiece.Fields("Qté").Value = Replace(itmPiece.Text, "*", "")
					
1495: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or itmPiece.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
1500: rstPiece.Fields("DESC_EN").Value = ""
1505: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("DESC_FR").Value = itmPiece.SubItems(I_COL_SOUM_DESCR).Text
1510: Else
1515: If m_eLangage = enumLangage.ANGLAIS Then
1520: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("DESC_EN").Value = itmPiece.SubItems(I_COL_SOUM_DESCR).Text
1525: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							rstPiece.Fields("DESC_FR").Value = itmPiece.SubItems.Item(I_COL_SOUM_DESCR).Tag
1530: Else
1535: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("DESC_FR").Value = itmPiece.SubItems(I_COL_SOUM_DESCR).Text
1540: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							rstPiece.Fields("DESC_EN").Value = itmPiece.SubItems.Item(I_COL_SOUM_DESCR).Tag
1545: End If
1550: End If
					
1555: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Manufact").Value = itmPiece.SubItems(I_COL_SOUM_MANUFACT).Text
1560: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
					
1565: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(itmPiece.SubItems(I_COL_SOUM_ESCOMPTE).Text) <> "" Then
1570: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("Escompte").Value = Conversion_Renamed(CDbl(Replace(itmPiece.SubItems(I_COL_SOUM_ESCOMPTE).Text, "%", "")) / 100, ModuleMain.enumConvert.MODE_PAS_FORMAT)
1575: Else
1580: rstPiece.Fields("Escompte").Value = ""
1585: End If
					
1590: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
					
1595: If m_eType = enumType.TYPE_PROJET Then
1600: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("DateRéception").Value = itmPiece.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
1605: End If
					
1610: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rstPiece.Fields("OrdreSection").Value = itmPiece.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
1615: rstPiece.Fields("NuméroLigne").Value = iCompteur
					
1620: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ORANGE Then
1625: rstPiece.Fields("Commandé").Value = True
1630: Else
1635: rstPiece.Fields("Commandé").Value = False
1640: End If
					
1645: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_GRIS Then
1650: rstPiece.Fields("Recu").Value = True
1655: Else
1660: rstPiece.Fields("Recu").Value = False
1665: End If
					
1670: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ROUGE Then
1675: rstPiece.Fields("Retour").Value = True
1680: Else
1685: rstPiece.Fields("Retour").Value = False
1690: End If
					
1695: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_VERT_FORET And itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Font.Bold = True Then
1700: rstPiece.Fields("CommandeAnnulée").Value = True
1705: Else
1710: rstPiece.Fields("CommandeAnnulée").Value = False
1715: End If
					
1720: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
1725: rstPiece.Fields("MatérielInutile").Value = True
1730: Else
1735: rstPiece.Fields("MatérielInutile").Value = False
1740: End If
					
1745: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(itmPiece.SubItems(I_COL_SOUM_DISTRIB).Text) <> vbNullString Then
1750: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("IDFRS").Value = CShort(itmPiece.SubItems.Item(I_COL_SOUM_DISTRIB).Tag)
1755: Else
1760: rstPiece.Fields("IDFRS").Value = 0
1765: End If
					
1770: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
1775: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
					
1780: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Len(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Tag) <= 50 Then
1785: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("SousSection").Value = itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Tag
1790: Else
1795: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("SousSection").Value = VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Tag, 50)
1800: End If
					
1805: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
1810: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("PrixOrigine").Value = itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
1815: Else
1820: rstPiece.Fields("PrixOrigine").Value = "0"
1825: End If
					
1830: If InStr(1, itmPiece.Text, "*") > 0 Then
1835: rstPiece.Fields("Quoté").Value = True
1840: Else
1845: rstPiece.Fields("Quoté").Value = False
1850: End If
					
1855: If m_eType = enumType.TYPE_PROJET Then
1860: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ROSE Then
1865: rstPiece.Fields("PieceExtraNonChargeable").Value = True
1870: rstPiece.Fields("PieceExtraChargeable").Value = False
1875: Else
1880: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BLEU Then
1885: rstPiece.Fields("PieceExtraChargeable").Value = True
1890: rstPiece.Fields("PieceExtraNonChargeable").Value = False
1895: Else
1900: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 6) = "RETOUR" Or VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 10) = "ANNULATION" Then
1905: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									sExtra = VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2)
									
1910: If sExtra >= "80" And sExtra <= "98" Then
1915: rstPiece.Fields("PieceExtraNonChargeable").Value = True
1920: rstPiece.Fields("PieceExtraChargeable").Value = False
1925: Else
1930: rstPiece.Fields("PieceExtraChargeable").Value = True
1935: rstPiece.Fields("PieceExtraNonChargeable").Value = False
1940: End If
1945: End If
1950: End If
1955: End If
						
1960: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_PROVENANCE).Text <> "" Then
1965: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("Provenance").Value = VB.Right(itmPiece.SubItems(I_COL_SOUM_PROVENANCE).Text, 2)
1970: Else
1975: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 6) = "RETOUR" Or VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 10) = "ANNULATION" Then
1980: rstPiece.Fields("Provenance").Value = sExtra
1985: End If
1990: End If
						
1995: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("DateCommande").Value = itmPiece.SubItems(I_COL_SOUM_DATE_COMMANDE).Text
2000: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("DateRequise").Value = itmPiece.SubItems(I_COL_SOUM_DATE_REQUISE).Text
						
2005: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_DATE_REQUISE).Text = "" Then
2010: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmPiece.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
2015: End If
						
2020: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("DateRetour").Value = itmPiece.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag
						
2025: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("NomCommande").Value = itmPiece.SubItems(I_COL_SOUM_NOM_COMMANDE).Text
						
2030: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("NoSéquentiel").Value = itmPiece.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text
2035: End If
					
2040: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Commentaire").Value = itmPiece.SubItems(I_COL_SOUM_COMMENTAIRE).Text
					
2045: Call rstPiece.Update()
					
2050: If m_eType = enumType.TYPE_PROJET Then
2055: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 80 Then
2060: Call AjouterPiecesExtraDansJob(itmPiece, rstProjSoum.Fields("LiaisonChargeable").Value)
2065: Else
2070: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 79 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 Then
2075: Call AjouterPiecesExtraChargeableDansJob(itmPiece, rstProjSoum.Fields("LiaisonChargeable").Value)
2080: Else
2085: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 6) = "RETOUR" Then
2090: Call AjouterInutileDansExtra(itmPiece, sExtra)
									
2095: bCalculExtra = True
									
2100: bExiste = False
									
2105: For iCompteurExtra = 1 To collExtra.Count()
2110: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Couldn't resolve default property of object collExtra(iCompteurExtra). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										If collExtra.Item(iCompteurExtra) = VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2) Then
2115: bExiste = True
											
2120: Exit For
2125: End If
2130: Next 
									
2135: If bExiste = False Then
2140: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										Call collExtra.Add(VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2))
2145: End If
2150: Else
2155: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 10) = "ANNULATION" Then
2160: Call AjouterAnnulationDansExtra(itmPiece, sExtra)
										
2165: bCalculExtra = True
										
2170: bExiste = False
										
2175: For iCompteurExtra = 1 To collExtra.Count()
2180: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											'UPGRADE_WARNING: Couldn't resolve default property of object collExtra(iCompteurExtra). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
											If collExtra.Item(iCompteurExtra) = VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2) Then
2185: bExiste = True
												
2190: Exit For
2195: End If
2200: Next 
										
2205: If bExiste = False Then
2210: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											Call collExtra.Add(VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2))
2215: End If
2220: End If
2225: End If
2230: End If
2235: End If
2240: End If
2245: End If
2250: End If
2255: Next 
		
2260: If m_eType = enumType.TYPE_PROJET Then
2265: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 Then
2270: Call CalculerTotalRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & rstProjSoum.Fields("LiaisonChargeable").Value)
2275: End If
2280: End If
		
2285: If bCalculExtra = True Then
2290: For iCompteurExtra = 1 To collExtra.Count()
2295: 'UPGRADE_WARNING: Couldn't resolve default property of object collExtra(iCompteurExtra). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call CalculerTotalRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & collExtra.Item(iCompteurExtra))
2300: Next 
2305: End If
		
2310: Call rstProjSoum.Update()
		
2315: Call rstProjSoum.Close()
2320: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
2325: Call rstPiece.Close()
2330: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
2335: If m_eType = enumType.TYPE_SOUMISSION Then
2340: Call AjouterSoumissionAuCumulatif()
2345: Else
2350: Call AjouterProjetAuCumulatif()
2355: End If
		
2360: Exit Sub
		
AfficherErreur: 
		
2365: Call AfficherErreur("frmProjSoumMec", "EnregistrerProjSoum", Err, Erl(), sNoProjSoum)
		
		'Si un erreur se produit dans l'enregistrement des pièces, il faut avertir
		'l'utilisateur de quelle pièce il s'agit et continuer avec un Resume Next
2370: If Erl() >= 1355 And Erl() <= 2250 Then
2375: rstSection = New ADODB.Recordset
			
2380: If m_eLangage = enumLangage.ANGLAIS Then
2385: Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
2390: If Not rstSection.EOF Then
2395: sSection = rstSection.Fields("NomSectionEN").Value
2400: Else
2405: 'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sSection = itmPiece.Tag
2410: End If
2415: Else
2420: Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
2425: If Not rstSection.EOF Then
2430: sSection = rstSection.Fields("NomSectionFR").Value
2435: Else
2440: 'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sSection = itmPiece.Tag
2445: End If
2450: End If
			
2455: Call rstSection.Close()
2460: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstSection = Nothing
			
2465: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call MsgBox("La pièce " & itmPiece.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs." & vbNewLine & "Il se peut qu'elle ne soit plus présente dans la liste.")
2470: End If
		
2475: Resume Next
	End Sub
	
	Private Sub AjouterPiecesExtraChargeableDansJob(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sLiaison As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
55: If Not rstProjet.EOF Then
			'Ouverture du recordset sur le projet original
60: rstPiece = New ADODB.Recordset
			
65: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
70: If Not rstPiece.EOF Then
75: Call rstPiece.MoveLast()
				
80: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
85: Else
90: iCompteur = 1
95: End If
			
100: Call rstPiece.AddNew()
			
105: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison
			
110: rstPiece.Fields("Type").Value = "M"
			
115: If itmSource.Checked = True Then
120: rstPiece.Fields("Visible").Value = True
125: Else
130: rstPiece.Fields("Visible").Value = False
135: End If
			
140: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Facturation").Value = itmSource.SubItems(I_COL_SOUM_FACTURATION).Text
			
145: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
150: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
155: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", vbNullString)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
165: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
180: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
185: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
190: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
195: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
200: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
205: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("IDFRS").Value = itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
210: End If
			
215: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
220: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
225: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
230: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
235: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
240: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 4)), ".", ",")
245: Else
250: rstPiece.Fields("PrixOrigine").Value = "0"
255: End If
260: Else
265: rstPiece.Fields("PrixOrigine").Value = "0"
270: End If
			
275: If InStr(1, itmSource.Text, "*") > 0 Then
280: rstPiece.Fields("Quoté").Value = True
285: Else
290: rstPiece.Fields("Quoté").Value = False
295: End If
			
300: rstPiece.Fields("PieceExtraChargeable").Value = True
305: rstPiece.Fields("Provenance").Value = VB.Right(txtNoProjSoum.Text, 2)
			
310: Call rstPiece.Update()
			
315: Call rstPiece.Close()
			
320: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
325: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
330: Do While Not rstPiece.EOF
335: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If rstPiece.Fields("PieceExtraChargeable").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
340: bSkip = True
345: Else
350: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
					
355: Call rstPiece.Update()
360: End If
				
365: Call rstPiece.MoveNext()
370: Loop 
			
375: Call rstPiece.Close()
380: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
385: End If
		
390: Call rstProjet.Close()
395: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
400: Exit Sub
		
AfficherErreur: 
		
405: Call AfficherErreur("frmProjSoumMec", "AjouterPiecesExtraDansJob", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub AjouterPiecesExtraDansJob(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sLiaison As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
50: If Not rstProjet.EOF Then
			'Ouverture du recordset
55: rstPiece = New ADODB.Recordset
			
60: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: If Not rstPiece.EOF Then
70: Call rstPiece.MoveLast()
				
75: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
80: Else
85: iCompteur = 1
90: End If
			
95: Call rstPiece.AddNew()
			
100: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison
			
105: rstPiece.Fields("Type").Value = "M"
			
110: If itmSource.Checked = True Then
115: rstPiece.Fields("Visible").Value = True
120: Else
125: rstPiece.Fields("Visible").Value = False
130: End If
			
135: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Facturation").Value = itmSource.SubItems(I_COL_SOUM_FACTURATION).Text
			
140: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
145: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
150: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", "")
155: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
165: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_List").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
180: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
185: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
190: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
195: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
200: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("IDFRS").Value = CShort(itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag)
205: End If
			
210: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
215: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
			
220: If Len(rstPiece.Fields("SousSection").Value) >= 255 Then
225: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
230: Else
235: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("SousSection").Value = VB.Left(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, 255)
240: End If
			
245: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
250: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
255: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 2)), ".", ",")
260: Else
265: rstPiece.Fields("PrixOrigine").Value = "0"
270: End If
275: Else
280: rstPiece.Fields("PrixOrigine").Value = "0"
285: End If
			
290: If InStr(1, itmSource.Text, "*") > 0 Then
295: rstPiece.Fields("Quoté").Value = True
300: Else
305: rstPiece.Fields("Quoté").Value = False
310: End If
			
315: rstPiece.Fields("PieceExtraNonChargeable").Value = True
320: rstPiece.Fields("Provenance").Value = VB.Right(txtNoProjSoum.Text, 2)
			
325: Call rstPiece.Update()
			
330: Call rstPiece.Close()
			
335: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
340: Do While Not rstPiece.EOF
345: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If rstPiece.Fields("PieceExtraNonChargeable").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
350: bSkip = True
355: Else
360: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
					
365: Call rstPiece.Update()
370: End If
				
375: Call rstPiece.MoveNext()
380: Loop 
			
385: Call rstPiece.Close()
390: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
395: End If
		
400: Call rstProjet.Close()
405: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
410: Exit Sub
		
AfficherErreur: 
		
415: Call AfficherErreur("frmProjSoumMec", "AjouterPiecesExtraDansJob", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionMec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub AjouterInutileDansExtra(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sExtra As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
50: If Not rstProjet.EOF Then
			'Ouverture du recordset sur le projet original
55: rstPiece = New ADODB.Recordset
			
60: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: If Not rstPiece.EOF Then
70: Call rstPiece.MoveLast()
				
75: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
80: Else
85: iCompteur = 1
90: End If
			
95: Call rstPiece.AddNew()
			
100: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra
			
105: rstPiece.Fields("Type").Value = "M"
			
110: If itmSource.Checked = True Then
115: rstPiece.Fields("Visible").Value = True
120: Else
125: rstPiece.Fields("Visible").Value = False
130: End If
			
135: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
140: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
145: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", vbNullString)
			
150: If m_eLangage = enumLangage.ANGLAIS Then
155: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
165: Else
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
180: End If
			
185: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
190: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
195: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
200: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
			
205: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
210: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
215: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If System.Drawing.ColorTranslator.ToOle(itmSource.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Then
220: rstPiece.Fields("MatérielInutile").Value = False
225: Else
230: rstPiece.Fields("MatérielInutile").Value = True
235: End If
			
240: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
245: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("IDFRS").Value = itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
250: End If
			
255: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
260: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
265: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
270: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
275: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
280: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 4)), ".", ",")
285: Else
290: rstPiece.Fields("PrixOrigine").Value = "0"
295: End If
300: Else
305: rstPiece.Fields("PrixOrigine").Value = "0"
310: End If
			
315: If InStr(1, itmSource.Text, "*") > 0 Then
320: rstPiece.Fields("Quoté").Value = True
325: Else
330: rstPiece.Fields("Quoté").Value = False
335: End If
			
340: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("DateRetour").Value = itmSource.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag
			
345: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Commentaire").Value = itmSource.SubItems(I_COL_SOUM_COMMENTAIRE).Text
			
350: Call rstPiece.Update()
			
355: Call rstPiece.Close()
			
360: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
365: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
370: Do While Not rstPiece.EOF
375: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(itmSource.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
380: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If rstPiece.Fields("MatérielInutile").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
385: bSkip = True
390: Else
395: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
						
400: Call rstPiece.Update()
405: End If
410: Else
415: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If rstPiece.Fields("MatérielInutile").Value = False And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
420: bSkip = True
425: Else
430: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
						
435: Call rstPiece.Update()
440: End If
445: End If
				
450: Call rstPiece.MoveNext()
455: Loop 
			
460: Call rstPiece.Close()
465: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
470: End If
		
475: Call rstProjet.Close()
480: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
485: Exit Sub
		
AfficherErreur: 
		
490: Call AfficherErreur("frmProjSoumMec", "AjouterInutileDansExtra", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & VB.Right("0" & CDbl(VB.Right(txtNoProjSoum.Text, 2)) + 80, 2) & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub AjouterAnnulationDansExtra(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sExtra As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
50: If Not rstProjet.EOF Then
			'Ouverture du recordset sur le projet original
55: rstPiece = New ADODB.Recordset
			
60: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: If Not rstPiece.EOF Then
70: Call rstPiece.MoveLast()
				
75: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
80: Else
85: iCompteur = 1
90: End If
			
95: Call rstPiece.AddNew()
			
100: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra
			
105: rstPiece.Fields("Type").Value = "M"
			
110: If itmSource.Checked = True Then
115: rstPiece.Fields("Visible").Value = True
120: Else
125: rstPiece.Fields("Visible").Value = False
130: End If
			
135: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
140: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
145: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", vbNullString)
			
150: If m_eLangage = enumLangage.ANGLAIS Then
155: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
165: Else
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
180: End If
			
185: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
190: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
195: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
200: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
			
205: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
210: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
215: rstPiece.Fields("CommandeAnnulée").Value = True
			
220: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
225: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("IDFRS").Value = itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
230: End If
			
235: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
240: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
245: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
250: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
255: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
260: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 2)), ".", ",")
265: Else
270: rstPiece.Fields("PrixOrigine").Value = "0"
275: End If
280: Else
285: rstPiece.Fields("PrixOrigine").Value = "0"
290: End If
			
295: If InStr(1, itmSource.Text, "*") > 0 Then
300: rstPiece.Fields("Quoté").Value = True
305: Else
310: rstPiece.Fields("Quoté").Value = False
315: End If
			
320: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Commentaire").Value = itmSource.SubItems(I_COL_SOUM_COMMENTAIRE).Text
			
325: Call rstPiece.Update()
			
330: Call rstPiece.Close()
			
335: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
340: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
345: Do While Not rstPiece.EOF
350: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If rstPiece.Fields("CommandeAnnulée").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
355: bSkip = True
360: Else
365: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
					
370: Call rstPiece.Update()
375: End If
				
380: Call rstPiece.MoveNext()
385: Loop 
			
390: Call rstPiece.Close()
395: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
400: End If
		
405: Call rstProjet.Close()
410: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
415: Exit Sub
		
AfficherErreur: 
		
420: Call AfficherErreur("frmProjSoumMec", "AjouterAnnulationDansExtra", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & VB.Right("0" & CDbl(VB.Right(txtNoProjSoum.Text, 2)) + 80, 2) & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub Cmdfermer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles Cmdfermer.Click
		
5: On Error GoTo AfficherErreur
		
		'Fermeture de la fenêtre
10: m_bResize = False
		
15: Call Me.Close()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "cmdFermer_Click", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewModifications()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le lvwHistorique
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim rstCreation As ADODB.Recordset
25: Dim sChamps As String
30: Dim sTable As String
35: Dim sTableCreer As String
40: Dim itmModif As System.Windows.Forms.ListViewItem
		
		'Il faut le vider avant de le remplir
45: Call lvwHistorique.Items.Clear()
		
50: If m_eType = enumType.TYPE_PROJET Then
55: sChamps = "IDProjet"
60: sTable = "GRB_Projet_Modif"
65: sTableCreer = "GRB_ProjetMec"
70: Else
75: sChamps = "IDSoumission"
80: sTable = "GRB_Soumission_Modif"
85: sTableCreer = "GRB_SoumissionMec"
90: End If
		
		'Ouverture du recordset selon le type
95: rstEmploye = New ADODB.Recordset
100: rstCreation = New ADODB.Recordset
		
105: Call rstCreation.Open("SELECT creer , creer_par FROM " & sTableCreer & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Ajout de la section "Création"
110: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		itmModif = lvwHistorique.Items.Add()
		
115: itmModif.Text = "Création"
		
120: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
		
		'Ajout du nom de celui qui l'a créé
125: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		itmModif = lvwHistorique.Items.Add()
		
130: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstCreation.Fields("creer_par").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
135: itmModif.Text = rstEmploye.Fields("Employe").Value
		
140: Call rstEmploye.Close()
		
		'Date
145: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
			itmModif.SubItems(I_COL_MODIF_DATE).Text = rstCreation.Fields("Creer").Value
		Else
			itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstCreation.Fields("Creer").Value))
		End If
		
150: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
			itmModif.SubItems(I_COL_MODIF_HEURE).Text = vbNullString
		Else
			itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
		End If
		
155: Call rstCreation.Close()
160: 'UPGRADE_NOTE: Object rstCreation may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstCreation = Nothing
		
165: rstProjSoum = New ADODB.Recordset
		
170: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'M' And TypeModif = 'MODIFICATION' ORDER BY Date, Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
175: If Not rstProjSoum.EOF Then
			'Ajout de la section "Modifications"
180: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
185: itmModif.Text = "Modifications"
			
190: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
195: Do While Not rstProjSoum.EOF
				'Ajout des modifications
200: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
205: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Employé
210: itmModif.Text = rstEmploye.Fields("Employe").Value
				
215: Call rstEmploye.Close()
				
				'Date
220: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
225: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
230: Call rstProjSoum.MoveNext()
235: Loop 
240: End If
		
245: Call rstProjSoum.Close()
		
250: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'M' AND TypeModif = 'RECEPTION' ORDER BY Date, Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
255: If Not rstProjSoum.EOF Then
			'Ajout de la section "Réception"
260: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
265: itmModif.Text = "Réception"
			
270: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
275: Do While Not rstProjSoum.EOF
				'Ajout des modifications
280: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
285: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Employé
290: itmModif.Text = rstEmploye.Fields("Employe").Value
				
295: Call rstEmploye.Close()
				
				'Date
300: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
305: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
310: Call rstProjSoum.MoveNext()
315: Loop 
320: End If
		
325: Call rstProjSoum.Close()
		
330: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'M' AND TypeModif = 'RETOUR' ORDER BY Date, Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
335: If Not rstProjSoum.EOF Then
			'Ajout de la section "Retour de marchandise"
340: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
345: itmModif.Text = "Retour de marchandise"
			
350: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
355: Do While Not rstProjSoum.EOF
				'Ajout des retour de marchandise
360: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
365: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				'Employé
370: itmModif.Text = rstEmploye.Fields("Employe").Value
				
375: Call rstEmploye.Close()
				
				'Date
380: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
385: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
390: Call rstProjSoum.MoveNext()
395: Loop 
400: End If
		
405: Call rstProjSoum.Close()
		
410: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'M' AND TypeModif = 'FACTURATION' ORDER BY Date, Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
415: If Not rstProjSoum.EOF Then
			'Ajout de la section "Facturation"
420: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
425: itmModif.Text = "Facturation"
			
430: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
435: Do While Not rstProjSoum.EOF
				'Ajout des modifications
440: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
445: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Employé
450: itmModif.Text = rstEmploye.Fields("Employe").Value
				
455: Call rstEmploye.Close()
				
				'Date
460: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
465: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
				'Montant
470: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_MONTANT Then
					itmModif.SubItems(I_COL_MODIF_MONTANT).Text = rstProjSoum.Fields("Valeur").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_MONTANT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Valeur").Value))
				End If
				
475: Call rstProjSoum.MoveNext()
480: Loop 
485: End If
		
490: Call rstProjSoum.Close()
495: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
500: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
505: Exit Sub
		
AfficherErreur: 
		
510: Call AfficherErreur("frmProjSoumMec", "RemplirListViewModifications", Err, Erl())
	End Sub
	
	Private Sub Cmdajouter_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles Cmdajouter.Click
		
5: On Error GoTo AfficherErreur
		
		'Ajoute une soumission
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sNumero As String
20: Dim sNoProjet As String
25: Dim bExiste As Boolean
30: Dim bProjet As Boolean
35: Dim bContinuer As Boolean
40: Dim bNoValide As Boolean
		
		'Affiche le message de saisie selon le type
45: If m_eType = enumType.TYPE_PROJET Then
50: sNumero = InputBox("Veuillez entrer le numéro du projet")
55: Else
60: If MsgBox("Voulez-vous créer une nouvelle soumission?" & vbNewLine & "Oui - Nouvelle soumission" & vbNewLine & "Non - Copie d'un projet dans une soumission", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
65: sNumero = InputBox("Veuillez entrer le numéro de la soumission")
70: Else
75: sNumero = InputBox("Veuillez entrer le numéro de la soumission")
				
80: sNoProjet = InputBox("À partir de quel projet voulez-vous créer cette soumission?")
				
85: bProjet = True
90: End If
95: End If
		
100: If bProjet = True Then
105: If sNumero <> vbNullString And sNoProjet <> vbNullString Then
110: bContinuer = True
115: End If
120: Else
125: If sNumero <> vbNullString Then
130: bContinuer = True
135: End If
140: End If
		
145: If bContinuer = True Then
150: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
			
155: bNoValide = True
			
160: If ValiderFormatNumeroProjSoum(sNumero) = False Then
165: bNoValide = False
170: End If
			
175: If bNoValide = True Then
180: If ValiderFormatMecanique(sNumero) = False Then
185: bNoValide = False
190: End If
195: End If
			
200: If bNoValide = True Then
205: If m_eType = enumType.TYPE_PROJET Then
210: If ValiderFormatJobSansSoum(sNumero) = False Then
215: bNoValide = False
220: End If
225: Else
230: If ValiderFormatSoumission(sNumero) = False Then
235: bNoValide = False
240: End If
245: End If
250: End If
			
255: If bNoValide = False Then
260: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
265: Exit Sub
270: End If
			
275: sNumero = UCase(sNumero)
			
280: rstProjSoum = New ADODB.Recordset
			
			'Ouvre le recordset selon le type
285: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
290: If rstProjSoum.EOF Then
295: bExiste = False
300: Else
305: bExiste = True
				
310: Call MsgBox("Le numéro " & sNumero & " existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
315: End If
			
320: Call rstProjSoum.Close()
			
325: If bExiste = False Then
330: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
335: If rstProjSoum.EOF Then
340: bExiste = False
345: Else
350: bExiste = True
					
355: Call MsgBox("Le numéro " & sNumero & " existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
360: End If
				
365: Call rstProjSoum.Close()
370: End If
			
375: If bExiste = False Then
380: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
385: If rstProjSoum.EOF Then
390: bExiste = False
395: Else
400: bExiste = True
					
405: Call MsgBox("Le numéro " & sNumero & " existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
410: End If
				
415: Call rstProjSoum.Close()
420: End If
			
425: If bExiste = False Then
430: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
435: If rstProjSoum.EOF Then
440: bExiste = False
445: Else
450: bExiste = True
					
455: Call MsgBox("Le numéro " & sNumero & " existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
460: End If
				
465: Call rstProjSoum.Close()
470: End If
			
			'Si le projet ou la soumission n'existe pas
475: If bExiste = False Then
				'Pour pouvoir réafficher l'élément affiché avant l'ajout au cas où la personne
				'annule l'ajout
480: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
485: If rstProjSoum.EOF = False Then
490: If rstProjSoum.Fields("Ouvert").Value = False Then
495: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
						
500: Call rstProjSoum.Close()
505: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
510: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
515: Exit Sub
520: End If
525: End If
				
530: Call rstProjSoum.Close()
535: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
540: If bProjet = False Then
545: Call InitialiserTempsTaux(True)
					
550: Call InitialiserNouveauxTaux()
					
555: m_sAncienProjSoum = txtNoProjSoum.Text
					
					'Affiche le nouveau numéro
560: txtNoProjSoum.Text = sNumero
					
565: Call InitialiserVariables(sNumero)
					
					'Débarre les champs
570: Call BarrerChamps(False)
					
					'Vide les champs
575: Call ViderChamps()
580: Else
585: If VerifierProjet(sNoProjet) = True Then
						'Vide les champs
590: Call ViderChamps()
						
595: txtNoProjSoum.Text = sNumero
						
600: Call RemplirSoumissionProjet(sNumero, sNoProjet)
605: Else
610: Call MsgBox("Le projet " & sNoProjet & " n'existe pas!", MsgBoxStyle.OKOnly, "Erreur")
						
615: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
620: Exit Sub
625: End If
630: End If
				
				'Vide la valeur par défaut si demande sous-section
635: m_sSousSection = vbNullString
				
640: m_bModeAjout = True
645: m_bModeAffichage = False
				
650: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
655: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
				
				'Met le form en mode ajout/modif
660: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
665: End If
670: End If
		
675: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
680: Exit Sub
		
AfficherErreur: 
		
685: Call AfficherErreur("frmProjSoumMec", "cmdAjouter_Click", Err, Erl())
	End Sub
	
	Private Function VerifierProjet(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjet As ADODB.Recordset
15: Dim bExiste As Boolean
		
20: rstProjet = New ADODB.Recordset
		
25: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
30: If Not rstProjet.EOF Then
35: bExiste = True
40: Else
45: bExiste = False
50: End If
		
55: Call rstProjet.Close()
60: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
65: VerifierProjet = bExiste
		
70: Exit Function
		
AfficherErreur: 
		
75: Call AfficherErreur("frmProjSoumMec", "VerifierProjet", Err, Erl())
	End Function
	
	Private Sub RemplirSoumissionProjet(ByVal sNoSoumission As String, ByVal sNoProjet As String)
		
5: On Error GoTo AfficherErreur
		
		'Affiche le projet ou la soumission choisie
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim bVariables As Boolean
25: Dim bTauxHoraire As Boolean
30: Dim bPrixPieces As Boolean
		
35: rstProjSoum = New ADODB.Recordset
40: rstConfig = New ADODB.Recordset
		
45: If MsgBox("Voulez-vous mettre à jour les variables systèmes?" & vbNewLine & "-  % Profit" & vbNewLine & "-  % Commission" & vbNewLine & "-  % Imprévu", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
50: bVariables = True
55: Else
60: bVariables = False
65: End If
		
70: If MsgBox("Voulez-vous mettre à jour les taux horaires?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
75: bTauxHoraire = True
80: Else
85: bTauxHoraire = False
90: End If
		
95: If MsgBox("Voulez-vous mettre à jour le prix des pièces?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
100: bPrixPieces = True
105: Else
110: bPrixPieces = False
115: End If
		
120: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
125: If rstProjSoum.Fields("TempsProjBarré").Value = False Then
130: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessinProj").Value) Then
135: m_sTempsDessin = rstProjSoum.Fields("TempsDessinProj").Value
140: Else
145: m_sTempsDessin = "0"
150: End If
			
155: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupeProj").Value) Then
160: m_sTempsCoupe = rstProjSoum.Fields("TempsCoupeProj").Value
165: Else
170: m_sTempsCoupe = "0"
175: End If
			
180: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinageProj").Value) Then
185: m_sTempsMachinage = rstProjSoum.Fields("TempsMachinageProj").Value
190: Else
195: m_sTempsMachinage = "0"
200: End If
			
205: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudureProj").Value) Then
210: m_sTempsSoudure = rstProjSoum.Fields("TempsSoudureProj").Value
215: Else
220: m_sTempsSoudure = "0"
225: End If
			
230: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
235: m_sTempsAssemblage = rstProjSoum.Fields("TempsAssemblageProj").Value
240: Else
245: m_sTempsAssemblage = "0"
250: End If
			
255: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeintureProj").Value) Then
260: m_sTempsPeinture = rstProjSoum.Fields("TempsPeintureProj").Value
265: Else
270: m_sTempsPeinture = "0"
275: End If
			
280: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTestProj").Value) Then
285: m_sTempsTest = rstProjSoum.Fields("TempsTestProj").Value
290: Else
295: m_sTempsTest = "0"
300: End If
			
305: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallationProj").Value) Then
310: m_sTempsInstallation = rstProjSoum.Fields("TempsInstallationProj").Value
315: Else
320: m_sTempsInstallation = "0"
325: End If
			
330: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormationProj").Value) Then
335: m_sTempsFormation = rstProjSoum.Fields("TempsFormationProj").Value
340: Else
345: m_sTempsFormation = "0"
350: End If
			
355: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestionProj").Value) Then
360: m_sTempsGestion = rstProjSoum.Fields("TempsGestionProj").Value
365: Else
370: m_sTempsGestion = "0"
375: End If
			
380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShippingProj").Value) Then
385: m_sTempsShipping = rstProjSoum.Fields("TempsShippingProj").Value
390: Else
395: m_sTempsShipping = "0"
400: End If
405: Else
410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessinConc").Value) Then
415: m_sTempsDessin = rstProjSoum.Fields("TempsDessinConc").Value
420: Else
425: m_sTempsDessin = "0"
430: End If
			
435: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupeConc").Value) Then
440: m_sTempsCoupe = rstProjSoum.Fields("TempsCoupeConc").Value
445: Else
450: m_sTempsCoupe = "0"
455: End If
			
460: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinageConc").Value) Then
465: m_sTempsMachinage = rstProjSoum.Fields("TempsMachinageConc").Value
470: Else
475: m_sTempsMachinage = "0"
480: End If
			
485: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudureConc").Value) Then
490: m_sTempsSoudure = rstProjSoum.Fields("TempsSoudureConc").Value
495: Else
500: m_sTempsSoudure = "0"
505: End If
			
510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
515: m_sTempsAssemblage = rstProjSoum.Fields("TempsAssemblageConc").Value
520: Else
525: m_sTempsAssemblage = "0"
530: End If
			
535: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeintureConc").Value) Then
540: m_sTempsPeinture = rstProjSoum.Fields("TempsPeintureConc").Value
545: Else
550: m_sTempsPeinture = "0"
555: End If
			
560: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTestConc").Value) Then
565: m_sTempsTest = rstProjSoum.Fields("TempsTestConc").Value
570: Else
575: m_sTempsTest = "0"
580: End If
			
585: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallationConc").Value) Then
590: m_sTempsInstallation = rstProjSoum.Fields("TempsInstallationConc").Value
595: Else
600: m_sTempsInstallation = "0"
605: End If
			
610: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormationConc").Value) Then
615: m_sTempsFormation = rstProjSoum.Fields("TempsFormationConc").Value
620: Else
625: m_sTempsFormation = "0"
630: End If
			
635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestionConc").Value) Then
640: m_sTempsGestion = rstProjSoum.Fields("TempsGestionConc").Value
645: Else
650: m_sTempsGestion = "0"
655: End If
			
660: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShippingConc").Value) Then
665: m_sTempsShipping = rstProjSoum.Fields("TempsShippingConc").Value
670: Else
675: m_sTempsShipping = "0"
680: End If
685: End If
		
690: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
695: m_sNbrePersonne = rstProjSoum.Fields("NbrePersonne").Value
700: Else
705: m_sNbrePersonne = "0"
710: End If
		
720: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
725: m_sTempsHebergement = rstProjSoum.Fields("TempsHebergement").Value
730: Else
735: m_sTempsHebergement = "0"
740: End If
		
745: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
750: m_sTempsRepas = rstProjSoum.Fields("TempsRepas").Value
755: Else
760: m_sTempsRepas = "0"
765: End If
		
770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
775: m_sTempsTransport = rstProjSoum.Fields("TempsTransport").Value
780: Else
785: m_sTempsTransport = "0"
790: End If
		
795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
800: m_sTempsUniteMobile = rstProjSoum.Fields("TempsUniteMobile").Value
805: Else
810: m_sTempsUniteMobile = "0"
815: End If
		
820: m_sPrixEmballage = rstProjSoum.Fields("PrixEmballage").Value
		
825: Call rstConfig.Open("SELECT * FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
830: If bTauxHoraire = True Then
835: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxDessinMec").Value) Then
840: m_sTauxDessin = rstConfig.Fields("TauxDessinMec").Value
845: Else
850: m_sTauxDessin = "0"
855: End If
			
860: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxCoupe").Value) Then
865: m_sTauxCoupe = rstConfig.Fields("TauxCoupe").Value
870: Else
875: m_sTauxCoupe = "0"
880: End If
			
885: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxMachinage").Value) Then
890: m_sTauxMachinage = rstConfig.Fields("TauxMachinage").Value
895: Else
900: m_sTauxMachinage = "0"
905: End If
			
910: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxSoudure").Value) Then
915: m_sTauxSoudure = rstConfig.Fields("TauxSoudure").Value
920: Else
925: m_sTauxSoudure = "0"
930: End If
			
935: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxAssemblageMec").Value) Then
940: m_sTauxAssemblage = rstConfig.Fields("TauxAssemblageMec").Value
945: Else
950: m_sTauxAssemblage = "0"
955: End If
			
960: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxPeinture").Value) Then
965: m_sTauxPeinture = rstConfig.Fields("TauxPeinture").Value
970: Else
975: m_sTauxPeinture = "0"
980: End If
			
985: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxTestMec").Value) Then
990: m_sTauxTest = rstConfig.Fields("TauxTestMec").Value
995: Else
1000: m_sTauxTest = "0"
1005: End If
			
1010: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxInstallationMec").Value) Then
1015: m_sTauxInstallation = rstConfig.Fields("TauxInstallationMec").Value
1020: Else
1025: m_sTauxInstallation = "0"
1030: End If
			
1035: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxFormationMec").Value) Then
1040: m_sTauxFormation = rstConfig.Fields("TauxFormationMec").Value
1045: Else
1050: m_sTauxFormation = "0"
1055: End If
			
1060: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxGestionProjetsMec").Value) Then
1065: m_sTauxGestion = rstConfig.Fields("TauxGestionProjetsMec").Value
1070: Else
1075: m_sTauxGestion = "0"
1080: End If
			
1085: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxShippingMec").Value) Then
1090: m_sTauxShipping = rstConfig.Fields("TauxShippingMec").Value
1095: Else
1100: m_sTauxShipping = "0"
1105: End If
			
1110: m_sTauxHebergement1 = rstConfig.Fields("Hebergement1").Value
1115: m_sTauxHebergement2 = rstConfig.Fields("Hebergement2").Value
1120: m_sTauxRepas = rstConfig.Fields("Repas").Value
1125: m_sTauxTransport = rstConfig.Fields("Standard").Value
1130: m_sTauxUniteMobile = rstConfig.Fields("UniteMobile").Value
1135: Else
1140: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
1145: m_sTauxDessin = rstProjSoum.Fields("TauxDessin").Value
1150: Else
1155: m_sTauxDessin = "0"
1160: End If
			
1165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
1170: m_sTauxCoupe = rstProjSoum.Fields("TauxCoupe").Value
1175: Else
1180: m_sTauxCoupe = "0"
1185: End If
			
1190: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
1195: m_sTauxMachinage = rstProjSoum.Fields("TauxMachinage").Value
1200: Else
1205: m_sTauxMachinage = "0"
1210: End If
			
1215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
1220: m_sTauxSoudure = rstProjSoum.Fields("TauxSoudure").Value
1225: Else
1230: m_sTauxSoudure = "0"
1235: End If
			
1240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
1245: m_sTauxAssemblage = rstProjSoum.Fields("TauxAssemblage").Value
1250: Else
1255: m_sTauxAssemblage = "0"
1260: End If
			
1265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
1270: m_sTauxPeinture = rstProjSoum.Fields("TauxPeinture").Value
1275: Else
1280: m_sTauxPeinture = "0"
1285: End If
			
1290: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
1295: m_sTauxTest = rstProjSoum.Fields("TauxTest").Value
1300: Else
1305: m_sTauxTest = "0"
1310: End If
			
1315: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
1320: m_sTauxInstallation = rstProjSoum.Fields("TauxInstallation").Value
1325: Else
1330: m_sTauxInstallation = "0"
1335: End If
			
1340: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
1345: m_sTauxFormation = rstProjSoum.Fields("TauxFormation").Value
1350: Else
1355: m_sTauxFormation = "0"
1360: End If
			
1365: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
1370: m_sTauxGestion = rstProjSoum.Fields("TauxGestion").Value
1375: Else
1380: m_sTauxGestion = "0"
1385: End If
			
1390: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1395: m_sTauxShipping = rstProjSoum.Fields("TauxShipping").Value
1400: Else
1405: m_sTauxShipping = "0"
1410: End If
			
1415: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
1420: m_sTauxHebergement1 = rstProjSoum.Fields("TauxHebergement1").Value
1425: Else
1430: m_sTauxHebergement1 = "0"
1435: End If
			
1440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
1445: m_sTauxHebergement2 = rstProjSoum.Fields("TauxHebergement2").Value
1450: Else
1455: m_sTauxHebergement2 = "0"
1460: End If
			
1465: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
1470: m_sTauxRepas = rstProjSoum.Fields("TauxRepas").Value
1475: Else
1480: m_sTauxRepas = "0"
1485: End If
			
1490: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
1495: m_sTauxTransport = rstProjSoum.Fields("TauxTransport").Value
1500: Else
1505: m_sTauxTransport = "0"
1510: End If
			
1515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
1520: m_sTauxUniteMobile = rstProjSoum.Fields("TauxUniteMobile").Value
1525: Else
1530: m_sTauxUniteMobile = "0"
1535: End If
1540: End If
		
1545: If bVariables = True Then
1550: m_sProfit = rstConfig.Fields("ProfitMec").Value
1555: m_sCommission = rstConfig.Fields("Commission").Value
1560: m_sImprevue = rstConfig.Fields("Imprévus").Value
1565: Else
1570: m_sProfit = rstProjSoum.Fields("Profit").Value
1575: m_sCommission = rstProjSoum.Fields("Commission").Value
1580: m_sImprevue = rstProjSoum.Fields("Imprevue").Value
1585: End If
		
1590: Call rstConfig.Close()
1595: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
1600: txtDescription.Text = rstProjSoum.Fields("Description").Value
1605: txtNbreManuel.Text = rstProjSoum.Fields("manuel").Value
1610: txtPrixManuel.Text = rstProjSoum.Fields("total_manuel").Value
		
1615: txtTotalPieces.Text = rstProjSoum.Fields("Total_Piece").Value
1620: txtTotalTemps.Text = rstProjSoum.Fields("Total_Temps").Value
1625: txtPrixTotal.Text = rstProjSoum.Fields("PrixTotal").Value
1630: txtImprevus.Text = rstProjSoum.Fields("Total_Imprevue").Value
1635: txtProfit.Text = rstProjSoum.Fields("total_profit").Value
1640: txtCommission.Text = rstProjSoum.Fields("total_commission").Value
		
1645: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("CheminPhotos").Value) Then
1650: txtCheminPhotos.Text = rstProjSoum.Fields("CheminPhotos").Value
1655: Else
1660: txtCheminPhotos.Text = vbNullString
1665: End If
		
1670: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("MontantForfait").Value) Then
1675: txtForfait.Text = rstProjSoum.Fields("MontantForfait").Value
			
1680: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("InitialeForfait").Value) Then
1685: lblForfaitInitiale.Text = rstProjSoum.Fields("InitialeForfait").Value
1690: Else
1695: lblForfaitInitiale.Text = ""
1700: End If
1705: Else
1710: txtForfait.Text = ""
1715: lblForfaitInitiale.Text = ""
1720: End If
		
1725: Call rstProjSoum.Close()
1730: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'Affiche les pieces de la soumission
1735: Call RemplirListViewSoumissionProjet(sNoProjet)
		
1740: If bPrixPieces = True Then
1745: Call UpdatePieces()
1750: End If
		
1755: m_bModeAffichage = False
		
1760: Call CalculerPrix()
		
1765: Exit Sub
		
AfficherErreur: 
		
1770: Call AfficherErreur("frmProjSoumMec", "RemplirSoumissionProjet", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewSoumissionProjet(ByVal sNoProjet As String)
		
5: On Error GoTo AfficherErreur
		
		'Remplis les pièces de la soumission avec la BD
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstSection As ADODB.Recordset
20: Dim rstFRS As ADODB.Recordset
25: Dim itmProjSoum As System.Windows.Forms.ListViewItem
30: Dim bPremierEnr As Boolean
35: Dim iOrdreSection As Short
40: Dim sSousSection As String
45: Dim sSection As String
50: Dim lColor As Integer
		
55: Call lvwSoumission.Items.Clear()
		
60: bPremierEnr = True
		
65: rstProjSoum = New ADODB.Recordset
		
70: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
75: If m_eLangage = enumLangage.ANGLAIS Then
80: sSection = "NomSectionEN"
85: Else
90: sSection = "NomSectionFR"
95: End If
		
100: rstSection = New ADODB.Recordset
105: rstFRS = New ADODB.Recordset
		
110: Do While Not rstProjSoum.EOF
115: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmProjSoum = lvwSoumission.Items.Add()
			
			'Si c'est le premier enregistrement, il faut ajouter la section et la sous-section
120: If bPremierEnr = True Then
125: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
130: sSousSection = rstProjSoum.Fields("SousSection").Value
				
				'Pour avoir le nom de la section
135: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajout du nom de la section
140: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSection.Fields(sSection).Value) Then
145: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
					End If
150: Else
155: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
160: End If
				
165: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
				
170: Call ValeurParDefaut(itmProjSoum)
				
175: Call rstSection.Close()
				
180: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
				'Ajout du nom de la sous-section
185: If sSousSection = S_PAS_SOUS_SECTION Then
190: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
195: Else
200: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
					End If
205: End If
				
				'Le tag ne peut pas être remplis si la colonne est vide
210: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
				
215: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
				
220: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
				
225: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
				
230: Call ValeurParDefaut(itmProjSoum)
				
235: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
240: bPremierEnr = False
245: Else
				'Si c'est pas le premier enregistrement, il faut vérifier avec l'ancienne section
250: If iOrdreSection <> rstProjSoum.Fields("OrdreSection").Value Then
255: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
					
260: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSection.Fields(sSection).Value) Then
270: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
						End If
275: Else
280: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
285: End If
					
290: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
					
295: Call ValeurParDefaut(itmProjSoum)
					
300: Call rstSection.Close()
					
305: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
					
310: sSousSection = rstProjSoum.Fields("SousSection").Value
					
315: If sSousSection = S_PAS_SOUS_SECTION Then
320: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
325: Else
330: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("SousSection").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("SousSection").Value))
						End If
335: End If
					
					'Le tag ne peut pas être remplis si la colonne est vide
340: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
						itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
					
345: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
					
350: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
					
355: Call ValeurParDefaut(itmProjSoum)
					
360: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
					
365: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
370: Else
					'il faut vérifier avec l'ancienne sous-section
375: If sSousSection <> rstProjSoum.Fields("SousSection").Value Then
380: sSousSection = rstProjSoum.Fields("SousSection").Value
						
385: If sSousSection = S_PAS_SOUS_SECTION Then
390: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
395: Else
400: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
							End If
405: End If
						
410: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
						
415: Call ValeurParDefaut(itmProjSoum)
						
420: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
						
						'Le tag ne peut pas être remplis si la colonne est vide
425: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
							itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
						
430: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
						
435: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						itmProjSoum = lvwSoumission.Items.Add()
440: End If
445: End If
450: End If
			
455: If rstProjSoum.Fields("IDFRS").Value = 0 And rstProjSoum.Fields("NumItem").Value <> "Texte" And rstProjSoum.Fields("NumItem").Value <> "Text" Then
460: lColor = COLOR_MAGENTA
465: Else
470: lColor = COLOR_NOIR
475: End If
			
			'On met l'ID de la section dans le tag
480: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
			
485: If rstProjSoum.Fields("Visible").Value = True Then
490: itmProjSoum.Checked = True
495: Else
500: itmProjSoum.Checked = False
505: End If
			
			'Quantité
510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Qté").Value) Then
515: itmProjSoum.Text = rstProjSoum.Fields("Qté").Value
520: Else
525: itmProjSoum.Text = vbNullString
530: End If
			
535: If rstProjSoum.Fields("Quoté").Value = True Then
540: itmProjSoum.Text = itmProjSoum.Text & "*"
545: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
550: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, True)
555: Else
560: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
565: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, False)
570: End If
			
			'Numéro d'item
575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("NumItem").Value) Then
580: If rstProjSoum.Fields("NumItem").Value = "Texte" Or rstProjSoum.Fields("NumItem").Value = "Text" Then
585: If m_eLangage = enumLangage.ANGLAIS Then
590: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Text"))
						End If
595: Else
600: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Texte"))
						End If
605: End If
610: Else
615: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstProjSoum.Fields("NumItem").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NumItem").Value))
					End If
620: End If
625: Else
630: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
					itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
635: End If
			
640: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom de la sous-section dans le tag du numéro d'item
645: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = rstProjSoum.Fields("SousSection").Value
			
650: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
655: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
				End If
660: Else
665: If m_eLangage = enumLangage.ANGLAIS Then
					'Description en anglais
670: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_EN").Value) Then
675: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_EN").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_EN").Value))
						End If
680: Else
685: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
690: End If
					
695: 'On met la description en francais dans le tag de la description en anglais
700: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
705: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("DESC_FR").Value
710: Else
715: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
720: End If
725: Else
					'Description en francais
730: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
735: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
						End If
740: Else
745: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
750: End If
					
					'On met la description en anglais dans le tag de la description en francais
755: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Desc_EN").Value) Then
760: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("Desc_EN").Value
765: Else
770: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
775: End If
780: End If
785: End If
			
790: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Fabricant
795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Manufact").Value) Then
800: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = rstProjSoum.Fields("Manufact").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Manufact").Value))
				End If
805: Else
810: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
815: End If
			
820: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met l'ordre de la section dans le tag du fabricant
825: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
			
			'Prix listé
830: If Trim(rstProjSoum.Fields("Prix_List").Value) <> vbNullString Then
835: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(rstProjSoum.Fields("Prix_list"), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Prix_list"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
840: Else
845: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
850: End If
			
855: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
860: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstProjSoum.Fields("PrixOrigine").Value
			
			'Escompte
865: If Trim(rstProjSoum.Fields("Escompte").Value) <> vbNullString Then
870: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)))
				End If
875: Else
880: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
885: End If
			
890: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix net
895: If Trim(rstProjSoum.Fields("Prix_net").Value) <> vbNullString Then
900: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstProjSoum.Fields("Prix_net"), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Prix_net"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
905: Else
910: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
915: End If
			
920: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Fournisseur
925: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDFRS").Value) And rstProjSoum.Fields("IDFRS").Value <> "0" Then
930: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
935: Call rstFRS.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstProjSoum.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
					'On affiche le nom dans la colonne
940: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = rstFRS.Fields("NomFournisseur").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstFRS.Fields("NomFournisseur").Value))
					End If
					
945: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
					'On affiche l'Id dans le tag
950: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = rstProjSoum.Fields("IDFRS").Value
					
955: Call rstFRS.Close()
960: End If
965: Else
970: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
					itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
975: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(0)
980: End If
			
			'Prix total
985: If Trim(rstProjSoum.Fields("Prix_total").Value) <> vbNullString Then
990: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
					itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
995: Else
1000: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
					itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
1005: End If
			
1010: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Profit
1015: If Trim(rstProjSoum.Fields("Profit_argent").Value) <> vbNullString Then
1020: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
					itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
1025: Else
1030: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
					itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
1035: End If
			
1040: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
1045: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Commentaire").Value) Then
1050: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
					itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = rstProjSoum.Fields("Commentaire").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Commentaire").Value))
				End If
1055: Else
1060: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
					itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
1065: End If
			
1070: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
1075: Call rstProjSoum.MoveNext()
1080: Loop 
		
1085: Call rstProjSoum.Close()
1090: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
1095: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
1100: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
1105: Exit Sub
		
AfficherErreur: 
		
1110: Call AfficherErreur("frmProjSoumMec", "RemplirListViewProjSoum", Err, Erl())
	End Sub
	
	Private Sub RechercherProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui recherche une soumission ou un projet dans le combo
		'et qui la sélectionne
10: Dim iCompteur As Short
		
		'Pour chaque élément du combo
15: For iCompteur = 0 To cmbProjSoum.Items.Count - 1
			'Si le texte de l'élément du combo est égal au numéro recherché
20: If VB6.GetItemString(cmbProjSoum, iCompteur) = sNoProjSoum Then
				'On le sélectionne
25: cmbProjSoum.SelectedIndex = iCompteur
				
30: Exit For
35: End If
40: Next 
		
45: If cmbProjSoum.SelectedIndex = -1 Then
50: cmbProjSoum.SelectedIndex = 0
55: End If
		
60: Exit Sub
		
AfficherErreur: 
		
65: Call AfficherErreur("frmProjSoumMec", "RechercherProjSoum", Err, Erl())
	End Sub
	
	Private Sub RemplirProjSoum()
		
5: On Error GoTo AfficherErreur
		
		'Affiche le projet ou la soumission choisie
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstSoum As ADODB.Recordset
20: Dim rstClient As ADODB.Recordset
25: Dim rstContact As ADODB.Recordset
		
		'Ouvre le recordset selon le type
30: rstProjSoum = New ADODB.Recordset
		
35: If m_eType = enumType.TYPE_PROJET Then
40: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
45: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
50: txtNoSoumission.Text = rstProjSoum.Fields("IDSoumission").Value
55: End If
			
60: If VB.Right(txtNoProjSoum.Text, 2) >= "60" And VB.Right(txtNoProjSoum.Text, 2) <= "98" Then
65: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("LiaisonChargeable").Value) And Trim(rstProjSoum.Fields("LiaisonChargeable").Value) <> "" Then
70: m_sLiaison = rstProjSoum.Fields("LiaisonChargeable").Value
75: Else
80: m_sLiaison = ""
					
85: Do While Trim(m_sLiaison) = ""
90: m_sLiaison = InputBox("Quelle est l'extention au projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & " auquel ce projet sera lié?")
95: Loop 
					
100: rstProjSoum.Fields("LiaisonChargeable").Value = m_sLiaison
					
105: Call rstProjSoum.Update()
110: End If
115: End If
120: Else
125: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
130: End If
		
		'Recordset pour avoir le nom du client
135: rstClient = New ADODB.Recordset
		
140: Call rstClient.Open("SELECT NomClient,IDClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Recordset pour avoir le nom du contact
145: rstContact = New ADODB.Recordset
		
150: Call rstContact.Open("SELECT NomContact,IDContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
155: txtClient.Text = rstClient.Fields("NomClient").Value
		
160: txtcontact.Text = rstContact.Fields("NomContact").Value
		
165: Call rstClient.Close()
170: 'UPGRADE_NOTE: Object rstClient may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstClient = Nothing
		
175: Call rstContact.Close()
180: 'UPGRADE_NOTE: Object rstContact may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstContact = Nothing
		
185: txtDescription.Text = rstProjSoum.Fields("Description").Value
		
190: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("manuel").Value) Then
195: txtNbreManuel.Text = rstProjSoum.Fields("manuel").Value
200: Else
205: txtNbreManuel.Text = "0"
210: End If
		
215: txtPrixManuel.Text = rstProjSoum.Fields("total_manuel").Value
		
220: txtTotalPieces.Text = rstProjSoum.Fields("Total_Piece").Value
225: txtTotalTemps.Text = rstProjSoum.Fields("Total_Temps").Value
230: txtPrixTotal.Text = rstProjSoum.Fields("PrixTotal").Value
235: txtImprevus.Text = rstProjSoum.Fields("Total_Imprevue").Value
240: txtProfit.Text = rstProjSoum.Fields("total_profit").Value
245: txtCommission.Text = rstProjSoum.Fields("total_commission").Value
		
250: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("CheminPhotos").Value) Then
255: txtCheminPhotos.Text = rstProjSoum.Fields("CheminPhotos").Value
260: Else
265: txtCheminPhotos.Text = vbNullString
270: End If
		
275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("MontantForfait").Value) Then
280: txtForfait.Text = Conversion_Renamed(rstProjSoum.Fields("MontantForfait"), ModuleMain.enumConvert.MODE_ARGENT)
			
285: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("InitialeForfait").Value) Then
290: lblForfaitInitiale.Text = rstProjSoum.Fields("InitialeForfait").Value
295: Else
300: lblForfaitInitiale.Text = ""
305: End If
310: Else
315: txtForfait.Text = ""
320: lblForfaitInitiale.Text = ""
325: End If
		
330: If m_eType = enumType.TYPE_PROJET Then
335: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("PrixRéception").Value) Then
340: If Trim(rstProjSoum.Fields("PrixRéception").Value) <> "" Then
345: txtPrixReception.Text = Conversion_Renamed(rstProjSoum.Fields("PrixRéception"), ModuleMain.enumConvert.MODE_ARGENT)
350: Else
355: txtPrixReception.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
360: End If
365: Else
370: txtPrixReception.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
375: End If
			
380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
385: rstSoum = New ADODB.Recordset
				
390: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & rstProjSoum.Fields("IDSoumission").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
395: If Not rstSoum.EOF Then
400: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("PrixTotal").Value) Then
405: If Trim(rstSoum.Fields("PrixTotal").Value) <> "" Then
410: txtPrixSoumission.Text = Conversion_Renamed(rstSoum.Fields("PrixTotal"), ModuleMain.enumConvert.MODE_ARGENT)
415: Else
420: txtPrixSoumission.Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
425: End If
430: Else
435: txtPrixSoumission.Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
440: End If
445: Else
450: txtPrixSoumission.Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
455: End If
				
460: Call rstSoum.Close()
465: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstSoum = Nothing
470: End If
475: End If
		
480: Call rstProjSoum.Close()
485: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'Affiche les pieces de la soumission
490: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
495: Exit Sub
		
AfficherErreur: 
		
500: Call AfficherErreur("frmProjSoumMec", "RemplirProjSoum", Err, Erl())
	End Sub
	
	Private Sub RemplirComboCategoriesPieces()
		
5: On Error GoTo AfficherErreur
		
		'Remplir le combo categorie
10: Dim rstCatalogueMec As ADODB.Recordset
		
		'Il faut vider le combo avant de le remplir
15: Call cmbPieces.Items.Clear()
		
		'Cette méthode crée un recordset contenant les categorie
		'le nom de toutes les tables de la BD
20: rstCatalogueMec = New ADODB.Recordset
		
25: Call rstCatalogueMec.Open("SELECT DISTINCT CATEGORIE FROM GRB_CatalogueMec ORDER BY CATEGORIE", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Tant que ce n'est pas la fin des enregistrements
30: Do While Not rstCatalogueMec.EOF
35: Call cmbPieces.Items.Add(rstCatalogueMec.Fields("CATEGORIE").Value)
			
40: Call rstCatalogueMec.MoveNext()
45: Loop 
		
50: Call rstCatalogueMec.Close()
55: 'UPGRADE_NOTE: Object rstCatalogueMec may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstCatalogueMec = Nothing
		
		'Si le combo n'est pas vide, on sélectionne le premier
60: If cmbPieces.Items.Count > 0 Then
65: cmbPieces.SelectedIndex = 0
70: End If
		
75: Exit Sub
		
AfficherErreur: 
		
80: Call AfficherErreur("frmProjSoumMec", "RemplirComboCategoriesPieces", Err, Erl())
	End Sub
	
	Private Sub RemplirComboClients(ByVal sRecherche As String)
		
5: On Error GoTo AfficherErreur
		
		'Remplit le combo des clients
10: Dim rstClient As ADODB.Recordset
		
15: Call cmbclient.Items.Clear()
		
20: rstClient = New ADODB.Recordset
		
25: Call rstClient.Open("SELECT NomClient, IDClient FROM GRB_Client WHERE Instr(1, NomClient, '" & Replace(sRecherche, "'", "''") & "') > 0 AND Supprimé = False", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
30: Do While Not rstClient.EOF
			'on met le nom du client dans le combo
35: Call cmbclient.Items.Add(rstClient.Fields("NomClient").Value)
			
			'on met l'id du client dans l'itemdata
40: 'UPGRADE_ISSUE: ComboBox property cmbclient.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
			VB6.SetItemData(cmbclient, cmbclient.NewIndex, rstClient.Fields("IDClient").Value)
			
45: Call rstClient.MoveNext()
50: Loop 
		
55: Call rstClient.Close()
60: 'UPGRADE_NOTE: Object rstClient may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstClient = Nothing
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumMec", "RemplirComboClients", Err, Erl())
	End Sub
	
	Private Sub RemplirComboContacts()
		
5: On Error GoTo AfficherErreur
		
		'Remplis le combo des contacts selon le client choisi
10: Dim rstContact As ADODB.Recordset
		
15: Call cmbContact.Items.Clear()
		
20: If cmbclient.SelectedIndex > -1 Then
25: rstContact = New ADODB.Recordset
			
30: Call rstContact.Open("SELECT NomContact, IDContact FROM GRB_Contact INNER JOIN GRB_ContactClient ON GRB_Contact.IDContact = GRB_ContactClient.NoContact WHERE GRB_ContactClient.noClient = " & VB6.GetItemData(cmbclient, cmbclient.SelectedIndex), g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Si il n'y a aucun contact pour le client choisi
35: If rstContact.EOF Then
				'On ajoute tous les contacts
40: Call rstContact.Close()
				
45: Call rstContact.Open("SELECT NomContact, IDContact FROM GRB_Contact WHERE Supprimé = False", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: End If
			
55: Do While Not rstContact.EOF
				'On ajoute le nom du contact dans le combo
60: Call cmbContact.Items.Add(rstContact.Fields("NomContact").Value)
				
				'On ajoute l'id du contact dans l'itemdata du combo
65: 'UPGRADE_ISSUE: ComboBox property cmbContact.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
				VB6.SetItemData(cmbContact, cmbContact.NewIndex, rstContact.Fields("IDContact").Value)
				
70: Call rstContact.MoveNext()
75: Loop 
			
80: Call rstContact.Close()
85: 'UPGRADE_NOTE: Object rstContact may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstContact = Nothing
			
			'Si le combo n'est pas vide, on sélectionne le premier élément
90: If cmbContact.Items.Count > 0 Then
95: cmbContact.SelectedIndex = 0
100: End If
105: End If
		
110: Exit Sub
		
AfficherErreur: 
		
115: Call AfficherErreur("frmProjSoumMec", "RemplirComboContacts", Err, Erl())
	End Sub
	
	Private Sub RemplirComboSections()
		
5: On Error GoTo AfficherErreur
		
		'Remplis le combo des sections
10: Dim rstSection As ADODB.Recordset
15: Dim sChamps As String
		
20: Call cmbSections.Items.Clear()
		
		'Il faut le remplir selon l'ordre
25: rstSection = New ADODB.Recordset
		
30: Call rstSection.Open("SELECT * FROM GRB_SoumProjSectionMec ORDER BY Ordre", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
35: Do While Not rstSection.EOF
			'On met le nom de la section dans le combo
40: If m_eLangage = enumLangage.ANGLAIS Then
45: sChamps = "NomSectionEN"
50: Else
55: sChamps = "NomSectionFR"
60: End If
			
65: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSection.Fields(sChamps).Value) Then
70: Call cmbSections.Items.Add(rstSection.Fields(sChamps).Value)
75: Else
80: Call cmbSections.Items.Add(vbNullString)
85: End If
			
			'On met l'id de la section dans l'itemdata du combo
90: 'UPGRADE_ISSUE: ComboBox property cmbSections.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
			VB6.SetItemData(cmbSections, cmbSections.NewIndex, rstSection.Fields("IDSection").Value)
			
95: Call rstSection.MoveNext()
100: Loop 
		
105: Call rstSection.Close()
110: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'Si le combo n'est pas vide, on sélectionne le premier élément
115: If cmbSections.Items.Count > 0 Then
120: cmbSections.SelectedIndex = 0
125: End If
		
130: Exit Sub
		
AfficherErreur: 
		
135: Call AfficherErreur("frmProjSoumMec", "RemplirComboSections", Err, Erl())
	End Sub
	
	Private Sub cmdImprimer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdImprimer.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: If txtNoProjSoum.Text <> vbNullString Then
25: If VerifierSiOuvert(sUser) = False Then
				'ouvre les tables
30: rstProjSoum = New ADODB.Recordset
				
35: If m_eType = enumType.TYPE_PROJET Then
40: If MsgBox("Voulez-vous faire imprimer le projet et tous les extras associés à ce projet?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
45: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE Left$(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' ORDER BY IDProjet", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: Else
55: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "' ORDER BY IDProjet", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
60: End If
65: Else
70: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "' ORDER BY IDSoumission", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
75: End If
				
76: bTrigger = False
77: intdummie = 0
				
				'***********************************************************************************
				'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
				'***********************************************************************************
				If MsgBox("Désirez-vous afficher les dates de réception et de commande?", MsgBoxStyle.YesNo, "Date de réception et de commande") = MsgBoxResult.Yes Then
					bFlag = True
				Else
					bFlag = False
				End If
				'***********************************************************************************
				
80: Do While Not rstProjSoum.EOF
85: If m_eType = enumType.TYPE_PROJET Then
90: Call CalculerTotalRecordset(rstProjSoum.Fields("IDProjet").Value)
95: End If
					
100: Call ImprimerProjSoum(rstProjSoum)
101: If Not intdummie = MsgBoxResult.Yes Then
105: Call ImprimerListePieces(rstProjSoum)
106: End If
110: Call rstProjSoum.MoveNext()
115: Loop 
				
120: Call rstProjSoum.Close()
125: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
130: Else
135: If m_eType = enumType.TYPE_PROJET Then
140: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
145: Else
150: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
155: End If
160: End If
165: End If
		
170: Exit Sub
		
AfficherErreur: 
		
175: Call AfficherErreur("frmProjSoumMec", "cmdImprimer_Click", Err, Erl())
	End Sub
	
	Private Sub ImprimerProjSoum(ByVal rstProjSoum As ADODB.Recordset)
		Dim DR_SoumissionMec As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de soumission
10: Dim rstPiece As ADODB.Recordset
15: Dim rstPrixSoum As ADODB.Recordset
20: Dim rstTemp As ADODB.Recordset
25: Dim rstImpProjSoum As ADODB.Recordset
30: Dim rstSoum As ADODB.Recordset
35: Dim sOrdreSection As String
40: Dim iCompteurSoum As Short
45: Dim sSousSection As String
50: Dim sSousSectionRS As String
55: Dim dblTempsDessin As Double
60: Dim dblTempsCoupe As Double
65: Dim dblTempsMachinage As Double
70: Dim dblTempsSoudure As Double
75: Dim dblTempsAssemblage As Double
80: Dim dblTempsPeinture As Double
85: Dim dblTempsTest As Double
90: Dim dblTempsInstallation As Double
95: Dim dblTempsFormation As Double
100: Dim dblTempsGestion As Double
105: Dim dblTempsShipping As Double
110: Dim dblTotalTemps As Double
115: Dim dblTotalAutre As Double
120: Dim dblTotalReste As Double
125: Dim dblTotalHebergement As Double
130: Dim dblTotalRepas As Double
135: Dim dblTotalTransport As Double
140: Dim dblTotalUniteMobile As Double
145: Dim sChampsSection As String
150: Dim sNoProjet As String
155: Dim sNoSoumission As String
160: Dim dblPrixEmballage As Double
		
		'Supprime les données de l'impression
165: Call g_connData.Execute("DELETE * FROM GRB_impression_soumission")
		
170: iCompteurSoum = 1
		
175: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
180: rstImpProjSoum = New ADODB.Recordset
		
185: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_soumission", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
190: sOrdreSection = vbNullString
		
195: rstPiece = New ADODB.Recordset
		
200: If m_eType = enumType.TYPE_PROJET Then
205: sNoProjet = rstProjSoum.Fields("IDProjet").Value
			
210: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
215: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
220: Else
225: sNoSoumission = vbNullString
230: End If
			
235: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' And Type = 'M' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
240: Else
245: sNoProjet = vbNullString
250: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
255: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoSoumission & "' And Type = 'M' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
260: End If
		
265: rstTemp = New ADODB.Recordset
		
270: Do While Not rstPiece.EOF
275: sSousSectionRS = rstPiece.Fields("SousSection").Value
			
280: If sSousSectionRS = S_PAS_SOUS_SECTION Then
285: sSousSectionRS = " "
290: End If
			
295: If sOrdreSection <> rstPiece.Fields("OrdreSection").Value Then
				'remplis la table impression_soumission
				'ajoute seulement la section
300: sOrdreSection = rstPiece.Fields("OrdreSection").Value
				
305: If m_eLangage = enumLangage.ANGLAIS Then
310: sChampsSection = "NomSectionEN"
315: Else
320: sChampsSection = "NomSectionFR"
325: End If
				
330: Call rstTemp.Open("SELECT " & sChampsSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajoute la section dans la soumission
335: Call rstImpProjSoum.AddNew()
				
340: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
345: If m_eType = enumType.TYPE_PROJET Then
350: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
355: Else
360: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
365: End If
				
370: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstTemp.Fields(sChampsSection).Value) Then
375: rstImpProjSoum.Fields("NomSection").Value = rstTemp.Fields(sChampsSection).Value
380: Else
385: rstImpProjSoum.Fields("NomSection").Value = " "
390: End If
				
395: Call rstImpProjSoum.Update()
				
400: iCompteurSoum = iCompteurSoum + 1
				
405: Call rstTemp.Close()
				
410: sSousSection = rstPiece.Fields("SousSection").Value
				
415: If sSousSection = S_PAS_SOUS_SECTION Or sSousSection = "" Then
420: sSousSection = " "
425: End If
				
430: Call rstImpProjSoum.AddNew()
				
435: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
440: If m_eType = enumType.TYPE_PROJET Then
445: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
450: Else
455: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
460: End If
				
465: rstImpProjSoum.Fields("SousSection").Value = sSousSection
				
470: Call rstImpProjSoum.Update()
				
475: iCompteurSoum = iCompteurSoum + 1
480: Else
				'ajoute une soussection dans impression_soum
485: If sSousSection <> sSousSectionRS Then
490: sSousSection = sSousSectionRS
					
495: Call rstImpProjSoum.AddNew()
					
500: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
					
505: If m_eType = enumType.TYPE_PROJET Then
510: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
515: Else
520: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
525: End If
					
530: rstImpProjSoum.Fields("SousSection").Value = sSousSectionRS
					
535: Call rstImpProjSoum.Update()
					
540: iCompteurSoum = iCompteurSoum + 1
545: End If
550: End If
			
			'ajoute une piece dans impression_soum
555: Call rstImpProjSoum.AddNew()
			
560: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
			
565: If m_eType = enumType.TYPE_PROJET Then
570: rstImpProjSoum.Fields("IDsoumission").Value = sNoProjet
575: Else
580: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
585: End If
			
590: rstImpProjSoum.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value
595: rstImpProjSoum.Fields("Qté").Value = rstPiece.Fields("Qté").Value
			
600: If m_eLangage = enumLangage.ANGLAIS Then
605: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_EN").Value
610: Else
615: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_FR").Value
620: End If
			
			'************************************************************************************************
			'SECTION MODIFIER PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
			'************************************************************************************************
			
625: rstImpProjSoum.Fields("MANUFACT").Value = rstPiece.Fields("MANUFACT").Value
630: 'rstImpProjSoum.Fields("PRIX_LIST") = rstPiece.Fields("PRIX_LIST")
			
635: 'If Trim(rstPiece.Fields("ESCOMPTE")) <> vbNullString Then
640: '  rstImpProjSoum.Fields("ESCOMPTE") = Conversion(Replace(rstPiece.Fields("ESCOMPTE"), ".", ","), MODE_POURCENT)
645: 'Else
650: '  rstImpProjSoum.Fields("ESCOMPTE") = Conversion(0, MODE_POURCENT)
655: 'End If
			
660: rstImpProjSoum.Fields("PRIX_NET").Value = rstPiece.Fields("PRIX_NET").Value
			
665: Call rstTemp.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstPiece.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
670: If Not rstTemp.EOF Then
675: rstImpProjSoum.Fields("NomFournisseur").Value = rstTemp.Fields("NomFournisseur").Value
680: End If
			
685: Call rstTemp.Close()
			
690: rstImpProjSoum.Fields("PRIX_TOTAL").Value = rstPiece.Fields("PRIX_TOTAL").Value
695: rstImpProjSoum.Fields("PROFIT_ARGENT").Value = rstPiece.Fields("PROFIT_ARGENT").Value
			
			
			''''''''''''''''''''''''''''''''''''''''''''''''''''
			'' ajout du Numéros sequentiel de commande dans impression
			''''''''''''''''''''''''''''''''
			rstImpProjSoum.Fields("NoSéquentiel").Value = rstPiece.Fields("NoSéquentiel").Value
			
			
			
			
			'AJOUT DE CETTE SECTION PAR GAÉTAN GINGRAS LE 6 FÉVRIER 2010
			'*************************************************************
			If m_eType = enumType.TYPE_PROJET Then
				If Trim(rstPiece.Fields("DateRéception").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateReception").Value = rstPiece.Fields("DateRéception").Value
				Else
					rstImpProjSoum.Fields("DateReception").Value = ""
				End If
				If Trim(rstPiece.Fields("DateCommande").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateCommande").Value = rstPiece.Fields("DateCommande").Value
				Else
					rstImpProjSoum.Fields("DateCommande").Value = ""
				End If
			Else 'il n'y a pas de champ date de réception et de commande dans la table GRB_Soumission_Pièces
				rstImpProjSoum.Fields("DateReception").Value = ""
				rstImpProjSoum.Fields("DateCommande").Value = ""
			End If
			'************************************************************************************************
			'FIN DE LA SECTION DE MODIFICATION
			'************************************************************************************************
			
			
			
700: Call rstImpProjSoum.Update()
			
705: iCompteurSoum = iCompteurSoum + 1
			
			'prochaine enreg
710: Call rstPiece.MoveNext()
715: Loop 
		
		'ferme les tables
717: Call rstImpProjSoum.Close()
		
		''''''''''''''''''''''''''''''''''
		' rapport soumission, met dans l'ordre de ligne
		''''''''''''''''''''''''''''''''''''
718: Dim sProjet As String
		
719: If m_eType = enumType.TYPE_PROJET Then
720: sProjet = sNoProjet
721: Else
722: sProjet = sNoSoumission
723: End If
		
724: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_Soumission WHERE IDSoumission = '" & sProjet & "' ORDER BY NoLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
725: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.DataSource = rstImpProjSoum
		
		'***********************************************************************
		'Pour cas d'urgence, la fonction d'exporter dans Excel va être ici.
		'Nous pourrons plus tard le mettre à un meilleur endroit.
		'Gaétan Gingras le 14 mai 2009
		'***********************************************************************
		
726: If bTrigger = False Then
727: bTrigger = True
728: intdummie = MsgBox("Désirez-vous exporter les données dans Excel, SEULEMENT ?", MsgBoxStyle.YesNo + MsgBoxStyle.Information, "Exportation dans Excel")
729: End If
730: Dim sqlstr As String
		Dim rstExport As ADODB.Recordset
		If intdummie = MsgBoxResult.Yes Then
742: 743: 744: rstExport = New ADODB.Recordset
745: sqlstr = "SELECT GRB_impression_soumission.IDSoumission, CDbl([Qté]) AS Quantité, GRB_impression_soumission.NumItem, GRB_impression_soumission.Description, GRB_impression_soumission.Manufact, CDbl([Prix_list]) AS PrixdeListe, CDbl(Left([escompte],Len([escompte])-1)) AS Escomptes, CDbl([Prix_net]) AS prix_nette,GRB_impression_soumission.Prix_total - GRB_impression_soumission.Profit_Argent AS Prix_Total, GRB_impression_soumission.NomFournisseur , GRB_impression_soumission.DateReception, GRB_impression_soumission.DateCommande , GRB_impression_soumission.NoSéquentiel "
746: sqlstr = sqlstr & "FROM GRB_impression_soumission "
747: sqlstr = sqlstr & "WHERE (((GRB_impression_soumission.IDSoumission)='" & sProjet & "') AND ((GRB_impression_soumission.NumItem) Is Not Null)) "
748: sqlstr = sqlstr & "ORDER BY GRB_impression_soumission.noligne"
749: Call rstExport.Open(sqlstr, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
750: Call ExportdansExcel(rstExport)
751: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
752: Exit Sub
753: End If
		'***********************************************************************
		
755: Call TraduireImpressionSoumission()
		
760: If m_eType = enumType.TYPE_PROJET Then
765: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("shpCadrePrixReception").Visible = True
770: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixReception").Visible = True
775: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblPrixReception").Visible = True
			
780: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("shpCadrePrixSoumission").Visible = True
785: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixSoumission").Visible = True
790: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblPrixSoumission").Visible = True
795: Else
800: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("shpCadrePrixReception").Visible = False
805: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixReception").Visible = False
810: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblPrixReception").Visible = False
			
815: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("shpCadrePrixSoumission").Visible = False
820: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixSoumission").Visible = False
825: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblPrixSoumission").Visible = False
830: End If
		
		'affiche la date
		'**************************************************
		'ajout par Gaétan Gingras le 20 mai 2009
834: If MsgBox("Désirez-vous afficher la date en bas de page ?", MsgBoxStyle.YesNo + MsgBoxStyle.Information, "Affichage de la date") = MsgBoxResult.Yes Then
835: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("section3").Controls("lbldate").Caption = ConvertDate(Today)
836: Else
837: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("section3").Controls("lbldate").Caption = " "
838: End If
		'**************************************************
		
		'affiche entete
840: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblSoumission").Caption = sNoSoumission
		
845: If m_eType = enumType.TYPE_PROJET Then
850: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblprojet").Caption = rstProjSoum.Fields("IDProjet").Value
855: Else
860: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblProjet").Caption = vbNullString
865: End If
		
870: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lbldescription").Caption = rstProjSoum.Fields("Description").Value
		
875: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
880: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblclient").Caption = rstTemp.Fields("NomClient").Value
		
885: Call rstTemp.Close()
		
890: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
895: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblcontact").Caption = rstTemp.Fields("NomContact").Value
		
900: Call rstTemp.Close()
		
		'Affiche pied d'état
		
		'Temps
905: If m_eType = enumType.TYPE_SOUMISSION Then
910: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
915: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = rstProjSoum.Fields("TauxDessin").Value
920: Else
925: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = "0"
930: End If
			
935: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
940: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = rstProjSoum.Fields("TauxCoupe").Value
945: Else
950: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = "0"
955: End If
			
960: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
965: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = rstProjSoum.Fields("TauxMachinage").Value
970: Else
975: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = "0"
980: End If
			
985: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
990: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = rstProjSoum.Fields("TauxSoudure").Value
995: Else
1000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = "0"
1005: End If
			
1010: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
1015: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = rstProjSoum.Fields("TauxAssemblage").Value
1020: Else
1025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = "0"
1030: End If
			
1035: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
1040: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = rstProjSoum.Fields("TauxPeinture").Value
1045: Else
1050: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = "0"
1055: End If
			
1060: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
1065: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = rstProjSoum.Fields("TauxTest").Value
1070: Else
1075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = "0"
1080: End If
			
1085: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
1090: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = rstProjSoum.Fields("TauxInstallation").Value
1095: Else
1100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = "0"
1105: End If
			
1110: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
1115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = rstProjSoum.Fields("TauxFormation").Value
1120: Else
1125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = "0"
1130: End If
			
1135: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
1140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = rstProjSoum.Fields("TauxGestion").Value
1145: Else
1150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = "0"
1155: End If
			
1160: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1165: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = rstProjSoum.Fields("TauxShipping").Value
1170: Else
1175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = "0"
1180: End If
			
1185: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
1190: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = rstProjSoum.Fields("TempsDessin").Value
1195: Else
1200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "0"
1205: End If
			
1210: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupe").Value) Then
1215: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = rstProjSoum.Fields("TempsCoupe").Value
1220: Else
1225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "0"
1230: End If
			
1235: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinage").Value) Then
1240: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = rstProjSoum.Fields("TempsMachinage").Value
1245: Else
1250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "0"
1255: End If
			
1260: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudure").Value) Then
1265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = rstProjSoum.Fields("TempsSoudure").Value
1270: Else
1275: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "0"
1280: End If
			
1285: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
1290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = rstProjSoum.Fields("TempsAssemblage").Value
1295: Else
1300: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "0"
1305: End If
			
1310: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeinture").Value) Then
1315: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = rstProjSoum.Fields("TempsPeinture").Value
1320: Else
1325: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "0"
1330: End If
			
1335: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
1340: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = rstProjSoum.Fields("TempsTest").Value
1345: Else
1350: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "0"
1355: End If
			
1360: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
1365: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = rstProjSoum.Fields("TempsInstallation").Value
1370: Else
1375: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "0"
1380: End If
			
1385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
1390: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = rstProjSoum.Fields("TempsFormation").Value
1395: Else
1400: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "0"
1405: End If
			
1410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
1415: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = rstProjSoum.Fields("TempsGestion").Value
1420: Else
1425: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "0"
1430: End If
			
1435: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
1440: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = rstProjSoum.Fields("TempsShipping").Value
1445: Else
1450: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "0"
1455: End If
			
1460: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
1465: If IsNumeric(rstProjSoum.Fields("TempsDessin").Value) Then
1470: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessin").Value)
1475: Else
1480: dblTempsDessin = 0
1485: End If
1490: Else
1495: dblTempsDessin = 0
1500: End If
			
1505: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupe").Value) Then
1510: If IsNumeric(rstProjSoum.Fields("TempsCoupe").Value) Then
1515: dblTempsCoupe = CDbl(rstProjSoum.Fields("TempsCoupe").Value)
1520: Else
1525: dblTempsCoupe = 0
1530: End If
1535: Else
1540: dblTempsCoupe = 0
1545: End If
			
1550: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinage").Value) Then
1555: If IsNumeric(rstProjSoum.Fields("TempsMachinage").Value) Then
1560: dblTempsMachinage = CDbl(rstProjSoum.Fields("TempsMachinage").Value)
1565: Else
1570: dblTempsMachinage = 0
1575: End If
1580: Else
1585: dblTempsMachinage = 0
1590: End If
			
1595: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudure").Value) Then
1600: If IsNumeric(rstProjSoum.Fields("TempsSoudure").Value) Then
1605: dblTempsSoudure = CDbl(rstProjSoum.Fields("TempsSoudure").Value)
1610: Else
1615: dblTempsSoudure = 0
1620: End If
1625: Else
1630: dblTempsSoudure = 0
1635: End If
			
1640: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
1645: If IsNumeric(rstProjSoum.Fields("TempsAssemblage").Value) Then
1650: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblage").Value)
1655: Else
1660: dblTempsAssemblage = 0
1665: End If
1670: Else
1675: dblTempsAssemblage = 0
1680: End If
			
1685: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeinture").Value) Then
1690: If IsNumeric(rstProjSoum.Fields("TempsPeinture").Value) Then
1695: dblTempsPeinture = CDbl(rstProjSoum.Fields("TempsPeinture").Value)
1700: Else
1705: dblTempsPeinture = 0
1710: End If
1715: Else
1720: dblTempsPeinture = 0
1725: End If
			
1730: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
1735: If IsNumeric(rstProjSoum.Fields("TempsTest").Value) Then
1740: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTest").Value)
1745: Else
1750: dblTempsTest = 0
1755: End If
1760: Else
1765: dblTempsTest = 0
1770: End If
			
1775: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
1780: If IsNumeric(rstProjSoum.Fields("TempsInstallation").Value) Then
1785: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallation").Value)
1790: Else
1795: dblTempsInstallation = 0
1800: End If
1805: Else
1810: dblTempsInstallation = 0
1815: End If
			
1820: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
1825: If IsNumeric(rstProjSoum.Fields("TempsFormation").Value) Then
1830: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormation").Value)
1835: Else
1840: dblTempsFormation = 0
1845: End If
1850: Else
1855: dblTempsFormation = 0
1860: End If
			
1865: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
1870: If IsNumeric(rstProjSoum.Fields("TempsGestion").Value) Then
1875: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestion").Value)
1880: Else
1885: dblTempsGestion = 0
1890: End If
1895: Else
1900: dblTempsGestion = 0
1905: End If
			
1910: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
1915: If IsNumeric(rstProjSoum.Fields("TempsShipping").Value) Then
1920: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShipping").Value)
1925: Else
1930: dblTempsShipping = 0
1935: End If
1940: Else
1945: dblTempsShipping = 0
1950: End If
			
1955: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
			
1960: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = dblTotalTemps
			
1965: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinProj").Caption = "---"
1970: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeProj").Caption = "---"
1975: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageProj").Caption = "---"
1980: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureProj").Caption = "---"
1985: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageProj").Caption = "---"
1990: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureProj").Caption = "---"
1995: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestProj").Caption = "---"
2000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationProj").Caption = "---"
2005: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationProj").Caption = "---"
2010: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionProj").Caption = "---"
2015: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingProj").Caption = "---"
			
2020: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHProj").Caption = "---"
			
2025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = "---"
2030: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = "---"
2035: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = "---"
2040: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = "---"
2045: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = "---"
2050: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = "---"
2055: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = "---"
2060: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = "---"
2065: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = "---"
2070: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = "---"
2075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = "---"
			
2080: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHConc").Caption = "---"
2085: Else
2090: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
2095: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = rstProjSoum.Fields("TauxDessin").Value
2100: Else
2105: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = "0"
2110: End If
			
2115: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
2120: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = rstProjSoum.Fields("TauxCoupe").Value
2125: Else
2130: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = "0"
2135: End If
			
2140: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
2145: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = rstProjSoum.Fields("TauxMachinage").Value
2150: Else
2155: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = "0"
2160: End If
			
2165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
2170: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = rstProjSoum.Fields("TauxSoudure").Value
2175: Else
2180: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = "0"
2185: End If
			
2190: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
2195: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = rstProjSoum.Fields("TauxAssemblage").Value
2200: Else
2205: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = "0"
2210: End If
			
2215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
2220: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = rstProjSoum.Fields("TauxPeinture").Value
2225: Else
2230: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = "0"
2235: End If
			
2240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
2245: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = rstProjSoum.Fields("TauxTest").Value
2250: Else
2255: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = "0"
2260: End If
			
2265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
2270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = rstProjSoum.Fields("TauxInstallation").Value
2275: Else
2280: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = "0"
2285: End If
			
2290: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
2295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = rstProjSoum.Fields("TauxFormation").Value
2300: Else
2305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = "0"
2310: End If
			
2315: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
2320: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = rstProjSoum.Fields("TauxGestion").Value
2325: Else
2330: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = "0"
2335: End If
			
2340: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
2345: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = rstProjSoum.Fields("TauxShipping").Value
2350: Else
2355: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = "0"
2360: End If
			
2365: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
2370: rstSoum = New ADODB.Recordset
				
2375: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & rstProjSoum.Fields("IDSoumission").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
2380: If Not rstSoum.EOF Then
2385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
2390: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = rstSoum.Fields("TempsDessin").Value
2395: Else
2400: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "0"
2405: End If
					
2410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsCoupe").Value) Then
2415: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = rstSoum.Fields("TempsCoupe").Value
2420: Else
2425: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "0"
2430: End If
					
2435: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsMachinage").Value) Then
2440: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = rstSoum.Fields("TempsMachinage").Value
2445: Else
2450: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "0"
2455: End If
					
2460: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsSoudure").Value) Then
2465: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = rstSoum.Fields("TempsSoudure").Value
2470: Else
2475: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "0"
2480: End If
					
2485: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
2490: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = rstSoum.Fields("TempsAssemblage").Value
2495: Else
2500: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "0"
2505: End If
					
2510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsPeinture").Value) Then
2515: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = rstSoum.Fields("TempsPeinture").Value
2520: Else
2525: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "0"
2530: End If
					
2535: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
2540: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = rstSoum.Fields("TempsTest").Value
2545: Else
2550: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "0"
2555: End If
					
2560: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
2565: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = rstSoum.Fields("TempsInstallation").Value
2570: Else
2575: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "0"
2580: End If
					
2585: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
2590: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = rstSoum.Fields("TempsFormation").Value
2595: Else
2600: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "0"
2605: End If
					
2610: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
2615: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = rstSoum.Fields("TempsGestion").Value
2620: Else
2625: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "0"
2630: End If
					
2635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
2640: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = rstSoum.Fields("TempsShipping").Value
2645: Else
2650: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "0"
2655: End If
					
2660: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
2665: If IsNumeric(rstSoum.Fields("TempsDessin").Value) Then
2670: dblTempsDessin = CDbl(rstSoum.Fields("TempsDessin").Value)
2675: Else
2680: dblTempsDessin = 0
2685: End If
2690: Else
2695: dblTempsDessin = 0
2700: End If
					
2705: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsCoupe").Value) Then
2710: If IsNumeric(rstSoum.Fields("TempsCoupe").Value) Then
2715: dblTempsCoupe = CDbl(rstSoum.Fields("TempsCoupe").Value)
2720: Else
2725: dblTempsCoupe = 0
2730: End If
2735: Else
2740: dblTempsCoupe = 0
2745: End If
					
2750: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsMachinage").Value) Then
2755: If IsNumeric(rstSoum.Fields("TempsMachinage").Value) Then
2760: dblTempsMachinage = CDbl(rstSoum.Fields("TempsMachinage").Value)
2765: Else
2770: dblTempsMachinage = 0
2775: End If
2780: Else
2785: dblTempsMachinage = 0
2790: End If
					
2795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsSoudure").Value) Then
2800: If IsNumeric(rstSoum.Fields("TempsSoudure").Value) Then
2805: dblTempsSoudure = CDbl(rstSoum.Fields("TempsSoudure").Value)
2810: Else
2815: dblTempsSoudure = 0
2820: End If
2825: Else
2830: dblTempsSoudure = 0
2835: End If
					
2840: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
2845: If IsNumeric(rstSoum.Fields("TempsAssemblage").Value) Then
2850: dblTempsAssemblage = CDbl(rstSoum.Fields("TempsAssemblage").Value)
2855: Else
2860: dblTempsAssemblage = 0
2865: End If
2870: Else
2875: dblTempsAssemblage = 0
2880: End If
					
2885: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsPeinture").Value) Then
2890: If IsNumeric(rstSoum.Fields("TempsPeinture").Value) Then
2895: dblTempsPeinture = CDbl(rstSoum.Fields("TempsPeinture").Value)
2900: Else
2905: dblTempsPeinture = 0
2910: End If
2915: Else
2920: dblTempsPeinture = 0
2925: End If
					
2930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
2935: If IsNumeric(rstSoum.Fields("TempsTest").Value) Then
2940: dblTempsTest = CDbl(rstSoum.Fields("TempsTest").Value)
2945: Else
2950: dblTempsTest = 0
2955: End If
2960: Else
2965: dblTempsTest = 0
2970: End If
					
2975: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
2980: If IsNumeric(rstSoum.Fields("TempsInstallation").Value) Then
2985: dblTempsInstallation = CDbl(rstSoum.Fields("TempsInstallation").Value)
2990: Else
2995: dblTempsInstallation = 0
3000: End If
3005: Else
3010: dblTempsInstallation = 0
3015: End If
					
3020: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
3025: If IsNumeric(rstSoum.Fields("TempsFormation").Value) Then
3030: dblTempsFormation = CDbl(rstSoum.Fields("TempsFormation").Value)
3035: Else
3040: dblTempsFormation = 0
3045: End If
3050: Else
3055: dblTempsFormation = 0
3060: End If
					
3065: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
3070: If IsNumeric(rstSoum.Fields("TempsGestion").Value) Then
3075: dblTempsGestion = CDbl(rstSoum.Fields("TempsGestion").Value)
3080: Else
3085: dblTempsGestion = 0
3090: End If
3095: Else
3100: dblTempsGestion = 0
3105: End If
					
3110: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
3115: If IsNumeric(rstSoum.Fields("TempsShipping").Value) Then
3120: dblTempsShipping = CDbl(rstSoum.Fields("TempsShipping").Value)
3125: Else
3130: dblTempsShipping = 0
3135: End If
3140: Else
3145: dblTempsShipping = 0
3150: End If
					
3155: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
					
3160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = dblTotalTemps
3165: Else
3170: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "---"
3175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "---"
3180: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "---"
3185: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "---"
3190: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "---"
3195: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "---"
3200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "---"
3205: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "---"
3210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "---"
3215: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "---"
3220: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "---"
					
3225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = "---"
3230: End If
				
3235: Call rstSoum.Close()
3240: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstSoum = Nothing
3245: Else
3250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "---"
3255: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "---"
3260: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "---"
3265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "---"
3270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "---"
3275: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "---"
3280: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "---"
3285: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "---"
3290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "---"
3295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "---"
3300: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "---"
				
3305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = "---"
3310: End If
			
3315: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessinProj").Value) Then
3320: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinProj").Caption = rstProjSoum.Fields("TempsDessinProj").Value
3325: Else
3330: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinProj").Caption = "0"
3335: End If
			
3340: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupeProj").Value) Then
3345: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeProj").Caption = rstProjSoum.Fields("TempsCoupeProj").Value
3350: Else
3355: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeProj").Caption = "0"
3360: End If
			
3365: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinageProj").Value) Then
3370: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageProj").Caption = rstProjSoum.Fields("TempsMachinageProj").Value
3375: Else
3380: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageProj").Caption = "0"
3385: End If
			
3390: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudureProj").Value) Then
3395: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureProj").Caption = rstProjSoum.Fields("TempsSoudureProj").Value
3400: Else
3405: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureProj").Caption = "0"
3410: End If
			
3415: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
3420: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageProj").Caption = rstProjSoum.Fields("TempsAssemblageProj").Value
3425: Else
3430: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageProj").Caption = "0"
3435: End If
			
3440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeintureProj").Value) Then
3445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureProj").Caption = rstProjSoum.Fields("TempsPeintureProj").Value
3450: Else
3455: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureProj").Caption = "0"
3460: End If
			
3465: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTestProj").Value) Then
3470: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestProj").Caption = rstProjSoum.Fields("TempsTestProj").Value
3475: Else
3480: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestProj").Caption = "0"
3485: End If
			
3490: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallationProj").Value) Then
3495: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationProj").Caption = rstProjSoum.Fields("TempsInstallationProj").Value
3500: Else
3505: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationProj").Caption = "0"
3510: End If
			
3515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormationProj").Value) Then
3520: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationProj").Caption = rstProjSoum.Fields("TempsFormationProj").Value
3525: Else
3530: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationProj").Caption = "0"
3535: End If
			
3540: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestionProj").Value) Then
3545: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionProj").Caption = rstProjSoum.Fields("TempsGestionProj").Value
3550: Else
3555: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionProj").Caption = "0"
3560: End If
			
3565: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShippingProj").Value) Then
3570: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingProj").Caption = rstProjSoum.Fields("TempsShippingProj").Value
3575: Else
3580: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingProj").Caption = "0"
3585: End If
			
3590: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessinProj").Value) Then
3595: If IsNumeric(rstProjSoum.Fields("TempsDessinProj").Value) Then
3600: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessinProj").Value)
3605: Else
3610: dblTempsDessin = 0
3615: End If
3620: Else
3625: dblTempsDessin = 0
3630: End If
			
3635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupeProj").Value) Then
3640: If IsNumeric(rstProjSoum.Fields("TempsCoupeProj").Value) Then
3645: dblTempsCoupe = CDbl(rstProjSoum.Fields("TempsCoupeProj").Value)
3650: Else
3655: dblTempsCoupe = 0
3660: End If
3665: Else
3670: dblTempsCoupe = 0
3675: End If
			
3680: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinageProj").Value) Then
3685: If IsNumeric(rstProjSoum.Fields("TempsMachinageProj").Value) Then
3690: dblTempsMachinage = CDbl(rstProjSoum.Fields("TempsMachinageProj").Value)
3695: Else
3700: dblTempsMachinage = 0
3705: End If
3710: Else
3715: dblTempsMachinage = 0
3720: End If
			
3725: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudureProj").Value) Then
3730: If IsNumeric(rstProjSoum.Fields("TempsSoudureProj").Value) Then
3735: dblTempsSoudure = CDbl(rstProjSoum.Fields("TempsSoudureProj").Value)
3740: Else
3745: dblTempsSoudure = 0
3750: End If
3755: Else
3760: dblTempsSoudure = 0
3765: End If
			
3770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
3775: If IsNumeric(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
3780: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblageProj").Value)
3785: Else
3790: dblTempsAssemblage = 0
3795: End If
3800: Else
3805: dblTempsAssemblage = 0
3810: End If
			
3815: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeintureProj").Value) Then
3820: If IsNumeric(rstProjSoum.Fields("TempsPeintureProj").Value) Then
3825: dblTempsPeinture = CDbl(rstProjSoum.Fields("TempsPeintureProj").Value)
3830: Else
3835: dblTempsPeinture = 0
3840: End If
3845: Else
3850: dblTempsPeinture = 0
3855: End If
			
3860: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTestProj").Value) Then
3865: If IsNumeric(rstProjSoum.Fields("TempsTestProj").Value) Then
3870: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTestProj").Value)
3875: Else
3880: dblTempsTest = 0
3885: End If
3890: Else
3895: dblTempsTest = 0
3900: End If
			
3905: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallationProj").Value) Then
3910: If IsNumeric(rstProjSoum.Fields("TempsInstallationProj").Value) Then
3915: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallationProj").Value)
3920: Else
3925: dblTempsInstallation = 0
3930: End If
3935: Else
3940: dblTempsInstallation = 0
3945: End If
			
3950: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormationProj").Value) Then
3955: If IsNumeric(rstProjSoum.Fields("TempsFormationProj").Value) Then
3960: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormationProj").Value)
3965: Else
3970: dblTempsFormation = 0
3975: End If
3980: Else
3985: dblTempsFormation = 0
3990: End If
			
3995: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestionProj").Value) Then
4000: If IsNumeric(rstProjSoum.Fields("TempsGestionProj").Value) Then
4005: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestionProj").Value)
4010: Else
4015: dblTempsGestion = 0
4020: End If
4025: Else
4030: dblTempsGestion = 0
4035: End If
			
4040: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShippingProj").Value) Then
4045: If IsNumeric(rstProjSoum.Fields("TempsShippingProj").Value) Then
4050: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShippingProj").Value)
4055: Else
4060: dblTempsShipping = 0
4065: End If
4070: Else
4075: dblTempsShipping = 0
4080: End If
			
4085: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
			
4090: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHProj").Caption = dblTotalTemps
			
4095: If rstProjSoum.Fields("TempsProjBarré").Value = True Then
4100: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessinConc").Value) Then
4105: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = rstProjSoum.Fields("TempsDessinConc").Value
4110: Else
4115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = "0"
4120: End If
				
4125: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupeConc").Value) Then
4130: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = rstProjSoum.Fields("TempsCoupeConc").Value
4135: Else
4140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = "0"
4145: End If
				
4150: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinageConc").Value) Then
4155: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = rstProjSoum.Fields("TempsMachinageConc").Value
4160: Else
4165: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = "0"
4170: End If
				
4175: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudureConc").Value) Then
4180: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = rstProjSoum.Fields("TempsSoudureConc").Value
4185: Else
4190: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = "0"
4195: End If
				
4200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
4205: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = rstProjSoum.Fields("TempsAssemblageConc").Value
4210: Else
4215: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = "0"
4220: End If
				
4225: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeintureConc").Value) Then
4230: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = rstProjSoum.Fields("TempsPeintureConc").Value
4235: Else
4240: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = "0"
4245: End If
				
4250: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTestConc").Value) Then
4255: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = rstProjSoum.Fields("TempsTestConc").Value
4260: Else
4265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = "0"
4270: End If
				
4275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallationConc").Value) Then
4280: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = rstProjSoum.Fields("TempsInstallationConc").Value
4285: Else
4290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = "0"
4295: End If
				
4300: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormationConc").Value) Then
4305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = rstProjSoum.Fields("TempsFormationConc").Value
4310: Else
4315: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = "0"
4320: End If
				
4325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestionConc").Value) Then
4330: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = rstProjSoum.Fields("TempsGestionConc").Value
4335: Else
4340: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = "0"
4345: End If
				
4350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShippingConc").Value) Then
4355: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = rstProjSoum.Fields("TempsShippingConc").Value
4360: Else
4365: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = "0"
4370: End If
				
4375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessinConc").Value) Then
4380: If IsNumeric(rstProjSoum.Fields("TempsDessinConc").Value) Then
4385: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessinConc").Value)
4390: Else
4395: dblTempsDessin = 0
4400: End If
4405: Else
4410: dblTempsDessin = 0
4415: End If
				
4420: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupeConc").Value) Then
4425: If IsNumeric(rstProjSoum.Fields("TempsCoupeConc").Value) Then
4430: dblTempsCoupe = CDbl(rstProjSoum.Fields("TempsCoupeConc").Value)
4435: Else
4440: dblTempsCoupe = 0
4445: End If
4450: Else
4455: dblTempsCoupe = 0
4460: End If
				
4465: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinageConc").Value) Then
4470: If IsNumeric(rstProjSoum.Fields("TempsMachinageConc").Value) Then
4475: dblTempsMachinage = CDbl(rstProjSoum.Fields("TempsMachinageConc").Value)
4480: Else
4485: dblTempsMachinage = 0
4490: End If
4495: Else
4500: dblTempsMachinage = 0
4505: End If
				
4510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudureConc").Value) Then
4515: If IsNumeric(rstProjSoum.Fields("TempsSoudureConc").Value) Then
4520: dblTempsSoudure = CDbl(rstProjSoum.Fields("TempsSoudureConc").Value)
4525: Else
4530: dblTempsSoudure = 0
4535: End If
4540: Else
4545: dblTempsSoudure = 0
4550: End If
				
4555: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
4560: If IsNumeric(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
4565: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblageConc").Value)
4570: Else
4575: dblTempsAssemblage = 0
4580: End If
4585: Else
4590: dblTempsAssemblage = 0
4595: End If
				
4600: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeintureConc").Value) Then
4605: If IsNumeric(rstProjSoum.Fields("TempsPeintureConc").Value) Then
4610: dblTempsPeinture = CDbl(rstProjSoum.Fields("TempsPeintureConc").Value)
4615: Else
4620: dblTempsPeinture = 0
4625: End If
4630: Else
4635: dblTempsPeinture = 0
4640: End If
				
4645: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTestConc").Value) Then
4650: If IsNumeric(rstProjSoum.Fields("TempsTestConc").Value) Then
4655: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTestConc").Value)
4660: Else
4665: dblTempsTest = 0
4670: End If
4675: Else
4680: dblTempsTest = 0
4685: End If
				
4690: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallationConc").Value) Then
4695: If IsNumeric(rstProjSoum.Fields("TempsInstallationConc").Value) Then
4700: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallationConc").Value)
4705: Else
4710: dblTempsInstallation = 0
4715: End If
4720: Else
4725: dblTempsInstallation = 0
4730: End If
				
4735: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormationConc").Value) Then
4740: If IsNumeric(rstProjSoum.Fields("TempsFormationConc").Value) Then
4745: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormationConc").Value)
4750: Else
4755: dblTempsFormation = 0
4760: End If
4765: Else
4770: dblTempsFormation = 0
4775: End If
				
4780: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestionConc").Value) Then
4785: If IsNumeric(rstProjSoum.Fields("TempsGestionConc").Value) Then
4790: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestionConc").Value)
4795: Else
4800: dblTempsGestion = 0
4805: End If
4810: Else
4815: dblTempsGestion = 0
4820: End If
				
4825: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShippingConc").Value) Then
4830: If IsNumeric(rstProjSoum.Fields("TempsShippingConc").Value) Then
4835: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShippingConc").Value)
4840: Else
4845: dblTempsShipping = 0
4850: End If
4855: Else
4860: dblTempsShipping = 0
4865: End If
				
4870: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
				
4875: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHConc").Caption = dblTotalTemps
4880: Else
4885: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = "---"
4890: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = "---"
4895: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = "---"
4900: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = "---"
4905: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = "---"
4910: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = "---"
4915: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = "---"
4920: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = "---"
4925: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = "---"
4930: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = "---"
4935: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = "---"
				
4940: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHConc").Caption = "---"
4945: End If
			
4950: Call CalculerTempsReelsImpression(rstProjSoum.Fields("IDProjet").Value)
4955: End If
		
		'Autres frais
4960: If m_eType = enumType.TYPE_PROJET Then
4965: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblNbrePersonne").Caption = "0"
4970: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsHebergement").Caption = "0"
4975: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement1").Caption = "0"
4980: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement2").Caption = "0"
4985: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsRepas").Caption = "0"
4990: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTauxRepas").Caption = "0"
4995: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsTransport").Caption = "0"
5000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTauxTransport").Caption = "0"
5005: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = "0"
5010: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = "0"
5015: Else
5020: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
5025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblNbrePersonne").Caption = rstProjSoum.Fields("NbrePersonne").Value
5030: Else
5035: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblNbrePersonne").Caption = "0"
5040: End If
			
5045: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
5050: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsHebergement").Caption = rstProjSoum.Fields("TempsHebergement").Value
5055: Else
5060: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsHebergement").Caption = "0"
5065: End If
			
5070: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
5075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement1").Caption = rstProjSoum.Fields("TauxHebergement1").Value
5080: Else
5085: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement1").Caption = "0"
5090: End If
			
5095: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
5100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement2").Caption = rstProjSoum.Fields("TauxHebergement2").Value
5105: Else
5110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement2").Caption = "0"
5115: End If
			
5120: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
5125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsRepas").Caption = rstProjSoum.Fields("TempsRepas").Value
5130: Else
5135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsRepas").Caption = "0"
5140: End If
			
5145: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
5150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxRepas").Caption = rstProjSoum.Fields("TauxRepas").Value
5155: Else
5160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxRepas").Caption = "0"
5165: End If
			
5170: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
5175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTransport").Caption = rstProjSoum.Fields("TempsTransport").Value
5180: Else
5185: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTransport").Caption = "0"
5190: End If
			
5195: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
5200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTransport").Caption = rstProjSoum.Fields("TauxTransport").Value
5205: Else
5210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTransport").Caption = "0"
5215: End If
			
5220: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
5225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = rstProjSoum.Fields("TempsUniteMobile").Value
5230: Else
5235: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = "0"
5240: End If
			
5245: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
5250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = rstProjSoum.Fields("TauxUniteMobile").Value
5255: Else
5260: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = "0"
5265: End If
5270: End If
		
5275: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblPrixEmballage").Caption = rstProjSoum.Fields("PrixEmballage").Value
5280: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblPrixManuel").Caption = rstProjSoum.Fields("Total_Manuel").Value
		
5285: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_temps"), ModuleMain.enumConvert.MODE_ARGENT)
5290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTotalPieceAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_piece"), ModuleMain.enumConvert.MODE_ARGENT)
5295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblProfit").Caption = Conversion_Renamed((rstProjSoum.Fields("profit").Value - 1) * 100, ModuleMain.enumConvert.MODE_POURCENT)
5300: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTotalProfit").Caption = Conversion_Renamed(rstProjSoum.Fields("total_profit"), ModuleMain.enumConvert.MODE_ARGENT)
5305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblImprevue").Caption = Conversion_Renamed(rstProjSoum.Fields("imprevue"), ModuleMain.enumConvert.MODE_POURCENT)
5310: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblImprevueAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_imprevue"), ModuleMain.enumConvert.MODE_ARGENT)
5315: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblCommission").Caption = Conversion_Renamed(rstProjSoum.Fields("commission"), ModuleMain.enumConvert.MODE_POURCENT)
5320: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblCommissionAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_commission"), ModuleMain.enumConvert.MODE_ARGENT)
		
5325: If m_eType = enumType.TYPE_PROJET Then
5330: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("PrixRéception").Value) Then
5335: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblPrixReception").Caption = Conversion_Renamed(rstProjSoum.Fields("PrixRéception"), ModuleMain.enumConvert.MODE_ARGENT)
5340: Else
5345: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblPrixReception").Caption = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
5350: End If
			
5355: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
5360: rstPrixSoum = New ADODB.Recordset
				
5365: Call rstPrixSoum.Open("SELECT PrixTotal FROM GRB_SoumissionMec WHERE IDSoumission = '" & rstProjSoum.Fields("IDSoumission").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
5370: If Not rstPrixSoum.EOF Then
5375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstPrixSoum.Fields("PrixTotal").Value) Then
5380: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed(rstPrixSoum.Fields("PrixTotal"), ModuleMain.enumConvert.MODE_ARGENT)
5385: Else
5390: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
5395: End If
5400: Else
5405: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
5410: End If
				
5415: Call rstPrixSoum.Close()
5420: 'UPGRADE_NOTE: Object rstPrixSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstPrixSoum = Nothing
5425: Else
5430: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
5435: End If
5440: End If
		
5445: If m_eType = enumType.TYPE_PROJET Then
5450: dblTotalHebergement = 0
5455: dblTotalRepas = 0
5460: dblTotalTransport = 0
5465: dblTotalUniteMobile = 0
5470: Else
5475: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TotalHebergement").Value) Then
5480: dblTotalHebergement = CDbl(rstProjSoum.Fields("TotalHebergement").Value)
5485: Else
5490: dblTotalHebergement = 0
5495: End If
			
5500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TotalRepas").Value) Then
5505: dblTotalRepas = CDbl(rstProjSoum.Fields("TotalRepas").Value)
5510: Else
5515: dblTotalRepas = 0
5520: End If
			
5525: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) And Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
5530: dblTotalTransport = CDbl(rstProjSoum.Fields("TempsTransport").Value) * CDbl(rstProjSoum.Fields("TauxTransport").Value)
5535: Else
5540: dblTotalTransport = 0
5545: End If
			
5550: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) And Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
5555: dblTotalUniteMobile = CDbl(rstProjSoum.Fields("TempsUniteMobile").Value) * CDbl(rstProjSoum.Fields("TauxUniteMobile").Value)
5560: Else
5565: dblTotalUniteMobile = 0
5570: End If
5575: End If
		
5580: dblPrixEmballage = CDbl(Replace(rstProjSoum.Fields("PrixEmballage").Value, ".", ","))
		
5585: dblTotalReste = dblTotalHebergement + dblTotalRepas + dblTotalTransport + dblTotalUniteMobile + dblPrixEmballage
		
5590: dblTotalAutre = dblTotalReste + CDbl(rstProjSoum.Fields("total_manuel").Value)
		
5595: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblAutre").Caption = Conversion_Renamed(CStr(dblTotalAutre), ModuleMain.enumConvert.MODE_ARGENT)
		
5600: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblGrandTotalAR").Caption = Conversion_Renamed(rstProjSoum.Fields("prixtotal"), ModuleMain.enumConvert.MODE_ARGENT)
		
5605: If rstProjSoum.Fields("MontantForfait").Value <> "" Then
5610: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("shpCadreForfait").Visible = True
5615: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreForfait").Visible = True
5620: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblForfait").Visible = True
			
5625: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreForfait").Caption = DR_SoumissionMec.Sections("Section5").Controls("lblTitreForfait").Caption & " ( " & rstProjSoum.Fields("InitialeForfait").Value & " )"
5630: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblForfait").Caption = rstProjSoum.Fields("MontantForfait").Value
5635: Else
5640: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("shpCadreForfait").Visible = False
5645: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreForfait").Visible = False
5650: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblForfait").Visible = False
5655: End If
		
		'************************************************************************************************
		'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
		'************************************************************************************************
		If bFlag = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateReception").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateReception").Visible = True
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateReception").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateReception").Visible = False
		End If
		'************************************************************************************************
		'FIN DE LA SECTION MODIFIÉ
		'************************************************************************************************
		
		'Affiche le rapport soumission
5660: ' DR_SoumissionMec.Orientation = rptOrientLandscape
		
5665: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_SoumissionMec.Show(VB6.FormShowConstants.Modal)
		
5670: Call rstImpProjSoum.Close()
5675: 'UPGRADE_NOTE: Object rstImpProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpProjSoum = Nothing
		
5680: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
5685: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
5690: Exit Sub
		
AfficherErreur: 
		
5695: Call AfficherErreur("frmProjSoumMec", "ImprimerProjSoum", Err, Erl())
	End Sub
	
	Private Sub ImprimerListePieces(ByVal rstProjSoum As ADODB.Recordset)
		Dim DR_Liste_piece As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de soumission
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpListePiece As ADODB.Recordset
25: Dim iCompteurPiece As Short
30: Dim sSousSection As String
35: Dim sSection As String
40: Dim sNoProjet As String
45: Dim sNoSoumission As String
50: Dim bAjouterSection As Boolean
55: Dim bAjouterSousSection As Boolean
60: Dim bAjouterPiece As Boolean
		
65: Call g_connData.Execute("DELETE * FROM GRB_impression_listepiece")
		
70: iCompteurPiece = 1
		
75: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
80: rstPiece = New ADODB.Recordset
		
85: If m_eType = enumType.TYPE_PROJET Then
90: sNoProjet = rstProjSoum.Fields("IDProjet").Value
			
95: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
100: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
105: End If
			
110: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' And Type = 'M' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
115: Else
120: sNoProjet = vbNullString
125: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
130: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoSoumission & "' And Type = 'M' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
135: End If
		
140: rstImpListePiece = New ADODB.Recordset
145: rstTemp = New ADODB.Recordset
		
150: rstImpListePiece.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
155: Do While Not rstPiece.EOF
160: If rstPiece.Fields("Visible").Value = True Then
165: bAjouterSection = True
170: bAjouterSousSection = True
175: bAjouterPiece = True
				
180: rstImpListePiece.Filter = ""
				
185: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_listepiece WHERE IDSection = '" & rstPiece.Fields("IDSection").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
190: If Not rstImpListePiece.EOF Then
195: bAjouterSection = False
					
200: Do While Not rstImpListePiece.EOF
205: If rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value Then
210: bAjouterSousSection = False
							
215: If rstPiece.Fields("NumItem").Value <> "Texte" And rstPiece.Fields("NumItem").Value <> "Text" Then
220: If rstImpListePiece.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value Then
225: bAjouterPiece = False
									
230: rstImpListePiece.Fields("Qté").Value = CDbl(Replace(rstImpListePiece.Fields("Qté").Value, ".", ",")) + CDbl(rstPiece.Fields("Qté").Value)
									
235: Call rstImpListePiece.Update()
									
240: If rstImpListePiece.Fields("Qté").Value = 0 Then
245: Call rstImpListePiece.Delete()
										
250: rstImpListePiece.Filter = "NomSousSection = '" & Replace(rstPiece.Fields("SousSection").Value, "'", "''") & "'"
										
255: If rstImpListePiece.RecordCount = 1 Then
260: Call rstImpListePiece.Delete()
											
265: rstImpListePiece.Filter = "IDSection = '" & rstPiece.Fields("IDSection").Value & "'"
											
270: If rstImpListePiece.RecordCount = 1 Then
275: Call rstImpListePiece.Delete()
280: End If
285: End If
290: End If
295: End If
300: Else
305: Exit Do
310: End If
315: End If
						
320: Call rstImpListePiece.MoveNext()
325: Loop 
330: End If
				
335: If bAjouterSection = True Then
340: If m_eLangage = enumLangage.ANGLAIS Then
345: sSection = "NomSectionEN"
350: Else
355: sSection = "NomSectionFR"
360: End If
					
365: Call rstTemp.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
370: Call rstImpListePiece.AddNew()
					
375: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
380: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
					
385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstTemp.Fields(sSection).Value) Then
390: rstImpListePiece.Fields("Section").Value = rstTemp.Fields(sSection).Value
395: Else
400: rstImpListePiece.Fields("Section").Value = " "
405: End If
					
410: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
415: Call rstImpListePiece.Update()
					
420: iCompteurPiece = iCompteurPiece + 1
					
425: Call rstTemp.Close()
430: End If
				
435: If bAjouterSousSection = True Then
440: sSousSection = rstPiece.Fields("SousSection").Value
					
445: If sSousSection = S_PAS_SOUS_SECTION Then
450: sSousSection = " "
455: End If
					
460: Call rstImpListePiece.AddNew()
					
465: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
470: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
475: rstImpListePiece.Fields("SousSection").Value = sSousSection
480: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
485: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
490: Call rstImpListePiece.Update()
					
495: iCompteurPiece = iCompteurPiece + 1
500: End If
				
505: If bAjouterPiece = True Then
					'ajoute une piece dans la liste de pièce
510: Call rstImpListePiece.AddNew()
					
515: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
520: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
525: rstImpListePiece.Fields("numitem").Value = rstPiece.Fields("numitem").Value
530: rstImpListePiece.Fields("qté").Value = rstPiece.Fields("qté").Value
					
535: If m_eLangage = enumLangage.ANGLAIS Then
540: rstImpListePiece.Fields("description").Value = rstPiece.Fields("DESC_EN").Value
545: Else
550: rstImpListePiece.Fields("description").Value = rstPiece.Fields("DESC_FR").Value
555: End If
					
560: rstImpListePiece.Fields("manufact").Value = rstPiece.Fields("manufact").Value
					
565: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
570: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
575: Call rstImpListePiece.Update()
					
580: iCompteurPiece = iCompteurPiece + 1
585: End If
				
590: Call rstImpListePiece.Close()
595: End If
			
			'prochaine enreg
600: Call rstPiece.MoveNext()
605: Loop 
		
610: Call rstPiece.Close()
615: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
		''''''''''''''''''''''''''''''''''''''''''''''''''
		' rapport liste piece, met dans l'ordre de ligne '
		''''''''''''''''''''''''''''''''''''''''''''''''''
620: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_Listepiece WHERE IDSoumission = '" & sNoSoumission & "' ORDER BY NoLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
625: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.DataSource = rstImpListePiece
		
630: Call TraduireImpressionListePiece()
		
		'Affiche la date
635: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section3").Controls("lbldate").Caption = ConvertDate(Today)
		
		'Affiche l'entête
640: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblsoumission").Caption = sNoSoumission
		
645: If m_eType = enumType.TYPE_PROJET Then
650: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("section4").Controls("lblprojet").Caption = rstProjSoum.Fields("IDProjet").Value
655: Else
660: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("section4").Controls("lblProjet").Caption = vbNullString
665: End If
		
670: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lbldescription").Caption = rstProjSoum.Fields("Description").Value
		
675: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
680: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblclient").Caption = rstTemp.Fields("NomClient").Value
		
685: Call rstTemp.Close()
		
690: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
695: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblcontact").Caption = rstTemp.Fields("NomContact").Value
		
700: Call rstTemp.Close()
		
		'Affiche le rapport liste des pieces
705: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Orientation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Orientation = MSDataReportLib.OrientationConstants.rptOrientPortrait
		
710: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_Liste_piece.Show(VB6.FormShowConstants.Modal)
		
715: Call rstImpListePiece.Close()
720: 'UPGRADE_NOTE: Object rstImpListePiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpListePiece = Nothing
		
725: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
730: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
735: Exit Sub
		
AfficherErreur: 
		
740: Call AfficherErreur("frmProjSoumMec", "ImprimerListePieces", Err, Erl())
	End Sub
	
	Private Sub CalculerTempsReelsImpression(ByVal sNoProjet As String)
		Dim DR_SoumissionMec As Object
		
5: On Error GoTo AfficherErreur
		
10: Dim rstTotal As ADODB.Recordset
15: Dim sDateDebut As String
20: Dim sDateFin As String
25: Dim sTotal As String
30: Dim sFilterNoProjet As String
		
35: If VB.Right(sNoProjet, 2) = "99" Then
40: sFilterNoProjet = "LEFT(NoProjet, 6) = '" & VB.Left(sNoProjet, 6) & "'"
45: Else
50: sFilterNoProjet = "NoProjet = '" & sNoProjet & "'"
55: End If
		
60: rstTotal = New ADODB.Recordset
		
65: sDateDebut = "TIMESERIAL(Left(GRB_Punch.HeureDébut,2),RIGHT(GRB_Punch.HeureDébut,2),0)"
		
70: sDateFin = "TIMESERIAL(Left(GRB_Punch.HeureFin,2),RIGHT(GRB_Punch.HeureFin,2),0)"
		
75: sTotal = "(SUM(" & sDateFin & " - " & sDateDebut & ")* 24) As Total"
		
80: Call rstTotal.Open("SELECT Type, " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null GROUP BY Type", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
85: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinReel").Caption = "0"
90: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeReel").Caption = "0"
95: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageReel").Caption = "0"
100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureReel").Caption = "0"
105: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageReel").Caption = "0"
110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureReel").Caption = "0"
115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestReel").Caption = "0"
120: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationReel").Caption = "0"
125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationReel").Caption = "0"
130: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionReel").Caption = "0"
135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingReel").Caption = "0"
		
140: Do While Not rstTotal.EOF
145: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstTotal.Fields("Total").Value) Then
150: Select Case rstTotal.Fields("Type").Value
					Case "Dessin"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
155: Case "Coupe"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
160: Case "Machinage"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
165: Case "Soudure"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
170: Case "Assemblage"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
175: Case "Peinture"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
180: Case "Test"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
185: Case "Installation"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
190: Case "Formation"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
195: Case "Gestion"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
200: Case "Shipping"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
205: End Select
210: End If
			
215: Call rstTotal.MoveNext()
220: Loop 
		
225: Call rstTotal.Close()
		
230: Call rstTotal.Open("SELECT " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
235: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstTotal.Fields("Total").Value) Then
240: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
245: Else
250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHReel").Caption = "0"
255: End If
		
260: Call rstTotal.Close()
265: 'UPGRADE_NOTE: Object rstTotal may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTotal = Nothing
		
270: Exit Sub
		
AfficherErreur: 
		
275: Call AfficherErreur("frmProjSoumMec", "CalculerTempsReels", Err, Erl())
	End Sub
	
	Private Sub TraduireImpressionListePiece()
		Dim DR_Liste_piece As Object
		
5: On Error GoTo AfficherErreur
		
10: If m_eLangage = enumLangage.ANGLAIS Then
15: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreProjet").Caption = "Project:"
20: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreSoumission").Caption = "Quote:"
			
25: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qty"
30: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreNoItem").Caption = "Item No."
35: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturer"
40: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreID").Caption = "ID #"
			
45: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section3").Controls("lblNoPage").Caption = "Page %p of %P"
50: Else
55: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreProjet").Caption = "Projet:"
60: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreSoumission").Caption = "Soumission:"
			
65: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qté"
70: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreNoItem").Caption = "No. Item"
75: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturier"
80: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreID").Caption = "# ID"
			
85: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section3").Controls("lblNoPage").Caption = "Page %p de %P"
90: End If
		
95: Exit Sub
		
AfficherErreur: 
		
100: Call AfficherErreur("frmProjSoumMec", "TraduireImpressionListePiece", Err, Erl())
	End Sub
	
	Private Sub TraduireImpressionSoumission()
		Dim DR_SoumissionMec As Object
		
5: On Error GoTo AfficherErreur
		
10: If m_eLangage = enumLangage.ANGLAIS Then
15: If m_eType = enumType.TYPE_PROJET Then
20: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Caption = "Mechanical Project"
25: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section2").Controls("lblGrosTitre").Caption = "Mechanical project"
30: Else
35: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Caption = "Mechanical Quote"
40: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section2").Controls("lblGrosTitre").Caption = "Mechanical quote"
45: End If
			
50: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreProjet").Caption = "Project:"
55: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreSoumission").Caption = "Quote:"
60: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreClient").Caption = "Client:"
65: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreContact").Caption = "Contact:"
			
			'************************************************************************************************
			'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
			'************************************************************************************************
			
70: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qty"
75: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreNoItem").Caption = "Item No."
80: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreDescription").Caption = "Description"
85: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturer"
90: 'DR_SoumissionMec.Sections("Section2").Controls("lblTitrePrixListe").Caption = "Listed price"
95: 'DR_SoumissionMec.Sections("Section2").Controls("lblTitreEscompte").Caption = "Discount"
100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreCoutant").Caption = "Cost"
105: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreFournisseur").Caption = "Supplier"
110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreTotal").Caption = "Total"
			
			'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
			'****************************************************************************************
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateCommande").Caption = "Order Date"
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateReception").Caption = "Reception Date"
			'****************************************************************************************
			
115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreMachinage").Caption = "Machining :"
120: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreCoupePreparation").Caption = "Cutting and preparing :"
125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreAssemblageSoudure").Caption = "Cutting, welding and grinding :"
130: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreAssemblageSysteme").Caption = "System assembling :"
135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePeintureFinition").Caption = "Painting and finishing :"
140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTestFinal").Caption = "Final test :"
145: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreGestion").Caption = "Project management :"
150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreShipping").Caption = "Shipping :"
155: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreConceptionDessin").Caption = "Conception and drafting :"
160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreFormation").Caption = "Training :"
165: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreInstallation").Caption = "Installation :"
170: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreNbrePersonne").Caption = "Number of persons :"
175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreHebergement1").Caption = "Lodging (1 bed) :"
180: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreHebergement2").Caption = "Lodging (2 beds) :"
185: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreRepas").Caption = "Meals :"
190: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTransportDeplacement").Caption = "Workers freight :"
195: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTransportUniteMobile").Caption = "Mobile unit freight :"
200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTransportEmballage").Caption = "Freight / Packing :"
205: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTauxHoraire").Caption = "Rate / Hours"
210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTemps").Caption = "Time"
215: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure1").Caption = "Hours"
220: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure2").Caption = "Hours"
225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure3").Caption = "Hours"
230: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure4").Caption = "Hours"
235: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure5").Caption = "Hours"
240: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure6").Caption = "Hours"
245: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure7").Caption = "Hours"
250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure8").Caption = "Hours"
255: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure9").Caption = "Hours"
260: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure10").Caption = "Hours"
265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure11").Caption = "Hours"
270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure12").Caption = "Hours"
285: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblJour1").Caption = "Days"
290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblJour2").Caption = "Days"
295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTotalTemps").Caption = "Time total:"
300: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTotalPiece").Caption = "Parts total:"
305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreImprevue").Caption = "Unforeseen:"
310: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreAutre").Caption = "Other:"
315: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreGrandTotal").Caption = "Final price:"
			
320: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section3").Controls("lblNoPage").Caption = "Page %p of %P"
325: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixReception").Caption = "Receiving up to date"
330: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixSoumission").Caption = "Quote Price"
335: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreForfait").Caption = "Package Deal"
340: Else
345: If m_eType = enumType.TYPE_PROJET Then
350: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Caption = "Projet Mécanique"
355: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section2").Controls("lblGrosTitre").Caption = "Projet mécanique"
360: Else
365: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Caption = "Soumission Mécanique"
370: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section2").Controls("lblGrosTitre").Caption = "Soumission mécanique"
375: End If
			
380: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreProjet").Caption = "Projet:"
385: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreSoumission").Caption = "Soumission:"
390: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreClient").Caption = "Client:"
395: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreContact").Caption = "Contact:"
			
400: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qté"
405: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreNoItem").Caption = "No. item"
410: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreDescription").Caption = "Description"
415: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturier"
420: 'DR_SoumissionMec.Sections("Section2").Controls("lblTitrePrixListe").Caption = "Prix de liste"
425: 'DR_SoumissionMec.Sections("Section2").Controls("lblTitreEscompte").Caption = "Escompte"
430: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreCoutant").Caption = "Coûtant"
435: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreFournisseur").Caption = "Fournisseur"
440: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lblTitreTotal").Caption = "Total"
			
			'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
			'****************************************************************************************
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateCommande").Caption = "Date commandé"
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateReception").Caption = "Date reçu"
			'****************************************************************************************
			
			'************************************************************************************************
			'FIN DE LA SECTION DE MODIFICATION
			'************************************************************************************************
			
445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreMachinage").Caption = "Machinage :"
450: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreCoupePreparation").Caption = "Coupe et préparation :"
455: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreAssemblageSoudure").Caption = "Soudure et meulage :"
460: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreAssemblageSysteme").Caption = "Assemblage des systèmes :"
465: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePeintureFinition").Caption = "Peinture et finition :"
470: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTestFinal").Caption = "Tests finaux :"
475: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreGestion").Caption = "Gestion du projet :"
480: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreShipping").Caption = "Expédition :"
485: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreConceptionDessin").Caption = "Conception et dessin :"
490: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreFormation").Caption = "Formation du personnel :"
495: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreInstallation").Caption = "Installation :"
500: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreNbrePersonne").Caption = "Nombre de personnes :"
505: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreHebergement1").Caption = "Hébergement (1 lit):"
510: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreHebergement2").Caption = "Hébergement (2 lits) :"
515: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreRepas").Caption = "Repas :"
520: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTransportDeplacement").Caption = "Transport / Déplacement :"
525: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTransportUniteMobile").Caption = "Transport de l'unité mobile :"
530: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTransportEmballage").Caption = "Transport / Emballage :"
535: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTauxHoraire").Caption = "Taux horaire"
540: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTemps").Caption = "Temps"
545: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure1").Caption = "Heures"
550: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure2").Caption = "Heures"
555: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure3").Caption = "Heures"
560: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure4").Caption = "Heures"
565: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure5").Caption = "Heures"
570: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure6").Caption = "Heures"
575: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure7").Caption = "Heures"
580: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure8").Caption = "Heures"
585: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure9").Caption = "Heures"
590: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure10").Caption = "Heures"
595: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure11").Caption = "Heures"
600: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblHeure12").Caption = "Heures"
615: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblJour1").Caption = "Jours"
620: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblJour2").Caption = "Jours"
625: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTotalTemps").Caption = "Temps total:"
630: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreTotalPiece").Caption = "Total des pièces:"
635: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreImprevue").Caption = "Imprévue:"
640: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreAutre").Caption = "Autre:"
645: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreGrandTotal").Caption = "Grand total:"
			
650: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section3").Controls("lblNoPage").Caption = "Page %p de %P"
655: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixReception").Caption = "Réception jusqu'à maintenant"
660: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixSoumission").Caption = "$ Soumission"
665: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTitreForfait").Caption = "Forfait"
670: End If
		
675: Exit Sub
		
AfficherErreur: 
		
680: Call AfficherErreur("frmProjSoumMec", "TraduireImpressionSoumission", Err, Erl())
	End Sub
	
	Private Sub cmdModifier_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdModifier.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: m_collQteSupp = New Collection
25: m_collDateSupp = New Collection
30: m_collHeureSupp = New Collection
35: m_collNoItemSupp = New Collection
		
40: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
45: If m_eType = enumType.TYPE_PROJET Then
50: Call MsgBox("Ce projet ne peut pas être modifié!", MsgBoxStyle.OKOnly, "Erreur")
55: Else
60: Call MsgBox("Cette soumission ne peut pas être modifiée!", MsgBoxStyle.OKOnly, "Erreur")
65: End If
			
70: Exit Sub
75: End If
		
80: rstProjSoum = New ADODB.Recordset
		
85: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
90: If rstProjSoum.Fields("Ouvert").Value = False Or rstProjSoum.Fields("Verrouillé").Value = True Then
95: If rstProjSoum.Fields("Ouvert").Value = False Then
100: If m_eType = enumType.TYPE_PROJET Then
105: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
110: Else
115: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly, "Erreur")
120: End If
125: Else
130: If m_eType = enumType.TYPE_PROJET Then
135: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
140: Else
145: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly, "Erreur")
150: End If
155: End If
			
160: Call rstProjSoum.Close()
165: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
170: Exit Sub
175: End If
		
180: Call rstProjSoum.Close()
185: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
190: If VerifierSiOuvert(sUser) = False Then
			'Modifier une soumission
195: If cmbProjSoum.SelectedIndex > -1 Then
200: If m_eType = enumType.TYPE_SOUMISSION Then
205: If VerifierSiDejaProjet = True Then
210: Call MsgBox("Vous ne pouvez pas modifier cette soumission, le projet a déjà été crée!", MsgBoxStyle.OKOnly, "Erreur")
						
215: Exit Sub
220: End If
225: End If
				
230: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				
				'Débarre les champs
235: Call BarrerChamps(False)
				
				'Pour pouvoir afficher le dernier enregistrement affiché quand la personne va
				'enregistrer ou annuler
240: m_sAncienProjSoum = txtNoProjSoum.Text
				
245: m_bModeAjout = False
250: m_bModeAffichage = False
				
				'Rapetisse le listview de la soumission pour afficher le lvwPiece
255: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
260: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
				
265: Call RemplirProjSoum()
				
270: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
				
275: Call UpdateOrdre()
				
280: Call CalculerPrix()
				
285: Call OuvrirProjSoum(True)
				
290: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
295: End If
300: Else
305: If m_eType = enumType.TYPE_PROJET Then
310: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
315: Else
320: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
325: End If
330: End If
		
335: Exit Sub
		
AfficherErreur: 
		
340: Call AfficherErreur("frmProjSoumMec", "cmdModifier_Click", Err, Erl())
	End Sub
	
	Private Sub InitialiserNouveauxTaux()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstConfig As ADODB.Recordset
		
15: rstConfig = New ADODB.Recordset
		
20: Call rstConfig.Open("SELECT TauxDessinMec, TauxCoupe, TauxMachinage, TauxSoudure, TauxAssemblageMec, TauxPeinture, TauxTestMec, TauxFormationMec, TauxInstallationMec, TauxGestionProjetsMec, TauxShippingMec, Hebergement1, Hebergement2, Repas, Standard, UniteMobile FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
25: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxDessinMec").Value) Then
30: m_sTauxDessin = rstConfig.Fields("TauxDessinMec").Value
35: Else
40: m_sTauxDessin = "0"
45: End If
		
50: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxCoupe").Value) Then
55: m_sTauxCoupe = rstConfig.Fields("TauxCoupe").Value
60: Else
65: m_sTauxCoupe = "0"
70: End If
		
75: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxMachinage").Value) Then
80: m_sTauxMachinage = rstConfig.Fields("TauxMachinage").Value
85: Else
90: m_sTauxMachinage = "0"
95: End If
		
100: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxSoudure").Value) Then
105: m_sTauxSoudure = rstConfig.Fields("TauxSoudure").Value
110: Else
115: m_sTauxSoudure = "0"
120: End If
		
125: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxAssemblageMec").Value) Then
130: m_sTauxAssemblage = rstConfig.Fields("TauxAssemblageMec").Value
135: Else
140: m_sTauxAssemblage = "0"
145: End If
		
150: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxPeinture").Value) Then
155: m_sTauxPeinture = rstConfig.Fields("TauxPeinture").Value
160: Else
165: m_sTauxPeinture = "0"
170: End If
		
175: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxTestMec").Value) Then
180: m_sTauxTest = rstConfig.Fields("TauxTestMec").Value
185: Else
190: m_sTauxTest = "0"
195: End If
		
200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxInstallationMec").Value) Then
205: m_sTauxInstallation = rstConfig.Fields("TauxInstallationMec").Value
210: Else
215: m_sTauxInstallation = "0"
220: End If
		
225: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxFormationMec").Value) Then
230: m_sTauxFormation = rstConfig.Fields("TauxFormationMec").Value
235: Else
240: m_sTauxFormation = "0"
245: End If
		
250: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxGestionProjetsMec").Value) Then
255: m_sTauxGestion = rstConfig.Fields("TauxGestionProjetsMec").Value
260: Else
265: m_sTauxGestion = "0"
270: End If
		
275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxShippingMec").Value) Then
280: m_sTauxShipping = rstConfig.Fields("TauxShippingMec").Value
285: Else
290: m_sTauxShipping = "0"
295: End If
		
300: If m_eType = enumType.TYPE_PROJET Then
305: m_sTauxHebergement1 = "0"
310: m_sTauxHebergement2 = "0"
315: m_sTauxRepas = "0"
320: m_sTauxTransport = "0"
325: m_sTauxUniteMobile = "0"
330: Else
335: m_sTauxHebergement1 = rstConfig.Fields("Hebergement1").Value
340: m_sTauxHebergement2 = rstConfig.Fields("Hebergement2").Value
345: m_sTauxRepas = rstConfig.Fields("Repas").Value
350: m_sTauxTransport = rstConfig.Fields("Standard").Value
355: m_sTauxUniteMobile = rstConfig.Fields("UniteMobile").Value
360: End If
		
365: Call rstConfig.Close()
370: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
375: Exit Sub
		
AfficherErreur: 
		
380: Call AfficherErreur("frmProjSoumMec", "InitialiserNouveauxTaux", Err, Erl())
	End Sub
	
	Private Sub cmdsupprimer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdsupprimer.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim iReponse As Short
25: Dim sSoumission As String
30: Dim sUser As String
35: Dim iExtension As Short
		
		'S'il y a des enregistrements
40: If cmbProjSoum.Items.Count > 0 Then
45: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
50: If m_eType = enumType.TYPE_PROJET Then
55: Call MsgBox("Vous ne pouvez pas supprimer ce projet!", MsgBoxStyle.OKOnly, "Erreur")
60: Else
65: Call MsgBox("Vous ne pouvez pas supprimer cette soumission!", MsgBoxStyle.OKOnly, "Erreur")
70: End If
				
75: Exit Sub
80: End If
			
85: rstProjSoum = New ADODB.Recordset
			
90: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
95: If rstProjSoum.Fields("Ouvert").Value = False Or rstProjSoum.Fields("Verrouillé").Value = True Then
100: If rstProjSoum.Fields("Ouvert").Value = False Then
105: If m_eType = enumType.TYPE_PROJET Then
110: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
115: Else
120: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly, "Erreur")
125: End If
130: Else
135: If m_eType = enumType.TYPE_PROJET Then
140: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
145: Else
150: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly, "Erreur")
155: End If
160: End If
				
165: Call rstProjSoum.Close()
170: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
175: Exit Sub
180: End If
			
185: Call rstProjSoum.Close()
190: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
195: If m_eType = enumType.TYPE_SOUMISSION Then
200: If VerifierSiDejaProjet = True Then
205: Call MsgBox("Vous ne pouvez pas supprimer cette soumission, le projet a déjà été crée!", MsgBoxStyle.OKOnly, "Erreur")
					
210: Exit Sub
215: End If
220: End If
			
225: If VerifierSiOuvert(sUser) = False Then
				'Valider le choix
230: If m_eType = enumType.TYPE_PROJET Then
235: iReponse = MsgBox("Voulez-vous vraiment EFFACER LE PROJET " & txtNoProjSoum.Text & "?", MsgBoxStyle.YesNo)
					
240: If iReponse = MsgBoxResult.Yes Then
245: Call frmValiderSuppression.Afficher(True, txtNoProjSoum.Text, Me)
						
250: If m_bValide = True Then
255: iReponse = MsgBoxResult.Yes
260: Else
265: iReponse = MsgBoxResult.No
270: End If
275: End If
280: Else
285: iReponse = MsgBox("Voulez-vous vraiment EFFACER LA SOUMISSION " & txtNoProjSoum.Text & "?", MsgBoxStyle.YesNo)
					
290: If iReponse = MsgBoxResult.Yes Then
295: Call frmValiderSuppression.Afficher(False, txtNoProjSoum.Text, Me)
						
300: If m_bValide = True Then
305: iReponse = MsgBoxResult.Yes
310: Else
315: iReponse = MsgBoxResult.No
320: End If
325: End If
330: End If
				
				'S'il veut vraiment effacer
335: If iReponse = MsgBoxResult.Yes Then
					'Si c'est un projet
340: If m_eType = enumType.TYPE_PROJET Then
345: rstProjet = New ADODB.Recordset
						
350: Call rstProjet.Open("SELECT IDSoumission FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
						
355: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
						If Not IsDbNull(rstProjet.Fields("IDSoumission").Value) Then
360: sSoumission = rstProjet.Fields("IDSoumission").Value
365: Else
370: sSoumission = vbNullString
375: End If
						
380: Call rstProjet.Close()
385: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjet = Nothing
						
						'Efface les Pièces
390: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Type = 'M'")
						
395: If IsNumeric(VB.Right(txtNoProjSoum.Text, 2)) Then
400: iExtension = CShort(VB.Right(txtNoProjSoum.Text, 2))
405: Else
410: iExtension = 0
415: End If
						
420: If (iExtension >= 60 And iExtension <= 79) Or (iExtension >= 80 And iExtension <= 98) Then
425: rstProjSoum = New ADODB.Recordset
							
430: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
							
435: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & rstProjSoum.Fields("LiaisonChargeable").Value & "' AND Provenance = '" & iExtension & "'")
							
440: Call CalculerTotalRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & rstProjSoum.Fields("LiaisonChargeable").Value)
							
445: Call rstProjSoum.Close()
450: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
							rstProjSoum = Nothing
455: End If
						
						'Efface les modifications
460: Call g_connData.Execute("DELETE * FROM GRB_Projet_Modif WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Type = 'M'")
						
						'Efface le projet
465: Call g_connData.Execute("DELETE * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'")
						
						'Efface le projet dans la table GRB_ProjSoum
470: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'")
						
475: rstProjSoum = New ADODB.Recordset
						
480: Call rstProjSoum.Open("SELECT Ouvert FROM GRB_ProjSoum WHERE IDProjSoum = '" & sSoumission & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
485: If Not rstProjSoum.EOF Then
490: rstProjSoum.Fields("Ouvert").Value = True
							
495: Call rstProjSoum.Update()
500: End If
						
505: Call rstProjSoum.Close()
510: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
515: Else
						'Efface les pièces
520: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "' AND Type = 'M'")
						
						'Efface les modifications
525: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Modif WHERE IDSoumission = '" & txtNoProjSoum.Text & "' AND Type = 'M'")
						
						'Efface la soumission
530: Call g_connData.Execute("DELETE * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'")
						
						'Efface la soumission dans la table GRB_ProjSoum
535: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'")
540: End If
					
545: If m_eType = enumType.TYPE_PROJET Then
550: Call RecreerProjetCumulatif()
555: Else
560: Call RecreerSoumissionCumulatif()
565: End If
					
					'Affiche la premiere soumission
570: Call AfficherProjSoum(vbNullString)
575: End If
580: Else
585: If m_eType = enumType.TYPE_PROJET Then
590: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
595: Else
600: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
605: End If
610: End If
615: End If
		
620: Exit Sub
		
AfficherErreur: 
		
625: Call AfficherErreur("frmProjSoumMec", "cmdSupprimer_Click", Err, Erl())
	End Sub
	
	Private Sub FrmProjSoumMec_Load(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles MyBase.Load
		
5: On Error GoTo AfficherErreur
		
10: Call frmChoixProjSoum.Close()
		
15: m_eLangage = enumLangage.FRANCAIS
		
20: cmdAnglaisFrancais.Text = "Anglais"
		
		'Initialise le tri à PIECE_GRB
25: cmbTri.SelectedIndex = I_CMB_PIECE
		
		'Donne accès aux boutons selon le groupe
30: Call ActiverBoutonsGroupe()
		
		'Rempli le combo des clients
35: Call RemplirComboClients(vbNullString)
		
		'Rempli le combo des contacts
40: Call RemplirComboSections()
		
		'Rempli le combo des catégories de pièce
45: Call RemplirComboCategoriesPieces()
		
50: cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT
		
55: If m_eType = enumType.TYPE_PROJET Then
60: cmbChoix.SelectedIndex = I_IDX_PROJET
65: Else
70: cmbChoix.SelectedIndex = I_IDX_SOUMISSION
75: End If
		
80: Exit Sub
		
AfficherErreur: 
		
85: Call AfficherErreur("frmProjSoumMec", "Form_Load", Err, Erl())
	End Sub
	
	Private Sub RemplirColonnes()
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour afficher les colonnes selon le groupe de sécurité.
		
		'Ceux qui n'ont pas le droit de modifier les soumissions ou les projets, n'ont pas
		'le droit de voir les prix, donc il faut cacher les colonnes
10: Dim bModif As Boolean
15: Dim bCacherPrix As Boolean
		
		'Si le type d'affichage est "Projet"
20: If m_eType = enumType.TYPE_PROJET Then
			'Si l'utilisateur n'a pas le droit de modification sur les projets
25: If m_bModifProj = False Then
				'On cache les prix
30: bCacherPrix = True
35: End If
40: Else
			'Si l'utilisateur n'a pas le droit de modification sur les soumissions
45: If m_bModifSoum = False Then
				'On cache les prix
50: bCacherPrix = True
55: End If
60: End If
		
		'Si on cache les prix
65: If bCacherPrix = True Then
70: m_bDroitPrix = False
			
			'Si les bonnes colonnes sont déjà toutes affichées
75: If lvwSoumission.Columns.Count = 9 Then
80: Exit Sub
85: End If
90: Else
95: m_bDroitPrix = True
			
			'Si les bonnes colonnes sont déjà toutes affichées
100: If lvwSoumission.Columns.Count = 15 Then
105: Exit Sub
110: End If
115: End If
		
		'Il faut enlever les colonnes avant d'en ajouter d'autres
120: Call lvwSoumission.Columns.Clear()
		
125: Call lvwSoumission.Columns.Add("", "Qté", CInt(VB6.TwipsToPixelsX(650.1418)))
130: Call lvwSoumission.Columns.Add("", "No. Item", CInt(VB6.TwipsToPixelsX(2200)))
135: Call lvwSoumission.Columns.Add("", "Description", CInt(VB6.TwipsToPixelsX(3809.746)))
140: Call lvwSoumission.Columns.Add("", "Manufacturier", CInt(VB6.TwipsToPixelsX(1154.8348)))
		
145: If bCacherPrix = False Then
150: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Prix listé", CInt(VB6.TwipsToPixelsX(920.1261)), vbRightJustify)
155: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Escompte", CInt(VB6.TwipsToPixelsX(884.9765)), vbRightJustify)
160: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Prix net", CInt(VB6.TwipsToPixelsX(920.1261)), vbRightJustify)
165: End If
		
170: Call lvwSoumission.Columns.Add("", "Distributeur", CInt(VB6.TwipsToPixelsX(1005.1655)))
		
175: If bCacherPrix = False Then
180: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("TOTAL", CInt(VB6.TwipsToPixelsX(1099.8426)), vbRightJustify)
185: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Profit", CInt(VB6.TwipsToPixelsX(920.1261)), vbRightJustify)
190: End If
		
195: Call lvwSoumission.Columns.Add("", "Commentaire", CInt(VB6.TwipsToPixelsX(1000)))
		
200: If m_eType = enumType.TYPE_PROJET Then
205: If bCacherPrix = False Then
210: Call lvwSoumission.Columns.Add("", "Facturation", CInt(VB6.TwipsToPixelsX(1440)))
215: End If
			
220: Call lvwSoumission.Columns.Add("", "Date Commande", CInt(VB6.TwipsToPixelsX(1440)))
225: Call lvwSoumission.Columns.Add("", "Date Requise", CInt(VB6.TwipsToPixelsX(1440)))
230: Call lvwSoumission.Columns.Add("", "Commandé par", CInt(VB6.TwipsToPixelsX(1440)))
235: Call lvwSoumission.Columns.Add("", "No Séquentiel", CInt(VB6.TwipsToPixelsX(1440)))
240: End If
		
245: Call lvwSoumission.Columns.Add("", "Provenance", CInt(VB6.TwipsToPixelsX(1440)))
		
250: Exit Sub
		
AfficherErreur: 
		
255: Call AfficherErreur("frmProjSoumMec", "RemplirColonnes", Err, Erl())
	End Sub
	
	Private Sub BarrerChamps(ByVal bBarrer As Boolean)
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui barre ou débarre les champs d'après la variable bBarrer
10: txtDescription.ReadOnly = bBarrer
15: txtNbreManuel.ReadOnly = bBarrer
20: txtPrixManuel.ReadOnly = bBarrer
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "BarrerChamps", Err, Erl())
	End Sub
	
	Private Sub ViderChamps()
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui initialise les champs
10: txtClient.Text = vbNullString
15: txtcontact.Text = vbNullString
20: txtDescription.Text = vbNullString
25: txtNbreManuel.Text = CStr(0)
30: txtPrixManuel.Text = CStr(0)
35: txtPrixTotal.Text = CStr(0)
40: txtProfit.Text = CStr(0)
45: txtPrixReception.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
50: txtPrixSoumission.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
55: txtCommission.Text = CStr(0)
60: txtTotalPieces.Text = CStr(0)
65: txtTotalTemps.Text = CStr(0)
70: txtImprevus.Text = CStr(0)
75: txtNoSoumission.Text = vbNullString
80: txtCheminPhotos.Text = vbNullString
85: txtForfait.Text = vbNullString
90: lblForfaitInitiale.Text = vbNullString
		
95: cmbclient.SelectedIndex = -1
		
100: Call lvwSoumission.Items.Clear()
		
105: Exit Sub
		
AfficherErreur: 
		
110: Call AfficherErreur("frmProjSoumMec", "ViderChamps", Err, Erl())
	End Sub
	
	Private Sub RemplirComboProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Rempli le combo des soumissions
10: Dim rstProjSoum As ADODB.Recordset
		
		'Il faut vider le combo avant de le remplir
15: Call cmbProjSoum.Items.Clear()
		
20: rstProjSoum = New ADODB.Recordset
		
		'Ouvre le recordset selon le type
25: If m_eType = enumType.TYPE_PROJET Then
30: If cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT Then
35: Call rstProjSoum.Open("SELECT IDProjet FROM GRB_ProjetMec INNER JOIN GRB_ProjSoum ON GRB_ProjetMec.IDProjet = GRB_ProjSoum.IDProjSoum WHERE Ouvert = True ORDER BY IDProjet DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
40: Else
45: Call rstProjSoum.Open("SELECT IDProjet FROM GRB_ProjetMec ORDER BY IDProjet DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: End If
55: Else
60: If cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT Then
65: Call rstProjSoum.Open("SELECT IDSoumission FROM GRB_SoumissionMec INNER JOIN GRB_ProjSoum ON GRB_SoumissionMec.IDSoumission = GRB_ProjSoum.IDProjSoum WHERE Ouvert = True ORDER BY IDSoumission DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
70: Else
75: Call rstProjSoum.Open("SELECT IDSoumission FROM GRB_SoumissionMec ORDER BY IDSoumission DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
80: End If
85: End If
		
		'Tant que ce n'est pas la fin des enregistrements
90: Do While Not rstProjSoum.EOF
			'On met le numéro de la soumission dans le combo des soumissions
95: If m_eType = enumType.TYPE_PROJET Then
100: Call cmbProjSoum.Items.Add(rstProjSoum.Fields("IDProjet").Value)
105: Else
110: Call cmbProjSoum.Items.Add(rstProjSoum.Fields("IDSoumission").Value)
115: End If
			
120: Call rstProjSoum.MoveNext()
125: Loop 
		
130: Call rstProjSoum.Close()
135: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'Si le combo n'est pas vide, on sélectionne l'item voulu ou le premier
140: If cmbProjSoum.Items.Count > 0 Then
			'Si il y a un numéro de projet
145: If sNoProjSoum <> vbNullString Then
				'On le sélectionne dans le combo
150: Call RechercherProjSoum(sNoProjSoum)
155: Else
				'Sinon, on sélectionne le premier
160: cmbProjSoum.SelectedIndex = 0
165: End If
170: End If
		
175: Exit Sub
		
AfficherErreur: 
		
180: Call AfficherErreur("frmProjSoumMec", "RemplirComboProjSoum", Err, Erl())
	End Sub
	
	Private Sub CalculerPrixReel(ByVal sNoItem As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPieceFRS As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim sPrixCalcul As String
25: Dim sTauxUSA As String
30: Dim sTauxSPA As String
		
35: rstConfig = New ADODB.Recordset
		
40: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
45: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
50: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
55: Call rstConfig.Close()
60: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
65: rstPieceFRS = New ADODB.Recordset
		
70: Call rstPieceFRS.Open("SELECT PrixReel, PRIX_NET, PRIX_SP, DeviseMonétaire FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(sNoItem, "'", "''") & "' AND Type = 'M'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
75: Do While Not rstPieceFRS.EOF
80: If rstPieceFRS.Fields("PRIX_NET").Value <> vbNullString Then
85: sPrixCalcul = Replace(rstPieceFRS.Fields("PRIX_NET").Value, ".", ",")
90: Else
95: sPrixCalcul = Replace(rstPieceFRS.Fields("PRIX_SP").Value, ".", ",")
100: End If
			
105: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
110: rstPieceFRS.Fields("PrixReel").Value = Conversion_Renamed(CStr(System.Math.Round(CDbl(sPrixCalcul) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_DECIMAL, 4)
115: Else
120: If rstPieceFRS.Fields("DeviseMonétaire").Value = "SPA" Then
125: rstPieceFRS.Fields("PrixReel").Value = Conversion_Renamed(CStr(System.Math.Round(CDbl(sPrixCalcul) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_DECIMAL, 4)
130: Else
135: rstPieceFRS.Fields("PrixReel").Value = Conversion_Renamed(sPrixCalcul, ModuleMain.enumConvert.MODE_DECIMAL, 4)
140: End If
145: End If
			
150: Call rstPieceFRS.Update()
			
155: Call rstPieceFRS.MoveNext()
160: Loop 
		
165: Call rstPieceFRS.Close()
170: 'UPGRADE_NOTE: Object rstPieceFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceFRS = Nothing
		
175: Exit Sub
		
AfficherErreur: 
		
180: Call AfficherErreur("frmProjSoumMec", "CalculerPrixReel", Err, Erl())
	End Sub
	
	Private Sub RemplirComboFournisseur()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstFRS As ADODB.Recordset
		
		'Il faut vider le combo avant de le remplir
15: Call cmbfrs.Items.Clear()
		
20: rstFRS = New ADODB.Recordset
		
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call rstFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Replace(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' ORDER BY NomFournisseur", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Tant que ce n'est pas la fin des enregistrements
30: Do While Not rstFRS.EOF
35: Call cmbfrs.Items.Add(rstFRS.Fields("NomFournisseur").Value)
			
40: 'UPGRADE_ISSUE: ComboBox property cmbfrs.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
			VB6.SetItemData(cmbfrs, cmbfrs.NewIndex, rstFRS.Fields("IDFRS").Value)
			
45: Call rstFRS.MoveNext()
50: Loop 
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumMec", "RemplirComboFournisseur", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewFournisseur()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le listview des distributeur pour une pièce choisie
10: Dim rstPieceFRS As ADODB.Recordset
15: Dim rstContact As ADODB.Recordset
20: Dim rstFRS As ADODB.Recordset
25: Dim rstInv As ADODB.Recordset
30: Dim itmFRS As System.Windows.Forms.ListViewItem
35: Dim iCompteur As Short
40: Dim iNoClient As Short
45: Dim bAjouterDP As Boolean
50: Dim sDevise As String
55: Dim lColor As Integer
		
60: rstPieceFRS = New ADODB.Recordset
65: rstContact = New ADODB.Recordset
70: rstFRS = New ADODB.Recordset
		
		'Vide le lister
75: Call lvwfournisseur.Items.Clear()
		
80: If m_bPieceInutile = True Or m_bChangementFRS = True Then
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call CalculerPrixReel(Trim(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text))
90: Else
95: If m_bRecherchePiece = True Then
100: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call CalculerPrixReel(Trim(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text))
105: Else
110: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call CalculerPrixReel(Trim(lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text))
115: End If
120: End If
		
125: Call rstFRS.Open("SELECT IDFRS FROM GRB_Fournisseur WHERE NomFournisseur = 'FOURNI PAR LE CLIENT'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
130: iNoClient = rstFRS.Fields("IDFRS").Value
		
135: Call rstFRS.Close()
140: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
		
145: If m_bPieceInutile = True Or m_bChangementFRS = True Then
150: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPieceFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Trim(Replace(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text, "'", "''")) & "' AND Type = 'M' ORDER BY CDbl(PrixReel)", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
155: Else
160: If m_bRecherchePiece = True Then
165: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstPieceFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Trim(Replace(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text, "'", "''")) & "' AND Type = 'M' ORDER BY CDbl(PrixReel)", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
170: Else
175: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstPieceFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Trim(Replace(lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text, "'", "''")) & "' AND Type = 'M' ORDER BY CDbl(PrixReel)", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
180: End If
185: End If
		
		'Tant il y a des fournisseur de la piece, ajoute dans lister
190: Do While Not rstPieceFRS.EOF
195: If m_bPieceInutile = True Then
200: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
205: If rstPieceFRS.Fields("IDFRS").Value = iNoClient Then
210: Call rstPieceFRS.MoveNext()
						
215: If rstPieceFRS.EOF Then
220: Exit Do
225: End If
230: End If
235: End If
240: End If
			
			'on change la couleur de l'enregistrement selon la devise monétaire.
			'CAN = rouge, USA ou ESP = bleu
245: If rstPieceFRS.Fields("DeviseMonétaire").Value = "CAN" Then
250: sDevise = "CAN"
255: lColor = COLOR_NOIR
260: Else
265: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
270: sDevise = "USA"
275: lColor = COLOR_BLEU
280: Else
285: sDevise = "SPA"
290: lColor = COLOR_BLEU
295: End If
300: End If
			
305: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwfournisseur.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmFRS = lvwfournisseur.Items.Add()
			
310: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
				itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
315: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_ESCOMPTE Then
				itmFRS.SubItems(I_COL_FRS_ESCOMPTE).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
320: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_NET Then
				itmFRS.SubItems(I_COL_FRS_PRIX_NET).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
325: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_SP Then
				itmFRS.SubItems(I_COL_FRS_PRIX_SP).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_SP, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
			
			'Nom du FRS
330: itmFRS.Text = rstPieceFRS.Fields("NomFournisseur").Value
			
335: itmFRS.Tag = rstPieceFRS.Fields("IDFRS").Value
			
340: itmFRS.ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Personne ressource
345: If Trim(rstPieceFRS.Fields("PERS_RESS").Value) <> vbNullString Then
350: Call rstContact.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstPieceFRS.Fields("PERS_RESS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
355: If Not rstContact.EOF Then
360: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmFRS.SubItems.Count > I_COL_FRS_PERS_RESS Then
						itmFRS.SubItems(I_COL_FRS_PERS_RESS).Text = rstContact.Fields("NomContact").Value
					Else
						itmFRS.SubItems.Insert(I_COL_FRS_PERS_RESS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstContact.Fields("NomContact").Value))
					End If
					
365: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmFRS.SubItems.Item(I_COL_FRS_PERS_RESS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
370: End If
				
375: Call rstContact.Close()
380: End If
			
			'Date
385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPieceFRS.Fields("Date").Value) Then
390: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_DATE Then
					itmFRS.SubItems(I_COL_FRS_DATE).Text = rstPieceFRS.Fields("Date").Value
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieceFRS.Fields("Date").Value))
				End If
395: Else
400: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_DATE Then
					itmFRS.SubItems(I_COL_FRS_DATE).Text = vbNullString
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
405: End If
			
410: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_DATE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Entrer par
415: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPieceFRS.Fields("Entrer_par").Value) Then
420: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ENTRER_PAR Then
					itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = rstPieceFRS.Fields("Entrer_Par").Value
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ENTRER_PAR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieceFRS.Fields("Entrer_Par").Value))
				End If
425: Else
430: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ENTRER_PAR Then
					itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = vbNullString
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ENTRER_PAR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
435: End If
			
440: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_ENTRER_PAR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Valide
445: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPieceFRS.Fields("Valide").Value) Then
450: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_VALIDE Then
					itmFRS.SubItems(I_COL_FRS_VALIDE).Text = rstPieceFRS.Fields("Valide").Value
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_VALIDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieceFRS.Fields("Valide").Value))
				End If
455: Else
460: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_VALIDE Then
					itmFRS.SubItems(I_COL_FRS_VALIDE).Text = vbNullString
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_VALIDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
465: End If
			
470: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_VALIDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix listé
475: If rstPieceFRS.Fields("PRIX_LIST").Value <> vbNullString Then
480: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
					itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_LIST").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_LIST").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
485: End If
			
490: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Escompte
495: If rstPieceFRS.Fields("ESCOMPTE").Value <> vbNullString Then
500: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ESCOMPTE Then
					itmFRS.SubItems(I_COL_FRS_ESCOMPTE).Text = Conversion_Renamed(CDbl(Replace(rstPieceFRS.Fields("ESCOMPTE").Value, "_", vbNullString)) * 100, ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CDbl(Replace(rstPieceFRS.Fields("ESCOMPTE").Value, "_", vbNullString)) * 100, ModuleMain.enumConvert.MODE_POURCENT)))
				End If
505: End If
			
510: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix net
515: If rstPieceFRS.Fields("PRIX_NET").Value <> vbNullString Then
520: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_NET Then
					itmFRS.SubItems(I_COL_FRS_PRIX_NET).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_NET").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_NET").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
525: End If
			
530: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix spécial
535: If rstPieceFRS.Fields("PRIX_SP").Value <> vbNullString Then
540: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_SP Then
					itmFRS.SubItems(I_COL_FRS_PRIX_SP).Text = Conversion_Renamed(System.Math.Round(rstPieceFRS.Fields("PRIX_SP").Value, 4), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_SP, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstPieceFRS.Fields("PRIX_SP").Value, 4), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
545: End If
			
550: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PRIX_SP).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Quoter
555: If rstPieceFRS.Fields("QUOTER").Value = True Then
560: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_QUOTER Then
					itmFRS.SubItems(I_COL_FRS_QUOTER).Text = "Oui"
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_QUOTER, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Oui"))
				End If
565: Else
570: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_QUOTER Then
					itmFRS.SubItems(I_COL_FRS_QUOTER).Text = "Non"
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_QUOTER, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Non"))
				End If
575: End If
			
580: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_QUOTER).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
585: If rstPieceFRS.Fields("IDFRS").Value = 717 Then 'Si le fournisseur est "SOLUTION GRB Inc."
590: rstInv = New ADODB.Recordset
				
595: Call rstInv.Open("SELECT * FROM GRB_InventaireMec WHERE TRIM(NoItem) = '" & Trim(Replace(rstPieceFRS.Fields("PIECE").Value, "'", "''")) & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
600: If Not rstInv.EOF Then
605: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstInv.Fields("QuantitéStock").Value) Then
610: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmFRS.SubItems.Count > I_COL_FRS_STOCK Then
							itmFRS.SubItems(I_COL_FRS_STOCK).Text = rstInv.Fields("QuantitéStock").Value
						Else
							itmFRS.SubItems.Insert(I_COL_FRS_STOCK, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstInv.Fields("QuantitéStock").Value))
						End If
615: Else
620: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmFRS.SubItems.Count > I_COL_FRS_STOCK Then
							itmFRS.SubItems(I_COL_FRS_STOCK).Text = CStr(0)
						Else
							itmFRS.SubItems.Insert(I_COL_FRS_STOCK, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(0)))
						End If
625: End If
630: End If
				
635: Call rstInv.Close()
640: 'UPGRADE_NOTE: Object rstInv may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstInv = Nothing
645: End If
			
			'Pour garder en mémoire le prix d'origine, je le mets dans le
			'tag de la colonne Prix Listé
650: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = vbNullString Then
655: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
					itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = " "
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
660: End If
			
665: If rstPieceFRS.Fields("PRIX_NET").Value <> vbNullString Then
670: If rstPieceFRS.Fields("PRIX_LIST").Value = "0,00" Or rstPieceFRS.Fields("PRIX_LIST").Value = "0" Then
675: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag = Replace(rstPieceFRS.Fields("PRIX_NET").Value, ".", ",")
680: Else
685: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag = Replace(rstPieceFRS.Fields("PRIX_LIST").Value, ".", ",")
690: End If
695: Else
700: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag = Replace(rstPieceFRS.Fields("PRIX_SP").Value, ".", ",")
705: End If
			
710: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = vbNullString Then
715: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ENTRER_PAR Then
					itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = " "
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ENTRER_PAR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
720: End If
			
725: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_ENTRER_PAR).Tag = rstPieceFRS.Fields("NoEnreg").Value
			
730: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems(I_COL_FRS_PERS_RESS).Text = "" Then
735: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PERS_RESS Then
					itmFRS.SubItems(I_COL_FRS_PERS_RESS).Text = " "
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PERS_RESS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
740: End If
			
745: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = sDevise
			
750: Call rstPieceFRS.MoveNext()
755: Loop 
		
		'Ferme la table
760: Call rstPieceFRS.Close()
765: 'UPGRADE_NOTE: Object rstPieceFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceFRS = Nothing
		
770: 'UPGRADE_NOTE: Object rstContact may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstContact = Nothing
		
		'Modification temporaire
775: If m_bPieceInutile = False Then
780: If lvwSoumission.Items.Count > 0 Then
785: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BRUN Then
790: bAjouterDP = True
795: End If
800: Else
805: bAjouterDP = True
810: End If
815: Else
820: If m_bChangementFRS = True Then
825: If lvwSoumission.Items.Count > 0 Then
830: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BRUN Then
835: bAjouterDP = True
840: End If
845: Else
850: bAjouterDP = True
855: End If
860: End If
865: End If
		
870: If bAjouterDP = True Then
875: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwfournisseur.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmFRS = lvwfournisseur.Items.Add()
			
880: itmFRS.Text = "CHOISIR ULTÉRIEUREMENT"
885: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
				itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
890: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_ESCOMPTE Then
				itmFRS.SubItems(I_COL_FRS_ESCOMPTE).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
895: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_NET Then
				itmFRS.SubItems(I_COL_FRS_PRIX_NET).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
900: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_SP Then
				itmFRS.SubItems(I_COL_FRS_PRIX_SP).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_SP, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
905: End If
		
910: Exit Sub
		
AfficherErreur: 
		
915: Call AfficherErreur("frmProjSoumMec", "RemplirListViewFournisseur", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewPieces()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le listview des pièces selon la catégorie de pièce choisit
10: Dim rstPieces As ADODB.Recordset
15: Dim itmPieces As System.Windows.Forms.ListViewItem
20: Dim sCategorie As String
25: Dim sTri As String
30: Dim sOrderBy As String
35: Dim bDebut As Boolean
40: Dim iIndex As Short
		
45: sTri = m_sTri
		
50: Select Case cmbTri.SelectedIndex
			Case I_CMB_PIECE_GRB : sOrderBy = "PIECE_GRB"
55: Case I_CMB_PIECE : sOrderBy = "PIECE"
60: Case I_CMB_FABRICANT : sOrderBy = "FABRICANT"
65: Case I_CMB_DESCR_FR : sOrderBy = "DESC_FR"
70: Case I_CMB_DESCR_EN : sOrderBy = "DESC_EN"
75: End Select
		
		'Il faut vider le ListView avant de le remplir
80: Call lvwPieces.Items.Clear()
		
85: sCategorie = Replace(cmbPieces.Text, "'", "''")
		
		'On ouvre un recordset selon la table choisie
90: rstPieces = New ADODB.Recordset
		
95: Call rstPieces.Open("SELECT * FROM GRB_CatalogueMec WHERE CATEGORIE = '" & sCategorie & "' ORDER BY " & sOrderBy, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
100: iIndex = 1
		
		'Tant que ce n'est pas la fin des enregistrements
105: Do While Not rstPieces.EOF
110: If rstPieces.Fields("PIECE").Value <> vbNullString And rstPieces.Fields("FABRICANT").Value <> vbNullString Then
				'Si il y a une recherche à faire
115: If sTri <> vbNullString Then
120: bDebut = False
					
					'Selon la colonne
125: Select Case m_iCol
						'Si c'est la colonne PIECE_GRB
						Case I_COL_PIECES_PIECE_GRB
							'Si la PIECE_GRB contient la recherche
130: If InStr(1, UCase(rstPieces.Fields("PIECE_GRB").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
135: bDebut = True
140: End If
							
							'Si c'est la colonne No. d'item
145: Case I_COL_PIECES_NO_ITEM
							'Si le no. d'item contient la recherche
150: If InStr(1, UCase(rstPieces.Fields("PIECE").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
155: bDebut = True
160: End If
							
							'Si c'est la colonne Manufacturier
165: Case I_COL_PIECES_MANUFACT
							'Si le manufacturier contient la recherche
170: If InStr(1, UCase(rstPieces.Fields("FABRICANT").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
175: bDebut = True
180: End If
							
							'Si c'est la colonne No. d'item
185: Case I_COL_PIECES_DESCR_FR
							'Si la description française contient la recherche
190: If InStr(1, UCase(rstPieces.Fields("DESC_FR").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
195: bDebut = True
200: End If
							
							'Si c'est la colonne No. d'item
205: Case I_COL_PIECES_DESCR_EN
							'Si la description anglaise contient la recherche
210: If InStr(1, UCase(rstPieces.Fields("DESC_EN").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
215: bDebut = True
220: End If
225: End Select
					
230: If bDebut = True Then
235: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmPieces = lvwPieces.Items.Insert(iIndex, "")
						
240: iIndex = iIndex + 1
245: Else
250: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwPieces.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						itmPieces = lvwPieces.Items.Add()
255: End If
260: Else
265: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwPieces.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmPieces = lvwPieces.Items.Add()
270: End If
				
				'PIECE_GRB
275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("PIECE_GRB").Value) Then
280: itmPieces.Text = rstPieces.Fields("PIECE_GRB").Value
285: Else
290: itmPieces.Text = vbNullString
295: End If
				
				'PIECE
300: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("PIECE").Value) Then
305: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_NO_ITEM Then
						itmPieces.SubItems(I_COL_PIECES_NO_ITEM).Text = rstPieces.Fields("PIECE").Value
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieces.Fields("PIECE").Value))
					End If
310: Else
315: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_NO_ITEM Then
						itmPieces.SubItems(I_COL_PIECES_NO_ITEM).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
320: End If
				
				'FABRICANT
325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("FABRICANT").Value) Then
330: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_MANUFACT Then
						itmPieces.SubItems(I_COL_PIECES_MANUFACT).Text = rstPieces.Fields("FABRICANT").Value
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieces.Fields("FABRICANT").Value))
					End If
335: Else
340: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_MANUFACT Then
						itmPieces.SubItems(I_COL_PIECES_MANUFACT).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
345: End If
				
				'DESCR_FR
350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("DESC_FR").Value) Then
355: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_FR Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_FR).Text = rstPieces.Fields("DESC_FR").Value
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieces.Fields("DESC_FR").Value))
					End If
360: Else
365: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_FR Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_FR).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
370: End If
				
				'DESCR_EN
375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("DESC_EN").Value) Then
380: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_EN Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_EN).Text = rstPieces.Fields("DESC_EN").Value
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieces.Fields("DESC_EN").Value))
					End If
385: Else
390: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_EN Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_EN).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
395: End If
400: End If
			
405: Call rstPieces.MoveNext()
410: Loop 
		
415: Call rstPieces.Close()
420: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
		
425: Exit Sub
		
AfficherErreur: 
		
430: Call AfficherErreur("frmProjSoumMec", "RemplirListViewPieces", Err, Erl())
	End Sub
	
	Private Function TrouverIndexSection(ByVal sSousSection As String) As Short
		
5: On Error GoTo AfficherErreur
		
		'recherche la section et l'ajouter si elle n'a pas été trouvée
10: Dim iCompteur As Short
15: Dim iIndex As Short
20: Dim iTagSection As Short
25: Dim iIDSection As Short
30: Dim iIndexSect As Short
35: Dim iIndexSSection As Short
40: Dim bTrouverSect As Boolean
45: Dim bTrouverSSect As Boolean
50: Dim bTrouverIndexItem As Boolean
55: Dim sTagSousSection As String
60: Dim itmSoum As System.Windows.Forms.ListViewItem
		
		'Si la variable sSousSection = PAS DE SOUS-SECTION
65: If sSousSection = S_PAS_SOUS_SECTION Then
			'On l'initialise à rien
70: sSousSection = vbNullString
			'On met le tag à PAS DE SOUS-SECTION
75: sTagSousSection = S_PAS_SOUS_SECTION
80: Else
85: sTagSousSection = sSousSection
90: End If
		
		'Si le listview n'est pas vide
95: If lvwSoumission.Items.Count > 0 Then
			'Pour chaque élément du listview
100: For iCompteur = 1 To lvwSoumission.Items.Count
				'Si c'est écrit le nom de la section dans la colonne Piece
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text = cmbSections.Text Then
					'La section a été trouvée
110: bTrouverSect = True
					
					'On stock l'index de la section
115: iIndexSect = iCompteur
					
					'On commence à rechercher la sous-section à l'index suivant
120: iCompteur = iCompteur + 1
					
					'Tant que le tag du listItem est égal à l'index de la section
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					Do While lvwSoumission.Items.Item(iCompteur).Tag = VB6.GetItemData(cmbSections, cmbSections.SelectedIndex)
						'Si c'est écrit le nom de la sous-section dans la colonne Description
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_DESCR).Text = sSousSection And lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_DESCR).Font.Bold = True Then
							'La sous-section a été trouvée
135: bTrouverSSect = True
							
							'On stock l'index du premier enregistrement de la section
140: iIndex = iCompteur + 1
							
145: Exit Do
150: End If
						
155: iCompteur = iCompteur + 1
						
						'Si le compteur est plus grand que le listItems.Count, il ne faut pas repasser
						'dans la boucle
160: If iCompteur > lvwSoumission.Items.Count Then
165: Exit Do
170: End If
175: Loop 
					
180: Exit For
185: End If
190: Next 
195: Else
200: bTrouverSect = False
205: End If
		
210: If bTrouverSect = False Then
			'Ajoute la section
			
			'Si il y a des enregistrements dans le listview
215: If lvwSoumission.Items.Count > 0 Then
				'Pour chaque élément du listview
220: For iCompteur = 1 To lvwSoumission.Items.Count
					'Si ce n'est pas une section
225: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
						'iTagSection est égal à l'ordre de la section du listitem
230: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						iTagSection = lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
						'iIDSection est égal à l'ordre de la section du combo
235: iIDSection = cmbSections.SelectedIndex + 1
						
						'Le premier enregistrement est 2 puisque 1 c'est une section
240: If iCompteur = 2 Then
							'Si l'index de la section du combo est plus petit que
							'l'index de la section du ListItem
245: If iIDSection < iTagSection Then
250: iIndex = 1
								
255: Exit For
260: End If
265: Else
270: If iCompteur = lvwSoumission.Items.Count Then
								'Si l'index de la section du combo est plus grand que l'index
								'de la section du ListItem
275: If iIDSection > iTagSection Then
280: iIndex = iCompteur + 1
									
285: Exit For
290: End If
295: Else
300: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.Items.Item(iCompteur + 1).Tag <> vbNullString Then
									'Si l'index de la section du combo est plus grand que l'index
									'de la section du ListItem et que l'index de la section du combo
									'est plus petit que l'index de la section du ListItem suivant
305: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If iIDSection > iTagSection And iIDSection < lvwSoumission.Items.Item(iCompteur + 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag Then
310: iIndex = iCompteur + 1
										
315: Exit For
320: End If
325: Else
									'Si l'index de la section du combo est plus grand que l'index
									'de la section du ListItem et que l'index de la section du combo
									'est plus petit que l'index de 2 ListItem plus loin
330: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If iIDSection > iTagSection And iIDSection < lvwSoumission.Items.Item(iCompteur + 2).SubItems.Item(I_COL_SOUM_MANUFACT).Tag Then
335: iIndex = iCompteur + 1
340: End If
345: End If
350: End If
355: End If
360: End If
365: Next 
370: Else
375: iIndex = 1
380: End If
			
			'On ajoute la section au bon index
385: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Insert(iIndex, "")
			
390: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = cmbSections.Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, cmbSections.Text))
			End If
395: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
			
400: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
405: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1)
			
410: iIndex = iIndex + 1
			
415: Call ValeurParDefaut(itmSoum)
			
			'On l'ajoute la sous-section à l'index suivant
420: iIndexSSection = AjouterSousSection(iIndex, sTagSousSection)
			
425: iIndex = iIndexSSection
430: Else
			'Si la sous-section n'a pas été trouvé dans le listview
435: If bTrouverSSect = False Then
				'On l'ajoute à l'index suivant la section
440: iIndexSSection = AjouterSousSection(iIndexSect + 1, sTagSousSection)
				
445: iIndex = iIndexSSection
450: End If
455: End If
		
		'Pour trouver le dernier élément de la sous-section
		
		'Pour chaque élément du listview à partir de l'index du premier élément de la sous-section
460: Dim counter As Short
		counter = iIndex
		For iCompteur = counter To lvwSoumission.Items.Count
			'Si on trouve une autre sous-section ou une autre section
465: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> VB6.GetItemData(cmbSections, cmbSections.SelectedIndex) Or lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag <> sTagSousSection Then
470: bTrouverIndexItem = True
				
				'On l'ajoute à cette index
475: iIndex = iCompteur
				
480: Exit For
485: End If
490: Next 
		
		'Si la fin de la sous-section n'a pas été, il faut l'ajouter à la fin
495: If bTrouverIndexItem = False Then
500: iIndex = lvwSoumission.Items.Count + 1
505: End If
		
510: TrouverIndexSection = iIndex
		
515: Exit Function
		
AfficherErreur: 
		
520: Call AfficherErreur("frmProjSoumMec", "TrouverIndexSection", Err, Erl())
	End Function
	
	Private Function AjouterSousSection(ByVal iIndexSection As Short, ByVal sSousSection As String) As Short
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui sert à ajouter une sous-section
10: Dim itmSoum As System.Windows.Forms.ListViewItem
15: Dim iCompteur As Short
20: Dim bTrouverIndexSSection As Boolean
25: Dim iIndex As Short
30: Dim sTag As String
		
35: If sSousSection = S_PAS_SOUS_SECTION Then
40: sSousSection = vbNullString
45: sTag = S_PAS_SOUS_SECTION
50: Else
55: sTag = sSousSection
60: End If
		
65: If sTag <> S_PAS_SOUS_SECTION Then
			'Pour chaque élément du listview
70: For iCompteur = iIndexSection To lvwSoumission.Items.Count
				'Si le tag du ListItem est différent du IDSection de la section
75: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag <> VB6.GetItemData(cmbSections, cmbSections.SelectedIndex) Then
80: bTrouverIndexSSection = True
					
85: iIndex = iCompteur
					
90: Exit For
95: End If
100: Next 
			
			'Si l'emplacement de la sous-section n'a pas été trouvée
105: If bTrouverIndexSSection = False Then
				'On la place à la fin
110: iIndex = lvwSoumission.Items.Count + 1
115: End If
120: Else
125: iIndex = iIndexSection
130: End If
		
135: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum = lvwSoumission.Items.Insert(iIndex, "")
		
140: Call ValeurParDefaut(itmSoum)
		
		'On met le nom de la sous-section dans la colonne Description
145: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
			itmSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
		End If
150: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
		
		'On met le nom de la sous-section dans le tag de la colonne Piece
		'155     itmSoum.ListSubItems(I_COL_SOUM_PIECE).Tag = sTag
		
		'On met l'ID de la section dans le tag du listitem
155: itmSoum.Tag = CStr(VB6.GetItemData(cmbSections, cmbSections.SelectedIndex))
		
		'On ne peut pas écrire dans le tag si vide
160: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
			itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
		End If
		
		'Ordre de la section
165: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1)
		
170: AjouterSousSection = iIndex + 1
		
175: Exit Function
		
AfficherErreur: 
		
180: Call AfficherErreur("frmProjSoumMec", "AjouterSousSection", Err, Erl())
	End Function
	
	Private Sub AjouterNegatifDansListView(ByVal dblQuantite As Double, ByVal sSousSection As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjet As ADODB.Recordset
15: Dim iIndex As Short
20: Dim iCompteur As Short
25: Dim iIDSection As Short
30: Dim iTagSection As Short
35: Dim iIndexSel As Short
40: Dim bSelected As Boolean
45: Dim dblTotalQte As Double
50: Dim lColor As Integer
55: Dim bQteOK As Boolean
60: Dim sNoProjet As String
65: Dim sPrixList As String
70: Dim sEscompte As String
75: Dim sPrixNet As String
80: Dim itmSoum As System.Windows.Forms.ListViewItem
		
85: rstProjet = New ADODB.Recordset
		
90: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 Then
95: sNoProjet = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & m_sLiaison
			
100: If m_bRecherchePiece = True Then
105: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstProjet.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND NumItem = '" & lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text & "' AND IDFRS = " & lvwfournisseur.FocusedItem.Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
110: Else
115: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstProjet.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND NumItem = '" & lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text & "' AND IDFRS = " & lvwfournisseur.FocusedItem.Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
120: End If
125: End If
		
130: If Not rstProjet.EOF Then
135: Do While Not rstProjet.EOF
140: dblTotalQte = dblTotalQte + rstProjet.Fields("Qté").Value
				
145: Call rstProjet.MoveNext()
150: Loop 
			
155: If dblTotalQte >= System.Math.Abs(dblQuantite) Then
160: bQteOK = True
165: End If
170: Else
175: Call MsgBox("La pièce n'existe pas dans le projet " & sNoProjet, MsgBoxStyle.OKOnly, "Erreur")
			
180: Call rstProjet.Close()
185: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjet = Nothing
			
190: Exit Sub
195: End If
		
200: If bQteOK = True Then
205: Call rstProjet.MovePrevious()
			
210: sPrixList = rstProjet.Fields("Prix_List").Value
215: sEscompte = rstProjet.Fields("Escompte").Value
220: sPrixNet = rstProjet.Fields("Prix_Net").Value
225: Else
230: If m_bRecherchePiece = True Then
235: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Il n'y a pas assez de " & lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text & " dans le projet " & sNoProjet & " pour en enlever " & System.Math.Abs(dblQuantite) & "!", MsgBoxStyle.OKOnly, "Erreur")
240: Else
245: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Il n'y a pas assez de " & lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text & " dans le projet " & sNoProjet & " pour en enlever " & System.Math.Abs(dblQuantite) & "!", MsgBoxStyle.OKOnly, "Erreur")
250: End If
			
255: Call rstProjet.Close()
260: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjet = Nothing
			
265: Exit Sub
270: End If
		
275: Call rstProjet.Close()
280: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
285: bSelected = False
		
		'S'il y a des items dans le ListView
290: If lvwSoumission.Items.Count > 0 Then
			'Si ce n'est pas le premier qui est sélectionné
			'(le premier est sélectionné par défaut)
295: If lvwSoumission.FocusedItem.Index > 1 Then
300: bSelected = True
				
305: iIndexSel = lvwSoumission.FocusedItem.Index
310: End If
315: End If
		
		'si le premier est sélectionné, on le considère comme si aucun n'est sélectionné
320: If bSelected = False Then
325: iIndex = TrouverIndexSection(sSousSection)
330: Else
			'Sinon, on l'ajoute à l'endroit sélectionné
335: iIndex = iIndexSel
340: End If
		
345: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum = lvwSoumission.Items.Insert(iIndex, "")
		
350: itmSoum.Checked = True
		
		'Quantité
355: itmSoum.Text = CStr(dblQuantite)
		
360: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_QUOTER).Text = "Oui" Then
365: itmSoum.Text = itmSoum.Text & "*"
370: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
375: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, True)
380: Else
385: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
390: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, False)
395: End If
		
		'On met l'id de la section dans le tag du listItem
400: itmSoum.Tag = CStr(VB6.GetItemData(cmbSections, cmbSections.SelectedIndex)) 'IDSection
		
		'No d'item
405: If m_bRecherchePiece = True Then
410: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text))
			End If
415: Else
420: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text))
			End If
425: End If
		
430: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'On met le nom de la sous-section dans le tag du no d'item
435: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
		
		'On met la description en francais dans la colonne et la description en anglais
		'dans le tag
440: If m_eLangage = enumLangage.ANGLAIS Then
445: If m_bRecherchePiece = True Then
450: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text))
				End If
455: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
460: Else
465: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text))
				End If
470: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
475: End If
480: Else
485: If m_bRecherchePiece = True Then
490: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text))
				End If
495: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
500: Else
505: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text))
				End If
510: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
515: End If
520: End If
		
525: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'On met le nom du fabricant dans la colonne et l'ordre de la section dans le tag
530: If m_bRecherchePiece = True Then
535: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text))
			End If
540: Else
545: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text))
			End If
550: End If
		
555: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1) 'Ordre de la section
		
560: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Prix listé
565: If Trim(sPrixList) = vbNullString Then
570: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
575: Else
580: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(sPrixList, ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(sPrixList, ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
585: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = sPrixList
590: End If
		
595: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Si il y a un prix net, on le met l'escompte et le prix net sinon, on prend le prix
		'spécial pour mettre dans le prix net
600: If Trim(sEscompte) <> vbNullString Then
605: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = sEscompte
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sEscompte))
			End If
610: Else
615: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
			End If
620: End If
		
625: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
630: If Trim(sPrixNet) <> vbNullString Then
635: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(sPrixNet, ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(sPrixNet, ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
640: Else
645: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
650: End If
		
655: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
660: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
			itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = lvwfournisseur.FocusedItem.Text
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwfournisseur.FocusedItem.Text))
		End If
665: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
		
670: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
675: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
			itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
		End If
		
680: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Pour le profit, c'est le prix total - (prix net * quantité)
685: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
			itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
		End If
		
690: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
695: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = vbNullString Then
700: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
705: End If
		
710: Exit Sub
		
AfficherErreur: 
		
715: Call AfficherErreur("frmProjSoumMec", "AjouterDansListViewSoumission", Err, Erl())
	End Sub
	
	Private Sub AjouterDansListViewSoumission(ByVal dblQuantite As Double, ByVal sSousSection As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstConfig As ADODB.Recordset
15: Dim itmSoum As System.Windows.Forms.ListViewItem
20: Dim iIndex As Short
25: Dim iCompteur As Short
30: Dim iIDSection As Short
35: Dim iTagSection As Short
40: Dim iIndexSel As Short
45: Dim bSelected As Boolean
50: Dim bAjouter As Boolean
55: Dim sDistrib As String
60: Dim sTauxUSA As String
65: Dim sTauxSPA As String
70: Dim lColor As Integer
		
75: rstConfig = New ADODB.Recordset
		
80: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
85: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
90: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
95: Call rstConfig.Close()
100: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
105: bSelected = False
		
		'Si il y a des items dans le ListView
110: If lvwSoumission.Items.Count > 0 Then
			'Si ce n'est pas le premier qui est sélectionné
			'(le premier est sélectionné par défaut)
115: If lvwSoumission.FocusedItem.Index > 1 Then
120: bSelected = True
				
125: iIndexSel = lvwSoumission.FocusedItem.Index
130: End If
135: End If
		
		'si le premier est sélectionné, on le considère comme si aucun n'est sélectionné
140: If bSelected = False Then
145: iIndex = TrouverIndexSection(sSousSection)
150: Else
			'Sinon, on l'ajoute à l'endroit sélectionné
155: iIndex = iIndexSel
160: End If
		
165: If VerifierSiPieceExiste(sSousSection, iIndex) = True Then
170: If sSousSection <> "PAS DE SOUS-SECTION" Then
175: If MsgBox("Cette pièce existe déjà dans la sous-section '" & sSousSection & "' de la section '" & cmbSections.Text & "'." & vbNewLine & "Voulez-vous l'ajouter à nouveau ?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
180: bAjouter = True
185: Else
190: bAjouter = False
195: End If
200: Else
205: If MsgBox("Cette pièce existe déjà dans la sous-section vide de la section '" & cmbSections.Text & "'." & vbNewLine & "Voulez-vous l'ajouter à nouveau ?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
210: bAjouter = True
215: Else
220: bAjouter = False
225: End If
230: End If
235: Else
240: bAjouter = True
245: End If
		
250: If bAjouter = True Then
255: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Insert(iIndex, "")
			
260: itmSoum.Checked = True
			
			'Quantité
265: itmSoum.Text = CStr(dblQuantite)
			
270: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_QUOTER).Text = "Oui" Then
275: itmSoum.Text = itmSoum.Text & "*"
280: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
285: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, True)
290: Else
295: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
300: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, False)
305: End If
			
310: If lvwfournisseur.FocusedItem.Text = "CHOISIR ULTÉRIEUREMENT" Then
315: lColor = COLOR_MAGENTA
320: Else
325: lColor = COLOR_NOIR
330: End If
			
			'On met l'id de la section dans le tag du listItem
335: itmSoum.Tag = CStr(VB6.GetItemData(cmbSections, cmbSections.SelectedIndex)) 'IDSection
			
			'No d'item
340: If m_bRecherchePiece = True Then
345: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
					itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text))
				End If
350: Else
355: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
					itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text))
				End If
360: End If
			
365: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom de la sous-section dans le tag du no d'item
370: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
			
			'On met la description en francais dans la colonne et la description en anglais
			'dans le tag
375: If m_eLangage = enumLangage.ANGLAIS Then
380: If m_bRecherchePiece = True Then
385: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text))
					End If
390: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
395: Else
400: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text))
					End If
405: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
410: End If
415: Else
420: If m_bRecherchePiece = True Then
425: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text))
					End If
430: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
435: Else
440: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text))
					End If
445: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
450: End If
455: End If
			
460: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom du fabricant dans la colonne et l'ordre de la section dans le tag
465: If m_bRecherchePiece = True Then
470: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text))
				End If
475: Else
480: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text))
				End If
485: End If
			
490: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1) 'Ordre de la section
			
495: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix listé
500: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) = vbNullString Then
505: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
510: Else
515: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
520: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
525: Else
530: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
535: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
540: Else
545: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
550: End If
555: End If
560: End If
			
565: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag
			
570: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Si il y a un prix net, on le met l'escompte et le prix net sinon, on prend le prix
			'spécial pour mettre dans le prix net
575: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) <> vbNullString Then
580: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text) <> "" Then
585: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)))
					End If
590: Else
595: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(0, ModuleMain.enumConvert.MODE_POURCENT)))
					End If
600: End If
				
605: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
610: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
615: Else
620: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
625: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
630: Else
635: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
640: End If
645: End If
650: Else
655: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) <> vbNullString Then
660: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
665: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
670: Else
675: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
680: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
685: Else
690: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
695: End If
700: End If
705: Else
710: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
					End If
715: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
720: End If
725: End If
			
730: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
735: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le fournisseur dans la colonne et l'id dans le tag
740: If lvwfournisseur.FocusedItem.Text = "CHOISIR ULTÉRIEUREMENT" Then
745: sDistrib = vbNullString
750: Else
755: sDistrib = lvwfournisseur.FocusedItem.Text
760: End If
			
765: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
				itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = sDistrib
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sDistrib))
			End If
770: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
			
775: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
780: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
785: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Pour le profit, c'est le prix total - (prix net * quantité)
790: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
795: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
800: If m_eType = enumType.TYPE_PROJET Then
805: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
					itmSoum.SubItems(I_COL_SOUM_FACTURATION).Text = " "
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
810: End If
			
815: 'UPGRADE_WARNING: MSComctlLib.ListItem method itmSoum.EnsureVisible has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			Call itmSoum.EnsureVisible()
820: End If
		
825: Exit Sub
		
AfficherErreur: 
		
830: Call AfficherErreur("frmProjSoumMec", "AjouterDansListViewSoumission", Err, Erl())
	End Sub
	
	Private Function VerifierSiPieceExiste(ByVal sSousSection As String, ByVal iIndex As Short) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: Dim bExiste As Boolean
15: Dim iCompteur As Short
20: Dim sPiece As String
		
25: If lvwSoumission.Items.Count >= iIndex Then
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection Then
35: iCompteur = iIndex
40: Else
45: iCompteur = iIndex - 1
50: End If
55: Else
60: iCompteur = iIndex - 1
65: End If
		
70: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Do While lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
75: iCompteur = iCompteur - 1
80: Loop 
		
85: iCompteur = iCompteur + 1
		
90: If iCompteur <= lvwSoumission.Items.Count Then
95: If m_bRecherchePiece = True Then
100: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				sPiece = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
105: Else
110: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				sPiece = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
115: End If
			
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Do While lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text = sPiece Then
130: bExiste = True
					
135: Exit Do
140: End If
				
145: iCompteur = iCompteur + 1
				
150: If iCompteur > lvwSoumission.Items.Count Then
155: Exit Do
160: End If
165: Loop 
170: Else
175: bExiste = False
180: End If
		
185: VerifierSiPieceExiste = bExiste
		
190: Exit Function
		
AfficherErreur: 
		
195: Call AfficherErreur("frmProjSoumMec", "VerifierSiPieceExiste", Err, Erl())
	End Function
	
	Private Function VerifierEmplacement(ByVal iIndexSelection As Short) As Boolean
		
5: On Error GoTo AfficherErreur
		
		'Vérifie si l'emplacement pour ajouter une pièce est valide
10: Dim itmSoum As System.Windows.Forms.ListViewItem
		
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum = lvwSoumission.Items.Item(iIndexSelection)
		
20: If itmSoum.Tag = vbNullString Then
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Item(iIndexSelection - 1)
30: End If
		
		'Si la section est correcte
35: If itmSoum.Tag = VB6.GetItemData(cmbSections, cmbSections.SelectedIndex) Then
40: VerifierEmplacement = True
45: Else
50: VerifierEmplacement = False
55: End If
		
60: Exit Function
		
AfficherErreur: 
		
65: Call AfficherErreur("frmProjSoumMec", "VerifierEmplacement", Err, Erl())
	End Function
	
	Private Sub ValeurParDefaut(ByVal itmSoumission As System.Windows.Forms.ListViewItem)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour mettre une valeur par défaut dans quelques colonnes de lvwSoumission.
		'Si ces colonnes sont vides, elles restent blanches lors de la sélection
10: If m_bDroitPrix = True Then
15: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoumission.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
20: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoumission.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
25: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoumission.SubItems(I_COL_SOUM_PRIX_NET).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
30: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoumission.SubItems(I_COL_SOUM_TOTAL).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
35: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoumission.SubItems(I_COL_SOUM_PROFIT).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
40: End If
		
45: Exit Sub
		
AfficherErreur: 
		
50: Call AfficherErreur("frmProjSoumMec", "ValeurParDefaut", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Remplis les pièces de la soumission avec la BD
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstSection As ADODB.Recordset
20: Dim rstFRS As ADODB.Recordset
25: Dim itmProjSoum As System.Windows.Forms.ListViewItem
30: Dim bPremierEnr As Boolean
35: Dim bBold As Boolean
40: Dim iOrdreSection As Short
45: Dim sSousSection As String
50: Dim sSection As String
55: Dim lColor As Integer
		
60: Call lvwSoumission.Items.Clear()
		
65: bPremierEnr = True
		
70: rstProjSoum = New ADODB.Recordset
		
75: If m_eType = enumType.TYPE_PROJET Then
80: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjSoum & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
85: Else
90: Call rstProjSoum.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoProjSoum & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
95: End If
		
100: If m_eLangage = enumLangage.ANGLAIS Then
105: sSection = "NomSectionEN"
110: Else
115: sSection = "NomSectionFR"
120: End If
		
125: rstSection = New ADODB.Recordset
130: rstFRS = New ADODB.Recordset
		
135: Do While Not rstProjSoum.EOF
140: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmProjSoum = lvwSoumission.Items.Add()
			
			'Si c'est le premier enregistrement, il faut ajouter la section et la sous-section
145: If bPremierEnr = True Then
150: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
155: sSousSection = rstProjSoum.Fields("SousSection").Value
				
				'Pour avoir le nom de la section
160: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajout du nom de la section
165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSection.Fields(sSection).Value) Then
170: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
					End If
175: Else
180: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
185: End If
				
190: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
				
195: Call ValeurParDefaut(itmProjSoum)
				
200: Call rstSection.Close()
				
205: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
				'Ajout du nom de la sous-section
210: If sSousSection = S_PAS_SOUS_SECTION Then
215: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
220: Else
225: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
					End If
230: End If
				
				'Le tag ne peut pas être remplis si la colonne est vide
235: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
				
240: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
				
245: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
				
250: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
				
255: Call ValeurParDefaut(itmProjSoum)
				
260: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
265: bPremierEnr = False
270: Else
				'Si c'est pas le premier enregistrement, il faut vérifier avec l'ancienne section
275: If iOrdreSection <> rstProjSoum.Fields("OrdreSection").Value Then
280: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
					
285: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
290: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSection.Fields(sSection).Value) Then
295: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
						End If
300: Else
305: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
310: End If
					
315: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
					
320: Call ValeurParDefaut(itmProjSoum)
					
325: Call rstSection.Close()
					
330: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
					
335: sSousSection = rstProjSoum.Fields("SousSection").Value
					
340: If sSousSection = S_PAS_SOUS_SECTION Then
345: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
350: Else
355: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("SousSection").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("SousSection").Value))
						End If
360: End If
					
					'Le tag ne peut pas être remplis si la colonne est vide
365: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
						itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
					
370: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
					
375: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
					
380: Call ValeurParDefaut(itmProjSoum)
					
385: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
					
390: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
395: Else
					'il faut vérifier avec l'ancienne sous-section
400: If sSousSection <> rstProjSoum.Fields("SousSection").Value Then
405: sSousSection = rstProjSoum.Fields("SousSection").Value
						
410: If sSousSection = S_PAS_SOUS_SECTION Then
415: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
420: Else
425: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
							End If
430: End If
						
435: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
						
440: Call ValeurParDefaut(itmProjSoum)
						
445: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
						
						'Le tag ne peut pas être remplis si la colonne est vide
450: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
							itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
						
455: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
						
460: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						itmProjSoum = lvwSoumission.Items.Add()
465: End If
470: End If
475: End If
			
480: If rstProjSoum.Fields("PieceExtraNonChargeable").Value = True Then
485: lColor = COLOR_ROSE
490: bBold = True
495: Else
500: If rstProjSoum.Fields("PieceExtraChargeable").Value = True Then
505: lColor = COLOR_BLEU
510: bBold = True
515: Else
520: If rstProjSoum.Fields("CommandeAnnulée").Value = True Then
525: lColor = COLOR_VERT_FORET
530: bBold = True
535: Else
540: If rstProjSoum.Fields("Retour").Value = True Then
545: lColor = COLOR_ROUGE
550: bBold = False
555: Else
560: If rstProjSoum.Fields("Commandé").Value = True Then
565: lColor = COLOR_ORANGE 'COLOR_ORANGE
570: bBold = False
575: Else
580: If rstProjSoum.Fields("Recu").Value = True Then
585: lColor = COLOR_GRIS 'Gris
590: bBold = False
595: Else
600: If rstProjSoum.Fields("IDFRS").Value = 0 And rstProjSoum.Fields("NumItem").Value <> "Texte" And rstProjSoum.Fields("NumItem").Value <> "Text" Then
605: lColor = COLOR_MAGENTA
610: bBold = False
615: Else
620: If rstProjSoum.Fields("MatérielInutile").Value = True Then
625: lColor = COLOR_BRUN
630: bBold = False
635: Else
640: lColor = COLOR_NOIR
645: bBold = False
650: End If
655: End If
660: End If
665: End If
670: End If
675: End If
680: End If
685: End If
			
			'On met l'ID de la section dans le tag
690: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
			
695: If rstProjSoum.Fields("Visible").Value = True Then
700: itmProjSoum.Checked = True
705: Else
710: itmProjSoum.Checked = False
715: End If
			
			'Quantité
720: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Qté").Value) Then
725: itmProjSoum.Text = rstProjSoum.Fields("Qté").Value
730: Else
735: itmProjSoum.Text = vbNullString
740: End If
			
745: If rstProjSoum.Fields("Quoté").Value = True Then
750: itmProjSoum.Text = itmProjSoum.Text & "*"
755: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
760: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, True)
765: Else
770: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
775: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, False)
780: End If
			
785: If m_eType = enumType.TYPE_PROJET Then
790: If g_bModificationProjetsMec = True Then
					'Facturation
795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Facturation").Value) Then
800: If Trim(rstProjSoum.Fields("Facturation").Value) <> "" Then
805: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = rstProjSoum.Fields("Facturation").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Facturation").Value))
							End If
810: Else
815: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
820: End If
825: Else
830: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
							itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
835: End If
840: End If
845: End If
			
			'Numéro d'item
850: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("NumItem").Value) Then
855: If rstProjSoum.Fields("NumItem").Value = "Texte" Or rstProjSoum.Fields("NumItem").Value = "Text" Then
860: If m_eLangage = enumLangage.ANGLAIS Then
865: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Text"))
						End If
870: Else
875: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Texte"))
						End If
880: End If
885: Else
890: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstProjSoum.Fields("NumItem").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NumItem").Value))
					End If
895: End If
900: Else
905: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
					itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
910: End If
			
915: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
920: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, bBold)
			
			'On met le nom de la sous-section dans le tag du numéro d'item
925: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = rstProjSoum.Fields("SousSection").Value
			
930: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
935: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
				End If
940: Else
945: If m_eLangage = enumLangage.ANGLAIS Then
					'Description en anglais
950: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_EN").Value) Then
955: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_EN").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_EN").Value))
						End If
960: Else
965: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
970: End If
					
					'On met la description en francais dans le tag de la description en anglais
975: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
980: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("DESC_FR").Value
985: Else
990: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
995: End If
1000: Else
					'Description en francais
1005: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
1010: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
						End If
1015: Else
1020: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1025: End If
					
					'On met la description en anglais dans le tag de la description en francais
1030: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Desc_EN").Value) Then
1035: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("Desc_EN").Value
1040: Else
1045: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
1050: End If
1055: End If
1060: End If
			
1065: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
1070: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, bBold)
			
			'Fabricant
1075: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Manufact").Value) Then
1080: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = rstProjSoum.Fields("Manufact").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Manufact").Value))
				End If
1085: Else
1090: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
1095: End If
			
1100: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
1105: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font, bBold)
			
			'On met l'ordre de la section dans le tag du fabricant
1110: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
			
			'Prix listé
1115: If m_bDroitPrix = True Then
1120: If Trim(rstProjSoum.Fields("Prix_List").Value) <> vbNullString Then
1125: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(rstProjSoum.Fields("Prix_list"), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Prix_list"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
1130: Else
1135: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1140: End If
				
1145: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1150: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, bBold)
				
1155: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstProjSoum.Fields("PrixOrigine").Value
				
				'Escompte
1160: If Trim(rstProjSoum.Fields("Escompte").Value) <> vbNullString Then
1165: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)))
					End If
1170: Else
1175: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1180: End If
				
1185: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1190: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, bBold)
				
				'Prix net
1195: If Trim(rstProjSoum.Fields("Prix_net").Value) <> vbNullString Then
1200: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstProjSoum.Fields("Prix_net"), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Prix_net"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
1205: Else
1210: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1215: End If
				
1220: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1225: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, bBold)
				
1230: If m_eType = enumType.TYPE_PROJET Then
1235: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateRéception").Value) Then
1240: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = rstProjSoum.Fields("DateRéception").Value
1245: End If
1250: End If
				
				'Fournisseur
1255: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("IDFRS").Value) And rstProjSoum.Fields("IDFRS").Value <> "0" Then
1260: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
1265: Call rstFRS.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstProjSoum.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
						'On affiche le nom dans la colonne
1270: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
							itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = rstFRS.Fields("NomFournisseur").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstFRS.Fields("NomFournisseur").Value))
						End If
						
1275: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
						
1280: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font, bBold)
						
						'On affiche l'Id dans le tag
1285: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = rstProjSoum.Fields("IDFRS").Value
						
1290: Call rstFRS.Close()
1295: End If
1300: Else
1305: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1310: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(0)
1315: End If
				
				'Prix total
1320: If Trim(rstProjSoum.Fields("Prix_total").Value) <> vbNullString Then
1325: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
						itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
1330: Else
1335: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
						itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1340: End If
				
1345: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1350: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font, bBold)
				
				'Profit
1355: If Trim(rstProjSoum.Fields("Profit_argent").Value) <> vbNullString Then
1360: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
1365: Else
1370: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1375: End If
				
1380: If m_eType = enumType.TYPE_PROJET Then
1385: If rstProjSoum.Fields("PieceExtraNonChargeable").Value = True Then
1390: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Tag = "EXTRA"
1395: End If
1400: End If
				
1405: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1410: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font, bBold)
				
1415: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Commentaire").Value) Then
1420: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = rstProjSoum.Fields("Commentaire").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Commentaire").Value))
					End If
1425: Else
1430: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1435: End If
				
1440: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1445: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font, bBold)
				
1450: If m_eType = enumType.TYPE_PROJET Then
1455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateCommande").Value) Then
1460: If Trim(rstProjSoum.Fields("DateCommande").Value) <> "" Then
1465: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = rstProjSoum.Fields("DateCommande").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateCommande").Value))
							End If
1470: Else
1475: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1480: End If
1485: Else
1490: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1495: End If
					
1500: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1505: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font, bBold)
					
1510: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag = rstProjSoum.Fields("NoRetour").Value
					
1515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateRequise").Value) Then
1520: If Trim(rstProjSoum.Fields("DateRequise").Value) <> "" Then
1525: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = rstProjSoum.Fields("DateRequise").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateRequise").Value))
							End If
1530: Else
1535: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1540: End If
1545: Else
1550: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
							itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1555: End If
					
1560: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1565: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font, bBold)
					
1570: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag = rstProjSoum.Fields("DateRetour").Value
					
1575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("NomCommande").Value) Then
1580: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = rstProjSoum.Fields("NomCommande").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NomCommande").Value))
						End If
1585: Else
1590: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1595: End If
					
1600: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1605: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font, bBold)
					
1610: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("NoSéquentiel").Value) Then
1615: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
							itmProjSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = rstProjSoum.Fields("NoSéquentiel").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NoSéquentiel").Value))
						End If
1620: Else
1625: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
							itmProjSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1630: End If
					
1635: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1640: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font, bBold)
					
1645: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
1650: If Trim(rstProjSoum.Fields("Provenance").Value) <> "" Then
1655: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
1660: Else
1665: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = ""
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
1670: End If
1675: Else
1680: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
							itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = ""
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
						End If
1685: End If
					
1690: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1695: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font, bBold)
1700: Else
1705: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
1710: If Trim(rstProjSoum.Fields("Provenance").Value) <> "" Then
1715: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
1720: Else
1725: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = ""
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
1730: End If
1735: Else
1740: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
							itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = ""
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
						End If
1745: End If
					
1750: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1755: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).Font, bBold)
1760: End If
1765: Else
				'Fournisseur
1770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("IDFRS").Value) And rstProjSoum.Fields("IDFRS").Value <> "0" Then
1775: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems(I_COL_SOUM_SP_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_SP_PIECE).Text <> "Text" Then
1780: Call rstFRS.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstProjSoum.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
						'On affiche le nom dans la colonne
1785: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DISTRIB Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_DISTRIB).Text = rstFRS.Fields("NomFournisseur").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstFRS.Fields("NomFournisseur").Value))
						End If
						
1790: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
						
1795: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).Font, bBold)
						
						'On affiche l'ID dans le tag
1800: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).Tag = rstProjSoum.Fields("IDFRS").Value
						
1805: Call rstFRS.Close()
1810: End If
1815: Else
1820: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_DISTRIB).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1825: End If
				
1830: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Commentaire").Value) Then
1835: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_COMMENTAIRE).Text = rstProjSoum.Fields("Commentaire").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Commentaire").Value))
					End If
1840: Else
1845: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_COMMENTAIRE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1850: End If
				
1855: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1860: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_COMMENTAIRE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_COMMENTAIRE).Font, bBold)
				
1865: If m_eType = enumType.TYPE_PROJET Then
1870: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateCommande").Value) Then
1875: If Trim(rstProjSoum.Fields("DateCommande").Value) <> "" Then
1880: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_COMMANDE).Text = rstProjSoum.Fields("DateCommande").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateCommande").Value))
							End If
1885: Else
1890: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_COMMANDE).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1895: End If
1900: Else
1905: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_COMMANDE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1910: End If
					
1915: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1920: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).Font, bBold)
					
1925: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).Tag = rstProjSoum.Fields("NoRetour").Value
					
1930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateRequise").Value) Then
1935: If Trim(rstProjSoum.Fields("DateRequise").Value) <> "" Then
1940: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_REQUISE).Text = rstProjSoum.Fields("DateRequise").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateRequise").Value))
							End If
1945: Else
1950: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_REQUISE).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1955: End If
1960: Else
1965: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_REQUISE Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_REQUISE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1970: End If
					
1975: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1980: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).Font, bBold)
					
1985: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).Tag = rstProjSoum.Fields("DateRetour").Value
					
1990: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_NOM_COMMANDE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_NOM_COMMANDE).Text = rstProjSoum.Fields("NomCommande").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NomCommande").Value))
					End If
					
1995: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2000: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NOM_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NOM_COMMANDE).Font, bBold)
					
2005: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_NO_SEQUENTIEL Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_NO_SEQUENTIEL).Text = rstProjSoum.Fields("NoSéquentiel").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NoSéquentiel").Value))
					End If
					
2010: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2015: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NO_SEQUENTIEL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NO_SEQUENTIEL).Font, bBold)
					
2025: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
2030: If Trim(rstProjSoum.Fields("Provenance").Value) <> "" Then
2035: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_PROVENANCE).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
2040: Else
2045: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_PROVENANCE).Text = ""
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
2050: End If
2055: Else
2060: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_PROVENANCE Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_PROVENANCE).Text = ""
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
						End If
2065: End If
					
2070: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_PROVENANCE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2075: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_PROVENANCE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_PROVENANCE).Font, bBold)
2080: Else
2085: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
2090: If Trim(rstProjSoum.Fields("Provenance").Value) <> "" Then
2095: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_SP_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_SP_PROV).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_SP_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
2100: Else
2105: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_SP_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_SP_PROV).Text = ""
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_SP_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
2110: End If
2115: Else
2120: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_SP_PROV Then
							itmProjSoum.SubItems(I_COL_SOUMISSION_SP_PROV).Text = ""
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_SP_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
						End If
2125: End If
					
2130: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_SP_PROV).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2135: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_SP_PROV).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUMISSION_SP_PROV).Font, bBold)
2140: End If
2145: End If
			
2150: Call rstProjSoum.MoveNext()
2155: Loop 
		
2160: If lvwSoumission.Items.Count > 0 Then
2165: Call Deselect()
			
2170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.Items.Item(1).Selected = True
2175: End If
		
2180: Call rstProjSoum.Close()
2185: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
2190: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
2195: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
2200: Call CalculerPrix()
		
2205: Exit Sub
		
AfficherErreur: 
		
2210: Call AfficherErreur("frmProjSoumMec", "RemplirListViewProjSoum", Err, Erl(), sNoProjSoum)
	End Sub
	
	Private Sub CalculerPrix()
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour calculer le prix
10: Dim dblPrixPieces As Double
15: Dim dblPrixTotal As Double
20: Dim dblCommission As Double
25: Dim dblTotalTemps As Double
30: Dim dblProfit As Double
35: Dim dblTotalManuel As Double
40: Dim dblTotalImprevue As Double
45: Dim dblGrandTotal As Double
50: Dim dblTotalDessin As Double
55: Dim dblTotalCoupe As Double
60: Dim dblTotalMachinage As Double
65: Dim dblTotalSoudure As Double
70: Dim dblTotalAssemblage As Double
75: Dim dblTotalPeinture As Double
80: Dim dblTotalTest As Double
85: Dim dblTotalInstallation As Double
90: Dim dblTotalFormation As Double
95: Dim dblTotalGestion As Double
100: Dim dblTotalShipping As Double
105: Dim dblHebergement As Double
110: Dim dblRepas As Double
115: Dim dblTransport As Double
120: Dim dblUniteMobile As Double
125: Dim dblPrixEmballage As Double
130: Dim dblTotalResteTemps As Double
135: Dim bDemande As Boolean
140: Dim iNbrePersonne As Short
145: Dim iCompteur As Short
		
		'Si ce n'est pas en mode affichage
150: If m_bModeAffichage = False Then
			'Pour chaque élément du listview
155: For iCompteur = 1 To lvwSoumission.Items.Count
				'Si ce n'est pas une section
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
							'On additionne le prix total
							
175: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If IsNumeric(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_TOTAL).Text) And IsNumeric(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text) Then
180: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								dblPrixPieces = dblPrixPieces + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_TOTAL).Text) - CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)
185: Else
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								Call MsgBox("La pièce " & lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text & " a un prix non numérique!", MsgBoxStyle.OKOnly, "Erreur")
195: End If
							
							'On additionne le profit
200: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If IsNumeric(Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)) = True Then
205: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								dblProfit = dblProfit + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)
210: End If
215: Else
220: bDemande = True
225: End If
230: End If
235: End If
240: Next 
			
			'Total des temps
245: dblTotalDessin = CDbl(m_sTempsDessin) * CDbl(m_sTauxDessin)
250: dblTotalCoupe = CDbl(m_sTempsCoupe) * CDbl(m_sTauxCoupe)
255: dblTotalMachinage = CDbl(m_sTempsMachinage) * CDbl(m_sTauxMachinage)
260: dblTotalSoudure = CDbl(m_sTempsSoudure) * CDbl(m_sTauxSoudure)
265: dblTotalAssemblage = CDbl(m_sTempsAssemblage) * CDbl(m_sTauxAssemblage)
270: dblTotalPeinture = CDbl(m_sTempsPeinture) * CDbl(m_sTauxPeinture)
275: dblTotalTest = CDbl(m_sTempsTest) * CDbl(m_sTauxTest)
280: dblTotalInstallation = CDbl(m_sTempsInstallation) * CDbl(m_sTauxInstallation)
285: dblTotalFormation = CDbl(m_sTempsFormation) * CDbl(m_sTauxFormation)
290: dblTotalGestion = CDbl(m_sTempsGestion) * CDbl(m_sTauxGestion)
295: dblTotalShipping = CDbl(m_sTempsShipping) * CDbl(m_sTauxShipping)
			
300: dblTotalTemps = dblTotalDessin + dblTotalCoupe + dblTotalMachinage + dblTotalSoudure + dblTotalAssemblage + dblTotalPeinture + dblTotalTest + dblTotalInstallation + dblTotalFormation + dblTotalGestion + dblTotalShipping
			
305: If m_eType = enumType.TYPE_PROJET Then
310: dblHebergement = 0
315: dblRepas = 0
320: dblTransport = 0
325: dblUniteMobile = 0
330: Else
335: iNbrePersonne = Int(CDbl(m_sNbrePersonne))
				
340: Do While iNbrePersonne > 0
345: If iNbrePersonne >= 2 Then
350: dblHebergement = dblHebergement + CDbl(m_sTempsHebergement) * CDbl(m_sTauxHebergement2)
						
355: iNbrePersonne = iNbrePersonne - 2
360: Else
365: dblHebergement = dblHebergement + CDbl(m_sTempsHebergement) * CDbl(m_sTauxHebergement1)
						
370: iNbrePersonne = iNbrePersonne - 1
375: End If
380: Loop 
				
385: dblRepas = CDbl(m_sTempsRepas) * CDbl(m_sTauxRepas) * CDbl(m_sNbrePersonne)
390: dblTransport = CDbl(m_sTempsTransport) * CDbl(m_sTauxTransport)
395: dblUniteMobile = CDbl(m_sTempsUniteMobile) * CDbl(m_sTauxUniteMobile)
400: End If
			
			'Correction d'un bug de Type Incompatible
405: If IsNumeric(m_sPrixEmballage) Then
410: dblPrixEmballage = CDbl(m_sPrixEmballage)
415: Else
420: dblPrixEmballage = 0
425: End If
			
430: dblTotalResteTemps = dblHebergement + dblRepas + dblTransport + dblUniteMobile + dblPrixEmballage
			
435: If IsNumeric(txtPrixManuel.Text) Then
440: dblTotalManuel = CDbl(txtPrixManuel.Text)
445: Else
450: dblTotalManuel = 0
455: End If
			
460: dblTotalImprevue = System.Math.Round((dblPrixPieces + dblProfit) * CDbl(m_sImprevue), 2)
			
465: dblPrixTotal = dblPrixPieces + dblProfit + dblTotalTemps + dblTotalImprevue + dblTotalManuel + dblTotalResteTemps
			
			'Le calcul de la commission est sur les manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps
470: dblCommission = System.Math.Round(dblPrixTotal * CDbl(m_sCommission), 2)
			
			'Le prix total est le calcul des manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps + total de la commission
475: dblGrandTotal = dblPrixTotal + dblCommission
			
			'Format monétaires avec 2 chiffres après la virgule
480: txtTotalPieces.Text = Conversion_Renamed(CStr(System.Math.Round(dblPrixPieces, 2)), ModuleMain.enumConvert.MODE_ARGENT)
485: txtTotalTemps.Text = Conversion_Renamed(CStr(System.Math.Round(dblTotalTemps, 2)), ModuleMain.enumConvert.MODE_ARGENT)
490: txtPrixTotal.Text = Conversion_Renamed(CStr(System.Math.Round(dblGrandTotal, 2)), ModuleMain.enumConvert.MODE_ARGENT)
			
495: If bDemande = True Then
500: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_JAUNE)
505: Else
510: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_ROUGE)
515: End If
			
520: txtImprevus.Text = Conversion_Renamed(CStr(System.Math.Round(dblTotalImprevue, 2)), ModuleMain.enumConvert.MODE_ARGENT)
525: txtCommission.Text = Conversion_Renamed(CStr(System.Math.Round(dblCommission, 2)), ModuleMain.enumConvert.MODE_ARGENT)
530: txtProfit.Text = Conversion_Renamed(CStr(System.Math.Round(dblProfit, 2)), ModuleMain.enumConvert.MODE_ARGENT)
535: Else
540: For iCompteur = 1 To lvwSoumission.Items.Count
				'Si ce n'est pas une section
545: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
550: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
555: If m_bDroitPrix = True Then
560: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString Then
565: bDemande = True
								
570: Exit For
575: End If
580: End If
585: End If
590: End If
595: Next 
			
600: If bDemande = True Then
605: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_JAUNE)
610: Else
615: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_ROUGE)
620: End If
625: End If
		
630: Exit Sub
		
AfficherErreur: 
		
635: Call AfficherErreur("frmProjSoumMec", "CalculerPrix", Err, Erl())
	End Sub
	
	Private Sub CalculerTotalRecordset(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour calculer le prix
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstPiece As ADODB.Recordset
20: Dim rstPunch As ADODB.Recordset
25: Dim dblPrixPieces As Double
30: Dim dblPrixTotal As Double
35: Dim dblCommission As Double
40: Dim dblTotalTemps As Double
45: Dim dblProfit As Double
50: Dim dblTotalManuel As Double
55: Dim dblTotalImprevue As Double
60: Dim dblGrandTotal As Double
65: Dim dblTotalDessin As Double
70: Dim dblTotalCoupe As Double
75: Dim dblTotalMachinage As Double
80: Dim dblTotalSoudure As Double
85: Dim dblTotalAssemblage As Double
90: Dim dblTotalPeinture As Double
95: Dim dblTotalTest As Double
100: Dim dblTotalInstallation As Double
105: Dim dblTotalFormation As Double
110: Dim dblTotalGestion As Double
115: Dim dblTotalShipping As Double
120: Dim dblHebergement As Double
125: Dim dblRepas As Double
130: Dim dblTransport As Double
135: Dim dblUniteMobile As Double
140: Dim dblPrixEmballage As Double
145: Dim dblTotalResteTemps As Double
150: Dim sFilterNoProjet As String
155: Dim sDateDebut As String
160: Dim sDateFin As String
165: Dim sTotal As String
		
170: rstProjSoum = New ADODB.Recordset
		
175: If m_eType = enumType.TYPE_PROJET Then
180: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
185: Else
190: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
195: End If
		
200: If Not rstProjSoum.EOF Then
205: rstPiece = New ADODB.Recordset
			
210: If m_eType = enumType.TYPE_PROJET Then
215: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjSoum & "' AND Type = 'M'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
220: Else
225: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoProjSoum & "' AND Type = 'M'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
230: End If
			
			'Pour chaque élément du recordset
235: Do While Not rstPiece.EOF
240: If Trim(rstPiece.Fields("Prix_total").Value) <> vbNullString Then
					'On additionne le prix total
245: dblPrixPieces = dblPrixPieces + rstPiece.Fields("Prix_total").Value - rstPiece.Fields("Profit_Argent").Value
					
					'On additionne le profit
250: dblProfit = dblProfit + rstPiece.Fields("Profit_Argent").Value
255: End If
				
260: Call rstPiece.MoveNext()
265: Loop 
			
			'Total des temps
270: If m_eType = enumType.TYPE_PROJET Then
275: sDateDebut = "TIMESERIAL(Left(GRB_Punch.HeureDébut,2),RIGHT(GRB_Punch.HeureDébut,2),0)"
				
280: sDateFin = "TIMESERIAL(Left(GRB_Punch.HeureFin,2),RIGHT(GRB_Punch.HeureFin,2),0)"
				
285: sTotal = "(SUM(" & sDateFin & " - " & sDateDebut & ")* 24) As Total"
				
290: If VB.Right(sNoProjSoum, 2) = "99" Then
295: sFilterNoProjet = "LEFT(NoProjet, 6) = '" & VB.Left(sNoProjSoum, 6) & "'"
300: Else
305: sFilterNoProjet = "NoProjet = '" & sNoProjSoum & "'"
310: End If
				
315: rstPunch = New ADODB.Recordset
				
320: Call rstPunch.Open("SELECT Type, " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null GROUP BY Type", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
325: dblTotalDessin = 0
330: dblTotalCoupe = 0
335: dblTotalMachinage = 0
340: dblTotalSoudure = 0
345: dblTotalAssemblage = 0
350: dblTotalPeinture = 0
355: dblTotalTest = 0
360: dblTotalInstallation = 0
365: dblTotalFormation = 0
370: dblTotalGestion = 0
375: dblTotalShipping = 0
				
380: Do While Not rstPunch.EOF
385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstPunch.Fields("Total").Value) Then
390: Select Case rstPunch.Fields("Type").Value
							Case "Dessin"
395: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
400: dblTotalDessin = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxDessin").Value)
405: Else
410: dblTotalDessin = 0
415: End If
								
420: Case "Coupe"
425: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
430: dblTotalCoupe = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxCoupe").Value)
435: Else
440: dblTotalCoupe = 0
445: End If
								
450: Case "Machinage"
455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
460: dblTotalMachinage = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxMachinage").Value)
465: Else
470: dblTotalMachinage = 0
475: End If
								
480: Case "Soudure"
485: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
490: dblTotalSoudure = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxSoudure").Value)
495: Else
500: dblTotalSoudure = 0
505: End If
								
510: Case "Assemblage"
515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
520: dblTotalAssemblage = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxAssemblage").Value)
525: Else
530: dblTotalAssemblage = 0
535: End If
								
540: Case "Peinture"
545: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
550: dblTotalPeinture = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxPeinture").Value)
555: Else
560: dblTotalPeinture = 0
565: End If
								
570: Case "Test"
575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
580: dblTotalTest = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxTest").Value)
585: Else
590: dblTotalTest = 0
595: End If
								
600: Case "Installation"
605: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
610: dblTotalInstallation = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxInstallation").Value)
615: Else
620: dblTotalInstallation = 0
625: End If
								
630: Case "Formation"
635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
640: dblTotalFormation = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxFormation").Value)
645: Else
650: dblTotalFormation = 0
655: End If
								
660: Case "Gestion"
665: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
670: dblTotalGestion = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxGestion").Value)
675: Else
680: dblTotalGestion = 0
685: End If
								
690: Case "Shipping"
695: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
700: dblTotalShipping = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxShipping").Value)
705: Else
710: dblTotalShipping = 0
715: End If
720: End Select
725: End If
					
730: Call rstPunch.MoveNext()
735: Loop 
				
740: Call rstPunch.Close()
745: 'UPGRADE_NOTE: Object rstPunch may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstPunch = Nothing
750: Else
755: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) And Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
760: dblTotalDessin = CDbl(rstProjSoum.Fields("TempsDessin").Value) * CDbl(rstProjSoum.Fields("TauxDessin").Value)
765: Else
770: dblTotalDessin = 0
775: End If
				
780: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupe").Value) And Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
785: dblTotalCoupe = CDbl(rstProjSoum.Fields("TempsCoupe").Value) * CDbl(rstProjSoum.Fields("TauxCoupe").Value)
790: Else
795: dblTotalCoupe = 0
800: End If
				
805: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinage").Value) And Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
810: dblTotalMachinage = CDbl(rstProjSoum.Fields("TempsMachinage").Value) * CDbl(rstProjSoum.Fields("TauxMachinage").Value)
815: Else
820: dblTotalMachinage = 0
825: End If
				
830: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudure").Value) And Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
835: dblTotalSoudure = CDbl(rstProjSoum.Fields("TempsSoudure").Value) * CDbl(rstProjSoum.Fields("TauxSoudure").Value)
840: Else
845: dblTotalSoudure = 0
850: End If
				
855: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) And Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
860: dblTotalAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblage").Value) * CDbl(rstProjSoum.Fields("TauxAssemblage").Value)
865: Else
870: dblTotalAssemblage = 0
875: End If
				
880: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeinture").Value) And Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
885: dblTotalPeinture = CDbl(rstProjSoum.Fields("TempsPeinture").Value) * CDbl(rstProjSoum.Fields("TauxPeinture").Value)
890: Else
895: dblTotalPeinture = 0
900: End If
				
905: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) And Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
910: dblTotalTest = CDbl(rstProjSoum.Fields("TempsTest").Value) * CDbl(rstProjSoum.Fields("TauxTest").Value)
915: Else
920: dblTotalTest = 0
925: End If
				
930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) And Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
935: dblTotalInstallation = CDbl(rstProjSoum.Fields("TempsInstallation").Value) * CDbl(rstProjSoum.Fields("TauxInstallation").Value)
940: Else
945: dblTotalInstallation = 0
950: End If
				
955: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) And Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
960: dblTotalFormation = CDbl(rstProjSoum.Fields("TempsFormation").Value) * CDbl(rstProjSoum.Fields("TauxFormation").Value)
965: Else
970: dblTotalFormation = 0
975: End If
				
980: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) And Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
985: dblTotalGestion = CDbl(rstProjSoum.Fields("TempsGestion").Value) * CDbl(rstProjSoum.Fields("TauxGestion").Value)
990: Else
995: dblTotalGestion = 0
1000: End If
				
1005: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) And Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1010: dblTotalShipping = CDbl(rstProjSoum.Fields("TempsShipping").Value) * CDbl(rstProjSoum.Fields("TauxShipping").Value)
1015: Else
1020: dblTotalShipping = 0
1025: End If
1030: End If
			
1035: dblTotalTemps = dblTotalDessin + dblTotalCoupe + dblTotalMachinage + dblTotalSoudure + dblTotalAssemblage + dblTotalPeinture + dblTotalTest + dblTotalInstallation + dblTotalFormation + dblTotalGestion + dblTotalShipping
			
1040: If m_eType = enumType.TYPE_PROJET Then
1045: dblHebergement = 0
1050: dblRepas = 0
1055: dblTransport = 0
1060: dblUniteMobile = 0
1065: Else
1070: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TotalHebergement").Value) Then
1075: dblHebergement = CDbl(rstProjSoum.Fields("TotalHebergement").Value)
1080: Else
1085: dblHebergement = 0
1090: End If
				
1095: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TotalRepas").Value) Then
1100: dblRepas = CDbl(rstProjSoum.Fields("TotalRepas").Value)
1105: Else
1110: dblRepas = 0
1115: End If
				
1120: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
1125: dblTransport = CDbl(rstProjSoum.Fields("TempsTransport").Value) * CDbl(rstProjSoum.Fields("TauxTransport").Value)
1130: Else
1135: dblTransport = 0
1140: End If
				
1145: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
1150: dblUniteMobile = CDbl(rstProjSoum.Fields("TempsUniteMobile").Value) * CDbl(rstProjSoum.Fields("TauxUniteMobile").Value)
1155: Else
1160: dblUniteMobile = 0
1165: End If
1170: End If
			
			'Correction d'un bug de Type Incompatible
1175: If IsNumeric(rstProjSoum.Fields("PrixEmballage").Value) Then
1180: dblPrixEmballage = CDbl(rstProjSoum.Fields("PrixEmballage").Value)
1185: Else
1190: dblPrixEmballage = 0
1195: End If
			
1200: dblTotalResteTemps = dblHebergement + dblRepas + dblTransport + dblUniteMobile + dblPrixEmballage
			
1205: If IsNumeric(rstProjSoum.Fields("total_manuel").Value) Then
1210: dblTotalManuel = CDbl(rstProjSoum.Fields("total_manuel").Value)
1215: Else
1220: dblTotalManuel = 0
1225: End If
			
1230: dblTotalImprevue = System.Math.Round((dblPrixPieces + dblProfit) * CDbl(rstProjSoum.Fields("Imprevue").Value), 2)
			
1235: dblPrixTotal = dblPrixPieces + dblProfit + dblTotalTemps + dblTotalImprevue + dblTotalManuel + dblTotalResteTemps
			
			'Le calcul de la commission est sur les manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps
1240: dblCommission = System.Math.Round(dblPrixTotal * CDbl(rstProjSoum.Fields("Commission").Value), 2)
			
			'Le prix total est le calcul des manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps + total de la commission
1245: dblGrandTotal = dblPrixTotal + dblCommission
			
			'Format monétaires avec 2 chiffres après la virgule
1250: rstProjSoum.Fields("Total_Piece").Value = Conversion_Renamed(CStr(System.Math.Round(dblPrixPieces, 2)), ModuleMain.enumConvert.MODE_ARGENT)
1255: rstProjSoum.Fields("Total_Temps").Value = Conversion_Renamed(CStr(System.Math.Round(dblTotalTemps, 2)), ModuleMain.enumConvert.MODE_ARGENT)
1260: rstProjSoum.Fields("PrixTotal").Value = Conversion_Renamed(CStr(System.Math.Round(dblGrandTotal, 2)), ModuleMain.enumConvert.MODE_ARGENT)
1265: rstProjSoum.Fields("total_Imprevue").Value = Conversion_Renamed(CStr(System.Math.Round(dblTotalImprevue, 2)), ModuleMain.enumConvert.MODE_ARGENT)
1270: rstProjSoum.Fields("total_commission").Value = Conversion_Renamed(CStr(System.Math.Round(dblCommission, 2)), ModuleMain.enumConvert.MODE_ARGENT)
1275: rstProjSoum.Fields("total_profit").Value = Conversion_Renamed(CStr(System.Math.Round(dblProfit, 2)), ModuleMain.enumConvert.MODE_ARGENT)
			
1280: Call rstProjSoum.Update()
			
1285: Call rstPiece.Close()
1290: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
1295: Else
1300: If m_eType = enumType.TYPE_PROJET Then
1305: Call MsgBox("Le projet " & sNoProjSoum & " est inexistant!", MsgBoxStyle.OKOnly, "Erreur")
1310: Else
1315: Call MsgBox("La soumission " & sNoProjSoum & " est inexistant!", MsgBoxStyle.OKOnly, "Erreur")
1320: End If
1325: End If
		
1330: Call rstProjSoum.Close()
1335: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
1340: Exit Sub
		
AfficherErreur: 
		
1345: Call AfficherErreur("frmProjSoumMec", "CalculerTotalRecordset", Err, Erl())
	End Sub
	
	Private Sub ChoisirFournisseurMateriel()
		
5: On Error GoTo AfficherErreur
		
		'On ajoute la pièce en négatif dans le listview
10: Dim rstProjet As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim itmAncien As System.Windows.Forms.ListViewItem
25: Dim itmNouveau As System.Windows.Forms.ListViewItem
30: Dim sQuantite As String
35: Dim sExtra As String
40: Dim sTauxUSA As String
45: Dim sTauxSPA As String
		
50: rstConfig = New ADODB.Recordset
		
55: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
60: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
65: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
70: Call rstConfig.Close()
75: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
80: If m_bChangementFRS = True Then
85: If lvwfournisseur.FocusedItem.Text <> "CHOISIR ULTÉRIEUREMENT" Then
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DISTRIB Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DISTRIB).Text = lvwfournisseur.FocusedItem.Text
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwfournisseur.FocusedItem.Text))
				End If
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
				
100: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BRUN Then
					'Prix listé
105: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) = vbNullString Then
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
115: Else
120: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
130: Else
135: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
140: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
145: Else
150: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
155: End If
160: End If
165: End If
					
170: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag
					
					'Si il y a un prix net, on le met l'escompte et le prix net sinon, on prend le prix
					'spécial pour mettre dans le prix net
175: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) <> vbNullString Then
180: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
							lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)
						Else
							lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)))
						End If
						
185: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
195: Else
200: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
205: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
210: Else
215: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
220: End If
225: End If
230: Else
235: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) <> vbNullString Then
240: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
250: Else
255: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
260: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
265: Else
270: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
275: End If
280: End If
285: Else
290: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
							End If
295: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
300: End If
305: End If
					
310: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_TOTAL Then
						lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
					Else
						lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
					End If
					
315: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TOTAL).Tag = lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag
					
					'Pour le profit, c'est le prix total - (prix net * quantité)
320: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PROFIT Then
						lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
325: End If
330: Else
335: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DISTRIB Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
340: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(0)
				
345: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)))
				End If
350: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
				End If
355: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)))
				End If
				
360: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_TOTAL Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
				End If
				
365: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PROFIT Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
				
370: If m_eType = enumType.TYPE_PROJET Then
375: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_COMMENTAIRE).Text <> "" Then
380: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
385: End If
					
390: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text <> "" Then
395: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_FACTURATION).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
400: End If
405: End If
				
410: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
415: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
420: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
425: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
430: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
435: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
440: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
445: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
				
450: Call lvwSoumission.Refresh()
455: End If
			
460: Call CalculerPrix()
			
			'On cache le listview
465: frafournisseur.Visible = False
			
470: m_bPieceInutile = False
475: m_bChangementFRS = False
480: Else
485: If VB.Right(txtNoProjSoum.Text, 2) >= "01" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
490: sExtra = InputBox("Dans quel extra le retour doit être fait ? (2 chiffres seulement)")
				
495: If Len(sExtra) <> 2 Then
500: Call MsgBox("Format incorrect!", MsgBoxStyle.OKOnly, "Erreur")
					
505: Exit Sub
510: End If
				
515: If Not IsNumeric(sExtra) Then
520: Call MsgBox("L'extra doit être numérique!", MsgBoxStyle.OKOnly, "Erreur")
					
525: Exit Sub
530: End If
				
535: If CDbl(sExtra) < 60 Or CDbl(sExtra) > 98 Then
540: Call MsgBox("L'extra doit être entre 60 et 98!", MsgBoxStyle.OKOnly, "Erreur")
					
545: Exit Sub
550: End If
				
555: rstProjet = New ADODB.Recordset
				
560: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
565: If rstProjet.EOF Then
570: Call MsgBox("Le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & " n'existe pas!", MsgBoxStyle.OKOnly, "Erreur")
					
575: Call rstProjet.Close()
580: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjet = Nothing
					
585: Exit Sub
590: Else
595: Call rstProjet.Close()
600: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjet = Nothing
605: End If
610: End If
			
			'Saisie de la quantité
615: sQuantite = InputBox("Quelle est la quantité?")
			
620: sQuantite = Replace(sQuantite, ".", ",")
			
625: sQuantite = Replace(sQuantite, "-", "")
			
630: If sQuantite <> vbNullString Then
635: If Not IsNumeric(sQuantite) Then
640: Call MsgBox("Quantité non numérique!", MsgBoxStyle.OKOnly, "Erreur")
					
645: Exit Sub
650: End If
655: Else
660: Exit Sub
665: End If
			
670: If CDbl(sQuantite) <= CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) Then
675: itmAncien = lvwSoumission.FocusedItem
680: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau = lvwSoumission.Items.Insert(itmAncien.Index + 1, "")
				
685: itmNouveau.Checked = itmAncien.Checked
				
				'Quantité
690: itmNouveau.Text = "-" & sQuantite
				
				'On met l'id de la section dans le tag du listItem
695: itmNouveau.Tag = itmAncien.Tag
				
				'No d'item
700: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PIECE Then
					itmNouveau.SubItems(I_COL_SOUM_PIECE).Text = itmAncien.SubItems(I_COL_SOUM_PIECE).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_PIECE).Text))
				End If
				
				'On met le nom de la sous-section dans le tag du no d'item
705: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAncien.SubItems.Item(I_COL_SOUM_PIECE).Tag
				
				'On met la description en francais dans la colonne et la description en anglais
				'dans le tag
710: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DESCR Then
					itmNouveau.SubItems(I_COL_SOUM_DESCR).Text = itmAncien.SubItems(I_COL_SOUM_DESCR).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_DESCR).Text))
				End If
715: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAncien.SubItems.Item(I_COL_SOUM_DESCR).Tag
				
				'On met le nom du fabricant dans la colonne et l'ordre de la section dans le tag
720: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmNouveau.SubItems(I_COL_SOUM_MANUFACT).Text = itmAncien.SubItems(I_COL_SOUM_MANUFACT).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_MANUFACT).Text))
				End If
725: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAncien.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
				
				'Prix listé
730: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmNouveau.SubItems(I_COL_SOUM_PRIX_LIST).Text = itmAncien.SubItems(I_COL_SOUM_PRIX_LIST).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_PRIX_LIST).Text))
				End If
				
735: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = itmAncien.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
				
740: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmNouveau.SubItems(I_COL_SOUM_ESCOMPTE).Text = itmAncien.SubItems(I_COL_SOUM_ESCOMPTE).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_ESCOMPTE).Text))
				End If
				
745: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text = itmAncien.SubItems(I_COL_SOUM_PRIX_NET).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_PRIX_NET).Text))
				End If
				
				'On met le fournisseur dans la colonne et l'id dans le tag
750: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DISTRIB Then
					itmNouveau.SubItems(I_COL_SOUM_DISTRIB).Text = lvwfournisseur.FocusedItem.Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwfournisseur.FocusedItem.Text))
				End If
755: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
				
				'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
760: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_TOTAL Then
					itmNouveau.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(m_sProfit)), 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(m_sProfit)), 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
				
				'Pour le profit, c'est le prix total - (prix net * quantité)
765: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PROFIT Then
					itmNouveau.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(System.Math.Round(CDbl(itmNouveau.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text))), 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(itmNouveau.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text))), 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
				
770: If VB.Right(txtNoProjSoum.Text, 2) >= "01" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
					'Pour savoir lors de l'enregistrement qu'il faut le lier avec le 81
775: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PROFIT).Tag = "RETOUR " & sExtra
780: End If
				
785: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
					itmNouveau.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
790: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
					itmNouveau.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
795: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
					itmNouveau.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
800: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
					itmNouveau.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
				
805: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(itmAncien.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Then
810: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
815: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
820: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
825: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
830: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
835: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
840: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
845: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
850: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
855: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
860: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
865: Else
870: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
875: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
880: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
885: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
890: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
895: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
900: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
905: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
910: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
915: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
920: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
925: End If
				
				'Calcul des prix
930: Call CalculerPrix()
				
				'On cache le listview
935: frafournisseur.Visible = False
				
940: m_bPieceInutile = False
				
				'Resélectionne le premier élément du listview
945: If lvwSoumission.Items.Count > 0 Then
950: Call Deselect()
					
955: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.Items.Item(1).Selected = True
960: End If
965: Else
970: Call MsgBox("Quantité trop grande!", MsgBoxStyle.OKOnly, "Erreur")
975: End If
980: End If
		
985: Exit Sub
		
AfficherErreur: 
		
990: Call AfficherErreur("frmProjSoumMec", "ChoisirFournisseurMateriel", Err, Erl())
	End Sub
	
	Private Sub ChoisirFournisseur()
		
5: On Error GoTo AfficherErreur
		
		'On ajoute la pièce dans lvwSoumission
10: Dim sQuantite As String
15: Dim sSousSection As String
20: Dim bDemanderSS As Boolean
		Dim sParams As String
		
		'Si l'utilisateur a déjà choisi un emplacement, il ne faut pas
		'lui demander dans quelle sous-section
		
		'Si il y a des enregistrements dans le listview
25: If lvwSoumission.Items.Count > 0 Then
			'Si le premier n'est pas sélectionné.. celui-ci est sélectionné par défaut
30: If lvwSoumission.FocusedItem.Index > 1 Then
				'Si l'emplacement est valide
35: If VerifierEmplacement(lvwSoumission.FocusedItem.Index) = True Then
					'Si c'est une sous-section
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).Tag = vbNullString Then
						'Si l'autre d'au dessus est une section
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).Tag = vbNullString Then
							'Message d'erreur
50: Call MsgBox("Vous ne pouvez pas mettre une pièce entre une section et une sous-section", MsgBoxStyle.OKOnly, "Erreur")
							
55: frafournisseur.Visible = False
							
							'Il faut resélectionné le premier pour faire comme si il n'était plus
							'sélectionné
60: Call Deselect()
							
65: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							lvwSoumission.Items.Item(1).Selected = True
							
70: Exit Sub
75: Else
							'Sinon, on prend le tag de la section d'en haut
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							sSousSection = lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
85: End If
90: Else
						'On prend le tag de l'élément sélectionné
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.SelectedItem.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sSousSection = lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).Tag
100: End If
105: Else
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag <> "" Then
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If MsgBox("Vous essayez d'ajouter une pièce de la section " & cmbSections.Text & " dans la section " & VB6.GetItemString(cmbSections, lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag - 1) & vbNewLine & "Voulez-vous ajouter la pièce dans la section " & VB6.GetItemString(cmbSections, lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag - 1), MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							cmbSections.SelectedIndex = lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag - 1
							
125: Call ChoisirFournisseur()
130: End If
						
135: frafournisseur.Visible = False
						
						'Il faut resélectionné le premier pour faire comme si il n'était plus
						'sélectionné
140: Call Deselect()
						
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.Items.Item(1).Selected = True
						
150: Exit Sub
155: Else
160: Call MsgBox("Impossible d'ajouter entre une section et une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
						
165: Exit Sub
170: End If
175: End If
180: Else
185: bDemanderSS = True
190: End If
195: Else
			'Sinon, on demande la section
200: bDemanderSS = True
205: End If
		
		'Saisie de la quantité
210: sQuantite = InputBox("Quelle est la quantité?")
		
215: sQuantite = Replace(sQuantite, ".", ",")
		
220: If sQuantite <> vbNullString Then
225: If Not IsNumeric(sQuantite) Then
230: Call MsgBox("Quantité non numérique!", MsgBoxStyle.OKOnly, "Erreur")
				
235: Exit Sub
240: Else
245: If CDbl(sQuantite) < 0 Then
250: If lvwfournisseur.FocusedItem.Text = "CHOISIR ULTÉRIEUREMENT" Then
255: Call MsgBox("Impossible de faire une demande de prix sur une pièce négative!", MsgBoxStyle.OKOnly, "Erreur")
						
260: Exit Sub
265: End If
270: End If
275: End If
280: Else
285: Exit Sub
290: End If
		
295: If bDemanderSS = True Then
300: If m_sSousSection <> S_PAS_SOUS_SECTION Then
305: sSousSection = InputBox("Quelle est la sous-section?",  , m_sSousSection)
310: Else
315: sSousSection = InputBox("Quelle est la sous-section?")
320: End If
325: End If
		
		'Si la sous-section est vide
330: If sSousSection = vbNullString Then
			'On initialise la sous-section à "PAS DE SOUS-SECTIONS"
335: sSousSection = S_PAS_SOUS_SECTION
340: m_sSousSection = vbNullString
345: Else
350: m_sSousSection = sSousSection
355: End If
		
360: If CDbl(sQuantite) < 0 Then
365: If m_eType = enumType.TYPE_PROJET Then
370: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 Then
375: Call AjouterNegatifDansListView(CDbl(sQuantite), sSousSection)
380: Else
385: Call AjouterDansListViewSoumission(CDbl(sQuantite), sSousSection)
390: End If
395: Else
400: Call AjouterDansListViewSoumission(CDbl(sQuantite), sSousSection)
405: End If
410: Else
415: Call AjouterDansListViewSoumission(CDbl(sQuantite), sSousSection)
420: End If
		
		'Calcul des prix
425: Call CalculerPrix()
		
		'On cache le listview
430: frafournisseur.Visible = False
		
		'Resélectionne le premier élément du listview
435: If lvwSoumission.Items.Count > 0 Then
440: Call Deselect()
			
445: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.Items.Item(1).Selected = True
450: End If
		
455: Exit Sub
		
AfficherErreur: 
		
		If Err.Number = 13 And Erl() = 115 Then
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			sParams = "cmbSections.Text : " & cmbSections.Text & "   " & "No Proj/Soum : " & txtNoProjSoum.Text & "   " & "lvwSoumission.SelectedItem.Index - 1 : " & lvwSoumission.FocusedItem.Index - 1 & "   " & "lvwSoumission.ListItems(lvwSoumission.SelectedItem.Index - 1).ListSubItems(I_COL_SOUM_MANUFACT).Tag : " & lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
			
			Call AfficherErreur("frmProjSoumMec", "ChoisirFournisseur", Err, Erl(), sParams)
		Else
460: Call AfficherErreur("frmProjSoumMec", "ChoisirFournisseur", Err, Erl())
		End If
	End Sub
	
	Private Sub lvwFournisseur_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwFournisseur.DoubleClick
		
5: On Error GoTo AfficherErreur
		
10: If m_bPieceInutile = True Or m_bChangementFRS = True Then
15: Call ChoisirFournisseurMateriel()
20: Else
25: Call ChoisirFournisseur()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "lvwFournisseur_DblClick", Err, Erl())
	End Sub
	
	Private Sub lvwPieces_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwPieces.DoubleClick
		
5: On Error GoTo AfficherErreur
		
10: m_bPieceInutile = False
15: m_bRecherchePiece = False
20: m_bChangementFRS = False
		
		'On affiche lvwFournisseur selon la pièce choisie
		'Rempli les fournisseurs de la pièce choisie
25: If cmbSections.Items.Count > 0 Then
30: Call AfficherListeFournisseurs()
			
			'si le listview n'est pas vide
35: If lvwfournisseur.Items.Count = 1 Then
40: If MsgBox("Il n'y a aucun fournisseur pour cette pièce!" & vbNewLine & "Voulez-vous en ajouter?", MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
					
					'On ouvre le catalogue sur cet enregistrement
50: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					Call FrmCatalogueMec.AfficherForm(cmbPieces.Text, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text)
					
55: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
60: End If
65: End If
70: Else
75: Call MsgBox("Il n'y a pas de sections!", MsgBoxStyle.OKOnly, "Erreur")
80: End If
		
85: Exit Sub
		
AfficherErreur: 
		
90: Call AfficherErreur("frmProjSoumMec", "lvwPieces_DblClick", Err, Erl())
	End Sub
	
	Private Sub AfficherListeFournisseurs()
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui sert à affiche la liste des fournisseurs
		'Affiche le frame seulement si il y a des items dans listview
10: Call RemplirListViewFournisseur()
		
15: If lvwfournisseur.Items.Count > 1 Then
20: If m_bRecherchePiece = True Then
25: fraPieceTrouve.Visible = False
30: End If
			
35: frafournisseur.Visible = True
40: Call lvwfournisseur.Focus()
45: End If
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumMec", "AfficherListeFournisseurs", Err, Erl())
	End Sub
	
	Private Sub lvwPieces_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles lvwPieces.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
10: Dim sTexte As String
		
15: If Shift = VB6.ShiftConstants.CtrlMask Then
20: If KeyCode = System.Windows.Forms.Keys.F Then
25: sTexte = InputBox("Quel est le texte à rechercher?")
				
30: If Trim(sTexte) <> vbNullString Then
35: If Len(Trim(sTexte)) >= 2 Then
40: Call RemplirListViewRecherche(I_COL_PIECES_NO_ITEM, sTexte)
						
45: If lvwPieceTrouve.Items.Count > 0 Then
50: fraPieceTrouve.Visible = True
55: Else
60: Call MsgBox("Aucun enregistrements trouvés!", MsgBoxStyle.OKOnly, "Erreur")
65: End If
70: Else
75: Call MsgBox("Il faut un minimum de 2 caractères pour rechercher!", MsgBoxStyle.OKOnly, "Erreur")
80: End If
85: End If
90: End If
95: Else
100: If KeyCode = System.Windows.Forms.Keys.Return Then
105: Call lvwPieces_DoubleClick(lvwPieces, New System.EventArgs())
110: End If
115: End If
		
120: Exit Sub
		
AfficherErreur: 
		
125: Call AfficherErreur("frmProjSoumMec", "lvwPieces_KeyDown", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwSoumission.DoubleClick
		
5: On Error GoTo AfficherErreur
		
		'Si il y a des enregistrements
10: If lvwSoumission.Items.Count > 0 Then
15: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
25: Call ModifierSousSection()
30: Else
					'Si c'est une pièce
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.FocusedItem.Tag <> vbNullString Then
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la pièce n'a pas de fournisseur
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString Then
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
55: Call AjouterPrix()
60: Else
65: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
70: End If
75: Else
								'Si le listItem est orange
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ORANGE Then
85: If MsgBox("Voulez-vous annuler cette commande?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
90: Call AnnulerCommande()
95: End If
100: Else
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
110: Call ChangerFournisseurRetour()
115: End If
120: End If
125: End If
130: Else
135: Call ModifierTexte()
140: End If
145: End If
150: End If
155: End If
160: End If
		
165: Exit Sub
		
AfficherErreur: 
		
170: Call AfficherErreur("frmProjSoumMec", "lvwSoumission_DblClick", Err, Erl())
	End Sub
	
	Private Sub AjouterPrix()
		
5: On Error GoTo AfficherErreur
		
10: Call ViderChamps_frs()
		
		'Rempli le combo des fournisseurs
15: Call RemplirComboFournisseur()
		
20: 'UPGRADE_ISSUE: ComboBox property cmbfrs.Locked was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		cmbfrs.Locked = False
		
25: m_bMauvaisPrix = False
		
		'Positionne le frame
30: fraPrix.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Top) + 500)
		
		'Montre le frame
35: fraPrix.Visible = True
		
		'Met le numéro de la pièce dans le tag
40: fraPrix.Tag = lvwSoumission.FocusedItem.Index
		
		'Donne le focus au combo
45: Call cmbfrs.Focus()
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumMec", "AjouterPrix", Err, Erl())
	End Sub
	
	Private Sub ModifierTexte()
		
5: On Error GoTo AfficherErreur
		
10: Dim sTexte As String
		
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		sTexte = InputBox("Quel est le nouveau texte?",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text)
		
20: If sTexte <> "" Then
25: If Len(sTexte) > 255 Then
30: Call MsgBox("Le texte ne doit pas dépasser 255 caractères!", MsgBoxStyle.OKOnly, "Erreur")
35: Else
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DESCR Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text = sTexte
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sTexte))
				End If
45: End If
50: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumMec", "ModifierTexte", Err, Erl())
	End Sub
	
	Private Sub ModifierSousSection()
		
5: On Error GoTo AfficherErreur
		
10: Dim sSousSection As String
15: Dim sAncienneSS As String
20: Dim sTag As String
25: Dim iCompteur As Short
		
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		sSousSection = InputBox("Quel est le nouveau nom de la sous-section?",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text)
		
35: 'UPGRADE_ISSUE: StrPtr function is not supported. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="367764E5-F3F8-4E43-AC3E-7FE0B5E074E2"'
		If StrPtr(sSousSection) <> 0 Then
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			sAncienneSS = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text
			
45: If sAncienneSS = vbNullString Then
50: sAncienneSS = S_PAS_SOUS_SECTION
55: End If
			
60: If Trim(sSousSection) = vbNullString Then
65: sTag = S_PAS_SOUS_SECTION
70: sSousSection = vbNullString
75: Else
80: sTag = sSousSection
85: End If
			
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DESCR Then
				lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
			Else
				lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
			End If
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
			
100: For iCompteur = lvwSoumission.FocusedItem.Index + 1 To lvwSoumission.Items.Count
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag = sAncienneSS Then
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag = sTag
115: Else
120: Exit For
125: End If
130: Next 
135: End If
		
140: Exit Sub
		
AfficherErreur: 
		
145: Call AfficherErreur("frmProjSoumMec", "ModifierSousSection", Err, Erl())
	End Sub
	
	Private Sub ChangerFournisseurRetour()
		
5: On Error GoTo AfficherErreur
		
10: m_bRecherchePiece = False
15: m_bChangementFRS = True
		
20: Call AfficherListeFournisseurs()
		
25: If lvwfournisseur.Items.Count = 0 Then
30: Call MsgBox("Il n'y a aucun fournisseur pour cette pièce!", MsgBoxStyle.OKOnly, "Erreur")
			
35: Exit Sub
40: Else
45: frafournisseur.Visible = True
50: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumMec", "ChangerFournisseurRetour", Err, Erl())
	End Sub
	
	
	Private Sub RechercherPieceListViewSoumission(ByVal sTexte As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
15: Dim iSelected As Short
20: Dim bTrouve As Boolean
		
25: If lvwSoumission.FocusedItem.Index = 1 Then
30: iSelected = 1
35: Else
40: If lvwSoumission.FocusedItem.Index + 1 > lvwSoumission.Items.Count Then
45: iSelected = 1
50: Else
55: iSelected = lvwSoumission.FocusedItem.Index + 1
60: End If
65: End If
		
70: For iCompteur = iSelected To lvwSoumission.Items.Count
75: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If InStr(1, UCase(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text), UCase(sTexte)) > 0 Then
80: Call lvwSoumission.Focus()
				
81: Call Deselect()
				
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(iCompteur).Selected = True
				
90: 'UPGRADE_WARNING: MSComctlLib.IListItem method lvwSoumission.SelectedItem.EnsureVisible has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				Call lvwSoumission.FocusedItem.EnsureVisible()
				
95: bTrouve = True
				
100: Exit For
105: End If
110: Next 
		
115: If bTrouve = False Then
120: For iCompteur = 1 To iSelected - 1
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If InStr(1, UCase(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text), UCase(sTexte)) > 0 Then
130: Call lvwSoumission.Focus()
					
131: Call Deselect()
					
135: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.Items.Item(iCompteur).Selected = True
					
140: 'UPGRADE_WARNING: MSComctlLib.IListItem method lvwSoumission.SelectedItem.EnsureVisible has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					Call lvwSoumission.FocusedItem.EnsureVisible()
					
145: bTrouve = True
					
150: Exit For
155: End If
160: Next 
165: End If
		
170: If bTrouve = False Then
175: Call MsgBox("Aucun enregistrement trouvé!", MsgBoxStyle.OKOnly, "Erreur")
180: End If
		
185: Exit Sub
		
AfficherErreur: 
		
190: Call AfficherErreur("frmProjSoumMec", "RechercherPieceListViewSoumission", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_ItemCheck(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.ItemCheckEventArgs) Handles lvwSoumission.ItemCheck
		Dim Item As System.Windows.Forms.ListViewItem = lvwSoumission.Items(eventArgs.Index)
		
5: On Error GoTo AfficherErreur
		
		'Si le programme n'est pas en mode ajout ou modif
10: If m_eMode = enumMode.MODE_INACTIF Then
			'On annule le ItemCheck
15: Item.Checked = Not Item.Checked
20: Else
			'Si c'est une section, une sous-section ou du texte
25: 'UPGRADE_WARNING: Lower bound of collection Item has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Item.Tag = vbNullString Or Item.SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
				'On annule le ItemCheck
30: Item.Checked = Not Item.Checked
35: End If
40: End If
		
45: Exit Sub
		
AfficherErreur: 
		
50: Call AfficherErreur("frmProjSoumMec", "lvwSoumission_ItemCheck", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles lvwSoumission.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
		'Si le ListView n'est pas vide
10: If lvwSoumission.Items.Count > 0 Then
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = -2147483640 Then
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.Color.Black
25: End If
			
30: If Shift = VB6.ShiftConstants.CtrlMask Then
35: If KeyCode = System.Windows.Forms.Keys.F Then
40: m_sTexteRecherche = InputBox("Quel est la pièce à rechercher?")
					
45: If Trim(m_sTexteRecherche) <> vbNullString Then
50: Call RechercherPieceListViewSoumission(m_sTexteRecherche)
55: End If
60: Else
65: If KeyCode = System.Windows.Forms.Keys.N Then
70: If Trim(m_sTexteRecherche) <> vbNullString Then
75: Call RechercherPieceListViewSoumission(m_sTexteRecherche)
80: End If
85: Else
						'S'il n'est pas en mode affichage
90: If m_bModeAffichage = False Then
							'Si ce n'est pas une sous-section
95: If KeyCode = System.Windows.Forms.Keys.C Then
100: Call CopierPiece()
105: Else
110: If KeyCode = System.Windows.Forms.Keys.V Then
115: Call CollerPiece()
120: End If
125: End If
130: End If
135: End If
140: End If
145: Else
				'S'il n'est pas en mode affichage
150: If m_bModeAffichage = False Then
					'Si ce n'est pas une section
155: If lvwSoumission.FocusedItem.Tag <> vbNullString Then
						'Si ce n'est pas une sous-section
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
							'Si la touche pesée est Delete
165: If KeyCode = System.Windows.Forms.Keys.Delete Then
								'On l'efface
170: Call EffacerItemListViewSoumission()
175: Else
180: If KeyCode = System.Windows.Forms.Keys.Return Or KeyCode = System.Windows.Forms.Keys.N Then
185: If m_eType = enumType.TYPE_PROJET Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
195: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
200: If KeyCode = System.Windows.Forms.Keys.Return Then
205: Call FacturerDate()
210: Else
215: Call FacturerNC()
220: End If
225: Else
230: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
235: End If
240: End If
245: End If
250: End If
255: End If
260: End If
265: End If
270: End If
275: End If
280: End If
		
285: Exit Sub
		
AfficherErreur: 
		
290: Call AfficherErreur("frmProjSoumMec", "lvwSoumission_KeyDown", Err, Erl())
	End Sub
	
	Private Sub FacturerDate()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si c'est pas une section
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> "" Then
				'Si c'est pas une sous-section
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "" Then
					'Si la pièce est sélectionnée
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
						'Si il y a une date d'écrit
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If VB.Left(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text, 2) = "F-" Then
							'On l'enlève
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
								lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = ""
							Else
								lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
45: Else
							'Si il n'y a rien
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text) = "" Then
								'On ajoute la date de facturation
55: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
									lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = "F-" & txtDateFacturation.Text
								Else
									lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "F-" & txtDateFacturation.Text))
								End If
60: End If
65: End If
70: End If
75: End If
80: End If
85: Next 
		
90: Exit Sub
		
AfficherErreur: 
		
95: Call AfficherErreur("frmProjSoumMec", "FacturerDate", Err, Erl())
	End Sub
	
	Private Sub FacturerNC()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si c'est pas une section
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> "" Then
				'Si c'est pas une sous-section
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "" Then
					'Si la pièce est sélectionnée
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
						'Si il y a NC d'écrit
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = "NC" Then
							'On l'enlève
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
								lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = ""
							Else
								lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
45: Else
							'Si il n'y a rien
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text) = "" Then
								'On ajoute la date de facturation
55: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
									lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = "NC"
								Else
									lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "NC"))
								End If
60: End If
65: End If
70: End If
75: End If
80: End If
85: Next 
		
90: Exit Sub
		
AfficherErreur: 
		
95: Call AfficherErreur("frmProjSoumMec", "FacturerNC", Err, Erl())
	End Sub
	
	Private Sub EffacerItemListViewSoumission()
		
5: On Error GoTo AfficherErreur
		
10: Dim bSeulSS As Boolean 'Pour savoir si c'est le seul enr. dans la sous-section
15: Dim bSeulS As Boolean 'Pour savoir si c'est le seul enr. dans la section
20: Dim iIndex As Short
25: Dim itmPrecedent As System.Windows.Forms.ListViewItem
30: Dim itmSuivant As System.Windows.Forms.ListViewItem
35: Dim iCompteur As Short
40: Dim sMessage As String
45: Dim iNbreSelected As Short
50: Dim bSupprimer As Boolean
55: Dim bPermission As Boolean
		
60: For iCompteur = 1 To lvwSoumission.Items.Count
65: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Selected = True Then
70: iNbreSelected = iNbreSelected + 1
				
75: If iNbreSelected > 1 Then
80: Exit For
85: End If
90: End If
95: Next 
		
100: If iNbreSelected > 1 Then
105: sMessage = "Voulez-vous vraiment effacer ces pièces?"
110: Else
115: sMessage = "Voulez-vous vraiment effacer cette pièce?"
120: End If
		
125: If m_eType = enumType.TYPE_SOUMISSION Then
130: bPermission = True
135: Else
140: If iNbreSelected > 1 Then
145: bPermission = True
150: Else
155: For iCompteur = 1 To lvwSoumission.Items.Count
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
165: Exit For
170: End If
175: Next 
				
180: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_MAGENTA Then
185: bPermission = True
190: End If
195: End If
200: End If
		
205: iCompteur = 1
		
210: If bPermission = True Then
215: If MsgBox(sMessage, MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
220: Do While iCompteur <= lvwSoumission.Items.Count
225: bSupprimer = False
230: bSeulS = False
235: bSeulSS = False
					
240: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
						'Si ce n'est pas une section
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
250: 'Si c'est une sous-section
255: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
260: If m_eType = enumType.TYPE_SOUMISSION Then
265: bSupprimer = True
270: Else
275: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_MAGENTA Then
280: bSupprimer = True
285: End If
290: End If
								
295: If bSupprimer = True Then
300: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text = "" Then
305: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_PROFIT Then
											lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text = " "
										Else
											lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
										End If
310: End If
									
315: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
320: If m_bModeAjout = False Then
325: Call AjouterSuppressionCollection(iCompteur)
330: End If
										
335: iIndex = iCompteur
										
										'Il faut vérifier si c'est le seul enregistrement de la section.
										'Si c'est le cas, il faut effacer la section en meme temps
										'Si l'item sélectionné est le dernier enregistrement
340: If iIndex = lvwSoumission.Items.Count Then
											'Si l'élément d'en haut est une sous-section
345: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Text = vbNullString Then
												'Il est le seul dans la sous-section
350: bSeulSS = True
												
												'Il faut maintenant vérifier si il est le seul dans la section
355: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												If lvwSoumission.Items.Item(iIndex - 2).Tag = vbNullString Then
													'Il est le seul enr. dans la section
360: bSeulS = True
365: End If
370: End If
375: Else
380: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											itmPrecedent = lvwSoumission.Items.Item(iIndex - 1)
385: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											itmSuivant = lvwSoumission.Items.Item(iIndex + 1)
											
											'Si l'élément précedent est une sous-section et le suivant est une sous-section ou une section
390: 'UPGRADE_WARNING: Lower bound of collection itmSuivant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											'UPGRADE_WARNING: Lower bound of collection itmPrecedent.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If itmPrecedent.SubItems.Item(I_COL_SOUM_PIECE).Tag = vbNullString And (itmSuivant.Tag = vbNullString Or (itmSuivant.Tag <> vbNullString And itmSuivant.SubItems.Item(I_COL_SOUM_PIECE).Tag = vbNullString)) Then
												'C'est le seul dans la sous-section
395: bSeulSS = True
												
												'Si les éléments avant et après sont des sections
400: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												If lvwSoumission.Items.Item(iIndex - 2).Tag = vbNullString And itmSuivant.Tag = vbNullString Then
405: bSeulS = True
410: End If
415: End If
420: End If
										
425: Call lvwSoumission.Items.RemoveAt(iIndex)
										
										'On calcule les prix
430: Call CalculerPrix()
										
										'Si c'est le seul dans la sous-section, on efface la sous-section
435: If bSeulSS = True Then
440: Call lvwSoumission.Items.RemoveAt(iIndex - 1)
											
445: iCompteur = iCompteur - 1
450: End If
										
										'Si c'est le seul dans la section, on efface la section
455: If bSeulS = True Then
460: Call lvwSoumission.Items.RemoveAt(iIndex - 2)
											
465: iCompteur = iCompteur - 1
470: End If
475: Else
480: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										Call MsgBox("La pièce " & lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text & " doit être effacée dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
										
485: iCompteur = iCompteur + 1
490: End If
495: Else
500: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									Call MsgBox("La pièce " & lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text & " ne peut pas être supprimée!", MsgBoxStyle.OKOnly, "Erreur")
									
505: iCompteur = iCompteur + 1
510: End If
515: Else
520: iCompteur = iCompteur + 1
525: End If
530: Else
535: iCompteur = iCompteur + 1
540: End If
545: Else
550: iCompteur = iCompteur + 1
555: End If
560: Loop 
565: Else
				'Cette ligne sert seulement à ne pas déselectionner et repositionner à la ligne 1 si l'utilisateur
				'décide de ne pas supprimer.
				'Le nom de la variable n'est pas significatif dans ce cas, mais c'est celle-ci qui est utilisé pour
				'désélectionner et remettre à la ligne 1
570: bPermission = False
575: End If
580: End If
		
		'Il faut resélectionner le premier à la fin
585: If lvwSoumission.Items.Count > 0 Then
590: If bPermission = True Then
595: Call Deselect()
				
600: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(1).Selected = True
605: End If
610: End If
		
615: Exit Sub
		
AfficherErreur: 
		
620: Call AfficherErreur("frmProjSoumMec", "EffacerItemListViewSoumission", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles lvwSoumission.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.PixelsToTwipsX(eventArgs.X)
		Dim Y As Single = VB6.PixelsToTwipsY(eventArgs.Y)
		
5: On Error GoTo AfficherErreur
		
10: Dim iNbreSelected As Short
15: Dim iIndexSelected As Short
20: Dim iCompteur As Short
25: Dim bAfficherMenu As Boolean
		
30: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
35: If Button = VB6.MouseButtonConstants.RightButton Then
40: If lvwSoumission.Items.Count > 0 Then
					'S'il y a plusieurs items de sélectionnés, c'est parce que l'utilisateur
					'a sélectionné plusieurs items
					'Donc, on ne désélectionne pas
45: For iCompteur = 1 To lvwSoumission.Items.Count
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).Selected = True Then
55: iNbreSelected = iNbreSelected + 1
							
60: iIndexSelected = iCompteur
65: End If
70: Next 
					
75: If iNbreSelected = 1 Then
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.Items.Item(iIndexSelected).Selected = False
85: End If
					
90: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					lvwSoumission.DropHighlight = lvwSoumission.GetItemAt(X, Y)
					
95: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					If Not lvwSoumission.DropHighlight Is Nothing Then
100: If iNbreSelected = 1 Then
105: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							lvwSoumission.DropHighlight.Selected = True
							
110: If lvwSoumission.FocusedItem.Tag <> "" Then
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor) <> COLOR_BLEU And System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor) <> COLOR_ROSE Then
120: bAfficherMenu = True
125: Else
130: bAfficherMenu = False
135: End If
140: End If
145: Else
150: If m_eType = enumType.TYPE_PROJET Then
155: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
								If lvwSoumission.DropHighlight.Selected = True Then
160: If lvwSoumission.FocusedItem.Tag <> "" Then
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
170: If g_bModificationFacturation = True Then
175: bAfficherMenu = True
180: Else
185: bAfficherMenu = False
190: End If
195: Else
200: bAfficherMenu = False
205: End If
210: Else
215: bAfficherMenu = False
220: End If
225: End If
230: Else
235: bAfficherMenu = False
240: End If
245: End If
250: Else
255: bAfficherMenu = False
260: End If
					
265: If bAfficherMenu = True Then
270: Call RemplirOptionsMenuRightClick(iNbreSelected)
						
275: 'UPGRADE_ISSUE: Form method FrmProjSoumMec.PopupMenu was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						Call PopupMenu(mnuRightClick)
280: End If
285: End If
290: Else
295: If Shift <> VB6.ShiftConstants.CtrlMask And Shift <> VB6.ShiftConstants.ShiftMask Then
300: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_NOTE: Object lvwSoumission.DropHighlight may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					lvwSoumission.DropHighlight = Nothing
305: End If
310: End If
315: End If
		
320: Exit Sub
		
AfficherErreur: 
		
325: Call AfficherErreur("frmProjSoumMec", "lvwSoumission_MouseDown", Err, Erl())
	End Sub
	
	Private Sub RemplirOptionsMenuRightClick(ByVal iNbreSelected As Short)
		
5: On Error GoTo AfficherErreur
		
10: Dim bFacturer As Boolean
15: Dim bNC As Boolean
20: Dim bDateRequise As Boolean
25: Dim bCommentaire As Boolean
30: Dim bMauvaisPrix As Boolean
35: Dim bMaterielInutile As Boolean
40: Dim bTexte As Boolean
45: Dim bSousSection As Boolean
50: Dim bFournisseur As Boolean
55: Dim bAnnulerCommande As Boolean
60: Dim bSupprimer As Boolean
65: Dim bAjouterPrix As Boolean
70: Dim bSortieMagasin As Boolean
75: Dim bQuantite As Boolean
		
80: If iNbreSelected > 1 Then
85: If m_eType = enumType.TYPE_PROJET Then
90: If g_bModificationFacturation = True Then
95: bFacturer = True
100: bNC = True
105: bSupprimer = True
110: End If
115: End If
120: Else
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = "" Then
130: bSousSection = True
135: Else
140: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
145: bTexte = True
					
150: If (m_eType = enumType.TYPE_SOUMISSION) Or ((m_eType = enumType.TYPE_PROJET) And (CDbl(VB.Right(txtNoProjSoum.Text, 2)) > 19)) Then
155: bSupprimer = True
160: End If
165: Else
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = -2147483640 Then
175: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(0)
180: End If
					
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					Select Case System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor)
						Case COLOR_ORANGE
190: If g_bModificationFacturation = True Then
195: bFacturer = True
200: bNC = True
205: End If
							
210: bDateRequise = True
215: bCommentaire = True
220: bAnnulerCommande = True
225: bMauvaisPrix = True
							
						Case COLOR_BRUN
230: bCommentaire = True
235: bFournisseur = True
							
240: If (m_eType = enumType.TYPE_SOUMISSION) Or ((m_eType = enumType.TYPE_PROJET) And (CDbl(VB.Right(txtNoProjSoum.Text, 2)) > 19)) Then
245: bSupprimer = True
250: End If
							
						Case COLOR_GRIS
255: If g_bModificationFacturation = True Then
260: bFacturer = True
265: bNC = True
270: End If
							
275: bCommentaire = True
280: bMauvaisPrix = True
285: bMaterielInutile = True
							
						Case COLOR_VERT_FORET
290: bCommentaire = True
							
295: If (m_eType = enumType.TYPE_SOUMISSION) Or ((m_eType = enumType.TYPE_PROJET) And (CDbl(VB.Right(txtNoProjSoum.Text, 2)) > 19)) Then
300: bSupprimer = True
305: End If
							
						Case COLOR_ROUGE
310: bCommentaire = True
							
						Case COLOR_MAGENTA
315: bCommentaire = True
320: bAjouterPrix = True
							
325: If m_eType = enumType.TYPE_SOUMISSION Then
330: bQuantite = True
335: End If
							
						Case COLOR_NOIR
340: If m_eType = enumType.TYPE_PROJET Then
345: If g_bModificationFacturation = True Then
350: bFacturer = True
355: bNC = True
360: End If
								
365: bMaterielInutile = True
370: bSortieMagasin = True
375: Else
380: bQuantite = True
385: End If
							
400: bCommentaire = True
405: bMauvaisPrix = True
410: bFournisseur = True
415: bSupprimer = True
420: End Select
425: End If
430: End If
435: End If
		
		'Pour empeche que tous les éléments deviennent invisible, je les mets visible au
		'début
440: mnuFacturer.Visible = True
445: mnuNC.Visible = True
450: mnuDateRequise.Visible = True
455: mnuCommentaire.Visible = True
460: mnuMauvaisPrix.Visible = True
465: mnuInutile.Visible = True
470: mnuTexte.Visible = True
475: mnuChangerSS.Visible = True
480: mnuFournisseur.Visible = True
485: mnuAnnulerCommande.Visible = True
490: mnuSupprimer.Visible = True
495: mnuAjouterPrix.Visible = True
500: mnuSortieMagasin.Visible = True
505: mnuQuantite.Visible = True
		
510: mnuFacturer.Visible = bFacturer
515: mnuNC.Visible = bNC
520: mnuDateRequise.Visible = bDateRequise
525: mnuCommentaire.Visible = bCommentaire
530: mnuMauvaisPrix.Visible = bMauvaisPrix
535: mnuInutile.Visible = bMaterielInutile
540: mnuTexte.Visible = bTexte
545: mnuChangerSS.Visible = bSousSection
550: mnuFournisseur.Visible = bFournisseur
555: mnuAnnulerCommande.Visible = bAnnulerCommande
560: mnuSupprimer.Visible = bSupprimer
565: mnuAjouterPrix.Visible = bAjouterPrix
570: mnuSortieMagasin.Visible = bSortieMagasin
575: mnuQuantite.Visible = bQuantite
		
580: Exit Sub
		
AfficherErreur: 
		
585: Call AfficherErreur("frmProjSoumMec", "RemplirOptionsMenuRightClick", Err, Erl())
	End Sub
	
	Public Sub mnuAjouterPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuAjouterPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: Call AjouterPrix()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuAjouterPrix_Click", Err, Erl())
	End Sub
	
	Public Sub mnuAnnulerCommande_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuAnnulerCommande.Click
		
5: On Error GoTo AfficherErreur
		
10: Call AnnulerCommande()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuAnnulerCommande_Click", Err, Erl())
	End Sub
	
	Public Sub mnuChangerSS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuChangerSS.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ModifierSousSection()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuChangerSS_Click", Err, Erl())
	End Sub
	
	Public Sub mnuDateRequise_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuDateRequise.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If Trim(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text) = "" Then
15: mvwDateRequise.Year = Year(Today)
20: mvwDateRequise.Month = Month(Today)
25: mvwDateRequise.Day = VB.Day(Today)
30: Else
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			mvwDateRequise.Year = CShort(VB.Left(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text, 4))
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			mvwDateRequise.Month = CShort(Mid(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text, 6, 2))
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			mvwDateRequise.Day = CShort(VB.Right(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text, 2))
50: End If
		
55: fraDateRequise.Top = lvwSoumission.Top
		
60: fraDateRequise.Visible = True
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumMec", "mnuDateRequise_Click", Err, Erl())
	End Sub
	
	Public Sub mnuCommentaire_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuCommentaire.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		txtcommentaire.Text = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_COMMENTAIRE).Text
		
15: fraCommentaire.Top = lvwSoumission.Top
		
20: fraCommentaire.Visible = True
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "mnuCommentaire_Click", Err, Erl())
	End Sub
	
	Public Sub mnuFacturer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuFacturer.Click
		
5: On Error GoTo AfficherErreur
		
10: Call FacturerDate()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuFacturer_Click", Err, Erl())
	End Sub
	
	Public Sub mnuFournisseur_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuFournisseur.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ChangerFournisseurRetour()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuFournisseur_Click", Err, Erl())
	End Sub
	
	Public Sub mnuInutile_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuInutile.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MaterielInutile()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuInutile_Click", Err, Erl())
	End Sub
	
	Public Sub mnuMauvaisPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuMauvaisPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MauvaisPrix()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuMauvaisPrix", Err, Erl())
	End Sub
	
	Public Sub mnuNC_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuNC.Click
		
5: On Error GoTo AfficherErreur
		
10: Call FacturerNC()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuNC_Click", Err, Erl())
	End Sub
	
	Public Sub mnuQuantite_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuQuantite.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ChangerQuantite()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuQuantite_Click", Err, Erl())
	End Sub
	
	Public Sub mnuSortieMagasin_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuSortieMagasin.Click
		
5: On Error GoTo AfficherErreur
		
10: Call SortieMagasin()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuSortieMagasin_Click", Err, Erl())
	End Sub
	
	Public Sub mnuSupprimer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuSupprimer.Click
		
5: On Error GoTo AfficherErreur
		
10: Call EffacerItemListViewSoumission()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuSupprimer_Click", Err, Erl())
	End Sub
	
	Public Sub mnuTexte_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTexte.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ModifierTexte()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mnuTexte_Click", Err, Erl())
	End Sub
	
	Private Sub EnleverSelection()
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_NOTE: Object lvwSoumission.DropHighlight may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		lvwSoumission.DropHighlight = Nothing
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "EnleverSelection", Err, Erl())
	End Sub
	
	Private Sub mvwDateRequise_Enter(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mvwDateRequise.Enter
		
5: On Error GoTo AfficherErreur
		
10: m_bMonthViewHasFocus = True
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "mvwDateRequise_GotFocus", Err, Erl())
	End Sub
	
	Private Sub txtCheminPhotos_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles txtCheminPhotos.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
10: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
15: If KeyCode <> System.Windows.Forms.Keys.Back And KeyCode <> System.Windows.Forms.Keys.Delete Then
20: KeyCode = 0
25: End If
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "txtCheminPhotos_KeyDown", Err, Erl())
	End Sub
	
	
	
	Private Sub txtPrixManuel_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixManuel.Leave
		
5: On Error GoTo AfficherErreur
		
10: txtPrixManuel.Text = Replace(txtPrixManuel.Text, ".", ",")
		
15: Call CalculerPrix()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "txtPrixManuel_LostFocus", Err, Erl())
	End Sub
	
	Private Sub txtPrixList_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixList.Leave
		
5: On Error GoTo AfficherErreur
		
10: If txtPrixList.Text <> vbNullString Then
15: txtPrixList.Text = Replace(txtPrixList.Text, ".", ",")
			
20: If IsNumeric(txtPrixList.Text) Then
25: Call CalculerPrixNet()
30: Else
35: Call MsgBox("Valeur non numérique!", MsgBoxStyle.OKOnly, "Erreur")
40: txtPrixList.Text = vbNullString
45: End If
50: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumMec", "txtPrixList_LostFocus", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event txtPrixNet.TextChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub txtPrixNet_TextChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixNet.TextChanged
		
5: On Error GoTo AfficherErreur
		
		'Quand le contenu du prix net change
		
		'Si la longueur du texte écrit est plus grand que 0
10: If Len(txtPrixNet.Text) > 0 Then
			'On vide le prix spécial et on le désactive
15: txtPrixSpecial.Text = vbNullString
20: txtPrixSpecial.Enabled = False
25: Else
			'Sinon, on active le prix spécial
30: txtPrixSpecial.Enabled = True
35: End If
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumMec", "txtPrixNet_Change", Err, Erl())
	End Sub
	
	Private Sub txtPrixNet_Enter(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixNet.Enter
		
5: On Error GoTo AfficherErreur
		
		'Si le prix net prend le focus
10: Call CalculerPrixNet()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "txtPrixNet_GotFocus", Err, Erl())
	End Sub
	
	Private Sub CalculerPrixNet()
		
5: On Error GoTo AfficherErreur
		
10: Dim dblEscompte As Double
15: Dim dblPrix As Double
		
		'Si le prix net n'est pas barré.. ie.. si le prix spécial est vide
20: If txtPrixNet.ReadOnly = False Then
25: mskEscompte.Text = Replace(mskEscompte.Text, "_", vbNullString)
			
30: mskEscompte.Text = Replace(mskEscompte.Text, ".", ",")
			
35: If mskEscompte.Text <> vbNullString Then
40: dblEscompte = CDbl(mskEscompte.Text)
45: Else
50: dblEscompte = 0
55: End If
			
60: If txtPrixList.Text <> vbNullString Then
65: dblPrix = CDbl(Replace(txtPrixList.Text, ".", ","))
70: Else
75: dblPrix = 0
80: End If
			
			'Calcul du prix net
85: txtPrixNet.Text = CStr(System.Math.Round((dblPrix) * (1 - dblEscompte), 4))
			
90: txtPrixNet.Text = Replace(txtPrixNet.Text, ".", ",")
95: End If
		
100: Exit Sub
		
AfficherErreur: 
		
105: Call AfficherErreur("frmProjSoumMec", "CalculerPrixNet", Err, Erl())
	End Sub
	
	Private Sub txtPrixNet_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixNet.Leave
		
5: On Error GoTo AfficherErreur
		
10: txtPrixNet.Text = Replace(txtPrixNet.Text, ".", ",")
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "txtPrixNet_LostFocus", Err, Erl())
	End Sub
	
	Private Sub ViderChamps_frs()
		
5: On Error GoTo AfficherErreur
		
		'Vide les champs pieces
10: txtPrixList.Text = vbNullString
15: mskEscompte.Text = vbNullString
20: txtPrixNet.Text = vbNullString
25: txtPrixSpecial.Text = vbNullString
		
30: optCAN.Checked = True
		
35: Call AfficherDrapeau()
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumMec", "ViderChamps_frs", Err, Erl())
	End Sub
	
	Private Sub ModifierPrixCatalogue()
		'Enregistrement du prix de la pièce
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPrix As ADODB.Recordset
15: Dim dblPrixList As Double
20: Dim dblEscompte As Double
25: Dim dblPrixNet As Double
		
30: If txtPrixList.Text <> "" Then
35: dblPrixList = CDbl(txtPrixList.Text)
40: Else
45: dblPrixList = 0
50: End If
		
55: If mskEscompte.Text <> vbNullString Then
60: dblEscompte = CDbl(mskEscompte.Text)
65: Else
70: dblEscompte = 0
75: End If
		
80: If txtPrixNet.Text <> "" Then
85: dblPrixNet = CDbl(txtPrixNet.Text)
90: Else
95: dblPrixNet = CDbl(txtPrixSpecial.Text)
100: End If
		
105: rstPrix = New ADODB.Recordset
		
110: If txtPrixNet.Enabled = True Then
			'Ouverture du recordset
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPrix.Open("SELECT * FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(lvwSoumission.Items.Item(CShort(fraPrix.Tag)).SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' AND IDFRS = " & VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex) & " AND PRIX_NET <> ''", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
120: If rstPrix.EOF Then
125: Call rstPrix.AddNew()
				
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPrix.Fields("PIECE").Value = lvwSoumission.Items.Item(CShort(fraPrix.Tag)).SubItems(I_COL_SOUM_PIECE).Text
135: rstPrix.Fields("IDFRS").Value = VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex)
140: End If
			
145: rstPrix.Fields("PRIX_LIST").Value = dblPrixList
150: rstPrix.Fields("ESCOMPTE").Value = dblEscompte
155: rstPrix.Fields("PRIX_NET").Value = dblPrixNet
160: rstPrix.Fields("PRIX_SP").Value = ""
165: Else
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPrix.Open("SELECT * FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(lvwSoumission.Items.Item(CShort(fraPrix.Tag)).SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' AND IDFRS = " & VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex) & " AND PRIX_SP <> ''", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
175: If rstPrix.EOF Then
180: Call rstPrix.AddNew()
				
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPrix.Fields("PIECE").Value = lvwSoumission.Items.Item(CShort(fraPrix.Tag)).SubItems(I_COL_SOUM_PIECE).Text
190: rstPrix.Fields("IDFRS").Value = VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex)
195: End If
			
200: rstPrix.Fields("PRIX_SP").Value = dblPrixNet
205: rstPrix.Fields("PRIX_LIST").Value = ""
210: rstPrix.Fields("ESCOMPTE").Value = ""
215: rstPrix.Fields("PRIX_NET").Value = ""
220: End If
		
225: If optCAN.Checked = True Then
230: rstPrix.Fields("DeviseMonétaire").Value = "CAN"
235: Else
240: If optUSA.Checked = True Then
245: rstPrix.Fields("DeviseMonétaire").Value = "USA"
250: Else
255: rstPrix.Fields("DeviseMonétaire").Value = "SPA"
260: End If
265: End If
		
270: rstPrix.Fields("Type").Value = "M"
		
275: rstPrix.Fields("ENTRER_PAR").Value = g_sInitiale
		
280: rstPrix.Fields("Date").Value = ConvertDate(Today)
		
285: Call rstPrix.Update()
		
290: Call rstPrix.Close()
295: 'UPGRADE_NOTE: Object rstPrix may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPrix = Nothing
		
300: Exit Sub
		
AfficherErreur: 
		
305: Call AfficherErreur("frmProjSoumMec", "ModifierPrixCatalogue", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event optCAN.CheckedChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub optCAN_CheckedChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles optCAN.CheckedChanged
		If eventSender.Checked Then
			
5: On Error GoTo AfficherErreur
			
			'dependant la devise, affiche le drapeau
10: Call AfficherDrapeau()
			
15: Exit Sub
			
AfficherErreur: 
			
20: Call AfficherErreur("frmProjSoumMec", "optCAN_Click", Err, Erl())
		End If
	End Sub
	
	Private Sub AfficherDrapeau()
		
5: On Error GoTo AfficherErreur
		
		'''''''''''''''''''''''''''''''''''''''''
		'Dépendant la devise, affiche le drapeau'
		'''''''''''''''''''''''''''''''''''''''''
10: If optCAN.Checked = True Then
15: imgCanada.Visible = True
20: imgEU.Visible = False
25: imgSpain.Visible = False
30: Else
35: If optUSA.Checked = True Then
40: imgEU.Visible = True
45: imgCanada.Visible = False
50: imgSpain.Visible = False
55: Else
60: imgSpain.Visible = True
65: imgCanada.Visible = False
70: imgEU.Visible = False
75: End If
80: End If
		
85: Exit Sub
		
AfficherErreur: 
		
90: Call AfficherErreur("frmProjSoumMec", "AfficherDrapeau", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event optSpain.CheckedChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub optSpain_CheckedChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles optSpain.CheckedChanged
		If eventSender.Checked Then
			
5: On Error GoTo AfficherErreur
			
			'dependant la devise, affiche le drapeau
10: Call AfficherDrapeau()
			
15: Exit Sub
			
AfficherErreur: 
			
20: Call AfficherErreur("frmProjSoumMec", "optSpain_Click", Err, Erl())
		End If
	End Sub
	
	'UPGRADE_WARNING: Event optUSA.CheckedChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub optUSA_CheckedChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles optUSA.CheckedChanged
		If eventSender.Checked Then
			
5: On Error GoTo AfficherErreur
			
			'dependant la devise, affiche le drapeau
10: Call AfficherDrapeau()
			
15: Exit Sub
			
AfficherErreur: 
			
20: Call AfficherErreur("frmProjSoumMec", "optUSA_Click", Err, Erl())
		End If
	End Sub
	
	Private Sub mskEscompte_Enter(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mskEscompte.Enter
		
5: On Error GoTo AfficherErreur
		
		'Quand le maskEdit prend le focus, on set le masque
10: If mskEscompte.Enabled = True Then
15: mskEscompte.Mask = "0,####"
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumMec", "mskEscompte_GotFocus", Err, Erl())
	End Sub
	
	Private Sub mskEscompte_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mskEscompte.Leave
		
5: On Error GoTo AfficherErreur
		
		'Quand le maskEdit perd le focus, on enlève le mask
10: mskEscompte.Mask = vbNullString
		
		'Si le champs contient 0,____, c'est parce que rien n'a été entré
15: If mskEscompte.Text = "0,____" Then
			'Donc, on le vide
20: mskEscompte.Text = vbNullString
25: End If
		
30: Call CalculerPrixNet()
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumMec", "mskEscompte_LostFocus", Err, Erl())
	End Sub
	
	Private Sub cmdExtra_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdExtra.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sNumero As String
20: Dim bExiste As Boolean
25: Dim sExtension As String
30: Dim bNoValide As Boolean
		
35: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
40: Call MsgBox("Vous ne pouvez pas faire un extra à partir de ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
45: Exit Sub
50: End If
		
55: sExtension = VB.Right(txtNoProjSoum.Text, 2)
		
60: sNumero = InputBox("Quel est l'extension à ajouter au numéro " & VB.Left(txtNoProjSoum.Text, 6) & "?")
		
65: If sNumero <> vbNullString Then
70: If Not IsNumeric(sNumero) Then
75: Call MsgBox("Numéro non numérique!", MsgBoxStyle.OKOnly, "Erreur")
				
80: Exit Sub
85: End If
			
90: sNumero = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & sNumero
			
95: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
			
100: bNoValide = True
			
105: If ValiderFormatNumeroProjSoum(sNumero) = False Then
110: bNoValide = False
115: End If
			
120: If bNoValide = True Then
125: If ValiderFormatMecanique(sNumero) = False Then
130: bNoValide = False
135: End If
140: End If
			
145: If bNoValide = True Then
150: If ValiderFormatJobExtra(sNumero) = False Then
155: bNoValide = False
160: End If
165: End If
			
170: If bNoValide = False Then
175: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
180: Exit Sub
185: End If
			
190: sNumero = UCase(sNumero)
			
195: rstProjSoum = New ADODB.Recordset
			
200: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
205: If rstProjSoum.EOF Then
210: bExiste = False
215: Else
220: bExiste = True
				
225: Call MsgBox("Ce numéro existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
230: End If
			
235: Call rstProjSoum.Close()
			
240: If bExiste = False Then
245: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
250: If rstProjSoum.EOF Then
255: bExiste = False
260: Else
265: bExiste = True
					
270: Call MsgBox("Ce numéro existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
275: End If
				
280: Call rstProjSoum.Close()
285: End If
			
290: If bExiste = False Then
295: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
300: If rstProjSoum.EOF Then
305: bExiste = False
310: Else
315: bExiste = True
					
320: Call MsgBox("Ce numéro existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
325: End If
				
330: Call rstProjSoum.Close()
335: End If
			
340: If bExiste = False Then
345: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
350: If rstProjSoum.EOF Then
355: bExiste = False
360: Else
365: bExiste = True
					
370: Call MsgBox("Ce numéro existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
375: End If
				
380: Call rstProjSoum.Close()
385: End If
			
			'Si le projet ou la soumission n'existe pas
390: If bExiste = False Then
				'Pour pouvoir réafficher l'élément affiché avant l'ajout au cas où la personne
				'annule l'ajout
395: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
400: If Not rstProjSoum.EOF Then
405: If rstProjSoum.Fields("Ouvert").Value = False Then
410: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
						
415: Call rstProjSoum.Close()
420: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
425: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
430: Exit Sub
435: End If
440: End If
				
445: Call rstProjSoum.Close()
450: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
455: m_sAncienProjSoum = txtNoProjSoum.Text
				
460: Call InitialiserVariables(txtNoProjSoum.Text)
				
				'Affiche le nouveau numéro
465: txtNoProjSoum.Text = sNumero
				
470: If CDbl(VB.Right(sNumero, 2)) >= 60 And CDbl(VB.Right(sNumero, 2)) <= 98 Then
475: m_sLiaison = InputBox("Quelle est l'extention au projet " & VB.Left(txtNoProjSoum.Text, 6) & " auquel ce projet sera lié?",  , sExtension)
480: End If
				
485: m_bModeAjout = True
				
				'Vide le listview
490: Call lvwSoumission.Items.Clear()
				
495: Call CalculerPrix()
				
				'Débarre les champs
500: Call BarrerChamps(False)
				
505: m_sTempsDessin = CStr(0)
510: m_sTempsCoupe = CStr(0)
515: m_sTempsMachinage = CStr(0)
520: m_sTempsSoudure = CStr(0)
525: m_sTempsAssemblage = CStr(0)
530: m_sTempsPeinture = CStr(0)
535: m_sTempsTest = CStr(0)
540: m_sTempsInstallation = CStr(0)
545: m_sTempsFormation = CStr(0)
550: m_sTempsGestion = CStr(0)
				
555: m_sNbrePersonne = CStr(0)
560: m_sTempsHebergement = CStr(0)
565: m_sTempsRepas = CStr(0)
570: m_sTempsTransport = CStr(0)
575: m_sTempsUniteMobile = CStr(0)
580: m_sPrixEmballage = CStr(0)
				
585: txtNbreManuel.Text = CStr(0)
590: txtPrixManuel.Text = CStr(0)
				
595: txtForfait.Text = ""
600: lblForfaitInitiale.Text = ""
				
605: txtPrixReception.Text = "0"
610: txtPrixSoumission.Text = "0"
				
615: txtPrixTotal.Text = "0"
620: txtProfit.Text = "0"
625: txtCommission.Text = "0"
630: txtTotalTemps.Text = "0"
635: txtTotalPieces.Text = "0"
640: txtImprevus.Text = "0"
645: txtNoSoumission.Text = vbNullString
				
				'Vide la valeur par défaut si demande Sous-Section
650: m_sSousSection = vbNullString
				
655: txtDescription.Text = vbNullString
				
660: m_bModeAjout = True
665: m_bModeAffichage = False
670: m_bExtra = True
				
675: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
680: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
				
				'Met le form en mode ajout/modif
685: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
690: End If
			
695: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
700: End If
		
705: Exit Sub
		
AfficherErreur: 
		
710: Call AfficherErreur("frmProjSoumMec", "cmdAjouter_Click", Err, Erl())
	End Sub
	
	Private Function VerifierSiOuvert(ByRef sUser As String) As Boolean
		'Vérifie si le projet ou la soumission n'est pas en modification
		'par un autre utilisateur sur un autre ordinateur
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim bModification As Boolean
		
20: rstProjSoum = New ADODB.Recordset
		
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
		
50: If rstProjSoum.Fields("Modification").Value = True Then
55: sUser = rstProjSoum.Fields("Par").Value
60: bModification = True
65: Else
70: sUser = ""
75: bModification = False
80: End If
		
85: Call rstProjSoum.Close()
90: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
95: VerifierSiOuvert = bModification
		
100: Exit Function
		
AfficherErreur: 
		
105: Call AfficherErreur("frmProjSoumMec", "VerifierSiOuvert", Err, Erl())
	End Function
	
	Private Sub OuvrirProjSoum(ByVal bOuvrir As Boolean)
		'Remplit ou vide les champs Modification et Par
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
		
15: rstProjSoum = New ADODB.Recordset
		
20: If IsNumeric(VB.Right(txtNoProjSoum.Text, 2)) Then
25: If ((VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19") Or (VB.Right(txtNoProjSoum.Text, 2) >= "80" And VB.Right(txtNoProjSoum.Text, 2) <= "98")) And (m_eType = enumType.TYPE_PROJET) Then
30: If VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
35: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "' OR IDProjet = '" & VB.Left(txtNoProjSoum.Text, 6) & "-" & CDbl(VB.Right(txtNoProjSoum.Text, 2)) + 80 & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
40: Else
45: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "' OR IDProjet = '" & VB.Left(txtNoProjSoum.Text, 6) & "-" & VB.Right("0" & CDbl(VB.Right(txtNoProjSoum.Text, 2)) - 80, 2) & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: End If
55: Else
60: If m_eType = enumType.TYPE_PROJET Then
65: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
70: Else
75: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
80: End If
85: End If
90: Else
95: If m_eType = enumType.TYPE_PROJET Then
100: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
105: Else
110: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
115: End If
120: End If
		
125: Do While Not rstProjSoum.EOF
130: If bOuvrir = True Then
135: rstProjSoum.Fields("Modification").Value = True
140: rstProjSoum.Fields("Par").Value = g_sEmploye
145: Else
150: rstProjSoum.Fields("Modification").Value = False
155: rstProjSoum.Fields("Par").Value = ""
160: End If
			
165: Call rstProjSoum.Update()
			
170: Call rstProjSoum.MoveNext()
175: Loop 
		
180: Call rstProjSoum.Close()
185: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
190: Exit Sub
		
AfficherErreur: 
		
195: Call AfficherErreur("frmProjSoumMec", "OuvrirProjSoum", Err, Erl())
	End Sub
	
	Private Sub cmdReset_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdReset.Click
		'Permet d'effacer le champs Modification et Par si c'est le user actuel
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
		
15: rstProjSoum = New ADODB.Recordset
		
20: If MsgBox("Êtes-vous certains de ne pas être en modification sur un autre ordinateur?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
			
50: rstProjSoum.Fields("Modification").Value = False
55: rstProjSoum.Fields("Par").Value = ""
			
60: Call rstProjSoum.Update()
			
65: Call rstProjSoum.Close()
70: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
75: cmdReset.Visible = False
80: End If
		
85: Exit Sub
		
AfficherErreur: 
		
90: Call AfficherErreur("frmProjSoumMec", "cmdReset_Click", Err, Erl())
	End Sub
	
	Private Sub lvwPieceTrouve_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwPieceTrouve.DoubleClick
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: m_bRecherchePiece = True
20: m_bPieceInutile = False
25: m_bChangementFRS = False
		
		'On affiche lvwFournisseur selon la pièce choisie
		'Rempli les fournisseurs de la pièce choisie
30: Call AfficherListeFournisseurs()
		
		'si le listview n'est pas vide
35: If lvwfournisseur.Items.Count = 1 Then
40: If MsgBox("Il n'y a aucun fournisseur pour cette pièce!" & vbNewLine & "Voulez-vous en ajouter?", MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				
				'On ouvre le catalogue sur cet enregistrement
50: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call FrmCatalogueElec.AfficherForm(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_CATEGORIE).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text)
				
55: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
				'On rappelle la méthode
60: Call AfficherListeFournisseurs()
65: End If
70: End If
		
75: Exit Sub
		
AfficherErreur: 
		
80: Call AfficherErreur("frmProjSoumMec", "lvwPieceTrouve_DblClick", Err, Erl())
	End Sub
	
	Private Sub cmdOKPieceTrouve_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKPieceTrouve.Click
		
5: On Error GoTo AfficherErreur
		
10: m_bRecherchePiece = True
15: m_bPieceInutile = False
		
		'On affiche lvwFournisseur selon la pièce choisie
		'Rempli les fournisseurs de la pièce choisie
20: Call AfficherListeFournisseurs()
		
		'si le listview n'est pas vide
25: If lvwfournisseur.Items.Count = 1 Then
30: If MsgBox("Il n'y a aucun fournisseur pour cette pièce!" & vbNewLine & "Voulez-vous en ajouter?", MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
35: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				
				'On ouvre le catalogue sur cet enregistrement
40: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call FrmCatalogueElec.AfficherForm(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_CATEGORIE).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text)
				
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
				'On rappelle la méthode
50: Call AfficherListeFournisseurs()
55: End If
60: End If
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumMec", "cmdOKPieceTrouve_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerPieceTrouve_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerPieceTrouve.Click
		
5: On Error GoTo AfficherErreur
		
10: fraPieceTrouve.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "cmdAnnulerPieceTrouve", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewRecherche(ByVal iIndexColumn As Short, ByVal sTexte As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim itmPiece As System.Windows.Forms.ListViewItem
20: Dim iCompteur As Short
25: Dim sChamps As String
30: Dim sRecherche As String
35: Dim sLettre As String
		
40: Call lvwPieceTrouve.Items.Clear()
		
45: If iIndexColumn = I_COL_PIECES_NO_ITEM Then
50: For iCompteur = 1 To Len(sTexte)
55: sLettre = Mid(sTexte, iCompteur, 1)
				
60: If (Asc(sLettre) >= 48 And Asc(sLettre) <= 57) Or (Asc(sLettre) >= 65 And Asc(sLettre) <= 90) Or (Asc(sLettre) >= 97 And Asc(sLettre) <= 122) Then
65: sRecherche = sRecherche & sLettre
70: End If
75: Next 
80: End If
		
		'Attribue le nom du champs selon la colonne cliquée
85: Select Case iIndexColumn
			Case I_COL_PIECES_PIECE_GRB : sChamps = "PIECE_GRB"
90: Case I_COL_PIECES_NO_ITEM : sChamps = "PIECE_MODIF"
95: Case I_COL_PIECES_DESCR_EN : sChamps = "DESC_EN"
100: Case I_COL_PIECES_DESCR_FR : sChamps = "DESC_FR"
105: Case I_COL_PIECES_MANUFACT : sChamps = "FABRICANT"
110: End Select
		
115: rstPiece = New ADODB.Recordset
		
120: If iIndexColumn = I_COL_PIECES_NO_ITEM Then
125: Call rstPiece.Open("SELECT * FROM GRB_CatalogueMec WHERE INSTR(1," & sChamps & ",'" & sRecherche & "')> 0 ", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
130: Else
135: Call rstPiece.Open("SELECT * FROM GRB_CatalogueMec WHERE INSTR(1," & sChamps & ",'" & Replace(sTexte, "'", "''") & "')> 0 ", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
140: End If
		
		'Pour chaque enregistrement
145: Do While Not rstPiece.EOF
			'On ajoute dans le ListView
150: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwPieceTrouve.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmPiece = lvwPieceTrouve.Items.Add()
			
155: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("PIECE_GRB").Value) Then
160: itmPiece.Text = rstPiece.Fields("PIECE_GRB").Value
165: Else
170: itmPiece.Text = ""
175: End If
			
180: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmPiece.SubItems.Count > I_COL_RECH_NO_ITEM Then
				itmPiece.SubItems(I_COL_RECH_NO_ITEM).Text = rstPiece.Fields("PIECE").Value
			Else
				itmPiece.SubItems.Insert(I_COL_RECH_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("PIECE").Value))
			End If
185: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmPiece.SubItems.Count > I_COL_RECH_CATEGORIE Then
				itmPiece.SubItems(I_COL_RECH_CATEGORIE).Text = rstPiece.Fields("CATEGORIE").Value
			Else
				itmPiece.SubItems.Insert(I_COL_RECH_CATEGORIE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("CATEGORIE").Value))
			End If
			
190: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("FABRICANT").Value) Then
195: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_MANUFACT Then
					itmPiece.SubItems(I_COL_RECH_MANUFACT).Text = rstPiece.Fields("FABRICANT").Value
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("FABRICANT").Value))
				End If
200: Else
205: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_MANUFACT Then
					itmPiece.SubItems(I_COL_RECH_MANUFACT).Text = ""
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
				End If
210: End If
			
215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("DESC_EN").Value) Then
220: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_EN Then
					itmPiece.SubItems(I_COL_RECH_DESCR_EN).Text = rstPiece.Fields("DESC_EN").Value
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("DESC_EN").Value))
				End If
225: Else
230: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_EN Then
					itmPiece.SubItems(I_COL_RECH_DESCR_EN).Text = ""
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
				End If
235: End If
			
240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("DESC_FR").Value) Then
245: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_FR Then
					itmPiece.SubItems(I_COL_RECH_DESCR_FR).Text = rstPiece.Fields("DESC_FR").Value
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("DESC_FR").Value))
				End If
250: Else
255: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_FR Then
					itmPiece.SubItems(I_COL_RECH_DESCR_FR).Text = ""
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
				End If
260: End If
			
265: Call rstPiece.MoveNext()
270: Loop 
		
275: Call rstPiece.Close()
280: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
285: Exit Sub
		
AfficherErreur: 
		
290: Call AfficherErreur("frmProjSoumMec", "RemplirListViewRecherche", Err, Erl())
	End Sub
	
	Private Sub mvwDateFacturation_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mvwDateFacturation.Leave
		
5: On Error GoTo AfficherErreur
		
		'Quand le calendrier perd le focus, il faut l'enlever
10: mvwDateFacturation.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "mvwDateFacturation_LostFocus", Err, Erl())
	End Sub
	
	Private Sub mvwDateFacturation_DateClick(ByVal eventSender As System.Object, ByVal eventArgs As AxMSComCtl2.DMonthViewEvents_DateClickEvent) Handles mvwDateFacturation.DateClick
		
5: On Error GoTo AfficherErreur
		
		'Affiche la date dans le TextBox sous le format AAAA-MM-JJ
10: txtDateFacturation.Text = ConvertDate(eventArgs.DateClicked)
		
		'Enlever le calendrier
15: mvwDateFacturation.Visible = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "mvwDateFacturation_DateClick", Err, Erl())
	End Sub
	
	Private Sub ImprimerProjSoumFacturation(ByVal rstProjSoum As ADODB.Recordset, ByVal sNoFacture As String)
		Dim DR_SoumissionMec As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de soumission
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpProjSoum As ADODB.Recordset
25: Dim rstSoum As ADODB.Recordset
30: Dim sOrdreSection As String
35: Dim iCompteurSoum As Short
40: Dim sSousSection As String
45: Dim sSousSectionRS As String
50: Dim dblTempsDessin As Double
55: Dim dblTempsCoupe As Double
60: Dim dblTempsMachinage As Double
65: Dim dblTempsSoudure As Double
70: Dim dblTempsAssemblage As Double
75: Dim dblTempsPeinture As Double
80: Dim dblTempsTest As Double
85: Dim dblTempsInstallation As Double
90: Dim dblTempsFormation As Double
95: Dim dblTempsGestion As Double
100: Dim dblTempsShipping As Double
105: Dim dblTotalTemps As Double
110: Dim sChampsSection As String
115: Dim sNoProjet As String
120: Dim sNoSoumission As String
125: Dim dblPrixEmballage As Double
130: Dim sTotalTemps As String
135: Dim sTotalPiece As String
140: Dim sProfit As String
145: Dim sImprevue As String
150: Dim sCommission As String
155: Dim sAutre As String
160: Dim sPrixTotal As String
		
		'Supprime les données de l'impression
165: Call g_connData.Execute("DELETE * FROM GRB_Impression_Soumission")
		
170: iCompteurSoum = 1
		
175: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
180: rstImpProjSoum = New ADODB.Recordset
		
185: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_soumission", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
190: sOrdreSection = vbNullString
		
195: sNoProjet = rstProjSoum.Fields("IDProjet").Value
200: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
		
205: rstPiece = New ADODB.Recordset
		
210: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' And Type = 'M' And Facturation = '" & sNoFacture & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
215: rstTemp = New ADODB.Recordset
		
220: Do While Not rstPiece.EOF
225: sSousSectionRS = rstPiece.Fields("SousSection").Value
			
230: If sSousSectionRS = S_PAS_SOUS_SECTION Then
235: sSousSectionRS = " "
240: End If
			
245: If sOrdreSection <> rstPiece.Fields("OrdreSection").Value Then
				'remplis la table impression_soumission
				'ajoute seulement la section
250: sOrdreSection = rstPiece.Fields("OrdreSection").Value
				
255: If m_eLangage = enumLangage.ANGLAIS Then
260: sChampsSection = "NomSectionEN"
265: Else
270: sChampsSection = "NomSectionFR"
275: End If
				
280: Call rstTemp.Open("SELECT " & sChampsSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajoute la section dans la soumission
285: Call rstImpProjSoum.AddNew()
				
290: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
295: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
				
300: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstTemp.Fields(sChampsSection).Value) Then
305: rstImpProjSoum.Fields("NomSection").Value = rstTemp.Fields(sChampsSection).Value
310: Else
315: rstImpProjSoum.Fields("NomSection").Value = " "
320: End If
				
325: Call rstImpProjSoum.Update()
				
330: iCompteurSoum = iCompteurSoum + 1
				
335: Call rstTemp.Close()
				
340: sSousSection = rstPiece.Fields("SousSection").Value
				
345: If sSousSection = S_PAS_SOUS_SECTION Then
350: sSousSection = " "
355: End If
				
360: Call rstImpProjSoum.AddNew()
				
365: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
370: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
				
375: rstImpProjSoum.Fields("SousSection").Value = sSousSection
				
380: Call rstImpProjSoum.Update()
				
385: iCompteurSoum = iCompteurSoum + 1
390: Else
				'ajoute une soussection dans impression_soum
395: If sSousSection <> sSousSectionRS Then
400: sSousSection = sSousSectionRS
					
405: Call rstImpProjSoum.AddNew()
					
410: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
					
415: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
					
420: rstImpProjSoum.Fields("SousSection").Value = sSousSectionRS
					
425: Call rstImpProjSoum.Update()
					
430: iCompteurSoum = iCompteurSoum + 1
435: End If
440: End If
			
			'ajoute une piece dans impression_soum
445: Call rstImpProjSoum.AddNew()
			
450: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
			
455: rstImpProjSoum.Fields("IDsoumission").Value = sNoProjet
			
460: rstImpProjSoum.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value
465: rstImpProjSoum.Fields("Qté").Value = rstPiece.Fields("Qté").Value
			
470: If m_eLangage = enumLangage.ANGLAIS Then
475: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_EN").Value
480: Else
485: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_FR").Value
490: End If
			
			'************************************************************************************************
			'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
			'************************************************************************************************
			
495: rstImpProjSoum.Fields("MANUFACT").Value = rstPiece.Fields("MANUFACT").Value
500: 'rstImpProjSoum.Fields("PRIX_LIST") = rstPiece.Fields("PRIX_LIST")
			
505: 'If Trim(rstPiece.Fields("ESCOMPTE")) <> vbNullString Then
510: '  rstImpProjSoum.Fields("ESCOMPTE") = Conversion(Replace(rstPiece.Fields("ESCOMPTE"), ".", ","), MODE_POURCENT)
515: 'Else
520: '  rstImpProjSoum.Fields("ESCOMPTE") = Conversion(0, MODE_POURCENT)
525: 'End If
			
530: rstImpProjSoum.Fields("PRIX_NET").Value = rstPiece.Fields("PRIX_NET").Value
			
535: Call rstTemp.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstPiece.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
540: If Not rstTemp.EOF Then
545: rstImpProjSoum.Fields("NomFournisseur").Value = rstTemp.Fields("NomFournisseur").Value
550: End If
			
555: Call rstTemp.Close()
			
560: rstImpProjSoum.Fields("PRIX_TOTAL").Value = rstPiece.Fields("PRIX_TOTAL").Value
565: rstImpProjSoum.Fields("PROFIT_ARGENT").Value = rstPiece.Fields("PROFIT_ARGENT").Value
			
			'AJOUT DE CETTE SECTION PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
			'*************************************************************
			If m_eType = enumType.TYPE_PROJET Then
				If Trim(rstPiece.Fields("DateRéception").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateReception").Value = rstPiece.Fields("DateRéception").Value
				Else
					rstImpProjSoum.Fields("DateReception").Value = ""
				End If
				If Trim(rstPiece.Fields("DateCommande").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateCommande").Value = rstPiece.Fields("DateCommande").Value
				Else
					rstImpProjSoum.Fields("DateCommande").Value = ""
				End If
			Else 'il n'y a pas de champ date de réception et de commande dans la table GRB_Soumission_Pièces
				rstImpProjSoum.Fields("DateReception").Value = ""
				rstImpProjSoum.Fields("DateCommande").Value = ""
			End If
			'************************************************************************************************
			'FIN DE LA SECTION DE MODIFICATION
			'************************************************************************************************
			
			
570: Call rstImpProjSoum.Update()
			
575: iCompteurSoum = iCompteurSoum + 1
			
			'Prochaine enreg
580: Call rstPiece.MoveNext()
585: Loop 
		
		'Ferme les tables
590: Call rstImpProjSoum.Close()
		
		''''''''''''''''''''''''''''''''''
		' rapport soumission, met dans l'ordre de ligne
		''''''''''''''''''''''''''''''''''''
595: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_soumission WHERE IDSoumission = '" & sNoProjet & "' ORDER BY NoLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
600: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.DataSource = rstImpProjSoum
		
605: Call CalculerPrixFacturation(sNoFacture, sCommission, sPrixTotal, sProfit, sTotalPiece, sImprevue, sTotalTemps, sAutre)
		
610: Call TraduireImpressionSoumission()
		
615: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("shpCadrePrixReception").Visible = False
620: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixReception").Visible = False
625: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblPrixReception").Visible = False
		
630: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("shpCadrePrixSoumission").Visible = False
635: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTitrePrixSoumission").Visible = False
640: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblPrixSoumission").Visible = False
		
645: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("shpCadreForfait").Visible = False
650: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTitreForfait").Visible = False
655: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblForfait").Visible = False
		
660: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblTitreNoFacture").Visible = True
665: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblNoFacture").Visible = True
		
		'Affiche la date
670: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("section3").Controls("lbldate").Caption = ConvertDate(Today)
		
		'Affiche entete
675: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblSoumission").Caption = rstProjSoum.Fields("IDSoumission").Value
		
680: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblprojet").Caption = rstProjSoum.Fields("IDProjet").Value
		
685: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lbldescription").Caption = rstProjSoum.Fields("Description").Value
		
690: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
695: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblclient").Caption = rstTemp.Fields("NomClient").Value
		
700: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblNoFacture").Caption = sNoFacture
		
705: Call rstTemp.Close()
		
710: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
715: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section2").Controls("lblcontact").Caption = rstTemp.Fields("NomContact").Value
		
720: Call rstTemp.Close()
		
		'Affiche pied d'état
		
		'Temps
725: If m_eType = enumType.TYPE_SOUMISSION Then
730: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
735: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = rstProjSoum.Fields("TauxDessin").Value
740: Else
745: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = "0"
750: End If
			
755: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
760: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = rstProjSoum.Fields("TauxCoupe").Value
765: Else
770: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = "0"
775: End If
			
780: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
785: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = rstProjSoum.Fields("TauxMachinage").Value
790: Else
795: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = "0"
800: End If
			
805: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
810: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = rstProjSoum.Fields("TauxSoudure").Value
815: Else
820: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = "0"
825: End If
			
830: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
835: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = rstProjSoum.Fields("TauxAssemblage").Value
840: Else
845: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = "0"
850: End If
			
855: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
860: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = rstProjSoum.Fields("TauxPeinture").Value
865: Else
870: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = "0"
875: End If
			
880: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
885: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = rstProjSoum.Fields("TauxTest").Value
890: Else
895: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = "0"
900: End If
			
905: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
910: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = rstProjSoum.Fields("TauxInstallation").Value
915: Else
920: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = "0"
925: End If
			
930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
935: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = rstProjSoum.Fields("TauxFormation").Value
940: Else
945: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = "0"
950: End If
			
955: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
960: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = rstProjSoum.Fields("TauxGestion").Value
965: Else
970: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = "0"
975: End If
			
980: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
985: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = rstProjSoum.Fields("TauxShipping").Value
990: Else
995: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = "0"
1000: End If
			
1005: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
1010: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = rstProjSoum.Fields("TempsDessin").Value
1015: Else
1020: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "0"
1025: End If
			
1030: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupe").Value) Then
1035: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = rstProjSoum.Fields("TempsCoupe").Value
1040: Else
1045: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "0"
1050: End If
			
1055: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinage").Value) Then
1060: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = rstProjSoum.Fields("TempsMachinage").Value
1065: Else
1070: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "0"
1075: End If
			
1080: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudure").Value) Then
1085: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = rstProjSoum.Fields("TempsSoudure").Value
1090: Else
1095: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "0"
1100: End If
			
1105: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
1110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = rstProjSoum.Fields("TempsAssemblage").Value
1115: Else
1120: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "0"
1125: End If
			
1130: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeinture").Value) Then
1135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = rstProjSoum.Fields("TempsPeinture").Value
1140: Else
1145: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "0"
1150: End If
			
1155: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
1160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = rstProjSoum.Fields("TempsTest").Value
1165: Else
1170: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "0"
1175: End If
			
1180: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
1185: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = rstProjSoum.Fields("TempsInstallation").Value
1190: Else
1195: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "0"
1200: End If
			
1205: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
1210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = rstProjSoum.Fields("TempsFormation").Value
1215: Else
1220: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "0"
1225: End If
			
1230: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
1235: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = rstProjSoum.Fields("TempsGestion").Value
1240: Else
1245: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "0"
1250: End If
			
1255: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
1260: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = rstProjSoum.Fields("TempsShipping").Value
1265: Else
1270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "0"
1275: End If
			
1280: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
1285: If IsNumeric(rstProjSoum.Fields("TempsDessin").Value) Then
1290: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessin").Value)
1295: Else
1300: dblTempsDessin = 0
1305: End If
1310: Else
1315: dblTempsDessin = 0
1320: End If
			
1325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupe").Value) Then
1330: If IsNumeric(rstProjSoum.Fields("TempsCoupe").Value) Then
1335: dblTempsCoupe = CDbl(rstProjSoum.Fields("TempsCoupe").Value)
1340: Else
1345: dblTempsCoupe = 0
1350: End If
1355: Else
1360: dblTempsCoupe = 0
1365: End If
			
1370: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinage").Value) Then
1375: If IsNumeric(rstProjSoum.Fields("TempsMachinage").Value) Then
1380: dblTempsMachinage = CDbl(rstProjSoum.Fields("TempsMachinage").Value)
1385: Else
1390: dblTempsMachinage = 0
1395: End If
1400: Else
1405: dblTempsMachinage = 0
1410: End If
			
1415: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudure").Value) Then
1420: If IsNumeric(rstProjSoum.Fields("TempsSoudure").Value) Then
1425: dblTempsSoudure = CDbl(rstProjSoum.Fields("TempsSoudure").Value)
1430: Else
1435: dblTempsSoudure = 0
1440: End If
1445: Else
1450: dblTempsSoudure = 0
1455: End If
			
1460: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
1465: If IsNumeric(rstProjSoum.Fields("TempsAssemblage").Value) Then
1470: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblage").Value)
1475: Else
1480: dblTempsAssemblage = 0
1485: End If
1490: Else
1495: dblTempsAssemblage = 0
1500: End If
			
1505: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeinture").Value) Then
1510: If IsNumeric(rstProjSoum.Fields("TempsPeinture").Value) Then
1515: dblTempsPeinture = CDbl(rstProjSoum.Fields("TempsPeinture").Value)
1520: Else
1525: dblTempsPeinture = 0
1530: End If
1535: Else
1540: dblTempsPeinture = 0
1545: End If
			
1550: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
1555: If IsNumeric(rstProjSoum.Fields("TempsTest").Value) Then
1560: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTest").Value)
1565: Else
1570: dblTempsTest = 0
1575: End If
1580: Else
1585: dblTempsTest = 0
1590: End If
			
1595: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
1600: If IsNumeric(rstProjSoum.Fields("TempsInstallation").Value) Then
1605: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallation").Value)
1610: Else
1615: dblTempsInstallation = 0
1620: End If
1625: Else
1630: dblTempsInstallation = 0
1635: End If
			
1640: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
1645: If IsNumeric(rstProjSoum.Fields("TempsFormation").Value) Then
1650: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormation").Value)
1655: Else
1660: dblTempsFormation = 0
1665: End If
1670: Else
1675: dblTempsFormation = 0
1680: End If
			
1685: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
1690: If IsNumeric(rstProjSoum.Fields("TempsGestion").Value) Then
1695: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestion").Value)
1700: Else
1705: dblTempsGestion = 0
1710: End If
1715: Else
1720: dblTempsGestion = 0
1725: End If
			
1730: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
1735: If IsNumeric(rstProjSoum.Fields("TempsShipping").Value) Then
1740: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShipping").Value)
1745: Else
1750: dblTempsShipping = 0
1755: End If
1760: Else
1765: dblTempsShipping = 0
1770: End If
			
1775: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
			
1780: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = dblTotalTemps
			
1785: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinProj").Caption = "---"
1790: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeProj").Caption = "---"
1795: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageProj").Caption = "---"
1800: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureProj").Caption = "---"
1805: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageProj").Caption = "---"
1810: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureProj").Caption = "---"
1815: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestProj").Caption = "---"
1820: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationProj").Caption = "---"
1825: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationProj").Caption = "---"
1830: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionProj").Caption = "---"
1835: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingProj").Caption = "---"
			
1840: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHProj").Caption = "---"
			
1845: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = "---"
1850: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = "---"
1855: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = "---"
1860: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = "---"
1865: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = "---"
1870: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = "---"
1875: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = "---"
1880: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = "---"
1885: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = "---"
1890: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = "---"
1895: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = "---"
			
1900: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHConc").Caption = "---"
1905: Else
1910: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
1915: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = rstProjSoum.Fields("TauxDessin").Value
1920: Else
1925: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxDessin").Caption = "0"
1930: End If
			
1935: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxCoupe").Value) Then
1940: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = rstProjSoum.Fields("TauxCoupe").Value
1945: Else
1950: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxCoupe").Caption = "0"
1955: End If
			
1960: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMachinage").Value) Then
1965: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = rstProjSoum.Fields("TauxMachinage").Value
1970: Else
1975: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxMachinage").Caption = "0"
1980: End If
			
1985: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxSoudure").Value) Then
1990: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = rstProjSoum.Fields("TauxSoudure").Value
1995: Else
2000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxSoudure").Caption = "0"
2005: End If
			
2010: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
2015: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = rstProjSoum.Fields("TauxAssemblage").Value
2020: Else
2025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxAssemblage").Caption = "0"
2030: End If
			
2035: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxPeinture").Value) Then
2040: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = rstProjSoum.Fields("TauxPeinture").Value
2045: Else
2050: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxPeinture").Caption = "0"
2055: End If
			
2060: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
2065: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = rstProjSoum.Fields("TauxTest").Value
2070: Else
2075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxTest").Caption = "0"
2080: End If
			
2085: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
2090: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = rstProjSoum.Fields("TauxInstallation").Value
2095: Else
2100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxInstallation").Caption = "0"
2105: End If
			
2110: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
2115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = rstProjSoum.Fields("TauxFormation").Value
2120: Else
2125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxFormation").Caption = "0"
2130: End If
			
2135: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
2140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = rstProjSoum.Fields("TauxGestion").Value
2145: Else
2150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxGestion").Caption = "0"
2155: End If
			
2160: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
2165: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = rstProjSoum.Fields("TauxShipping").Value
2170: Else
2175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTauxShipping").Caption = "0"
2180: End If
			
2185: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
2190: rstSoum = New ADODB.Recordset
				
2195: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & rstProjSoum.Fields("IDSoumission").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
2200: If Not rstSoum.EOF Then
2205: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
2210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = rstSoum.Fields("TempsDessin").Value
2215: Else
2220: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "0"
2225: End If
					
2230: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsCoupe").Value) Then
2235: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = rstSoum.Fields("TempsCoupe").Value
2240: Else
2245: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "0"
2250: End If
					
2255: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsMachinage").Value) Then
2260: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = rstSoum.Fields("TempsMachinage").Value
2265: Else
2270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "0"
2275: End If
					
2280: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsSoudure").Value) Then
2285: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = rstSoum.Fields("TempsSoudure").Value
2290: Else
2295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "0"
2300: End If
					
2305: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
2310: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = rstSoum.Fields("TempsAssemblage").Value
2315: Else
2320: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "0"
2325: End If
					
2330: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsPeinture").Value) Then
2335: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = rstSoum.Fields("TempsPeinture").Value
2340: Else
2345: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "0"
2350: End If
					
2355: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
2360: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = rstSoum.Fields("TempsTest").Value
2365: Else
2370: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "0"
2375: End If
					
2380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
2385: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = rstSoum.Fields("TempsInstallation").Value
2390: Else
2395: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "0"
2400: End If
					
2405: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
2410: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = rstSoum.Fields("TempsFormation").Value
2415: Else
2420: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "0"
2425: End If
					
2430: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
2435: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = rstSoum.Fields("TempsGestion").Value
2440: Else
2445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "0"
2450: End If
					
2455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
2460: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = rstSoum.Fields("TempsShipping").Value
2465: Else
2470: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "0"
2475: End If
					
2480: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
2485: If IsNumeric(rstSoum.Fields("TempsDessin").Value) Then
2490: dblTempsDessin = CDbl(rstSoum.Fields("TempsDessin").Value)
2495: Else
2500: dblTempsDessin = 0
2505: End If
2510: Else
2515: dblTempsDessin = 0
2520: End If
					
2525: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsCoupe").Value) Then
2530: If IsNumeric(rstSoum.Fields("TempsCoupe").Value) Then
2535: dblTempsCoupe = CDbl(rstSoum.Fields("TempsCoupe").Value)
2540: Else
2545: dblTempsCoupe = 0
2550: End If
2555: Else
2560: dblTempsCoupe = 0
2565: End If
					
2570: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsMachinage").Value) Then
2575: If IsNumeric(rstSoum.Fields("TempsMachinage").Value) Then
2580: dblTempsMachinage = CDbl(rstSoum.Fields("TempsMachinage").Value)
2585: Else
2590: dblTempsMachinage = 0
2595: End If
2600: Else
2605: dblTempsMachinage = 0
2610: End If
					
2615: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsSoudure").Value) Then
2620: If IsNumeric(rstSoum.Fields("TempsSoudure").Value) Then
2625: dblTempsSoudure = CDbl(rstSoum.Fields("TempsSoudure").Value)
2630: Else
2635: dblTempsSoudure = 0
2640: End If
2645: Else
2650: dblTempsSoudure = 0
2655: End If
					
2660: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
2665: If IsNumeric(rstSoum.Fields("TempsAssemblage").Value) Then
2670: dblTempsAssemblage = CDbl(rstSoum.Fields("TempsAssemblage").Value)
2675: Else
2680: dblTempsAssemblage = 0
2685: End If
2690: Else
2695: dblTempsAssemblage = 0
2700: End If
					
2705: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsPeinture").Value) Then
2710: If IsNumeric(rstSoum.Fields("TempsPeinture").Value) Then
2715: dblTempsPeinture = CDbl(rstSoum.Fields("TempsPeinture").Value)
2720: Else
2725: dblTempsPeinture = 0
2730: End If
2735: Else
2740: dblTempsPeinture = 0
2745: End If
					
2750: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
2755: If IsNumeric(rstSoum.Fields("TempsTest").Value) Then
2760: dblTempsTest = CDbl(rstSoum.Fields("TempsTest").Value)
2765: Else
2770: dblTempsTest = 0
2775: End If
2780: Else
2785: dblTempsTest = 0
2790: End If
					
2795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
2800: If IsNumeric(rstSoum.Fields("TempsInstallation").Value) Then
2805: dblTempsInstallation = CDbl(rstSoum.Fields("TempsInstallation").Value)
2810: Else
2815: dblTempsInstallation = 0
2820: End If
2825: Else
2830: dblTempsInstallation = 0
2835: End If
					
2840: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
2845: If IsNumeric(rstSoum.Fields("TempsFormation").Value) Then
2850: dblTempsFormation = CDbl(rstSoum.Fields("TempsFormation").Value)
2855: Else
2860: dblTempsFormation = 0
2865: End If
2870: Else
2875: dblTempsFormation = 0
2880: End If
					
2885: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
2890: If IsNumeric(rstSoum.Fields("TempsGestion").Value) Then
2895: dblTempsGestion = CDbl(rstSoum.Fields("TempsGestion").Value)
2900: Else
2905: dblTempsGestion = 0
2910: End If
2915: Else
2920: dblTempsGestion = 0
2925: End If
					
2930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
2935: If IsNumeric(rstSoum.Fields("TempsShipping").Value) Then
2940: dblTempsShipping = CDbl(rstSoum.Fields("TempsShipping").Value)
2945: Else
2950: dblTempsShipping = 0
2955: End If
2960: Else
2965: dblTempsShipping = 0
2970: End If
					
					
2975: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
					
2980: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = dblTotalTemps
2985: Else
2990: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "---"
2995: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "---"
3000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "---"
3005: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "---"
3010: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "---"
3015: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "---"
3020: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "---"
3025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "---"
3030: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "---"
3035: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "---"
3040: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "---"
					
3045: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = "---"
3050: End If
				
3055: Call rstSoum.Close()
3060: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstSoum = Nothing
3065: Else
3070: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "---"
3075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeSoum").Caption = "---"
3080: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageSoum").Caption = "---"
3085: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureSoum").Caption = "---"
3090: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "---"
3095: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureSoum").Caption = "---"
3100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "---"
3105: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "---"
3110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "---"
3115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "---"
3120: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "---"
				
3125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = "---"
3130: End If
			
3135: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessinProj").Value) Then
3140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinProj").Caption = rstProjSoum.Fields("TempsDessinProj").Value
3145: Else
3150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinProj").Caption = "0"
3155: End If
			
3160: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupeProj").Value) Then
3165: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeProj").Caption = rstProjSoum.Fields("TempsCoupeProj").Value
3170: Else
3175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeProj").Caption = "0"
3180: End If
			
3185: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinageProj").Value) Then
3190: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageProj").Caption = rstProjSoum.Fields("TempsMachinageProj").Value
3195: Else
3200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageProj").Caption = "0"
3205: End If
			
3210: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudureProj").Value) Then
3215: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureProj").Caption = rstProjSoum.Fields("TempsSoudureProj").Value
3220: Else
3225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureProj").Caption = "0"
3230: End If
			
3235: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
3240: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageProj").Caption = rstProjSoum.Fields("TempsAssemblageProj").Value
3245: Else
3250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageProj").Caption = "0"
3255: End If
			
3260: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeintureProj").Value) Then
3265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureProj").Caption = rstProjSoum.Fields("TempsPeintureProj").Value
3270: Else
3275: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureProj").Caption = "0"
3280: End If
			
3285: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTestProj").Value) Then
3290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestProj").Caption = rstProjSoum.Fields("TempsTestProj").Value
3295: Else
3300: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestProj").Caption = "0"
3305: End If
			
3310: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallationProj").Value) Then
3315: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationProj").Caption = rstProjSoum.Fields("TempsInstallationProj").Value
3320: Else
3325: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationProj").Caption = "0"
3330: End If
			
3335: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormationProj").Value) Then
3340: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationProj").Caption = rstProjSoum.Fields("TempsFormationProj").Value
3345: Else
3350: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationProj").Caption = "0"
3355: End If
			
3360: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestionProj").Value) Then
3365: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionProj").Caption = rstProjSoum.Fields("TempsGestionProj").Value
3370: Else
3375: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionProj").Caption = "0"
3380: End If
			
3385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShippingProj").Value) Then
3390: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingProj").Caption = rstProjSoum.Fields("TempsShippingProj").Value
3395: Else
3400: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingProj").Caption = "0"
3405: End If
			
3410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsDessinProj").Value) Then
3415: If IsNumeric(rstProjSoum.Fields("TempsDessinProj").Value) Then
3420: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessinProj").Value)
3425: Else
3430: dblTempsDessin = 0
3435: End If
3440: Else
3445: dblTempsDessin = 0
3450: End If
			
3455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsCoupeProj").Value) Then
3460: If IsNumeric(rstProjSoum.Fields("TempsCoupeProj").Value) Then
3465: dblTempsCoupe = CDbl(rstProjSoum.Fields("TempsCoupeProj").Value)
3470: Else
3475: dblTempsCoupe = 0
3480: End If
3485: Else
3490: dblTempsCoupe = 0
3495: End If
			
3500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsMachinageProj").Value) Then
3505: If IsNumeric(rstProjSoum.Fields("TempsMachinageProj").Value) Then
3510: dblTempsMachinage = CDbl(rstProjSoum.Fields("TempsMachinageProj").Value)
3515: Else
3520: dblTempsMachinage = 0
3525: End If
3530: Else
3535: dblTempsMachinage = 0
3540: End If
			
3545: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsSoudureProj").Value) Then
3550: If IsNumeric(rstProjSoum.Fields("TempsSoudureProj").Value) Then
3555: dblTempsSoudure = CDbl(rstProjSoum.Fields("TempsSoudureProj").Value)
3560: Else
3565: dblTempsSoudure = 0
3570: End If
3575: Else
3580: dblTempsSoudure = 0
3585: End If
			
3590: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
3595: If IsNumeric(rstProjSoum.Fields("TempsAssemblageProj").Value) Then
3600: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblageProj").Value)
3605: Else
3610: dblTempsAssemblage = 0
3615: End If
3620: Else
3625: dblTempsAssemblage = 0
3630: End If
			
3635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsPeintureProj").Value) Then
3640: If IsNumeric(rstProjSoum.Fields("TempsPeintureProj").Value) Then
3645: dblTempsPeinture = CDbl(rstProjSoum.Fields("TempsPeintureProj").Value)
3650: Else
3655: dblTempsPeinture = 0
3660: End If
3665: Else
3670: dblTempsPeinture = 0
3675: End If
			
3680: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTestProj").Value) Then
3685: If IsNumeric(rstProjSoum.Fields("TempsTestProj").Value) Then
3690: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTestProj").Value)
3695: Else
3700: dblTempsTest = 0
3705: End If
3710: Else
3715: dblTempsTest = 0
3720: End If
			
3725: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsInstallationProj").Value) Then
3730: If IsNumeric(rstProjSoum.Fields("TempsInstallationProj").Value) Then
3735: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallationProj").Value)
3740: Else
3745: dblTempsInstallation = 0
3750: End If
3755: Else
3760: dblTempsInstallation = 0
3765: End If
			
3770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsFormationProj").Value) Then
3775: If IsNumeric(rstProjSoum.Fields("TempsFormationProj").Value) Then
3780: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormationProj").Value)
3785: Else
3790: dblTempsFormation = 0
3795: End If
3800: Else
3805: dblTempsFormation = 0
3810: End If
			
3815: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsGestionProj").Value) Then
3820: If IsNumeric(rstProjSoum.Fields("TempsGestionProj").Value) Then
3825: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestionProj").Value)
3830: Else
3835: dblTempsGestion = 0
3840: End If
3845: Else
3850: dblTempsGestion = 0
3855: End If
			
3860: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsShippingProj").Value) Then
3865: If IsNumeric(rstProjSoum.Fields("TempsShippingProj").Value) Then
3870: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShippingProj").Value)
3875: Else
3880: dblTempsShipping = 0
3885: End If
3890: Else
3895: dblTempsShipping = 0
3900: End If
			
3905: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
			
3910: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHProj").Caption = dblTotalTemps
			
3915: If rstProjSoum.Fields("TempsProjBarré").Value = True Then
3920: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessinConc").Value) Then
3925: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = rstProjSoum.Fields("TempsDessinConc").Value
3930: Else
3935: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = "0"
3940: End If
				
3945: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupeConc").Value) Then
3950: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = rstProjSoum.Fields("TempsCoupeConc").Value
3955: Else
3960: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = "0"
3965: End If
				
3970: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinageConc").Value) Then
3975: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = rstProjSoum.Fields("TempsMachinageConc").Value
3980: Else
3985: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = "0"
3990: End If
				
3995: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudureConc").Value) Then
4000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = rstProjSoum.Fields("TempsSoudureConc").Value
4005: Else
4010: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = "0"
4015: End If
				
4020: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
4025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = rstProjSoum.Fields("TempsAssemblageConc").Value
4030: Else
4035: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = "0"
4040: End If
				
4045: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeintureConc").Value) Then
4050: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = rstProjSoum.Fields("TempsPeintureConc").Value
4055: Else
4060: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = "0"
4065: End If
				
4070: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTestConc").Value) Then
4075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = rstProjSoum.Fields("TempsTestConc").Value
4080: Else
4085: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = "0"
4090: End If
				
4095: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallationConc").Value) Then
4100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = rstProjSoum.Fields("TempsInstallationConc").Value
4105: Else
4110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = "0"
4115: End If
				
4120: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormationConc").Value) Then
4125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = rstProjSoum.Fields("TempsFormationConc").Value
4130: Else
4135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = "0"
4140: End If
				
4145: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestionConc").Value) Then
4150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = rstProjSoum.Fields("TempsGestionConc").Value
4155: Else
4160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = "0"
4165: End If
				
4170: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShippingConc").Value) Then
4175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = rstProjSoum.Fields("TempsShippingConc").Value
4180: Else
4185: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = "0"
4190: End If
				
4195: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessinConc").Value) Then
4200: If IsNumeric(rstProjSoum.Fields("TempsDessinConc").Value) Then
4205: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessinConc").Value)
4210: Else
4215: dblTempsDessin = 0
4220: End If
4225: Else
4230: dblTempsDessin = 0
4235: End If
				
4240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsCoupeConc").Value) Then
4245: If IsNumeric(rstProjSoum.Fields("TempsCoupeConc").Value) Then
4250: dblTempsCoupe = CDbl(rstProjSoum.Fields("TempsCoupeConc").Value)
4255: Else
4260: dblTempsCoupe = 0
4265: End If
4270: Else
4275: dblTempsCoupe = 0
4280: End If
				
4285: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMachinageConc").Value) Then
4290: If IsNumeric(rstProjSoum.Fields("TempsMachinageConc").Value) Then
4295: dblTempsMachinage = CDbl(rstProjSoum.Fields("TempsMachinageConc").Value)
4300: Else
4305: dblTempsMachinage = 0
4310: End If
4315: Else
4320: dblTempsMachinage = 0
4325: End If
				
4330: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsSoudureConc").Value) Then
4335: If IsNumeric(rstProjSoum.Fields("TempsSoudureConc").Value) Then
4340: dblTempsSoudure = CDbl(rstProjSoum.Fields("TempsSoudureConc").Value)
4345: Else
4350: dblTempsSoudure = 0
4355: End If
4360: Else
4365: dblTempsSoudure = 0
4370: End If
				
4375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
4380: If IsNumeric(rstProjSoum.Fields("TempsAssemblageConc").Value) Then
4385: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblageConc").Value)
4390: Else
4395: dblTempsAssemblage = 0
4400: End If
4405: Else
4410: dblTempsAssemblage = 0
4415: End If
				
4420: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsPeintureConc").Value) Then
4425: If IsNumeric(rstProjSoum.Fields("TempsPeintureConc").Value) Then
4430: dblTempsPeinture = CDbl(rstProjSoum.Fields("TempsPeintureConc").Value)
4435: Else
4440: dblTempsPeinture = 0
4445: End If
4450: Else
4455: dblTempsPeinture = 0
4460: End If
				
4465: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTestConc").Value) Then
4470: If IsNumeric(rstProjSoum.Fields("TempsTestConc").Value) Then
4475: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTestConc").Value)
4480: Else
4485: dblTempsTest = 0
4490: End If
4495: Else
4500: dblTempsTest = 0
4505: End If
				
4510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallationConc").Value) Then
4515: If IsNumeric(rstProjSoum.Fields("TempsInstallationConc").Value) Then
4520: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallationConc").Value)
4525: Else
4530: dblTempsInstallation = 0
4535: End If
4540: Else
4545: dblTempsInstallation = 0
4550: End If
				
4555: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormationConc").Value) Then
4560: If IsNumeric(rstProjSoum.Fields("TempsFormationConc").Value) Then
4565: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormationConc").Value)
4570: Else
4575: dblTempsFormation = 0
4580: End If
4585: Else
4590: dblTempsFormation = 0
4595: End If
				
4600: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestionConc").Value) Then
4605: If IsNumeric(rstProjSoum.Fields("TempsGestionConc").Value) Then
4610: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestionConc").Value)
4615: Else
4620: dblTempsGestion = 0
4625: End If
4630: Else
4635: dblTempsGestion = 0
4640: End If
				
4645: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShippingConc").Value) Then
4650: If IsNumeric(rstProjSoum.Fields("TempsShippingConc").Value) Then
4655: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShippingConc").Value)
4660: Else
4665: dblTempsShipping = 0
4670: End If
4675: Else
4680: dblTempsShipping = 0
4685: End If
				
				
4690: dblTotalTemps = dblTempsDessin + dblTempsCoupe + dblTempsMachinage + dblTempsSoudure + dblTempsAssemblage + dblTempsPeinture + dblTempsTest + dblTempsInstallation + dblTempsFormation + dblTempsGestion + dblTempsShipping
				
4695: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHConc").Caption = dblTotalTemps
4700: Else
4705: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsDessinConc").Caption = "---"
4710: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsCoupeConc").Caption = "---"
4715: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsMachinageConc").Caption = "---"
4720: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsSoudureConc").Caption = "---"
4725: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsAssemblageConc").Caption = "---"
4730: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsPeintureConc").Caption = "---"
4735: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsTestConc").Caption = "---"
4740: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsInstallationConc").Caption = "---"
4745: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsFormationConc").Caption = "---"
4750: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsGestionConc").Caption = "---"
4755: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTempsShippingConc").Caption = "---"
				
4760: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsRHConc").Caption = "---"
4765: End If
4770: End If
		
4775: Call CalculerTempsReelsImpression(rstProjSoum.Fields("IDProjet").Value)
		
		'Autres frais
4780: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
4785: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblNbrePersonne").Caption = rstProjSoum.Fields("NbrePersonne").Value
4790: Else
4795: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblNbrePersonne").Caption = "0"
4800: End If
		
4805: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsHebergement").Caption = rstProjSoum.Fields("TempsHebergement").Value
4810: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement1").Caption = rstProjSoum.Fields("TauxHebergement1").Value
4815: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTauxHebergement2").Caption = rstProjSoum.Fields("TauxHebergement2").Value
4820: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsRepas").Caption = rstProjSoum.Fields("TempsRepas").Value
4825: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTauxRepas").Caption = rstProjSoum.Fields("TauxRepas").Value
4830: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsTransport").Caption = rstProjSoum.Fields("TempsTransport").Value
4835: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTauxTransport").Caption = rstProjSoum.Fields("TauxTransport").Value
4840: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = rstProjSoum.Fields("TempsUniteMobile").Value
4845: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = rstProjSoum.Fields("TauxUniteMobile").Value
4850: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblPrixEmballage").Caption = rstProjSoum.Fields("PrixEmballage").Value
4855: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblPrixManuel").Caption = rstProjSoum.Fields("Total_Manuel").Value
		
4860: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTotalTempsAR").Caption = Conversion_Renamed(sTotalTemps, ModuleMain.enumConvert.MODE_ARGENT)
4865: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTotalPieceAR").Caption = Conversion_Renamed(sTotalPiece, ModuleMain.enumConvert.MODE_ARGENT)
4870: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblProfit").Caption = Conversion_Renamed(rstProjSoum.Fields("profit").Value * 100, ModuleMain.enumConvert.MODE_POURCENT)
4875: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblTotalProfit").Caption = Conversion_Renamed(sProfit, ModuleMain.enumConvert.MODE_ARGENT)
4880: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblImprevue").Caption = Conversion_Renamed(rstProjSoum.Fields("imprevue"), ModuleMain.enumConvert.MODE_POURCENT)
4885: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblImprevueAR").Caption = Conversion_Renamed(sImprevue, ModuleMain.enumConvert.MODE_ARGENT)
4890: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblCommission").Caption = Conversion_Renamed(rstProjSoum.Fields("commission"), ModuleMain.enumConvert.MODE_POURCENT)
4895: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblCommissionAR").Caption = Conversion_Renamed(sCommission, ModuleMain.enumConvert.MODE_ARGENT)
		
4900: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("PrixRéception").Value) Then
4905: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblPrixReception").Caption = Conversion_Renamed(rstProjSoum.Fields("PrixRéception"), ModuleMain.enumConvert.MODE_ARGENT)
4910: Else
4915: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section5").Controls("lblPrixReception").Caption = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
4920: End If
		
4925: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblAutre").Caption = Conversion_Renamed(sAutre, ModuleMain.enumConvert.MODE_ARGENT)
		
4930: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionMec.Sections("Section5").Controls("lblGrandTotalAR").Caption = Conversion_Renamed(sPrixTotal, ModuleMain.enumConvert.MODE_ARGENT)
		
		'************************************************************************************************
		'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
		'************************************************************************************************
		If bFlag = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateReception").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateReception").Visible = True
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section2").Controls("lbl_DateReception").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionMec.Sections("Section1").Controls("txt_DateReception").Visible = False
		End If
		'************************************************************************************************
		'FIN DE LA SECTION MODIFIÉ
		'************************************************************************************************
		
		'Affiche le rapport soumission
4935: ' DR_SoumissionMec.Orientation = rptOrientLandscape
		
4940: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionMec.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_SoumissionMec.Show(VB6.FormShowConstants.Modal)
		
4945: Call rstImpProjSoum.Close()
4950: 'UPGRADE_NOTE: Object rstImpProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpProjSoum = Nothing
		
4955: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
4960: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
4965: Exit Sub
		
AfficherErreur: 
		
4970: Call AfficherErreur("frmProjSoumMec", "ImprimerProjSoum", Err, Erl())
	End Sub
	
	Private Sub ImprimerListePiecesFacturation(ByVal rstProjSoum As ADODB.Recordset, ByVal sNoFacture As String)
		Dim DR_Liste_piece As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de soumission
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpListePiece As ADODB.Recordset
25: Dim iCompteurPiece As Short
30: Dim sSousSection As String
35: Dim sSousSectionRS As String
40: Dim sChampsSection As String
45: Dim sOrdreSection As String
50: Dim sNoProjet As String
55: Dim sNoSoumission As String
		
60: Call g_connData.Execute("DELETE * FROM GRB_impression_listepiece")
		
65: iCompteurPiece = 1
		
70: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
75: rstImpListePiece = New ADODB.Recordset
		
80: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_listepiece", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
85: sOrdreSection = vbNullString
		
90: sNoProjet = rstProjSoum.Fields("IDProjet").Value
95: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
		
100: rstPiece = New ADODB.Recordset
		
105: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND Type = 'M' AND Facturation = '" & sNoFacture & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
110: rstTemp = New ADODB.Recordset
		
115: Do While Not rstPiece.EOF
120: If rstPiece.Fields("Visible").Value = True Then
125: sSousSectionRS = rstPiece.Fields("SousSection").Value
				
130: If sSousSectionRS = S_PAS_SOUS_SECTION Then
135: sSousSectionRS = " "
140: End If
				
145: If sOrdreSection <> rstPiece.Fields("OrdreSection").Value Then
					'remplis la table impression_soumission
					'ajoute seulement la section
150: sOrdreSection = rstPiece.Fields("OrdreSection").Value
					
155: If m_eLangage = enumLangage.ANGLAIS Then
160: sChampsSection = "NomSectionEN"
165: Else
170: sChampsSection = "NomSectionFR"
175: End If
					
180: Call rstTemp.Open("SELECT " & sChampsSection & " FROM GRB_SoumProjSectionMec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
185: Call rstImpListePiece.AddNew()
					
190: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
195: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
					
200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstTemp.Fields(sChampsSection).Value) Then
205: rstImpListePiece.Fields("NomSection").Value = rstTemp.Fields(sChampsSection).Value
210: Else
215: rstImpListePiece.Fields("NomSection").Value = " "
220: End If
					
225: Call rstImpListePiece.Update()
					
230: iCompteurPiece = iCompteurPiece + 1
					
235: Call rstTemp.Close()
					
240: sSousSection = rstPiece.Fields("SousSection").Value
					
245: If sSousSection = S_PAS_SOUS_SECTION Then
250: sSousSection = " "
255: End If
					
260: Call rstImpListePiece.AddNew()
					
265: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
270: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
275: rstImpListePiece.Fields("SousSection").Value = sSousSection
					
280: Call rstImpListePiece.Update()
					
285: iCompteurPiece = iCompteurPiece + 1
290: Else
					'ajoute une soussection dans impression_soum
295: If sSousSection <> sSousSectionRS Then
300: sSousSection = sSousSectionRS
						
305: Call rstImpListePiece.AddNew()
						
310: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
315: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
320: rstImpListePiece.Fields("SousSection").Value = sSousSection
						
325: Call rstImpListePiece.Update()
						
330: iCompteurPiece = iCompteurPiece + 1
335: End If
340: End If
				
				'ajoute une piece dans la liste de pièce
345: Call rstImpListePiece.AddNew()
				
350: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
355: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
360: rstImpListePiece.Fields("numitem").Value = rstPiece.Fields("numitem").Value
365: rstImpListePiece.Fields("qté").Value = rstPiece.Fields("qté").Value
				
370: If m_eLangage = enumLangage.ANGLAIS Then
375: rstImpListePiece.Fields("description").Value = rstPiece.Fields("DESC_EN").Value
380: Else
385: rstImpListePiece.Fields("description").Value = rstPiece.Fields("DESC_FR").Value
390: End If
				
395: rstImpListePiece.Fields("manufact").Value = rstPiece.Fields("manufact").Value
				
400: Call rstImpListePiece.Update()
				
405: iCompteurPiece = iCompteurPiece + 1
410: End If
			
			'prochaine enreg
415: Call rstPiece.MoveNext()
420: Loop 
		
425: Call rstPiece.Close()
430: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
435: Call rstImpListePiece.Close()
		
		''''''''''''''''''''''''''''''''''''''''''''''''''
		' rapport liste piece, met dans l'ordre de ligne '
		''''''''''''''''''''''''''''''''''''''''''''''''''
		
440: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_Listepiece WHERE IDSoumission = '" & sNoSoumission & "' ORDER BY NoLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.DataSource = rstImpListePiece
		
450: Call TraduireImpressionListePiece()
		
455: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblTitreNoFacture").Visible = True
460: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblNoFacture").Visible = True
		
		'affiche la date
465: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section3").Controls("lbldate").Caption = ConvertDate(Today)
		
		'affiche l'entête
470: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblsoumission").Caption = rstProjSoum.Fields("IDSoumission").Value
		
475: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblprojet").Caption = rstProjSoum.Fields("IDProjet").Value
		
480: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lbldescription").Caption = rstProjSoum.Fields("Description").Value
		
485: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
490: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblclient").Caption = rstTemp.Fields("NomClient").Value
		
495: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblNoFacture").Caption = sNoFacture
		
500: Call rstTemp.Close()
		
505: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
510: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblcontact").Caption = rstTemp.Fields("NomContact").Value
		
515: Call rstTemp.Close()
		
		'affiche le rapport liste des pieces
520: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Orientation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Orientation = MSDataReportLib.OrientationConstants.rptOrientPortrait
		
525: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_Liste_piece.Show(VB6.FormShowConstants.Modal)
		
530: Call rstImpListePiece.Close()
535: 'UPGRADE_NOTE: Object rstImpListePiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpListePiece = Nothing
		
540: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
545: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
550: Exit Sub
		
AfficherErreur: 
		
555: Call AfficherErreur("frmProjSoumMec", "ImprimerListePiecesFacturation", Err, Erl())
	End Sub
	
	Private Sub CalculerPrixFacturation(ByVal sNoFacturation As String, ByRef sCommission As String, ByRef sPrixTotal As String, ByRef sProfit As String, ByRef sTotalPiece As String, ByRef sImprevue As String, ByRef sTotalTemps As String, ByRef sAutre As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour calculer le prix
10: Dim dblPrixPieces As Double
15: Dim dblPrixTotal As Double
20: Dim dblCommission As Double
25: Dim dblTotalTemps As Double
30: Dim dblProfit As Double
35: Dim dblTotalManuel As Double
40: Dim dblTotalImprevue As Double
45: Dim dblGrandTotal As Double
50: Dim dblTotalDessin As Double
55: Dim dblTotalCoupe As Double
60: Dim dblTotalMachinage As Double
65: Dim dblTotalSoudure As Double
70: Dim dblTotalAssemblage As Double
75: Dim dblTotalPeinture As Double
80: Dim dblTotalTest As Double
85: Dim dblTotalInstallation As Double
90: Dim dblTotalFormation As Double
95: Dim dblTotalGestion As Double
100: Dim dblTotalShipping As Double
105: Dim dblHebergement As Double
110: Dim dblRepas As Double
115: Dim dblTransport As Double
120: Dim dblUniteMobile As Double
125: Dim dblPrixEmballage As Double
130: Dim dblTotalResteTemps As Double
135: Dim bDemande As Boolean
140: Dim iNbrePersonne As Short
145: Dim iCompteur As Short
		
		'Pour chaque élément du listview
150: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si ce n'est pas une section
155: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
				'Si ce n'est pas une sous-section
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = sNoFacturation Then
						'On additionne le prix total
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						dblPrixPieces = dblPrixPieces + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_TOTAL).Text) - CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)
						
						'On additionne le profit
175: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						dblProfit = dblProfit + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)
180: End If
185: End If
190: End If
195: Next 
		
		'Total des temps
200: dblTotalDessin = CDbl(m_sTempsDessin) * CDbl(m_sTauxDessin)
205: dblTotalCoupe = CDbl(m_sTempsCoupe) * CDbl(m_sTauxCoupe)
210: dblTotalMachinage = CDbl(m_sTempsMachinage) * CDbl(m_sTauxMachinage)
215: dblTotalSoudure = CDbl(m_sTempsSoudure) * CDbl(m_sTauxSoudure)
220: dblTotalAssemblage = CDbl(m_sTempsAssemblage) * CDbl(m_sTauxAssemblage)
225: dblTotalPeinture = CDbl(m_sTempsPeinture) * CDbl(m_sTauxPeinture)
230: dblTotalTest = CDbl(m_sTempsTest) * CDbl(m_sTauxTest)
235: dblTotalInstallation = CDbl(m_sTempsInstallation) * CDbl(m_sTauxInstallation)
240: dblTotalFormation = CDbl(m_sTempsFormation) * CDbl(m_sTauxFormation)
245: dblTotalGestion = CDbl(m_sTempsGestion) * CDbl(m_sTauxGestion)
250: dblTotalShipping = CDbl(m_sTempsShipping) * CDbl(m_sTauxShipping)
		
255: dblTotalTemps = dblTotalDessin + dblTotalCoupe + dblTotalMachinage + dblTotalSoudure + dblTotalAssemblage + dblTotalPeinture + dblTotalTest + dblTotalInstallation + dblTotalFormation + dblTotalGestion + dblTotalShipping
		
260: iNbrePersonne = Int(CDbl(m_sNbrePersonne))
		
265: Do While iNbrePersonne > 0
270: If iNbrePersonne >= 2 Then
275: dblHebergement = dblHebergement + CDbl(m_sTempsHebergement) * CDbl(m_sTauxHebergement2)
				
280: iNbrePersonne = iNbrePersonne - 2
285: Else
290: dblHebergement = dblHebergement + CDbl(m_sTempsHebergement) * CDbl(m_sTauxHebergement1)
				
295: iNbrePersonne = iNbrePersonne - 1
300: End If
305: Loop 
		
310: dblRepas = CDbl(m_sTempsRepas) * CDbl(m_sTauxRepas) * CDbl(m_sNbrePersonne)
315: dblTransport = CDbl(m_sTempsTransport) * CDbl(m_sTauxTransport)
320: dblUniteMobile = CDbl(m_sTempsUniteMobile) * CDbl(m_sTauxUniteMobile)
		
		'Correction d'un bug de Type Incompatible
325: If IsNumeric(m_sPrixEmballage) Then
330: dblPrixEmballage = CDbl(m_sPrixEmballage)
335: Else
340: dblPrixEmballage = 0
345: End If
		
350: dblTotalResteTemps = dblHebergement + dblRepas + dblTransport + dblUniteMobile + dblPrixEmballage
		
355: If IsNumeric(txtPrixManuel.Text) Then
360: dblTotalManuel = CDbl(txtPrixManuel.Text)
365: Else
370: dblTotalManuel = 0
375: End If
		
380: dblTotalImprevue = (dblPrixPieces + dblProfit) * CDbl(m_sImprevue)
		
385: dblPrixTotal = dblPrixPieces + dblProfit + dblTotalTemps + dblTotalImprevue + dblTotalManuel + dblTotalResteTemps
		
		'Le calcul de la commission est sur les manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps
390: dblCommission = dblPrixTotal * CDbl(m_sCommission)
		
		'Le prix total est le calcul des manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps + total de la commission
395: dblGrandTotal = dblPrixTotal + dblCommission
		
		'Format monétaires avec 2 chiffres après la virgule
400: sTotalPiece = Conversion_Renamed(CStr(System.Math.Round(dblPrixPieces, 2)), ModuleMain.enumConvert.MODE_ARGENT)
405: sTotalTemps = Conversion_Renamed(CStr(System.Math.Round(dblTotalTemps, 2)), ModuleMain.enumConvert.MODE_ARGENT)
410: sPrixTotal = Conversion_Renamed(CStr(System.Math.Round(dblGrandTotal, 2)), ModuleMain.enumConvert.MODE_ARGENT)
415: sImprevue = Conversion_Renamed(CStr(System.Math.Round(dblTotalImprevue, 2)), ModuleMain.enumConvert.MODE_ARGENT)
420: sCommission = Conversion_Renamed(CStr(System.Math.Round(dblCommission, 2)), ModuleMain.enumConvert.MODE_ARGENT)
425: sProfit = Conversion_Renamed(CStr(System.Math.Round(dblProfit, 2)), ModuleMain.enumConvert.MODE_ARGENT)
430: sAutre = Conversion_Renamed(CStr(System.Math.Round(dblTotalResteTemps, 2)), ModuleMain.enumConvert.MODE_ARGENT)
		
435: Exit Sub
		
AfficherErreur: 
		
440: Call AfficherErreur("frmProjSoumMec", "CalculerPrix", Err, Erl())
	End Sub
	
	Private Sub CalculerPrixReception()
		
5: On Error GoTo AfficherErreur
		
10: Dim dblPrixReception As Double
15: Dim iCompteur As Short
20: Dim itmProjet As System.Windows.Forms.ListViewItem
		
25: If m_bDroitPrix = True Then
			'Pour chaque ListItems du ListView
30: For iCompteur = 1 To lvwSoumission.Items.Count
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjet = lvwSoumission.Items.Item(iCompteur)
				
				'Si ce n'est pas une section
40: If itmProjet.Tag <> "" Then
					'Si ce n'est pas une sous-section
45: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "" Then
						'Si c'est pas du texte
50: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si c'est une réception
55: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_GRIS Then
								'On ajoute le montant
60: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmProjet.SubItems.Item(I_COL_SOUM_FACTURATION).Tag <> "" Then
65: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									dblPrixReception = System.Math.Round(dblPrixReception + (CDbl(itmProjet.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmProjet.SubItems.Item(I_COL_SOUM_FACTURATION).Tag, "*", ""))), 2)
70: Else
75: dblPrixReception = System.Math.Round(dblPrixReception + 0, 2)
80: End If
85: Else
								'Si c'est un retour
90: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ROUGE Then
									'On soustrait le montant
95: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									dblPrixReception = System.Math.Round(dblPrixReception - (CDbl(itmProjet.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(Replace(itmProjet.Text, "-", ""), "*", ""))), 2)
100: End If
105: End If
110: End If
115: End If
120: End If
125: Next 
			
130: txtPrixReception.Text = Conversion_Renamed(dblPrixReception, ModuleMain.enumConvert.MODE_ARGENT)
135: Else
140: txtPrixReception.Text = ""
145: End If
		
150: Exit Sub
		
AfficherErreur: 
		
155: Call AfficherErreur("frmProjSoumMec", "CalculerPrixReception", Err, Erl())
	End Sub
	
	Private Sub AnnulerCommande()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjet As ADODB.Recordset
15: Dim itmAvant As System.Windows.Forms.ListViewItem
20: Dim itmAnnulation As System.Windows.Forms.ListViewItem
25: Dim sExtra As String
		
30: If VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
35: sExtra = InputBox("Dans quel extra l'annulation de commande doit être faite ? (2 chiffres seulement)")
			
40: If Len(sExtra) <> 2 Then
45: Call MsgBox("Format incorrect!", MsgBoxStyle.OKOnly, "Erreur")
				
50: Exit Sub
55: End If
			
60: If Not IsNumeric(sExtra) Then
65: Call MsgBox("L'extra doit être numérique!", MsgBoxStyle.OKOnly, "Erreur")
				
70: Exit Sub
75: End If
			
80: If CDbl(sExtra) < 60 Or CDbl(sExtra) > 98 Then
85: Call MsgBox("L'extra doit être entre 60 et 98!", MsgBoxStyle.OKOnly, "Erreur")
				
90: Exit Sub
95: End If
			
100: rstProjet = New ADODB.Recordset
			
105: Call rstProjet.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
110: If rstProjet.EOF Then
115: Call MsgBox("Le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & " n'existe pas!", MsgBoxStyle.OKOnly, "Erreur")
				
120: Call rstProjet.Close()
125: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjet = Nothing
				
130: Exit Sub
135: Else
140: Call rstProjet.Close()
145: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjet = Nothing
150: End If
155: End If
		
160: itmAvant = lvwSoumission.FocusedItem
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation = lvwSoumission.Items.Insert(itmAvant.Index + 1, "")
		
170: itmAnnulation.Checked = itmAvant.Checked
		
		'Quantité
175: itmAnnulation.Text = "-" & itmAvant.Text
		
		'On met l'id de la section dans le tag du listItem
180: itmAnnulation.Tag = itmAvant.Tag
		
		'No d'item
185: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PIECE Then
			itmAnnulation.SubItems(I_COL_SOUM_PIECE).Text = itmAvant.SubItems(I_COL_SOUM_PIECE).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PIECE).Text))
		End If
		
		'On met le nom de la sous-section dans le tag du no d'item
190: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Tag
		
		'On met la description en francais dans la colonne et la description en anglais
		'dans le tag
195: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_DESCR Then
			itmAnnulation.SubItems(I_COL_SOUM_DESCR).Text = itmAvant.SubItems(I_COL_SOUM_DESCR).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DESCR).Text))
		End If
200: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Tag
		
		'On met le nom du fabricant dans la colonne et l'ordre de la section dans le tag
205: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_MANUFACT Then
			itmAnnulation.SubItems(I_COL_SOUM_MANUFACT).Text = itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text))
		End If
210: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
		
		'Prix listé
215: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
			itmAnnulation.SubItems(I_COL_SOUM_PRIX_LIST).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text))
		End If
		
220: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
		
225: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
			itmAnnulation.SubItems(I_COL_SOUM_ESCOMPTE).Text = itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text))
		End If
		
230: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PRIX_NET Then
			itmAnnulation.SubItems(I_COL_SOUM_PRIX_NET).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text))
		End If
		
		'On met le fournisseur dans la colonne et l'id dans le tag
235: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_DISTRIB Then
			itmAnnulation.SubItems(I_COL_SOUM_DISTRIB).Text = itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text))
		End If
240: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
		
		'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
245: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_TOTAL Then
			itmAnnulation.SubItems(I_COL_SOUM_TOTAL).Text = "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text))
		End If
		
		'Pour le profit, c'est le prix total - (prix net * quantité)
250: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PROFIT Then
			itmAnnulation.SubItems(I_COL_SOUM_PROFIT).Text = "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text))
		End If
		
255: If VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
			'Pour savoir lors de l'enregistremenet qu'il faut le lier avec un extra
260: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).Tag = "ANNULATION " & sExtra
265: End If
		
270: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
275: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
280: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
285: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
290: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
295: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
300: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
305: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
310: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
		
315: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
320: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
325: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).Font, True)
330: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, True)
335: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).Font, True)
340: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, True)
345: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, True)
350: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).Font, True)
355: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_TOTAL).Font, True)
		
360: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
365: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
370: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
375: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
380: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
385: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
390: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
395: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
400: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
		
405: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text <> "" Then
410: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
415: End If
		
420: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
		
425: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
430: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
		
435: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
440: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
445: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Font, True)
450: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, True)
455: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Font, True)
460: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, True)
465: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, True)
470: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).Font, True)
475: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).Font, True)
		
480: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text <> "" Then
485: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font, True)
490: End If
		
495: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font, True)
		
500: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font, True)
505: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font, True)
		
510: Call lvwSoumission.Refresh()
		
515: Call CalculerPrix()
		
520: Exit Sub
		
AfficherErreur: 
		
525: Call AfficherErreur("frmProjSoumMec", "AnnulerCommande", Err, Erl())
	End Sub
	
	Private Sub AjouterSuppressionCollection(ByVal iIndex As Short)
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call m_collQteSupp.Add(Replace(lvwSoumission.Items.Item(iIndex).Text, "*", ""))
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call m_collNoItemSupp.Add(lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text)
25: Call m_collDateSupp.Add(ConvertDate(Today))
30: Call m_collHeureSupp.Add(TimeOfDay)
35: End If
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumMec", "AjouterSuppressionCollection", Err, Erl())
	End Sub
	
	Private Sub EnregistrerSuppression()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstBavard As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim iNoEmploye As Short
25: Dim iCompteur As Short
		
30: rstBavard = New ADODB.Recordset
35: rstEmploye = New ADODB.Recordset
		
40: Call rstBavard.Open("SELECT * FROM GRB_BavardSuppression", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
45: Call rstEmploye.Open("SELECT noEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
50: iNoEmploye = rstEmploye.Fields("noEmploye").Value
		
55: Call rstEmploye.Close()
60: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
65: If Not m_collNoItemSupp Is Nothing Then
70: For iCompteur = 1 To m_collNoItemSupp.Count()
75: Call rstBavard.AddNew()
				
80: rstBavard.Fields("IDUser").Value = iNoEmploye
85: rstBavard.Fields("NoProjsoum").Value = txtNoProjSoum.Text
90: rstBavard.Fields("Type").Value = "M"
95: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collQteSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstBavard.Fields("Qté").Value = m_collQteSupp.Item(iCompteur)
100: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collNoItemSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstBavard.Fields("No Item").Value = m_collNoItemSupp.Item(iCompteur)
105: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collDateSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstBavard.Fields("Date").Value = m_collDateSupp.Item(iCompteur)
110: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collHeureSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstBavard.Fields("Heure").Value = m_collHeureSupp.Item(iCompteur)
				
115: Call rstBavard.Update()
120: Next 
125: End If
		
130: Call rstBavard.Close()
135: 'UPGRADE_NOTE: Object rstBavard may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBavard = Nothing
		
140: Exit Sub
		
AfficherErreur: 
		
145: Call AfficherErreur("frmProjSoumMec", "EnregistrerSuppression", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewSuppression()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le listView avec les pièces supprimées
10: Dim rstBavard As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim itmBavard As System.Windows.Forms.ListViewItem
		
25: Call lvwBavard.Items.Clear()
		
30: rstBavard = New ADODB.Recordset
		
35: Call rstBavard.Open("SELECT * FROM GRB_BavardSuppression WHERE NoProjSoum = '" & txtNoProjSoum.Text & "' AND Type = 'E' ORDER BY Date, Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
40: rstEmploye = New ADODB.Recordset
		
45: Do While Not rstBavard.EOF
50: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwBavard.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmBavard = lvwBavard.Items.Add()
			
55: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE NoEmploye = " & rstBavard.Fields("IDUser").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
60: itmBavard.Text = rstEmploye.Fields("Employe").Value
			
65: Call rstEmploye.Close()
			
70: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_DATE Then
				itmBavard.SubItems(I_COL_SUPP_DATE).Text = rstBavard.Fields("Date").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("Date").Value))
			End If
75: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_HEURE Then
				itmBavard.SubItems(I_COL_SUPP_HEURE).Text = rstBavard.Fields("Heure").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("Heure").Value))
			End If
80: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_QTE Then
				itmBavard.SubItems(I_COL_SUPP_QTE).Text = rstBavard.Fields("Qté").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_QTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("Qté").Value))
			End If
85: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_NO_ITEM Then
				itmBavard.SubItems(I_COL_SUPP_NO_ITEM).Text = rstBavard.Fields("No Item").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("No Item").Value))
			End If
			
90: Call rstBavard.MoveNext()
95: Loop 
		
100: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
105: Call rstBavard.Close()
110: 'UPGRADE_NOTE: Object rstBavard may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBavard = Nothing
		
115: Exit Sub
		
AfficherErreur: 
		
120: Call AfficherErreur("frmProjSoumMec", "RemplirListViewSuppression", Err, Erl())
	End Sub
	
	Private Sub lvwBavard_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwBavard.Leave
		
5: On Error GoTo AfficherErreur
		
		'Lorsque le bavard perd le focus, on l'enlève
10: lvwBavard.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "lvwBavard_LostFocus", Err, Erl())
	End Sub
	
	Private Sub cmdForfait_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdForfait.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim sMontant As String
		
15: sMontant = InputBox("Quel est le montant du forfait?")
		
20: If Trim(sMontant) <> "" Then
25: sMontant = Replace(sMontant, ".", ",")
			
30: If IsNumeric(sMontant) Then
35: txtForfait.Text = Conversion_Renamed(sMontant, ModuleMain.enumConvert.MODE_ARGENT)
				
40: lblForfaitInitiale.Text = g_sInitiale
45: Else
50: Call MsgBox("Montant non numérique!", MsgBoxStyle.OKOnly, "Erreur")
55: End If
60: End If
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumMec", "cmdForfait_Click", Err, Erl())
	End Sub
	
	Private Sub cmdEffacerForfait_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdEffacerForfait.Click
		
5: On Error GoTo AfficherErreur
		
10: txtForfait.Text = ""
15: lblForfaitInitiale.Text = ""
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumMec", "cmdEffacerForfait_Click", Err, Erl())
	End Sub
	
	Private Sub CopierPiece()
		
5: On Error GoTo AfficherErreur
		
10: Dim itmCopier As System.Windows.Forms.ListViewItem
15: Dim iNbreSelect As Short
20: Dim iCompteur As Short
25: Dim iNbreSelected As Short
30: Dim iIndex As Short
		
35: For iCompteur = 1 To lvwSoumission.Items.Count
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Selected = True Then
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag = "" Or lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text = "" Then
50: Call MsgBox("Impossible de copier, la sélection contient une section ou une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
					
55: Exit Sub
60: Else
65: iNbreSelected = iNbreSelected + 1
70: End If
75: End If
80: Next 
		
85: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
90: m_iNbreCopie = iNbreSelected
		
95: ReDim m_arr_tyCopie(iNbreSelected - 1)
		
100: For iCompteur = 1 To lvwSoumission.Items.Count
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Selected = True Then
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmCopier = lvwSoumission.Items.Item(iCompteur)
				
115: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).lColor = System.Drawing.ColorTranslator.ToOle(itmCopier.SubItems.Item(I_COL_SOUM_PIECE).ForeColor)
				
120: m_arr_tyCopie(iIndex).bChecked = itmCopier.Checked
				
125: m_arr_tyCopie(iIndex).sQuantite = itmCopier.Text
				
130: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sPiece = itmCopier.SubItems(I_COL_SOUM_PIECE).Text
				
135: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sDescr = itmCopier.SubItems(I_COL_SOUM_DESCR).Text
140: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmCopier.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				m_arr_tyCopie(iIndex).sDescrTag = itmCopier.SubItems.Item(I_COL_SOUM_DESCR).Tag
				
145: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sManufact = itmCopier.SubItems(I_COL_SOUM_MANUFACT).Text
				
150: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sPrixList = itmCopier.SubItems(I_COL_SOUM_PRIX_LIST).Text
155: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmCopier.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				m_arr_tyCopie(iIndex).sPrixListTag = itmCopier.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
				
160: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sEscompte = itmCopier.SubItems(I_COL_SOUM_ESCOMPTE).Text
				
165: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sPrixNet = itmCopier.SubItems(I_COL_SOUM_PRIX_NET).Text
				
170: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sFRS = itmCopier.SubItems(I_COL_SOUM_DISTRIB).Text
175: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmCopier.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				m_arr_tyCopie(iIndex).sFRSTag = itmCopier.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
				
180: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sTotal = itmCopier.SubItems(I_COL_SOUM_TOTAL).Text
				
185: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sProfit = itmCopier.SubItems(I_COL_SOUM_PROFIT).Text
				
190: iIndex = iIndex + 1
195: End If
200: Next 
		
205: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
210: Exit Sub
		
AfficherErreur: 
		
215: Call AfficherErreur("frmProjSoumMec", "CopierPiece", Err, Erl())
	End Sub
	
	Private Sub CollerPiece()
		
5: On Error GoTo AfficherErreur
		
10: Dim sIDSection As String
15: Dim sOrdreSection As String
20: Dim sSousSection As String
25: Dim itmColler As System.Windows.Forms.ListViewItem
30: Dim iCompteur As Short
35: Dim iIndexSelected As Short
40: Dim iIndex As Short
		
		'Pour savoir s'il y a quelque chose à coller
45: If m_iNbreCopie = 0 Then
50: Exit Sub
55: End If
		
60: iIndexSelected = lvwSoumission.FocusedItem.Index
		
65: If iIndexSelected >= 3 Then
70: If lvwSoumission.FocusedItem.Tag = vbNullString Then
75: iIndex = iIndexSelected - 1
80: Else
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iIndexSelected - 1).Tag = "" Then
95: Call MsgBox("Impossible de coller la pièce entre une section et une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
						
100: Exit Sub
105: Else
110: iIndex = iIndexSelected - 1
115: End If
120: Else
125: iIndex = iIndexSelected
130: End If
135: End If
140: Else
145: Call MsgBox("Emplacement incorrect!", MsgBoxStyle.OKOnly, "Erreur")
			
150: Exit Sub
155: End If
		
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sIDSection = lvwSoumission.Items.Item(iIndex).Tag
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sOrdreSection = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sSousSection = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_PIECE).Tag
		
175: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
180: For iCompteur = 0 To UBound(m_arr_tyCopie)
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler = lvwSoumission.Items.Insert(iIndexSelected + iCompteur, "")
			
190: itmColler.Checked = m_arr_tyCopie(iCompteur).bChecked
			
195: itmColler.Text = m_arr_tyCopie(iCompteur).sQuantite
200: itmColler.Tag = sIDSection
			
205: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PIECE Then
				itmColler.SubItems(I_COL_SOUM_PIECE).Text = m_arr_tyCopie(iCompteur).sPiece
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sPiece))
			End If
210: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
			
215: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_DESCR Then
				itmColler.SubItems(I_COL_SOUM_DESCR).Text = m_arr_tyCopie(iCompteur).sDescr
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sDescr))
			End If
220: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_DESCR).Tag = m_arr_tyCopie(iCompteur).sDescrTag
			
225: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmColler.SubItems(I_COL_SOUM_MANUFACT).Text = m_arr_tyCopie(iCompteur).sManufact
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sManufact))
			End If
230: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = sOrdreSection
			
235: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmColler.SubItems(I_COL_SOUM_PRIX_LIST).Text = m_arr_tyCopie(iCompteur).sPrixList
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sPrixList))
			End If
240: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = m_arr_tyCopie(iCompteur).sPrixListTag
			
245: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmColler.SubItems(I_COL_SOUM_ESCOMPTE).Text = m_arr_tyCopie(iCompteur).sEscompte
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sEscompte))
			End If
			
250: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmColler.SubItems(I_COL_SOUM_PRIX_NET).Text = m_arr_tyCopie(iCompteur).sPrixNet
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sPrixNet))
			End If
			
255: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_DISTRIB Then
				itmColler.SubItems(I_COL_SOUM_DISTRIB).Text = m_arr_tyCopie(iCompteur).sFRS
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sFRS))
			End If
260: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = m_arr_tyCopie(iCompteur).sFRSTag
			
265: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmColler.SubItems(I_COL_SOUM_TOTAL).Text = m_arr_tyCopie(iCompteur).sTotal
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sTotal))
			End If
			
270: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmColler.SubItems(I_COL_SOUM_PROFIT).Text = m_arr_tyCopie(iCompteur).sProfit
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sProfit))
			End If
			
275: If m_eType = enumType.TYPE_PROJET Then
280: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
285: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
290: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
295: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
300: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
305: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
310: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
315: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
320: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
325: Else
330: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
335: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
340: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
345: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
350: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
355: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
360: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
365: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
370: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
375: End If
			
380: Call lvwSoumission.Refresh()
385: Next 
		
390: Call CalculerPrix()
		
395: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
400: Exit Sub
		
AfficherErreur: 
		
405: Call AfficherErreur("frmProjSoumMec", "CollerPiece", Err, Erl())
	End Sub
	
	Private Sub Deselect()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: If lvwSoumission.Items.Count > 0 Then
20: For iCompteur = 1 To lvwSoumission.Items.Count
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(iCompteur).Selected = False
30: Next 
35: End If
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumMec", "Deselect", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event txtPrixSpecial.TextChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub txtPrixSpecial_TextChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixSpecial.TextChanged
		
5: On Error GoTo AfficherErreur
		
		'Quand le contenu du prix spécial change
		
		'Si la longueur du texte écrit est plus grand que 0
10: If Len(txtPrixSpecial.Text) > 0 Then
			'On vide l'escompte, le prix net et on les désactive
15: mskEscompte.Text = vbNullString
20: txtPrixNet.Text = vbNullString
			
25: mskEscompte.Enabled = False
30: txtPrixNet.Enabled = False
35: Else
			'Sinon, on active escompte et prix net
40: mskEscompte.Enabled = True
45: txtPrixNet.Enabled = True
50: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumMec", "txtPrixSpecial_Change", Err, Erl())
	End Sub
	
	Private Sub txtPrixSpecial_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixSpecial.Leave
		
5: On Error GoTo AfficherErreur
		
10: txtPrixSpecial.Text = Replace(txtPrixSpecial.Text, ".", ",")
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumMec", "txtPrixSpecial_LostFocus", Err, Erl())
	End Sub
	
	Private Function ValiderFormatMecanique(ByVal sNoProjSoum As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If UCase(VB.Left(sNoProjSoum, 1)) = "M" Then
15: ValiderFormatMecanique = True
20: Else
25: Call MsgBox("Un numéro mécanique doit absolument commencé par 'M' !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatMecanique = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumMec", "ValiderFormatMecanique", Err, Erl())
	End Function
	
	Private Function ValiderFormatSoumission(ByVal sNoSoumission As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If Mid(sNoSoumission, 3, 1) = "1" Then
15: ValiderFormatSoumission = True
20: Else
25: Call MsgBox("Une soumission doit absolument avoir '1' comme 3e caractère !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatSoumission = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumMec", "ValiderFormatSoumission", Err, Erl())
	End Function
	
	Private Function ValiderFormatJobSansSoum(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If Mid(sNoProjet, 3, 1) <> "3" And Mid(sNoProjet, 3, 1) <> "1" Then
15: ValiderFormatJobSansSoum = True
20: Else
25: Call MsgBox("Un projet créé sans soumission ne doit pas être '" & VB.Left(sNoProjet, 3) & "' !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatJobSansSoum = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumMec", "ValiderFormatJobSansSoum", Err, Erl())
	End Function
	
	Private Function ValiderFormatJobAvecSoum(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If Mid(sNoProjet, 3, 1) = "3" Then
15: ValiderFormatJobAvecSoum = True
20: Else
25: Call MsgBox("Un projet créé à partir d'une soumission doit absolument avec un '3' comme 3e caractère!", MsgBoxStyle.OKOnly, "Errreu")
			
30: ValiderFormatJobAvecSoum = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumMec", "ValiderFormatJobAvecSoum", Err, Erl())
	End Function
	
	Private Function ValiderFormatJobExtra(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If CShort(VB.Right(sNoProjet, 2)) >= 50 And CShort(VB.Right(sNoProjet, 2)) <= 98 Then
15: ValiderFormatJobExtra = True
20: Else
25: Call MsgBox("L'entension d'un extra doit être compris entre 50 et 98 !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatJobExtra = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumMec", "ValiderFormatJobExtra", Err, Erl())
	End Function
	
	Private Sub AjouterProjetAuCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstProj As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstProjCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim rstEmploye As ADODB.Recordset
45: Dim rstSoum As ADODB.Recordset
50: Dim bCumulatifExiste As Boolean
55: Dim dblNbreManuel As Double
60: Dim dblPrixEmballage As Double
65: Dim dblTotalManuel As Double
70: Dim dblForfait As Double
		
75: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
80: rstProj = New ADODB.Recordset
85: rstPieces = New ADODB.Recordset
90: rstProjCumulatif = New ADODB.Recordset
95: rstPiecesCumulatif = New ADODB.Recordset
		
100: Call rstProjCumulatif.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
105: If rstProjCumulatif.EOF Then
110: bCumulatifExiste = False
			
115: Call rstProjCumulatif.AddNew()
			
120: rstProjCumulatif.Fields("IDProjet").Value = sNoCumulatif
			
			'Ouverture du projet -01 pour voir la soumission reliée pour ensuite assigner
			'la soumission -99 avec le projet -99
125: Call rstProj.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, 6) & "-01'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
130: If Not rstProj.EOF Then
135: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("IDSoumission").Value) Then
140: If Len(rstProj.Fields("IDSoumission").Value) >= 6 Then
145: rstSoum = New ADODB.Recordset
						
150: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & VB.Left(rstProj.Fields("IDSoumission").Value, 6) & "-99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
						
155: If Not rstSoum.EOF Then
160: rstProjCumulatif.Fields("IDSoumission").Value = rstSoum.Fields("IDSoumission").Value
165: End If
						
170: Call rstSoum.Close()
175: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstSoum = Nothing
180: End If
185: End If
190: End If
			
195: Call rstProj.Close()
			
200: Call rstProj.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
205: rstProjCumulatif.Fields("IDClient").Value = rstProj.Fields("IDClient").Value
210: rstProjCumulatif.Fields("IDContact").Value = rstProj.Fields("IDContact").Value
			
215: rstProjCumulatif.Fields("TauxMachinage").Value = rstProj.Fields("TauxMachinage").Value
220: rstProjCumulatif.Fields("TauxCoupe").Value = rstProj.Fields("TauxCoupe").Value
225: rstProjCumulatif.Fields("TauxSoudure").Value = rstProj.Fields("TauxSoudure").Value
230: rstProjCumulatif.Fields("TauxAssemblage").Value = rstProj.Fields("TauxAssemblage").Value
235: rstProjCumulatif.Fields("TauxPeinture").Value = rstProj.Fields("TauxPeinture").Value
240: rstProjCumulatif.Fields("TauxTest").Value = rstProj.Fields("TauxTest").Value
245: rstProjCumulatif.Fields("TauxDessin").Value = rstProj.Fields("TauxDessin").Value
250: rstProjCumulatif.Fields("TauxFormation").Value = rstProj.Fields("TauxFormation").Value
255: rstProjCumulatif.Fields("TauxInstallation").Value = rstProj.Fields("TauxInstallation").Value
260: rstProjCumulatif.Fields("TauxGestion").Value = rstProj.Fields("TauxGestion").Value
265: rstProjCumulatif.Fields("TauxShipping").Value = rstProj.Fields("TauxShipping").Value
			
270: rstProjCumulatif.Fields("Profit").Value = rstProj.Fields("Profit").Value
275: rstProjCumulatif.Fields("imprevue").Value = rstProj.Fields("imprevue").Value
280: rstProjCumulatif.Fields("commission").Value = rstProj.Fields("commission").Value
			
285: Call rstProj.Close()
			
290: rstProjCumulatif.Fields("Description").Value = "Cumulatif de " & VB.Left(txtNoProjSoum.Text, 6)
			
295: rstEmploye = New ADODB.Recordset
			
300: Call rstEmploye.Open("SELECT * FROM GRB_employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
305: rstProjCumulatif.Fields("creer").Value = ConvertDate(Today)
			
310: rstProjCumulatif.Fields("creer_par").Value = rstEmploye.Fields("NoEmploye").Value
			
315: Call rstEmploye.Close()
320: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstEmploye = Nothing
			
325: Call rstProjCumulatif.Update()
			
330: rstProjSoum = New ADODB.Recordset
			
335: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
340: Call rstProjSoum.AddNew()
			
345: rstProjSoum.Fields("IDProjSoum").Value = sNoCumulatif
350: rstProjSoum.Fields("NoClient").Value = rstProjCumulatif.Fields("IDClient").Value
355: rstProjSoum.Fields("Description").Value = rstProjCumulatif.Fields("Description").Value
360: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
365: rstProjSoum.Fields("Ouvert").Value = True
370: rstProjSoum.Fields("Verrouillé").Value = True
375: rstProjSoum.Fields("Type").Value = "P"
			
380: Call rstProjSoum.Update()
			
385: Call rstProjSoum.Close()
390: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
395: Else
400: bCumulatifExiste = True
405: End If
		
410: rstProj.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
415: Call rstProj.Open("SELECT * FROM GRB_ProjetMec WHERE LEFT(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDProjet, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
420: If rstProj.RecordCount = 1 Then
425: rstProjCumulatif.Fields("manuel").Value = rstProj.Fields("manuel").Value
			
430: rstProjCumulatif.Fields("PrixEmballage").Value = rstProj.Fields("PrixEmballage").Value
			
435: rstProjCumulatif.Fields("total_manuel").Value = rstProj.Fields("total_manuel").Value
			
440: rstProjCumulatif.Fields("MontantForfait").Value = rstProj.Fields("MontantForfait").Value
445: Else
450: Do While Not rstProj.EOF
455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("manuel").Value) Then
460: dblNbreManuel = dblNbreManuel + CDbl(rstProj.Fields("manuel").Value)
465: End If
				
470: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("PrixEmballage").Value) Then
475: dblPrixEmballage = dblPrixEmballage + CDbl(rstProj.Fields("PrixEmballage").Value)
480: End If
				
485: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("total_manuel").Value) Then
490: dblTotalManuel = dblTotalManuel + CDbl(rstProj.Fields("total_manuel").Value)
495: End If
				
500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("MontantForfait").Value) Then
505: If IsNumeric(rstProj.Fields("MontantForfait").Value) Then
510: dblForfait = dblForfait + CDbl(rstProj.Fields("MontantForfait").Value)
515: End If
520: End If
				
525: Call rstProj.MoveNext()
530: Loop 
			
535: rstProjCumulatif.Fields("manuel").Value = dblNbreManuel
540: rstProjCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
545: rstProjCumulatif.Fields("total_manuel").Value = dblTotalManuel
550: rstProjCumulatif.Fields("MontantForfait").Value = dblForfait
555: End If
		
560: Call rstProj.Close()
		
565: Call rstProjCumulatif.Update()
		
570: Call rstProjCumulatif.Close()
		
		'AJOUT DES PIÈCES
575: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
580: If bCumulatifExiste = True Then
585: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "' AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
			
590: Call rstPieces.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Provenance Is Null OR Provenance = '' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
595: Else
600: Call rstPieces.Open("SELECT * FROM GRB_Projet_Pieces WHERE LEFT(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDProjet, 2) <> '99' AND Provenance Is Null OR Provenance = '' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
605: End If
		
610: Do While Not rstPieces.EOF
615: Call rstPiecesCumulatif.AddNew()
			
620: rstPiecesCumulatif.Fields("IDProjet").Value = sNoCumulatif
625: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
630: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
635: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
640: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
645: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
650: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
655: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
660: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
665: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
670: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
675: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
680: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
685: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
690: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
695: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
700: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
705: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
710: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
715: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
720: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
725: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDProjet").Value, 2)
			
730: Call rstPiecesCumulatif.Update()
			
735: Call rstPieces.MoveNext()
740: Loop 
		
745: Call rstPiecesCumulatif.Close()
750: Call rstPieces.Close()
		
755: 'UPGRADE_NOTE: Object rstProj may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProj = Nothing
760: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
765: 'UPGRADE_NOTE: Object rstProjCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjCumulatif = Nothing
770: 'UPGRADE_NOTE: Object rstPiecesCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiecesCumulatif = Nothing
		
775: Call CalculerTotalRecordset(sNoCumulatif)
		
780: If bCumulatifExiste = False Then
785: If cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT Then
790: Call RemplirComboProjSoum(txtNoProjSoum.Text)
795: End If
800: End If
		
805: Exit Sub
		
AfficherErreur: 
		
810: Call AfficherErreur("FrmProjSoumElec", "AjouterProjetAuCumulatif", Err, Erl())
	End Sub
	
	Private Sub AjouterSoumissionAuCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstSoum As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstSoumCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim rstEmploye As ADODB.Recordset
45: Dim bCumulatifExiste As Boolean
50: Dim dblNbreManuel As Double
55: Dim dblTempsMachinage As Double
60: Dim dblTempsCoupe As Double
65: Dim dblTempsSoudure As Double
70: Dim dblTempsAssemblage As Double
75: Dim dblTempsPeinture As Double
80: Dim dblTempsTest As Double
85: Dim dblTempsDessin As Double
90: Dim dblTempsFormation As Double
95: Dim dblTempsInstallation As Double
100: Dim dblTempsGestion As Double
105: Dim dblTempsShipping As Double
110: Dim dblTempsTransport As Double
115: Dim dblTempsUniteMobile As Double
120: Dim dblTotalHebergement As Double
125: Dim dblTotalRepas As Double
130: Dim dblPrixEmballage As Double
135: Dim dblTotalManuel As Double
140: Dim dblForfait As Double
		
145: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
150: rstSoum = New ADODB.Recordset
155: rstPieces = New ADODB.Recordset
160: rstSoumCumulatif = New ADODB.Recordset
165: rstPiecesCumulatif = New ADODB.Recordset
		
170: Call rstSoumCumulatif.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
175: If rstSoumCumulatif.EOF Then
180: bCumulatifExiste = False
			
185: Call rstSoumCumulatif.AddNew()
			
190: rstSoumCumulatif.Fields("IDSoumission").Value = sNoCumulatif
			
195: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
200: rstSoumCumulatif.Fields("IDClient").Value = rstSoum.Fields("IDClient").Value
205: rstSoumCumulatif.Fields("IDContact").Value = rstSoum.Fields("IDContact").Value
			
210: rstSoumCumulatif.Fields("TauxMachinage").Value = rstSoum.Fields("TauxMachinage").Value
215: rstSoumCumulatif.Fields("TauxCoupe").Value = rstSoum.Fields("TauxCoupe").Value
220: rstSoumCumulatif.Fields("TauxSoudure").Value = rstSoum.Fields("TauxSoudure").Value
225: rstSoumCumulatif.Fields("TauxAssemblage").Value = rstSoum.Fields("TauxAssemblage").Value
230: rstSoumCumulatif.Fields("TauxPeinture").Value = rstSoum.Fields("TauxPeinture").Value
235: rstSoumCumulatif.Fields("TauxTest").Value = rstSoum.Fields("TauxTest").Value
240: rstSoumCumulatif.Fields("TauxDessin").Value = rstSoum.Fields("TauxDessin").Value
245: rstSoumCumulatif.Fields("TauxFormation").Value = rstSoum.Fields("TauxFormation").Value
250: rstSoumCumulatif.Fields("TauxInstallation").Value = rstSoum.Fields("TauxInstallation").Value
255: rstSoumCumulatif.Fields("TauxGestion").Value = rstSoum.Fields("TauxGestion").Value
260: rstSoumCumulatif.Fields("TauxShipping").Value = rstSoum.Fields("TauxShipping").Value
			
265: rstSoumCumulatif.Fields("TauxHebergement1").Value = rstSoum.Fields("TauxHebergement1").Value
270: rstSoumCumulatif.Fields("TauxHebergement2").Value = rstSoum.Fields("TauxHebergement2").Value
275: rstSoumCumulatif.Fields("TauxRepas").Value = rstSoum.Fields("TauxRepas").Value
280: rstSoumCumulatif.Fields("TauxTransport").Value = rstSoum.Fields("TauxTransport").Value
285: rstSoumCumulatif.Fields("TauxUniteMobile").Value = rstSoum.Fields("TauxUniteMobile").Value
			
290: rstSoumCumulatif.Fields("Profit").Value = rstSoum.Fields("Profit").Value
295: rstSoumCumulatif.Fields("imprevue").Value = rstSoum.Fields("imprevue").Value
300: rstSoumCumulatif.Fields("commission").Value = rstSoum.Fields("commission").Value
			
305: Call rstSoum.Close()
			
310: rstSoumCumulatif.Fields("Description").Value = "Cumulatif de " & VB.Left(txtNoProjSoum.Text, 6)
			
315: rstEmploye = New ADODB.Recordset
			
320: Call rstEmploye.Open("SELECT * FROM GRB_employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
325: rstSoumCumulatif.Fields("creer").Value = ConvertDate(Today)
			
330: rstSoumCumulatif.Fields("creer_par").Value = rstEmploye.Fields("NoEmploye").Value
			
335: Call rstEmploye.Close()
340: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstEmploye = Nothing
			
345: Call rstSoumCumulatif.Update()
			
350: rstProjSoum = New ADODB.Recordset
			
355: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
360: Call rstProjSoum.AddNew()
			
365: rstProjSoum.Fields("IDProjSoum").Value = sNoCumulatif
370: rstProjSoum.Fields("NoClient").Value = rstSoumCumulatif.Fields("IDClient").Value
375: rstProjSoum.Fields("Description").Value = rstSoumCumulatif.Fields("Description").Value
380: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
385: rstProjSoum.Fields("Ouvert").Value = True
390: rstProjSoum.Fields("Verrouillé").Value = True
395: rstProjSoum.Fields("Type").Value = "S"
			
400: Call rstProjSoum.Update()
			
405: Call rstProjSoum.Close()
410: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
415: Else
420: bCumulatifExiste = True
425: End If
		
430: rstSoum.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
435: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
440: If rstSoum.RecordCount = 1 Then
445: rstSoumCumulatif.Fields("manuel").Value = rstSoum.Fields("manuel").Value
			
450: rstSoumCumulatif.Fields("TempsMachinage").Value = rstSoum.Fields("TempsMachinage").Value
455: rstSoumCumulatif.Fields("TempsCoupe").Value = rstSoum.Fields("TempsCoupe").Value
460: rstSoumCumulatif.Fields("TempsSoudure").Value = rstSoum.Fields("TempsSoudure").Value
465: rstSoumCumulatif.Fields("TempsAssemblage").Value = rstSoum.Fields("TempsAssemblage").Value
470: rstSoumCumulatif.Fields("TempsPeinture").Value = rstSoum.Fields("TempsPeinture").Value
475: rstSoumCumulatif.Fields("TempsTest").Value = rstSoum.Fields("TempsTest").Value
480: rstSoumCumulatif.Fields("TempsDessin").Value = rstSoum.Fields("TempsDessin").Value
485: rstSoumCumulatif.Fields("TempsFormation").Value = rstSoum.Fields("TempsFormation").Value
490: rstSoumCumulatif.Fields("TempsInstallation").Value = rstSoum.Fields("TempsInstallation").Value
495: rstSoumCumulatif.Fields("TempsGestion").Value = rstSoum.Fields("TempsGestion").Value
500: rstSoumCumulatif.Fields("TempsShipping").Value = rstSoum.Fields("TempsShipping").Value
			
505: rstSoumCumulatif.Fields("NbrePersonne").Value = rstSoum.Fields("NbrePersonne").Value
510: rstSoumCumulatif.Fields("TempsHebergement").Value = rstSoum.Fields("TempsHebergement").Value
515: rstSoumCumulatif.Fields("TempsRepas").Value = rstSoum.Fields("TempsRepas").Value
520: rstSoumCumulatif.Fields("TempsTransport").Value = rstSoum.Fields("TempsTransport").Value
525: rstSoumCumulatif.Fields("TempsUniteMobile").Value = rstSoum.Fields("TempsUniteMobile").Value
			
530: rstSoumCumulatif.Fields("TotalHebergement").Value = rstSoum.Fields("TotalHebergement").Value
535: rstSoumCumulatif.Fields("TotalRepas").Value = rstSoum.Fields("TotalRepas").Value
540: rstSoumCumulatif.Fields("PrixEmballage").Value = rstSoum.Fields("PrixEmballage").Value
			
545: rstSoumCumulatif.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
			
550: rstSoumCumulatif.Fields("MontantForfait").Value = rstSoum.Fields("MontantForfait").Value
555: Else
560: Do While Not rstSoum.EOF
565: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("manuel").Value) Then
570: dblNbreManuel = dblNbreManuel + CDbl(rstSoum.Fields("manuel").Value)
575: End If
				
580: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsMachinage").Value) Then
585: dblTempsMachinage = dblTempsMachinage + CDbl(rstSoum.Fields("TempsMachinage").Value)
590: End If
				
595: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsCoupe").Value) Then
600: dblTempsCoupe = dblTempsCoupe + CDbl(rstSoum.Fields("TempsCoupe").Value)
605: End If
				
610: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsSoudure").Value) Then
615: dblTempsSoudure = dblTempsSoudure + CDbl(rstSoum.Fields("TempsSoudure").Value)
620: End If
				
625: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
630: dblTempsAssemblage = dblTempsAssemblage + CDbl(rstSoum.Fields("TempsAssemblage").Value)
635: End If
				
640: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsPeinture").Value) Then
645: dblTempsPeinture = dblTempsPeinture + CDbl(rstSoum.Fields("TempsPeinture").Value)
650: End If
				
655: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
660: dblTempsTest = dblTempsTest + CDbl(rstSoum.Fields("TempsTest").Value)
665: End If
				
670: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
675: dblTempsDessin = dblTempsDessin + CDbl(rstSoum.Fields("TempsDessin").Value)
680: End If
				
685: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
690: dblTempsFormation = dblTempsFormation + CDbl(rstSoum.Fields("TempsFormation").Value)
695: End If
				
700: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
705: dblTempsInstallation = dblTempsInstallation + CDbl(rstSoum.Fields("TempsInstallation").Value)
710: End If
				
715: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
720: dblTempsGestion = dblTempsGestion + CDbl(rstSoum.Fields("TempsGestion").Value)
725: End If
				
730: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
735: dblTempsShipping = dblTempsShipping + CDbl(rstSoum.Fields("TempsShipping").Value)
740: End If
				
745: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsTransport").Value) Then
750: dblTempsTransport = dblTempsTransport + CDbl(rstSoum.Fields("TempsTransport").Value)
755: End If
				
760: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsUniteMobile").Value) Then
765: dblTempsUniteMobile = dblTempsUniteMobile + CDbl(rstSoum.Fields("TempsUniteMobile").Value)
770: End If
				
775: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TotalHebergement").Value) Then
780: dblTotalHebergement = dblTotalHebergement + CDbl(rstSoum.Fields("TotalHebergement").Value)
785: End If
				
790: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TotalRepas").Value) Then
795: dblTotalRepas = dblTotalRepas + CDbl(rstSoum.Fields("TotalRepas").Value)
800: End If
				
805: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("PrixEmballage").Value) Then
810: dblPrixEmballage = dblPrixEmballage + CDbl(rstSoum.Fields("PrixEmballage").Value)
815: End If
				
820: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("total_manuel").Value) Then
825: dblTotalManuel = dblTotalManuel + CDbl(rstSoum.Fields("total_manuel").Value)
830: End If
				
835: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("MontantForfait").Value) Then
840: If IsNumeric(rstSoum.Fields("MontantForfait").Value) Then
845: dblForfait = dblForfait + CDbl(rstSoum.Fields("MontantForfait").Value)
850: End If
855: End If
				
860: Call rstSoum.MoveNext()
865: Loop 
			
870: rstSoumCumulatif.Fields("manuel").Value = dblNbreManuel
			
875: rstSoumCumulatif.Fields("TempsMachinage").Value = dblTempsMachinage
880: rstSoumCumulatif.Fields("TempsCoupe").Value = dblTempsCoupe
885: rstSoumCumulatif.Fields("TempsSoudure").Value = dblTempsSoudure
890: rstSoumCumulatif.Fields("TempsAssemblage").Value = dblTempsAssemblage
895: rstSoumCumulatif.Fields("TempsPeinture").Value = dblTempsPeinture
900: rstSoumCumulatif.Fields("TempsTest").Value = dblTempsTest
905: rstSoumCumulatif.Fields("TempsDessin").Value = dblTempsDessin
910: rstSoumCumulatif.Fields("TempsFormation").Value = dblTempsFormation
915: rstSoumCumulatif.Fields("TempsInstallation").Value = dblTempsInstallation
920: rstSoumCumulatif.Fields("TempsGestion").Value = dblTempsGestion
925: rstSoumCumulatif.Fields("TempsShipping").Value = dblTempsShipping
			
930: rstSoumCumulatif.Fields("TempsTransport").Value = dblTempsTransport
935: rstSoumCumulatif.Fields("TempsUniteMobile").Value = dblTempsUniteMobile
			
940: rstSoumCumulatif.Fields("TotalHebergement").Value = dblTotalHebergement
945: rstSoumCumulatif.Fields("TotalRepas").Value = dblTotalRepas
950: rstSoumCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
			
955: rstSoumCumulatif.Fields("total_manuel").Value = dblTotalManuel
			
960: rstSoumCumulatif.Fields("MontantForfait").Value = dblForfait
965: End If
		
970: Call rstSoumCumulatif.Update()
		
975: Call rstSoumCumulatif.Close()
		
980: Call rstSoum.Close()
		
		'AJOUT DES PIÈCES
985: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
990: If bCumulatifExiste = True Then
995: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "' AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
			
1000: Call rstPieces.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
1005: Else
1010: Call rstPieces.Open("SELECT * FROM GRB_Soumission_Pieces WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
1015: End If
		
1020: Do While Not rstPieces.EOF
1025: Call rstPiecesCumulatif.AddNew()
			
1030: rstPiecesCumulatif.Fields("IDSoumission").Value = sNoCumulatif
1035: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
1040: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
1045: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
1050: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
1055: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
1060: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
1065: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
1070: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
1075: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
1080: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
1085: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
1090: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
1095: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
1100: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
1105: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
1110: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
1115: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
1120: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
1125: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
1130: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
1135: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDSoumission").Value, 2)
			
1140: Call rstPiecesCumulatif.Update()
			
1145: Call rstPieces.MoveNext()
1150: Loop 
		
1155: Call rstPiecesCumulatif.Close()
1160: Call rstPieces.Close()
		
1165: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoum = Nothing
1170: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
1175: 'UPGRADE_NOTE: Object rstSoumCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoumCumulatif = Nothing
1180: 'UPGRADE_NOTE: Object rstPiecesCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiecesCumulatif = Nothing
		
1185: Call CalculerTotalRecordset(sNoCumulatif)
		
1190: Exit Sub
		
AfficherErreur: 
		
1195: Call AfficherErreur("FrmProjSoumElec", "AjouterSoumissionAuCumulatif", Err, Erl())
	End Sub
	
	Private Sub RecreerProjetCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstProj As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstProjCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim dblNbreManuel As Double
45: Dim dblPrixEmballage As Double
50: Dim dblTotalManuel As Double
55: Dim dblForfait As Double
60: Dim bSupprimer As Boolean
		
65: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
70: rstProj = New ADODB.Recordset
75: rstPieces = New ADODB.Recordset
80: rstProjCumulatif = New ADODB.Recordset
85: rstPiecesCumulatif = New ADODB.Recordset
		
90: rstProj.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
95: Call rstProj.Open("SELECT * FROM GRB_ProjetMec WHERE LEFT(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDProjet, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
100: If rstProj.EOF Then
105: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoCumulatif & "'")
			
110: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "' AND Type = 'E'")
			
			'Efface le projet
115: Call g_connData.Execute("DELETE * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoCumulatif & "'")
			
120: bSupprimer = True
125: Else
130: Call rstProjCumulatif.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
135: If rstProj.RecordCount = 1 Then
140: rstProjCumulatif.Fields("manuel").Value = rstProj.Fields("manuel").Value
				
145: rstProjCumulatif.Fields("PrixEmballage").Value = rstProj.Fields("PrixEmballage").Value
				
150: rstProjCumulatif.Fields("total_manuel").Value = rstProj.Fields("total_manuel").Value
				
155: rstProjCumulatif.Fields("MontantForfait").Value = rstProj.Fields("MontantForfait").Value
160: Else
165: Do While Not rstProj.EOF
170: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("manuel").Value) Then
175: dblNbreManuel = dblNbreManuel + CDbl(rstProj.Fields("manuel").Value)
180: End If
					
185: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("PrixEmballage").Value) Then
190: dblPrixEmballage = dblPrixEmballage + CDbl(rstProj.Fields("PrixEmballage").Value)
195: End If
					
200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("total_manuel").Value) Then
205: dblTotalManuel = dblTotalManuel + CDbl(rstProj.Fields("total_manuel").Value)
210: End If
					
215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("MontantForfait").Value) Then
220: If IsNumeric(rstProj.Fields("MontantForfait").Value) Then
225: dblForfait = dblForfait + CDbl(rstProj.Fields("MontantForfait").Value)
230: End If
235: End If
					
240: Call rstProj.MoveNext()
245: Loop 
				
250: rstProjCumulatif.Fields("manuel").Value = dblNbreManuel
255: rstProjCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
260: rstProjCumulatif.Fields("total_manuel").Value = dblTotalManuel
265: rstProjCumulatif.Fields("MontantForfait").Value = dblForfait
270: End If
			
275: Call rstProj.Close()
			
280: Call rstProjCumulatif.Update()
			
285: Call rstProjCumulatif.Close()
290: End If
		
		'AJOUT DES PIÈCES
295: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
300: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "' AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
		
305: Call rstPieces.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Provenance Is Null OR Provenance = '' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
310: Do While Not rstPieces.EOF
315: Call rstPiecesCumulatif.AddNew()
			
320: rstPiecesCumulatif.Fields("IDProjet").Value = sNoCumulatif
325: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
330: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
335: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
340: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
345: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
350: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
355: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
360: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
365: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
370: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
375: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
380: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
385: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
390: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
395: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
400: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
405: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
410: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
415: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
420: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
425: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDProjet").Value, 2)
			
430: Call rstPiecesCumulatif.Update()
			
435: Call rstPieces.MoveNext()
440: Loop 
		
445: Call rstPiecesCumulatif.Close()
450: Call rstPieces.Close()
		
455: 'UPGRADE_NOTE: Object rstProj may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProj = Nothing
460: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
465: 'UPGRADE_NOTE: Object rstProjCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjCumulatif = Nothing
470: 'UPGRADE_NOTE: Object rstPiecesCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiecesCumulatif = Nothing
		
475: If bSupprimer = False Then
480: Call CalculerTotalRecordset(sNoCumulatif)
485: End If
		
490: Exit Sub
		
AfficherErreur: 
		
495: Call AfficherErreur("FrmProjSoumElec", "AjouterProjetAuCumulatif", Err, Erl())
	End Sub
	
	Private Sub RecreerSoumissionCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstSoum As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstSoumCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim dblNbreManuel As Double
45: Dim dblTempsMachinage As Double
50: Dim dblTempsCoupe As Double
55: Dim dblTempsSoudure As Double
60: Dim dblTempsAssemblage As Double
65: Dim dblTempsPeinture As Double
70: Dim dblTempsTest As Double
75: Dim dblTempsDessin As Double
80: Dim dblTempsFormation As Double
85: Dim dblTempsInstallation As Double
90: Dim dblTempsGestion As Double
95: Dim dblTempsShipping As Double
100: Dim dblTempsTransport As Double
105: Dim dblTempsUniteMobile As Double
110: Dim dblTotalHebergement As Double
115: Dim dblTotalRepas As Double
120: Dim dblPrixEmballage As Double
125: Dim dblTotalManuel As Double
130: Dim dblForfait As Double
135: Dim bSupprimer As Boolean
		
140: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
145: rstSoum = New ADODB.Recordset
150: rstPieces = New ADODB.Recordset
155: rstSoumCumulatif = New ADODB.Recordset
160: rstPiecesCumulatif = New ADODB.Recordset
		
165: rstSoum.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
170: Call rstSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
175: If rstSoum.EOF Then
180: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoCumulatif & "'")
			
185: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "' AND Type = 'E'")
			
			'Efface la soumission
190: Call g_connData.Execute("DELETE * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoCumulatif & "'")
			
195: bSupprimer = True
200: Else
205: Call rstSoumCumulatif.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
210: If rstSoum.RecordCount = 1 Then
215: rstSoumCumulatif.Fields("manuel").Value = rstSoum.Fields("manuel").Value
				
220: rstSoumCumulatif.Fields("TempsMachinage").Value = rstSoum.Fields("TempsMachinage").Value
225: rstSoumCumulatif.Fields("TempsCoupe").Value = rstSoum.Fields("TempsCoupe").Value
230: rstSoumCumulatif.Fields("TempsSoudure").Value = rstSoum.Fields("TempsSoudure").Value
235: rstSoumCumulatif.Fields("TempsAssemblage").Value = rstSoum.Fields("TempsAssemblage").Value
240: rstSoumCumulatif.Fields("TempsPeinture").Value = rstSoum.Fields("TempsPeinture").Value
245: rstSoumCumulatif.Fields("TempsTest").Value = rstSoum.Fields("TempsTest").Value
250: rstSoumCumulatif.Fields("TempsDessin").Value = rstSoum.Fields("TempsDessin").Value
255: rstSoumCumulatif.Fields("TempsFormation").Value = rstSoum.Fields("TempsFormation").Value
260: rstSoumCumulatif.Fields("TempsInstallation").Value = rstSoum.Fields("TempsInstallation").Value
265: rstSoumCumulatif.Fields("TempsGestion").Value = rstSoum.Fields("TempsGestion").Value
270: rstSoumCumulatif.Fields("TempsShipping").Value = rstSoum.Fields("TempsShipping").Value
				
275: rstSoumCumulatif.Fields("NbrePersonne").Value = rstSoum.Fields("NbrePersonne").Value
280: rstSoumCumulatif.Fields("TempsHebergement").Value = rstSoum.Fields("TempsHebergement").Value
285: rstSoumCumulatif.Fields("TempsRepas").Value = rstSoum.Fields("TempsRepas").Value
290: rstSoumCumulatif.Fields("TempsTransport").Value = rstSoum.Fields("TempsTransport").Value
295: rstSoumCumulatif.Fields("TempsUniteMobile").Value = rstSoum.Fields("TempsUniteMobile").Value
				
300: rstSoumCumulatif.Fields("TotalHebergement").Value = rstSoum.Fields("TotalHebergement").Value
305: rstSoumCumulatif.Fields("TotalRepas").Value = rstSoum.Fields("TotalRepas").Value
310: rstSoumCumulatif.Fields("PrixEmballage").Value = rstSoum.Fields("PrixEmballage").Value
				
315: rstSoumCumulatif.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
				
320: rstSoumCumulatif.Fields("MontantForfait").Value = rstSoum.Fields("MontantForfait").Value
325: Else
330: Do While Not rstSoum.EOF
335: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("manuel").Value) Then
340: dblNbreManuel = dblNbreManuel + CDbl(rstSoum.Fields("manuel").Value)
345: End If
					
350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsMachinage").Value) Then
355: dblTempsMachinage = dblTempsMachinage + CDbl(rstSoum.Fields("TempsMachinage").Value)
360: End If
					
365: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsCoupe").Value) Then
370: dblTempsCoupe = dblTempsCoupe + CDbl(rstSoum.Fields("TempsCoupe").Value)
375: End If
					
380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsSoudure").Value) Then
385: dblTempsSoudure = dblTempsSoudure + CDbl(rstSoum.Fields("TempsSoudure").Value)
390: End If
					
395: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
400: dblTempsAssemblage = dblTempsAssemblage + CDbl(rstSoum.Fields("TempsAssemblage").Value)
405: End If
					
410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsPeinture").Value) Then
415: dblTempsPeinture = dblTempsPeinture + CDbl(rstSoum.Fields("TempsPeinture").Value)
420: End If
					
425: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
430: dblTempsTest = dblTempsTest + CDbl(rstSoum.Fields("TempsTest").Value)
435: End If
					
440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
445: dblTempsDessin = dblTempsDessin + CDbl(rstSoum.Fields("TempsDessin").Value)
450: End If
					
455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
460: dblTempsFormation = dblTempsFormation + CDbl(rstSoum.Fields("TempsFormation").Value)
465: End If
					
470: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
475: dblTempsInstallation = dblTempsInstallation + CDbl(rstSoum.Fields("TempsInstallation").Value)
480: End If
					
485: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
490: dblTempsGestion = dblTempsGestion + CDbl(rstSoum.Fields("TempsGestion").Value)
495: End If
					
500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
505: dblTempsShipping = dblTempsShipping + CDbl(rstSoum.Fields("TempsShipping").Value)
510: End If
					
515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTransport").Value) Then
520: dblTempsTransport = dblTempsTransport + CDbl(rstSoum.Fields("TempsTransport").Value)
525: End If
					
530: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsUniteMobile").Value) Then
535: dblTempsUniteMobile = dblTempsUniteMobile + CDbl(rstSoum.Fields("TempsUniteMobile").Value)
540: End If
					
545: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TotalHebergement").Value) Then
550: dblTotalHebergement = dblTotalHebergement + CDbl(rstSoum.Fields("TotalHebergement").Value)
555: End If
					
560: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TotalRepas").Value) Then
565: dblTotalRepas = dblTotalRepas + CDbl(rstSoum.Fields("TotalRepas").Value)
570: End If
					
575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("PrixEmballage").Value) Then
580: dblPrixEmballage = dblPrixEmballage + CDbl(rstSoum.Fields("PrixEmballage").Value)
585: End If
					
590: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("total_manuel").Value) Then
595: dblTotalManuel = dblTotalManuel + CDbl(rstSoum.Fields("total_manuel").Value)
600: End If
					
605: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("MontantForfait").Value) Then
610: If IsNumeric(rstSoum.Fields("MontantForfait").Value) Then
615: dblForfait = dblForfait + CDbl(rstSoum.Fields("MontantForfait").Value)
620: End If
625: End If
					
630: Call rstSoum.MoveNext()
635: Loop 
				
640: rstSoumCumulatif.Fields("manuel").Value = dblNbreManuel
				
645: rstSoumCumulatif.Fields("TempsMachinage").Value = dblTempsMachinage
650: rstSoumCumulatif.Fields("TempsCoupe").Value = dblTempsCoupe
655: rstSoumCumulatif.Fields("TempsSoudure").Value = dblTempsSoudure
660: rstSoumCumulatif.Fields("TempsAssemblage").Value = dblTempsAssemblage
665: rstSoumCumulatif.Fields("TempsPeinture").Value = dblTempsPeinture
670: rstSoumCumulatif.Fields("TempsTest").Value = dblTempsTest
675: rstSoumCumulatif.Fields("TempsDessin").Value = dblTempsDessin
680: rstSoumCumulatif.Fields("TempsFormation").Value = dblTempsFormation
685: rstSoumCumulatif.Fields("TempsInstallation").Value = dblTempsInstallation
690: rstSoumCumulatif.Fields("TempsGestion").Value = dblTempsGestion
695: rstSoumCumulatif.Fields("TempsShipping").Value = dblTempsShipping
				
700: rstSoumCumulatif.Fields("TempsTransport").Value = dblTempsTransport
705: rstSoumCumulatif.Fields("TempsUniteMobile").Value = dblTempsUniteMobile
				
710: rstSoumCumulatif.Fields("TotalHebergement").Value = dblTotalHebergement
715: rstSoumCumulatif.Fields("TotalRepas").Value = dblTotalRepas
720: rstSoumCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
				
725: rstSoumCumulatif.Fields("total_manuel").Value = dblTotalManuel
				
730: rstSoumCumulatif.Fields("MontantForfait").Value = dblForfait
735: End If
			
740: Call rstSoum.Close()
			
745: Call rstSoumCumulatif.Update()
			
750: Call rstSoumCumulatif.Close()
755: End If
		
		'AJOUT DES PIÈCES
760: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
765: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "'")
		
770: Call rstPieces.Open("SELECT * FROM GRB_Soumission_Pieces WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
775: Do While Not rstPieces.EOF
780: Call rstPiecesCumulatif.AddNew()
			
785: rstPiecesCumulatif.Fields("IDSoumission").Value = sNoCumulatif
790: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
795: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
800: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
805: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
810: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
815: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
820: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
825: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
830: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
835: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
840: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
845: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
850: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
855: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
860: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
865: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
870: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
875: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
880: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
885: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
890: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDSoumission").Value, 2)
			
895: Call rstPiecesCumulatif.Update()
			
900: Call rstPieces.MoveNext()
905: Loop 
		
910: Call rstPiecesCumulatif.Close()
915: Call rstPieces.Close()
		
920: rstSoum = New ADODB.Recordset
925: rstPieces = New ADODB.Recordset
930: rstSoumCumulatif = New ADODB.Recordset
935: rstPiecesCumulatif = New ADODB.Recordset
		
940: If bSupprimer = False Then
945: Call CalculerTotalRecordset(sNoCumulatif)
950: End If
		
955: Exit Sub
		
AfficherErreur: 
		
960: Call AfficherErreur("FrmProjSoumElec", "RecreerSoumissionCumulatif", Err, Erl())
	End Sub
	Private Function ExportdansExcel(ByVal oRecordset As ADODB.Recordset) As Object
		
5: On Error GoTo AfficherErreur
		
6: Dim iCount As Short
10: Dim oXLApp As Excel.Application 'Declare the object variables
15: Dim oXLBook As Excel.Workbook
20: Dim oXLSheet As Excel.Worksheet
		
25: oXLApp = New Excel.Application 'Create a new instance of Excel
30: oXLBook = oXLApp.Workbooks.Add 'Add a new workbook
35: oXLSheet = oXLBook.Worksheets(1) 'Work with the first worksheet
		
		
		' ajustement largeur des colonne
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(1).ColumnWidth = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(2).ColumnWidth = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(3).ColumnWidth = 20
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(4).ColumnWidth = 45
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(5).ColumnWidth = 20
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(6).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(7).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(8).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(9).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(10).ColumnWidth = 30
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(11).ColumnWidth = 20
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(12).ColumnWidth = 20
		
		oXLSheet.Range("A1: N1").Font.Bold = True
		
		
		
		
40: With oXLSheet 'Fill with data
45: For iCount = 0 To (oRecordset.Fields.Count - 1)
50: 'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Cells(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				.Cells._Default(1, iCount + 1) = oRecordset.Fields(iCount).Name
55: Next iCount
60: 'create and fill a recordset here, called oRecordset
65: .Range("A2").CopyFromRecordset(oRecordset)
70: End With
		
75: oXLApp.Visible = True 'Show it to the user
80: 'UPGRADE_NOTE: Object oXLSheet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		oXLSheet = Nothing 'Disconnect from all Excel objects (let the user take over)
85: 'UPGRADE_NOTE: Object oXLBook may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		oXLBook = Nothing
90: 'UPGRADE_NOTE: Object oXLApp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		oXLApp = Nothing
		
95: Exit Function
		
AfficherErreur: 
		
960: Call AfficherErreur("FrmProjSoumMec", "ExportdansExcel", Err, Erl())
	End Function
End Class