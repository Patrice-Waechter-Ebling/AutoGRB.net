Option Strict Off
Option Explicit On
Imports VB = Microsoft.VisualBasic
Friend Class FrmProjSoumElec
	Inherits System.Windows.Forms.Form
	
	'**************************************************************************************'
	'   Liste des valeurs du .Text et du .Tag pour chacune des colonnes de lvwSoumission   '
	'**************************************************************************************'
	'        COLONNE            |           TEXTE            |          TAG                '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_QUANTITE        |   Quantité                 |     ID Section              '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_PIECE           |   Pièce                    |     Sous-section            '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_DESCR           |   Description FR ou EN     |     Description FR ou EN    '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_MANUFACT        |   Manufacturier            |     Ordre section           '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_PRIX_LIST       |   Prix listé               |     Prix d'origine          '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_ESCOMPTE        |   Escompte                 |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_PRIX_NET        |   Prix net                 |     Date de réception       '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_DISTRIB         |   Fournisseur              |     ID Fournisseur          '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_TEMPS           |   Temps                    |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_MONTAGE         |   Montage                  |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_TOTAL           |   Total                    |     Devise monétaire        '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_PROFIT          |   Profit                   | EXTRA, RETOUR ou ANNULATION '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_COMMENTAIRE     |   Commentaire              |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_ID              |   ID                       |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_FACTURATION     |   Facturation              |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_DATE_COMMANDE   |   Date Commande            |     Numéro Retour           '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_DATE_REQUISE    |   Date Requise             |     Date Retour             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_NOM_COMMANDE    |   Personne qui a commandé  |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_NO_SEQUENTIEL   |   Numéro séquentiel du BC  |                             '
	'---------------------------|----------------------------|-----------------------------'
	'I_COL_SOUM_PROVENANCE      |   Provenance               |                             '
	'---------------------------|----------------------------|-----------------------------'
	
	'Index des colonnes de lvwSoumission
	Private Const I_COL_SOUM_QUANTITE As Short = 0
	Private Const I_COL_SOUM_PIECE As Short = 1
	Private Const I_COL_SOUM_DESCR As Short = 2
	Private Const I_COL_SOUM_MANUFACT As Short = 3
	Private Const I_COL_SOUM_PRIX_LIST As Short = 4
	Private Const I_COL_SOUM_ESCOMPTE As Short = 5
	Private Const I_COL_SOUM_PRIX_NET As Short = 6
	Private Const I_COL_SOUM_DISTRIB As Short = 7
	Private Const I_COL_SOUM_TEMPS As Short = 8
	Private Const I_COL_SOUM_MONTAGE As Short = 9
	Private Const I_COL_SOUM_TOTAL As Short = 10
	Private Const I_COL_SOUM_PROFIT As Short = 11
	Private Const I_COL_SOUM_COMMENTAIRE As Short = 12
	Private Const I_COL_SOUM_ID As Short = 13
	Private Const I_COL_SOUM_FACTURATION As Short = 14
	Private Const I_COL_SOUM_DATE_COMMANDE As Short = 15
	Private Const I_COL_SOUM_DATE_REQUISE As Short = 16
	Private Const I_COL_SOUM_NOM_COMMANDE As Short = 17
	Private Const I_COL_SOUM_NO_SEQUENTIEL As Short = 18
	Private Const I_COL_SOUM_PROVENANCE As Short = 19
	
	Private Const I_COL_SOUMISSION_PROV As Short = 13
	
	'Index des colonnes de lvwSoumission si les colonnes contenant
	'des prix ne sont pas là. (SP est pour Sans Prix)
	Private Const I_COL_SOUM_SP_QUANTITE As Short = 0
	Private Const I_COL_SOUM_SP_PIECE As Short = 1
	Private Const I_COL_SOUM_SP_DESCR As Short = 2
	Private Const I_COL_SOUM_SP_MANUFACT As Short = 3
	Private Const I_COL_SOUM_SP_DISTRIB As Short = 4
	Private Const I_COL_SOUM_SP_TEMPS As Short = 5
	Private Const I_COL_SOUM_SP_MONTAGE As Short = 6
	Private Const I_COL_SOUM_SP_COMMENTAIRE As Short = 7
	Private Const I_COL_SOUM_SP_ID As Short = 8
	Private Const I_COL_SOUM_SP_DATE_COMMANDE As Short = 9
	Private Const I_COL_SOUM_SP_DATE_REQUISE As Short = 10
	Private Const I_COL_SOUM_SP_NOM_COMMANDE As Short = 11
	Private Const I_COL_SOUM_SP_NO_SEQUENTIEL As Short = 12
	Private Const I_COL_SOUM_SP_PROVENANCE As Short = 13
	
	Private Const I_COL_SOUMISSION_SP_PROV As Short = 8
	
	'Index des colonnes de lvwPieces
	Private Const I_COL_PIECES_PIECE_GRB As Short = 0
	Private Const I_COL_PIECES_NO_ITEM As Short = 1
	Private Const I_COL_PIECES_MANUFACT As Short = 2
	Private Const I_COL_PIECES_DESCR_FR As Short = 3
	Private Const I_COL_PIECES_DESCR_EN As Short = 4
	
	'Index des colonnes de lvwPieceTrouve
	Private Const I_COL_RECH_PIECE_GRB As Short = 0
	Private Const I_COL_RECH_NO_ITEM As Short = 1
	Private Const I_COL_RECH_CATEGORIE As Short = 2
	Private Const I_COL_RECH_MANUFACT As Short = 3
	Private Const I_COL_RECH_DESCR_FR As Short = 4
	Private Const I_COL_RECH_DESCR_EN As Short = 5
	
	'Index des colonnes de lvwFournisseur
	Private Const I_COL_FRS_FRS As Short = 0
	Private Const I_COL_FRS_PERS_RESS As Short = 1
	Private Const I_COL_FRS_DATE As Short = 2
	Private Const I_COL_FRS_ENTRER_PAR As Short = 3
	Private Const I_COL_FRS_VALIDE As Short = 4
	Private Const I_COL_FRS_PRIX_LIST As Short = 5
	Private Const I_COL_FRS_ESCOMPTE As Short = 6
	Private Const I_COL_FRS_PRIX_NET As Short = 7
	Private Const I_COL_FRS_PRIX_SP As Short = 8
	Private Const I_COL_FRS_QUOTER As Short = 9
	Private Const I_COL_FRS_STOCK As Short = 10
	
	'Index des colonnes de lvwModification
	Private Const I_COL_MODIF_EMPLOYE As Short = 0
	Private Const I_COL_MODIF_DATE As Short = 1
	Private Const I_COL_MODIF_HEURE As Short = 2
	Private Const I_COL_MODIF_MONTANT As Short = 3
	
	'Index des colonnes de lvwBavard
	Private Const I_COL_SUPP_EMPLOYE As Short = 0
	Private Const I_COL_SUPP_DATE As Short = 1
	Private Const I_COL_SUPP_HEURE As Short = 2
	Private Const I_COL_SUPP_QTE As Short = 3
	Private Const I_COL_SUPP_NO_ITEM As Short = 4
	
	'Index des transports
	Private Const I_TRANS_FAB_GRANBY As Short = 0
	Private Const I_TRANS_CLIENT As Short = 1
	
	'Index de m_collFloorStock
	Private Const I_IDX_FS_DIX_MOINS As Short = 1
	Private Const I_IDX_FS_DIX As Short = 2
	Private Const I_IDX_FS_QUINZE As Short = 3
	Private Const I_IDX_FS_VINGT As Short = 4
	Private Const I_IDX_FS_VINGT_CINQ As Short = 5
	Private Const I_IDX_FS_CINQUANTE As Short = 6
	Private Const I_IDX_FS_CENT As Short = 7
	
	'Index de cmbChoix
	Private Const I_IDX_SOUMISSION As Short = 0
	Private Const I_IDX_PROJET As Short = 1
	
	'Index de cmbOuvertFerme
	Private Const I_CMB_OUVERT As Short = 0
	Private Const I_CMB_TOUS As Short = 1
	
	'Index de cmbTri
	Private Const I_CMB_PIECE_GRB As Short = 0
	Private Const I_CMB_PIECE As Short = 1
	Private Const I_CMB_FABRICANT As Short = 2
	Private Const I_CMB_DESCR_FR As Short = 3
	Private Const I_CMB_DESCR_EN As Short = 4
	
	'Constante s'il n'y a pas de sous-sections
	Private Const S_PAS_SOUS_SECTION As String = "PAS DE SOUS-SECTION"
	
	'Valeur servant au resize du lvwSoumission si le form est agrandi
	Private Const I_TOP_AFFICHAGE As Short = 3000
	Private Const I_HEIGHT_AFFICHAGE As Short = 3930
	
	'Énumeration servant à savoir si c'est l'affichage des soumissions ou des projets
	Private Enum enumType
		TYPE_PROJET = 0
		TYPE_SOUMISSION = 1
	End Enum
	
	'Énumération servant à savoir si le form est en mode modif/ajout ou en mode
	'inactif (affichage seulement)
	Private Enum enumMode
		MODE_AJOUT_MODIF = 0
		MODE_INACTIF = 1
	End Enum
	
	'Énumération servant à savoir si le form est en anglais ou en francais
	Private Enum enumLangage
		FRANCAIS = 0
		ANGLAIS = 1
	End Enum
	
	Private Structure tyCopiePiece
		Dim bChecked As Boolean
		Dim sQuantite As String
		Dim sPiece As String
		Dim sDescr As String
		Dim sManufact As String
		Dim sPrixList As String
		Dim sEscompte As String
		Dim sPrixNet As String
		Dim sFRS As String
		Dim sTemps As String
		Dim sMontage As String
		Dim sTotal As String
		Dim sProfit As String
		Dim sDescrTag As String
		Dim sPrixListTag As String
		Dim sFRSTag As String
		Dim lColor As Integer
	End Structure
	
	'Variables pour la configurations
	Private m_sProfit As String
	Private m_sCommission As String
	Private m_sImprevue As String
	
	'Pour la recherche de pièce dans lvwPieces
	Private m_sTri As String
	
	'Pour savoir quelle colonne trier
	Private m_iCol As Short
	
	'Pour savoir si le form a déjà été sur l'événement resize
	Private m_bResize As Boolean
	
	'Modes du form
	Private m_bModeAjout As Boolean
	Private m_bModeAffichage As Boolean
	
	'Pour avoir une sous-section par défaut
	Private m_sSousSection As String
	
	'Pour savoir si le form affiche les projets ou les soumissions
	Private m_eType As enumType
	
	'Pour savoir si les prix sont cachés ou non
	Public m_bDroitPrix As Boolean
	
	'Pour ne pas être obligé d'ouvrir le recordset à chaque fois
	Private m_bModifProj As Boolean
	Private m_bModifSoum As Boolean
	Private m_bModifBonCommande As Boolean
	
	'Variable pour savoir si l'utilisateur a le droit de voir le combo ou non
	Private m_bComboChoix As Boolean
	
	Private m_eMode As enumMode
	
	Private m_eLangage As enumLangage
	
	'Pour faire afficher le dernier enregitrement visionné après un ajout ou une
	'modification
	Private m_sAncienProjSoum As String
	
	Private m_bSupprimer As Boolean
	
	'Pour savoir si il faut calculer le temps mécanique ou non
	Public m_bSansTemps As Boolean
	
	'Pour savoir si le lvwFournisseur est affiché après marchandise non utilisée
	Private m_bPieceInutile As Boolean
	
	Public m_bAnnulerChemin As Boolean
	Public m_sChemin As String
	
	Private m_bRecherchePiece As Boolean
	
	'Pour savoir si le changement de prix a été appelé à partir du bouton "Mauvais Prix"
	Private m_bMauvaisPrix As Boolean
	Private m_bEnregistrement As Boolean
	Private m_collDateSupp As Collection
	Private m_collHeureSupp As Collection
	Private m_collQteSupp As Collection
	Private m_collNoItemSupp As Collection
	Private m_bChangementFRS As Boolean
	
	Public m_sTempsDessin As String
	Public m_sTempsFabrication As String
	Public m_sTempsAssemblage As String
	Public m_sTempsProgInterface As String
	Public m_sTempsProgAutomate As String
	Public m_sTempsProgRobot As String
	Public m_sTempsVision As String
	Public m_sTempsTest As String
	Public m_sTempsInstallation As String
	Public m_sTempsMiseService As String
	Public m_sTempsFormation As String
	Public m_sTempsGestion As String
	Public m_sTempsShipping As String
	
	Public m_sNbrePersonne As String
	Public m_sTempsHebergement As String
	Public m_sTempsRepas As String
	Public m_sTempsTransport As String
	Public m_sTempsUniteMobile As String
	Public m_sPrixEmballage As String
	
	Public m_sTauxHebergement1 As String
	Public m_sTauxHebergement2 As String
	Public m_sTauxRepas As String
	Public m_sTauxTransport As String
	Public m_sTauxUniteMobile As String
	
	Public m_sTauxDessin As String
	Public m_sTauxFabrication As String
	Public m_sTauxAssemblage As String
	Public m_sTauxProgInterface As String
	Public m_sTauxProgAutomate As String
	Public m_sTauxProgRobot As String
	Public m_sTauxVision As String
	Public m_sTauxTest As String
	Public m_sTauxInstallation As String
	Public m_sTauxMiseService As String
	Public m_sTauxFormation As String
	Public m_sTauxGestion As String
	Public m_sTauxShipping As String
	
	Public m_bTempsDejaOuvert As Boolean
	
	Private m_sTexteRecherche As String
	Private m_arr_tyCopie() As tyCopiePiece
	Private m_iNbreCopie As Short
	Public m_bModifFournisseurBC As Boolean
	Private m_sLiaison As String
	Private m_bExtra As Boolean
	Private m_bMonthViewHasFocus As Boolean
	Public m_bTransfertJobCancel As Boolean
	Private m_bChangementChoix As Boolean 'Pour empêcher l'événement cmbOuvertFerme_Click quand cmbChoix change
	Public m_bValide As Boolean 'Résultat de frmValiderSuppression
	
	
	Public intdummie As Short 'va servir à annuler l'impression des rapports dans la sub ImprimerProjSoum
	Public bTrigger As Boolean
	
	'**********************************************************************************************************
	'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
	'**********************************************************************************************************
	Public bFlag As Boolean 'pour garder en mémoire si on désir achiffer les dates de réception et de commande
	'**********************************************************************************************************
	
	Public Function PeutFermer() As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If m_eMode = enumMode.MODE_INACTIF Then
15: PeutFermer = True
20: Else
25: PeutFermer = False
30: End If
		
35: Exit Function
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "PeutFermer", Err, Erl())
	End Function
	
	Private Sub InitialiserVariables(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Initialisation des variables comprises dans la configuration
10: Dim rstConfig As ADODB.Recordset
15: Dim rstProjSoum As ADODB.Recordset
		
20: rstProjSoum = New ADODB.Recordset
		
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
		
50: If Not rstProjSoum.EOF Then
55: m_sProfit = rstProjSoum.Fields("Profit").Value
60: m_sCommission = rstProjSoum.Fields("Commission").Value
65: m_sImprevue = rstProjSoum.Fields("Imprevue").Value
70: Else
75: rstConfig = New ADODB.Recordset
			
80: Call rstConfig.Open("SELECT * FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
85: m_sProfit = rstConfig.Fields("ProfitElec").Value
90: m_sCommission = rstConfig.Fields("Commission").Value
95: m_sImprevue = rstConfig.Fields("Imprévus").Value
			
100: Call rstConfig.Close()
105: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstConfig = Nothing
110: End If
		
115: Call rstProjSoum.Close()
120: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
125: Exit Sub
		
AfficherErreur: 
		
130: Call AfficherErreur("frmProjSoumElec", "InitialiserVariables", Err, Erl())
	End Sub
	
	Private Sub ActiverBoutonsGroupe()
		
5: On Error GoTo AfficherErreur
		
		'Activation des boutons d'après le groupe
10: Dim bModif As Boolean
		
		'Si l'utilisateur a le droit d'affichage sur les projets et les soumissions
15: If g_bAffichageProjetsElec = True And g_bAffichageSoumissionsElec = True Then
			'On affiche cmbChoix
20: cmbChoix.Visible = True
			
			'Cette variable sert à savoir si l'utilisateur a le droit de voir le combo
25: m_bComboChoix = True
			
			'Type d'affichage
30: m_eType = enumType.TYPE_PROJET
			
			'Champs pour la modification
35: bModif = g_bModificationProjetsElec
40: Else
			'On cache cmbChoix
45: cmbChoix.Visible = False
			
			'Cette variable sert à savoir si l'utilisateur a le droit de voir le combo
50: m_bComboChoix = False
			
			'Si l'utilisateur a le droit d'affichage sur les projets
55: If g_bAffichageProjetsElec = True Then
				'Le seul choix possible est Projet
60: txtChoix.Text = "Projet"
				
				'Le type d'affichage
65: m_eType = enumType.TYPE_PROJET
				
				'Champs pour la modification
70: bModif = g_bModificationProjetsElec
75: Else
				'Le seul choix possible est Soumission
80: txtChoix.Text = "Soumission"
				
				'Type d'affichage
85: m_eType = enumType.TYPE_SOUMISSION
				
				'Champs pour la modification
90: bModif = g_bModificationSoumissionsElec
95: End If
100: End If
		
105: m_bModifProj = g_bModificationProjetsElec
110: m_bModifSoum = g_bModificationSoumissionsElec
115: m_bModifBonCommande = g_bModificationBC
120: m_bSupprimer = g_bSuppressionProjets
		
125: Cmdajouter.Enabled = bModif
130: cmdsupprimer.Enabled = bModif
135: cmdModifier.Enabled = bModif
140: cmdCopier.Enabled = bModif
145: cmdCreerProjet.Enabled = bModif
150: cmdBonCommande.Enabled = m_bModifBonCommande
155: cmdImprimer.Enabled = bModif
160: cmdDemande.Enabled = bModif
165: cmdAnglaisFrancais.Enabled = bModif
170: cmdExtra.Enabled = bModif
175: cmdSupprimerFRS.Visible = g_bModificationCatalogueElec
180: cmdRetour.Enabled = g_bModificationRetourMarchandise
185: cmdReception.Enabled = g_bModificationReception
		
190: Exit Sub
		
AfficherErreur: 
		
195: Call AfficherErreur("frmProjSoumElec", "ActiverBoutonsGroupe", Err, Erl())
	End Sub
	
	Private Sub AfficherProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
10: m_bPieceInutile = False
15: m_bChangementFRS = False
20: m_bRecherchePiece = False
		
		'Remet en mode affichage le projet ou la soumission voulue
25: m_bModeAffichage = True
		
		'Vide les champs
30: Call ViderChamps()
		
		'Rempli le combo
35: Call RemplirComboProjSoum(sNoProjSoum)
		
		'Barre les champs
40: Call BarrerChamps(True)
		
45: lvwSoumission.Top = VB6.TwipsToPixelsY(I_TOP_AFFICHAGE)
50: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - I_HEIGHT_AFFICHAGE)
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumElec", "AfficherProjSoum", Err, Erl())
	End Sub
	
	Private Sub AfficherControles(ByVal eMode As enumMode)
		
5: On Error GoTo AfficherErreur
		
		'Affichage des boutons selon si c'est un ajout/modif ou un affichage
10: Dim bAjouter As Boolean
15: Dim bModifier As Boolean
20: Dim bSupprimer As Boolean
25: Dim bEnregistrer As Boolean
30: Dim bAnnuler As Boolean
35: Dim bFermer As Boolean
40: Dim bImprimer As Boolean
45: Dim bCmbClient As Boolean
50: Dim bCmbContact As Boolean
55: Dim bCmbProjSoum As Boolean
60: Dim bCmbTransport As Boolean
65: Dim bCmbChoix As Boolean
70: Dim bCmbOuvertFerme As Boolean
75: Dim bSection As Boolean
80: Dim bPieces As Boolean
85: Dim bDate As Boolean
90: Dim bTexte As Boolean
95: Dim bCreerProjet As Boolean
100: Dim bHistorique As Boolean
105: Dim bCopier As Boolean
110: Dim bBonCommande As Boolean
115: Dim bTri As Boolean
120: Dim bDemande As Boolean
125: Dim bExtra As Boolean
130: Dim bCatalogue As Boolean
135: Dim bBrowseChemin As Boolean
140: Dim bInutile As Boolean
145: Dim bMauvaisPrix As Boolean
150: Dim bRapportFact As Boolean
155: Dim bDateFacture As Boolean
160: Dim bSortiMagasin As Boolean
165: Dim bRetour As Boolean
170: Dim bForfait As Boolean
175: Dim bExporter As Boolean
180: Dim bReception As Boolean
185: Dim bAnglaisFrancais As Boolean
190: Dim bRechercheClient As Boolean
		
195: m_eMode = eMode
		
200: Select Case eMode
			Case enumMode.MODE_AJOUT_MODIF
205: bEnregistrer = True
210: bAnnuler = True
				
215: bSection = True
220: bPieces = True
225: bTexte = True
230: bTri = True
				
235: If (m_eType = enumType.TYPE_SOUMISSION) Or (m_eType = enumType.TYPE_PROJET And Mid(txtNoProjSoum.Text, 3, 1) <> "3") Then
240: bCmbClient = True
245: bCmbContact = True
250: bRechercheClient = True
255: End If
				
260: bCmbTransport = True
265: bDate = True
270: bCatalogue = True
275: bBrowseChemin = True
280: bMauvaisPrix = True
285: bForfait = True
				
290: If m_eType = enumType.TYPE_PROJET Then
295: bInutile = True
					
300: If g_bModificationReception = True Then
305: bSortiMagasin = True
310: End If
					
315: If g_bModificationFacturation = True Then
320: bDateFacture = True
325: End If
330: End If
				
335: Case enumMode.MODE_INACTIF
340: bModifier = True
345: bFermer = True
350: bImprimer = True
355: bCmbProjSoum = True
360: bCmbChoix = True
365: bCmbOuvertFerme = True
370: bHistorique = True
375: bDemande = True
380: bExporter = True
385: bAnglaisFrancais = True
390: bAjouter = True
				
395: If m_eType = enumType.TYPE_PROJET Then
400: bBonCommande = True
405: bExtra = True
					
410: If g_bModificationRetourMarchandise = True Then
415: bRetour = True
420: End If
					
425: If g_bModificationFacturation = True Then
430: bRapportFact = True
435: End If
					
440: If g_bModificationReception = True Then
445: bReception = True
450: End If
					
455: If m_bSupprimer = True Then
460: bSupprimer = True
465: End If
470: Else
475: bSupprimer = True
480: bCopier = True
					
485: If VerifierSiDejaProjet = False Then
490: bCreerProjet = True
495: End If
500: End If
505: End Select
		
510: Cmdajouter.Visible = bAjouter
515: cmdModifier.Visible = bModifier
520: cmdsupprimer.Visible = bSupprimer
525: cmdEnregistrer.Visible = bEnregistrer
530: cmdAnnuler.Visible = bAnnuler
535: Cmdfermer.Visible = bFermer
540: cmdImprimer.Visible = bImprimer
545: cmdRapportFACT.Visible = bRapportFact
550: cmdDate.Visible = bDate
555: cmdTexte.Visible = bTexte
560: cmdHistorique.Visible = bHistorique
565: cmdCopier.Visible = bCopier
570: cmdBonCommande.Visible = bBonCommande
575: cmdCreerProjet.Visible = bCreerProjet
580: cmdDemande.Visible = bDemande
585: cmdExtra.Visible = bExtra
590: cmdCatalogue.Visible = bCatalogue
595: cmdBrowse.Visible = bBrowseChemin
600: cmdMaterielInutile.Visible = bInutile
605: cmdMauvaisPrix.Visible = bMauvaisPrix
610: cmdSortieMagasin.Visible = bSortiMagasin
615: cmdRetour.Visible = bRetour
620: cmdForfait.Visible = bForfait
625: cmdEffacerForfait.Visible = bForfait
630: cmdExport.Visible = bExporter
635: cmdReception.Visible = bReception
640: cmdAnglaisFrancais.Visible = bAnglaisFrancais
		
645: lblDateFacturation.Visible = bDateFacture
650: txtDateFacturation.Visible = bDateFacture
655: cmdDateFacturation.Visible = bDateFacture
		
660: cmbclient.Visible = bCmbClient
665: txtClient.Visible = Not bCmbClient
		
670: cmbContact.Visible = bCmbContact
675: txtcontact.Visible = Not bCmbContact
		
680: cmbtransport.Visible = bCmbTransport
685: txtTransport.Visible = Not bCmbTransport
		
		'Si on a le droit d'afficher le combo
690: If m_bComboChoix = True Then
695: cmbChoix.Visible = bCmbChoix
700: txtChoix.Visible = Not bCmbChoix
705: End If
		
710: cmbOuvertFerme.Visible = bCmbOuvertFerme
		
715: cmbProjSoum.Visible = bCmbProjSoum
720: txtNoProjSoum.Visible = Not bCmbProjSoum
		
725: lblSections.Visible = bSection
730: cmbSections.Visible = bSection
735: cmdAjouterSection.Visible = bSection
		
740: lblPiece.Visible = bPieces
745: cmbPieces.Visible = bPieces
750: lvwPieces.Visible = bPieces
		
755: lblTri.Visible = bTri
760: cmbTri.Visible = bTri
765: cmdTri.Visible = bTri
770: cmdRafraichir.Visible = bTri
		
775: fraPrix.Visible = m_bDroitPrix
		
780: cmdRechercherClient.Visible = bRechercheClient
		
785: Exit Sub
		
AfficherErreur: 
		
790: Call AfficherErreur("frmProjSoumElec", "AfficherControles", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbChoix.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbChoix_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbChoix.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
10: Dim bModif As Boolean
15: Dim iCmbOuvertFerme As Short
		
20: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
25: txtChoix.Text = cmbChoix.Text
		
		'Mets les CheckBoxes sur le ListView
30: lvwSoumission.CheckBoxes = True
		
35: If cmbChoix.SelectedIndex = I_IDX_SOUMISSION Then
			'Change le type
40: m_eType = enumType.TYPE_SOUMISSION
			
45: m_bChangementChoix = True
			
50: iCmbOuvertFerme = cmbOuvertFerme.SelectedIndex
			
55: Call cmbOuvertFerme.Items.Clear()
			
60: Call cmbOuvertFerme.Items.Add("Ouvertes")
65: Call cmbOuvertFerme.Items.Add("Toutes")
			
70: cmbOuvertFerme.SelectedIndex = iCmbOuvertFerme
			
75: m_bChangementChoix = False
			
80: bModif = m_bModifSoum
			
			'Cache la soumission
85: lblNoSoumission.Visible = False
90: txtNoSoumission.Visible = False
			
			'Cache Prix Réception
95: lblPrixReception.Visible = False
100: txtPrixReception.Visible = False
			
			'Cache Prix Soumission
105: lblPrixSoumission.Visible = False
110: txtPrixSoumission.Visible = False
115: Else
			'Change le type
120: m_eType = enumType.TYPE_PROJET
			
125: m_bChangementChoix = True
			
130: iCmbOuvertFerme = cmbOuvertFerme.SelectedIndex
			
135: Call cmbOuvertFerme.Items.Clear()
			
140: Call cmbOuvertFerme.Items.Add("Ouverts")
145: Call cmbOuvertFerme.Items.Add("Tous")
			
150: cmbOuvertFerme.SelectedIndex = iCmbOuvertFerme
			
155: m_bChangementChoix = False
			
160: bModif = m_bModifProj
			
			'Affiche la soumission
165: lblNoSoumission.Visible = True
170: txtNoSoumission.Visible = True
			
			'Affiche Prix Réception
175: lblPrixReception.Visible = True
180: txtPrixReception.Visible = True
			
			'Affiche Prix Soumission
185: lblPrixSoumission.Visible = True
190: txtPrixSoumission.Visible = True
			
195: txtDateFacturation.Text = ConvertDate(Today)
200: End If
		
		'Active ou désactive les boutons de modification selon
		'le groupe auquel l'utilisateur appartient
205: cmdModifier.Enabled = bModif
210: cmdsupprimer.Enabled = bModif
215: Cmdajouter.Enabled = bModif
220: cmdCopier.Enabled = bModif
225: cmdCreerProjet.Enabled = bModif
230: cmdBonCommande.Enabled = m_bModifBonCommande
235: cmdImprimer.Enabled = bModif
240: cmdAnglaisFrancais.Enabled = bModif
245: cmdDemande.Enabled = bModif
250: cmdExtra.Enabled = bModif
		
		'Ajoute les colonnes selon le groupe
255: Call RemplirColonnes()
		
260: m_bModeAffichage = True
		
		'Vide les champs
265: Call ViderChamps()
		
		'Barre les champs
270: Call BarrerChamps(True)
		
		'Rempli le combo
275: Call RemplirComboProjSoum(vbNullString)
		
		'Affiche les controles pour le mode inactif
280: Call AfficherControles(enumMode.MODE_INACTIF)
		
285: Call PositionnerBoutons()
		
290: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
295: Exit Sub
		
AfficherErreur: 
		
300: Call AfficherErreur("frmProjSoumElec", "cmbChoix_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbclient.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbclient_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbclient.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
		'Rempli le combo des contacts selon le client choisi
10: Call RemplirComboContacts()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmbclient_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbOuvertFerme.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbOuvertFerme_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbOuvertFerme.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
10: If cmbChoix.SelectedIndex <> -1 Then
15: If m_bChangementChoix = False Then
20: Call RemplirComboProjSoum("")
25: End If
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("FrmProjSoumElec", "cmbOuvertFerme_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbPieces.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbPieces_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbPieces.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
		'Rempli lvwPieces selon la catégorie de pièce choisie
10: Call RemplirListViewPieces()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmbPieces_Click", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event cmbProjSoum.SelectedIndexChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub cmbProjSoum_SelectedIndexChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmbProjSoum.SelectedIndexChanged
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstOuvert As ADODB.Recordset
20: Dim iCompteur As Short
25: Dim sNomClient As String
30: Dim sNomContact As String
35: Dim sNumero As String
40: Dim sTransport As String
45: Dim bTrouve As Boolean
		
50: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
55: m_bRecherchePiece = False
60: m_bChangementFRS = False
65: m_bPieceInutile = False
		
70: If cmbProjSoum.Text <> "" Then
75: sNumero = txtNoProjSoum.Text
			
80: txtNoProjSoum.Text = cmbProjSoum.Text
			
85: Call InitialiserVariables(txtNoProjSoum.Text)
			
90: If m_bEnregistrement = False Then
95: m_eLangage = enumLangage.FRANCAIS
				
100: cmdAnglaisFrancais.Text = "Anglais"
105: End If
			
110: rstProjSoum = New ADODB.Recordset
			
115: If m_eType = enumType.TYPE_SOUMISSION Then
120: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
125: Else
130: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
135: End If
			
140: If rstProjSoum.Fields("Modification").Value = True And rstProjSoum.Fields("Par").Value = g_sEmploye Then
145: cmdReset.Visible = True
150: End If
			
155: Call InitialiserTempsTaux(False)
			
160: If m_eType = enumType.TYPE_SOUMISSION Then
				'Si la soumission n'est pas assigné à un projet
165: If VerifierSiDejaProjet = False Then
					'On affiche le bouton cmdCreerProjet
170: cmdCreerProjet.Visible = True
175: Else
180: cmdCreerProjet.Visible = False
185: End If
190: End If
			
			'Rempli les valeurs de la soumission ou du projet sélectionné
195: Call RemplirProjSoum()
			
			'Le temps calculé dans le projet est le temps réel, c'est pourquoi il faut le recalculer
			'puisque le temps varie souvent
200: If m_eType = enumType.TYPE_PROJET Then
205: rstOuvert = New ADODB.Recordset
				
210: Call rstOuvert.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
215: If rstOuvert.Fields("Ouvert").Value = True Then
220: m_bModeAffichage = False
					
225: Call CalculerPrix()
					
230: m_bModeAffichage = True
					
235: rstProjSoum.Fields("total_Commission").Value = txtCommission.Text
240: rstProjSoum.Fields("Total_Profit").Value = txtProfit.Text
245: rstProjSoum.Fields("PrixTotal").Value = txtPrixTotal.Text
250: rstProjSoum.Fields("Total_piece").Value = txtTotalPieces.Text
255: rstProjSoum.Fields("total_imprevue").Value = txtImprevus.Text
260: rstProjSoum.Fields("Total_Temps").Value = txtTotalTemps.Text
					
265: Call rstProjSoum.Update()
270: End If
275: End If
			
280: Call rstProjSoum.Close()
			
285: sNomClient = txtClient.Text
290: sNomContact = txtcontact.Text
295: sTransport = txtTransport.Text
			
			'Pour choisir le bon client dans le combo des clients
300: For iCompteur = 0 To cmbclient.Items.Count - 1
305: If VB6.GetItemString(cmbclient, iCompteur) = sNomClient Then
310: cmbclient.SelectedIndex = iCompteur
					
315: bTrouve = True
					
320: Exit For
325: End If
330: Next 
			
335: If bTrouve = False Then
340: Call RemplirComboClients(vbNullString)
				
345: For iCompteur = 0 To cmbclient.Items.Count - 1
350: If VB6.GetItemString(cmbclient, iCompteur) = sNomClient Then
355: cmbclient.SelectedIndex = iCompteur
						
360: Exit For
365: End If
370: Next 
375: End If
			
			'Pour choisir le bon contact dans le combo des contacts
380: For iCompteur = 0 To cmbContact.Items.Count - 1
385: If VB6.GetItemString(cmbContact, iCompteur) = sNomContact Then
390: cmbContact.SelectedIndex = iCompteur
					
395: Exit For
400: End If
405: Next 
			
			'Pour choisir le bon transport dans le combo des transports
410: For iCompteur = 0 To cmbtransport.Items.Count - 1
415: If VB6.GetItemString(cmbtransport, iCompteur) = sTransport Then
420: cmbtransport.SelectedIndex = iCompteur
					
425: Exit For
430: End If
435: Next 
440: End If
		
445: Call CalculerPrixReception()
		
450: If m_eType = enumType.TYPE_PROJET Then
455: rstProjSoum.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
460: Call rstProjSoum.Open("SELECT PrixRéception FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
465: rstProjSoum.Fields("PrixRéception").Value = txtPrixReception.Text
			
470: Call rstProjSoum.Update()
			
475: Call rstProjSoum.Close()
480: End If
		
485: If m_bSansTemps = True Then
490: tmrTemps.Enabled = True
495: Else
500: tmrTemps.Enabled = False
505: lblPasTemps.Visible = False
510: End If
		
515: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
520: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
525: Exit Sub
		
AfficherErreur: 
		
530: Call AfficherErreur("frmProjSoumElec", "cmbProjSoum_Click", Err, Erl(), txtNoProjSoum.Text)
	End Sub
	
	Private Sub InitialiserTempsTaux(ByVal bEmpty As Boolean)
		
5: On Error GoTo AfficherErreur
		
		'Pour initialiser les temps et les taux horaires
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sTable As String
20: Dim sChamps As String
		
25: m_bTempsDejaOuvert = False
		
30: If bEmpty = True Then
35: m_sTempsDessin = "0"
40: m_sTempsFabrication = "0"
45: m_sTempsAssemblage = "0"
50: m_sTempsProgInterface = "0"
55: m_sTempsProgAutomate = "0"
60: m_sTempsProgRobot = "0"
65: m_sTempsVision = "0"
70: m_sTempsTest = "0"
75: m_sTempsInstallation = "0"
80: m_sTempsMiseService = "0"
85: m_sTempsFormation = "0"
90: m_sTempsGestion = "0"
95: m_sTempsShipping = "0"
			
100: m_sNbrePersonne = "0"
105: m_sTempsHebergement = "0"
110: m_sTempsRepas = "0"
115: m_sTempsTransport = "0"
120: m_sTempsUniteMobile = "0"
125: m_sPrixEmballage = "0"
130: m_sTauxHebergement1 = "0"
135: m_sTauxHebergement2 = "0"
140: m_sTauxRepas = "0"
145: m_sTauxTransport = "0"
150: m_sTauxUniteMobile = "0"
			
155: m_sTauxDessin = "0"
160: m_sTauxFabrication = "0"
165: m_sTauxAssemblage = "0"
170: m_sTauxProgInterface = "0"
175: m_sTauxProgAutomate = "0"
180: m_sTauxProgRobot = "0"
185: m_sTauxVision = "0"
190: m_sTauxTest = "0"
195: m_sTauxInstallation = "0"
200: m_sTauxMiseService = "0"
205: m_sTauxFormation = "0"
210: m_sTauxGestion = "0"
215: m_sTauxShipping = "0"
220: Else
225: If m_eType = enumType.TYPE_PROJET Then
230: sTable = "GRB_ProjetElec"
235: sChamps = "IDProjet"
240: Else
245: sTable = "GRB_SoumissionElec"
250: sChamps = "IDSoumission"
255: End If
			
260: rstProjSoum = New ADODB.Recordset
			
265: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
270: If m_eType = enumType.TYPE_SOUMISSION Then
275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
280: m_sTempsDessin = rstProjSoum.Fields("TempsDessin").Value
285: Else
290: m_sTempsDessin = "0"
295: End If
				
300: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFabrication").Value) Then
305: m_sTempsFabrication = rstProjSoum.Fields("TempsFabrication").Value
310: Else
315: m_sTempsFabrication = "0"
320: End If
				
325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
330: m_sTempsAssemblage = rstProjSoum.Fields("TempsAssemblage").Value
335: Else
340: m_sTempsAssemblage = "0"
345: End If
				
350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsProgInterface").Value) Then
355: m_sTempsProgInterface = rstProjSoum.Fields("TempsProgInterface").Value
360: Else
365: m_sTempsProgInterface = "0"
370: End If
				
375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsProgAutomate").Value) Then
380: m_sTempsProgAutomate = rstProjSoum.Fields("TempsProgAutomate").Value
385: Else
390: m_sTempsProgAutomate = "0"
395: End If
				
400: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsProgRobot").Value) Then
405: m_sTempsProgRobot = rstProjSoum.Fields("TempsProgRobot").Value
410: Else
415: m_sTempsProgRobot = "0"
420: End If
				
425: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsVision").Value) Then
430: m_sTempsVision = rstProjSoum.Fields("TempsVision").Value
435: Else
440: m_sTempsVision = "0"
445: End If
				
450: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
455: m_sTempsTest = rstProjSoum.Fields("TempsTest").Value
460: Else
465: m_sTempsTest = "0"
470: End If
				
475: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
480: m_sTempsInstallation = rstProjSoum.Fields("TempsInstallation").Value
485: Else
490: m_sTempsInstallation = "0"
495: End If
				
500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMiseService").Value) Then
505: m_sTempsMiseService = rstProjSoum.Fields("TempsMiseService").Value
510: Else
515: m_sTempsMiseService = "0"
520: End If
				
525: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
530: m_sTempsFormation = rstProjSoum.Fields("TempsFormation").Value
535: Else
540: m_sTempsFormation = "0"
545: End If
				
550: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
555: m_sTempsGestion = rstProjSoum.Fields("TempsGestion").Value
560: Else
565: m_sTempsGestion = "0"
570: End If
				
575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
580: m_sTempsShipping = rstProjSoum.Fields("TempsShipping").Value
585: Else
590: m_sTempsShipping = "0"
595: End If
600: Else
605: Call InitialiserTempsReel()
610: End If
			
615: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
620: m_sTauxDessin = rstProjSoum.Fields("TauxDessin").Value
625: Else
630: m_sTauxDessin = "0"
635: End If
			
640: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFabrication").Value) Then
645: m_sTauxFabrication = rstProjSoum.Fields("TauxFabrication").Value
650: Else
655: m_sTauxFabrication = "0"
660: End If
			
665: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
670: m_sTauxAssemblage = rstProjSoum.Fields("TauxAssemblage").Value
675: Else
680: m_sTauxAssemblage = "0"
685: End If
			
690: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxProgInterface").Value) Then
695: m_sTauxProgInterface = rstProjSoum.Fields("TauxProgInterface").Value
700: Else
705: m_sTauxProgInterface = "0"
710: End If
			
715: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxProgAutomate").Value) Then
720: m_sTauxProgAutomate = rstProjSoum.Fields("TauxProgAutomate").Value
725: Else
730: m_sTauxProgAutomate = "0"
735: End If
			
740: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxProgRobot").Value) Then
745: m_sTauxProgRobot = rstProjSoum.Fields("TauxProgRobot").Value
750: Else
755: m_sTauxProgRobot = "0"
760: End If
			
765: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxVision").Value) Then
770: m_sTauxVision = rstProjSoum.Fields("TauxVision").Value
775: Else
780: m_sTauxVision = "0"
785: End If
			
790: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
795: m_sTauxTest = rstProjSoum.Fields("TauxTest").Value
800: Else
805: m_sTauxTest = "0"
810: End If
			
815: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
820: m_sTauxInstallation = rstProjSoum.Fields("TauxInstallation").Value
825: Else
830: m_sTauxInstallation = "0"
835: End If
			
840: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMiseService").Value) Then
845: m_sTauxMiseService = rstProjSoum.Fields("TauxMiseService").Value
850: Else
855: m_sTauxMiseService = "0"
860: End If
			
865: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
870: m_sTauxFormation = rstProjSoum.Fields("TauxFormation").Value
875: Else
880: m_sTauxFormation = "0"
885: End If
			
890: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
895: m_sTauxGestion = rstProjSoum.Fields("TauxGestion").Value
900: Else
905: m_sTauxGestion = "0"
910: End If
			
915: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
920: m_sTauxShipping = rstProjSoum.Fields("TauxShipping").Value
925: Else
930: m_sTauxShipping = "0"
935: End If
			
940: If m_eType = enumType.TYPE_PROJET Then
945: m_sNbrePersonne = "0"
950: m_sTempsHebergement = "0"
955: m_sTempsRepas = "0"
960: m_sTempsTransport = "0"
965: m_sTempsUniteMobile = "0"
970: Else
975: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
980: m_sNbrePersonne = rstProjSoum.Fields("NbrePersonne").Value
985: Else
990: m_sNbrePersonne = "0"
995: End If
				
1000: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
1005: m_sTempsHebergement = rstProjSoum.Fields("TempsHebergement").Value
1010: Else
1015: m_sTempsHebergement = "0"
1020: End If
				
1025: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
1030: m_sTempsRepas = rstProjSoum.Fields("TempsRepas").Value
1035: Else
1040: m_sTempsRepas = "0"
1045: End If
				
1050: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
1055: m_sTempsTransport = rstProjSoum.Fields("TempsTransport").Value
1060: Else
1065: m_sTempsTransport = "0"
1070: End If
				
1075: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
1080: m_sTempsUniteMobile = rstProjSoum.Fields("TempsUniteMobile").Value
1085: Else
1090: m_sTempsUniteMobile = "0"
1095: End If
1100: End If
			
1105: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("PrixEmballage").Value) Then
1110: m_sPrixEmballage = rstProjSoum.Fields("PrixEmballage").Value
1115: Else
1120: m_sPrixEmballage = "0"
1125: End If
			
1130: If m_eType = enumType.TYPE_PROJET Then
1135: m_sTauxHebergement1 = "0"
1140: m_sTauxHebergement2 = "0"
1145: m_sTauxRepas = "0"
1150: m_sTauxTransport = "0"
1155: m_sTauxUniteMobile = "0"
1160: Else
1165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
1170: m_sTauxHebergement1 = rstProjSoum.Fields("TauxHebergement1").Value
1175: Else
1180: m_sTauxHebergement1 = "0"
1185: End If
				
1190: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
1195: m_sTauxHebergement2 = rstProjSoum.Fields("TauxHebergement2").Value
1200: Else
1205: m_sTauxHebergement2 = "0"
1210: End If
				
1215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
1220: m_sTauxRepas = rstProjSoum.Fields("TauxRepas").Value
1225: Else
1230: m_sTauxRepas = "0"
1235: End If
				
1240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
1245: m_sTauxTransport = rstProjSoum.Fields("TauxTransport").Value
1250: Else
1255: m_sTauxTransport = "0"
1260: End If
				
1265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
1270: m_sTauxUniteMobile = rstProjSoum.Fields("TauxUniteMobile").Value
1275: Else
1280: m_sTauxUniteMobile = "0"
1285: End If
1290: End If
			
1295: Call rstProjSoum.Close()
1300: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
1305: End If
		
1310: Exit Sub
		
AfficherErreur: 
		
1315: Call AfficherErreur("frmProjSoumElec", "InitialiserTempsTaux", Err, Erl())
	End Sub
	
	Private Sub InitialiserTempsReel()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPunch As ADODB.Recordset
15: Dim sDateDebut As String
20: Dim sDateFin As String
25: Dim sTotal As String
30: Dim sFilterNoProjet As String
		
35: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
40: sFilterNoProjet = "LEFT(NoProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "'"
45: Else
50: sFilterNoProjet = "NoProjet = '" & txtNoProjSoum.Text & "'"
55: End If
		
60: sDateDebut = "TIMESERIAL(Left(GRB_Punch.HeureDébut,2),RIGHT(GRB_Punch.HeureDébut,2),0)"
		
65: sDateFin = "TIMESERIAL(Left(GRB_Punch.HeureFin,2),RIGHT(GRB_Punch.HeureFin,2),0)"
		
70: sTotal = "(SUM(" & sDateFin & " - " & sDateDebut & ")* 24) As Total"
		
75: rstPunch = New ADODB.Recordset
		
80: Call rstPunch.Open("SELECT Type, " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null GROUP BY Type", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
85: m_sTempsDessin = "0"
90: m_sTempsFabrication = "0"
95: m_sTempsAssemblage = "0"
100: m_sTempsProgInterface = "0"
105: m_sTempsProgAutomate = "0"
110: m_sTempsProgRobot = "0"
115: m_sTempsVision = "0"
120: m_sTempsTest = "0"
125: m_sTempsInstallation = "0"
130: m_sTempsMiseService = "0"
135: m_sTempsFormation = "0"
140: m_sTempsGestion = "0"
145: m_sTempsShipping = "0"
		
150: Do While Not rstPunch.EOF
155: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPunch.Fields("Total").Value) Then
160: Select Case rstPunch.Fields("Type").Value
					Case "Dessin" : m_sTempsDessin = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
165: Case "Fabrication" : m_sTempsFabrication = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
170: Case "Assemblage" : m_sTempsAssemblage = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
175: Case "ProgInterface" : m_sTempsProgInterface = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
180: Case "ProgAutomate" : m_sTempsProgAutomate = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
185: Case "ProgRobot" : m_sTempsProgRobot = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
190: Case "Vision" : m_sTempsVision = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
195: Case "Test" : m_sTempsTest = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
200: Case "Installation" : m_sTempsInstallation = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
205: Case "MiseService" : m_sTempsMiseService = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
210: Case "Formation" : m_sTempsFormation = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
215: Case "Gestion" : m_sTempsGestion = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
220: Case "Shipping" : m_sTempsShipping = CStr(System.Math.Round(rstPunch.Fields("Total").Value, 2))
225: End Select
230: End If
			
235: Call rstPunch.MoveNext()
240: Loop 
		
245: Call rstPunch.Close()
		
250: 'UPGRADE_NOTE: Object rstPunch may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPunch = Nothing
		
255: Exit Sub
		
AfficherErreur: 
		
260: Call AfficherErreur("frmProjSoumElecTemps", "AfficherTempsReels", Err, Erl())
	End Sub
	
	Private Sub cmbProjSoum_KeyUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles cmbProjSoum.KeyUp
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: For iCompteur = 0 To cmbProjSoum.Items.Count - 1
20: If UCase(VB6.GetItemString(cmbProjSoum, iCompteur)) = UCase(cmbProjSoum.Text) Then
25: cmbProjSoum.SelectedIndex = iCompteur
				
30: Exit For
35: End If
40: Next 
		
45: Exit Sub
		
AfficherErreur: 
		
50: Call AfficherErreur("frmProjSoumElec", "cmbProjSoum_KeyUp", Err, Erl())
	End Sub
	
	Private Sub cmdAjouterSection_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAjouterSection.Click
		
5: On Error GoTo AfficherErreur
		
		'Affiche le form frmSoumissionSection
10: Call OuvrirForm(frmSoumissionSectionElec, True)
		
		'Après que l'utilisateur a refermé le form, on rafraichi le
		'contenu du combo
15: Call RemplirComboSections()
		
20: Call UpdateOrdre()
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumElec", "cmdAjouterSection_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnglaisFrancais_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnglaisFrancais.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
15: If cmdAnglaisFrancais.Text = "Anglais" Then
20: m_eLangage = enumLangage.ANGLAIS
			
25: cmdAnglaisFrancais.Text = "Français"
30: Else
35: m_eLangage = enumLangage.FRANCAIS
			
40: cmdAnglaisFrancais.Text = "Anglais"
45: End If
		
50: Call UpdateDescription()
		
55: Call RemplirComboSections()
		
60: Call UpdateOrdre()
		
65: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
70: Exit Sub
		
AfficherErreur: 
		
75: Call AfficherErreur("frmProjSoumElec", "cmdAnglaisFrancais_Click", Err, Erl())
	End Sub
	
	Private Sub UpdateDescription()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstPieceElec As ADODB.Recordset
		
20: rstProjSoum = New ADODB.Recordset
25: rstPieceElec = New ADODB.Recordset
		
30: If m_eType = enumType.TYPE_PROJET Then
35: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
40: Else
45: Call rstProjSoum.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: End If
		
55: Do While Not rstProjSoum.EOF
60: Call rstPieceElec.Open("SELECT * FROM GRB_CatalogueElec WHERE PIECE = '" & rstProjSoum.Fields("NumItem").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: rstProjSoum.Fields("Desc_Fr").Value = rstPieceElec.Fields("DESC_FR").Value
70: rstProjSoum.Fields("Desc_En").Value = rstPieceElec.Fields("DESC_EN").Value
			
75: Call rstProjSoum.Update()
			
80: Call rstPieceElec.Close()
			
85: Call rstProjSoum.MoveNext()
90: Loop 
		
95: 'UPGRADE_NOTE: Object rstPieceElec may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceElec = Nothing
		
100: Call rstProjSoum.Close()
105: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
110: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
115: Exit Sub
		
AfficherErreur: 
		
120: Call AfficherErreur("frmProjSoumElec", "UpdateDescription", Err, Erl())
	End Sub
	
	Private Sub cmdAnnuler_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnuler.Click
		
5: On Error GoTo AfficherErreur
		
10: fraPieceTrouve.Visible = False
15: frafournisseur.Visible = False
20: fraCommentaire.Visible = False
25: fraDateRequise.Visible = False
		
30: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
35: Call OuvrirProjSoum(False)
		
		'Remet en mode inactif
40: Call AfficherControles(enumMode.MODE_INACTIF)
		
45: m_bEnregistrement = True
		
		'Affiche l'enregistrement qui était actif avant
50: Call AfficherProjSoum(m_sAncienProjSoum)
		
55: m_bEnregistrement = False
		
60: m_bModeAjout = False
		
65: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
70: Exit Sub
		
AfficherErreur: 
		
75: Call AfficherErreur("frmProjSoumElec", "cmdAnnuler_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerCommentaire_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerCommentaire.Click
		
5: On Error GoTo AfficherErreur
		
10: fraCommentaire.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmdAnnulerCommentaire_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerDateRequise_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerDateRequise.Click
		
5: On Error GoTo AfficherErreur
		
10: fraDateRequise.Visible = False
		
15: m_bMonthViewHasFocus = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "cmdAnnulerDateRequise_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerDateRequise_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles cmdAnnulerDateRequise.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.PixelsToTwipsX(eventArgs.X)
		Dim Y As Single = VB6.PixelsToTwipsY(eventArgs.Y)
		
5: On Error GoTo AfficherErreur
		
10: If m_bMonthViewHasFocus = True Then
15: Call cmdAnnulerDateRequise_Click(cmdAnnulerDateRequise, New System.EventArgs())
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumElec", "cmdAnnulerDateRequise_MouseUp", Err, Erl())
	End Sub
	
	Private Sub cmdExport_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdExport.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
		
15: rstProjSoum = New ADODB.Recordset
		
20: Call g_connData.Execute("DELETE * FROM GRB_impression_listepiece")
		
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
		
50: Call ExporterListePieces(rstProjSoum)
		
55: Call rstProjSoum.Close()
60: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumElec", "cmdExport_Click", Err, Erl())
	End Sub
	
	Private Sub ExporterListePieces(ByVal rstProjSoum As ADODB.Recordset)
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de la liste des pièces
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpListePiece As ADODB.Recordset
25: Dim iCompteurPiece As Short
30: Dim sSousSection As String
35: Dim sSection As String
40: Dim sNoProjet As String
45: Dim sNoSoumission As String
50: Dim bAjouterSection As Boolean
55: Dim bAjouterSousSection As Boolean
60: Dim bAjouterPiece As Boolean
65: Dim xlsApp As Excel.Application
70: Dim xlsWorkBook As Excel.Workbook
75: Dim iCompteur As Short
80: Dim sSaveAsFileName As String
		
85: rstPiece = New ADODB.Recordset
90: rstTemp = New ADODB.Recordset
95: rstImpListePiece = New ADODB.Recordset
		
100: iCompteurPiece = 1
		
105: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
		'Ouverture du recordset
110: If m_eType = enumType.TYPE_PROJET Then
115: sNoProjet = rstProjSoum.Fields("IDProjet").Value
120: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
125: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND Type = 'E' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
130: Else
135: sNoProjet = vbNullString
140: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
145: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoSoumission & "' AND Type = 'E' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
150: End If
		
155: Do While Not rstPiece.EOF
160: If rstPiece.Fields("Visible").Value = True Then
165: bAjouterSection = True
170: bAjouterSousSection = True
175: bAjouterPiece = True
				
180: rstImpListePiece.CursorLocation = ADODB.CursorLocationEnum.adUseClient
				
185: Call rstImpListePiece.Open("SELECT * FROM GRB_Impression_ListePiece WHERE IDSection = '" & rstPiece.Fields("IDSection").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
190: If Not rstImpListePiece.EOF Then
195: bAjouterSection = False
					
200: Do While Not rstImpListePiece.EOF
205: If rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value Then
210: bAjouterSousSection = False
							
215: If rstPiece.Fields("NumItem").Value <> "Texte" And rstPiece.Fields("NumItem").Value <> "Text" Then
220: If rstImpListePiece.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value Then
225: bAjouterPiece = False
									
230: rstImpListePiece.Fields("Qté").Value = Replace(CStr(CDbl(rstImpListePiece.Fields("Qté").Value) + CDbl(rstPiece.Fields("Qté").Value)), ".", ",")
									
235: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
									If Not IsDbNull(rstImpListePiece.Fields("ID").Value) Then
240: If rstImpListePiece.Fields("ID").Value <> "" Then
245: rstImpListePiece.Fields("ID").Value = rstImpListePiece.Fields("ID").Value & ", " & rstPiece.Fields("ID").Value
250: Else
255: rstImpListePiece.Fields("ID").Value = rstPiece.Fields("ID").Value
260: End If
265: Else
270: rstImpListePiece.Fields("ID").Value = rstPiece.Fields("ID").Value
275: End If
									
280: Call rstImpListePiece.Update()
									
285: If rstImpListePiece.Fields("Qté").Value = 0 Then
290: Call rstImpListePiece.Delete()
										
295: rstImpListePiece.Filter = "NomSousSection = '" & Replace(rstPiece.Fields("SousSection").Value, "'", "''") & "'"
										
300: If rstImpListePiece.RecordCount = 1 Then
305: Call rstImpListePiece.Delete()
											
310: rstImpListePiece.Filter = "IDSection = '" & rstPiece.Fields("IDSection").Value & "'"
											
315: If rstImpListePiece.RecordCount = 1 Then
320: Call rstImpListePiece.Delete()
325: End If
330: End If
										
335: rstImpListePiece.Filter = ""
340: End If
									
345: Exit Do
350: End If
355: Else
360: Exit Do
365: End If
370: End If
						
375: Call rstImpListePiece.MoveNext()
380: Loop 
385: End If
				
390: If bAjouterSection = True Then
395: If m_eLangage = enumLangage.ANGLAIS Then
400: sSection = "NomSectionEN"
405: Else
410: sSection = "NomSectionFR"
415: End If
					
420: Call rstTemp.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
					'Ajoute la section dans la liste de pièces
425: Call rstImpListePiece.AddNew()
					
430: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
435: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
					
440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstTemp.Fields(sSection).Value) Then
445: rstImpListePiece.Fields("Section").Value = rstTemp.Fields(sSection).Value
450: Else
455: rstImpListePiece.Fields("Section").Value = " "
460: End If
					
465: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
470: Call rstImpListePiece.Update()
					
475: iCompteurPiece = iCompteurPiece + 1
					
480: Call rstTemp.Close()
485: End If
				
490: If bAjouterSousSection = True Then
495: sSousSection = rstPiece.Fields("SousSection").Value
					
500: If sSousSection = S_PAS_SOUS_SECTION Then
505: sSousSection = " "
510: End If
					
515: Call rstImpListePiece.AddNew()
					
520: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
525: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
530: rstImpListePiece.Fields("SousSection").Value = sSousSection
535: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
540: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
545: Call rstImpListePiece.Update()
					
550: iCompteurPiece = iCompteurPiece + 1
555: End If
				
560: If bAjouterPiece = True Then
					'Ajoute la pièce à la liste de pièces
565: Call rstImpListePiece.AddNew()
					
570: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
575: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
580: rstImpListePiece.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value
585: rstImpListePiece.Fields("Qté").Value = rstPiece.Fields("Qté").Value
					
590: If m_eLangage = enumLangage.ANGLAIS Then
595: rstImpListePiece.Fields("Description").Value = rstPiece.Fields("Desc_EN").Value
600: Else
605: rstImpListePiece.Fields("Description").Value = rstPiece.Fields("Desc_FR").Value
610: End If
					
615: rstImpListePiece.Fields("Manufact").Value = rstPiece.Fields("Manufact").Value
					
620: If m_eType = enumType.TYPE_PROJET Then
625: rstImpListePiece.Fields("ID").Value = rstPiece.Fields("ID").Value
630: End If
					
635: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
640: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
					
645: Call rstImpListePiece.Update()
					
650: iCompteurPiece = iCompteurPiece + 1
655: End If
				
660: Call rstImpListePiece.Close()
665: End If
			
			'Prochaine enregistrement
670: Call rstPiece.MoveNext()
675: Loop 
		
		''''''''''''''''''''''''''''''''''''''''''''''''''
		' Rapport liste pièce, met dans l'ordre de ligne '
		''''''''''''''''''''''''''''''''''''''''''''''''''
680: rstImpListePiece.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
685: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_Listepiece WHERE TRIM(IDSoumission) = '" & Trim(sNoSoumission) & "' ORDER BY noligne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
690: xlsApp = New Excel.Application
		
695: xlsWorkBook = xlsApp.Workbooks.Add
		
700: xlsApp.Range("A1")._Default = "Liste de matériel ( " & txtNoProjSoum.Text & " )"
705: xlsApp.Range("A1").Font.Bold = True
710: xlsApp.Range("A1").Font.Underline = Excel.XlUnderlineStyle.xlUnderlineStyleSingle
715: xlsApp.Range("A1").HorizontalAlignment = Excel.Constants.xlCenter
720: xlsApp.Range("A1").Font.Size = 14
		
725: Call xlsApp.Range("A1:E1").Merge()
		
730: xlsApp.Range("A4")._Default = "Qté"
735: xlsApp.Range("A4").Font.Bold = True
740: xlsApp.Range("A4").HorizontalAlignment = Excel.Constants.xlCenter
		
745: xlsApp.Range("B4")._Default = "No. Item"
750: xlsApp.Range("B4").Font.Bold = True
755: xlsApp.Range("B4").HorizontalAlignment = Excel.Constants.xlCenter
		
760: xlsApp.Range("C4")._Default = "Description"
765: xlsApp.Range("C4").Font.Bold = True
770: xlsApp.Range("C4").HorizontalAlignment = Excel.Constants.xlCenter
		
775: xlsApp.Range("D4")._Default = "Manufacturier"
780: xlsApp.Range("D4").Font.Bold = True
785: xlsApp.Range("D4").HorizontalAlignment = Excel.Constants.xlCenter
		
790: xlsApp.Range("E4")._Default = "#ID"
795: xlsApp.Range("E4").Font.Bold = True
800: xlsApp.Range("E4").HorizontalAlignment = Excel.Constants.xlCenter
		
805: xlsApp.Range("A4:E4").Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlContinuous
810: xlsApp.Range("A4:E4").Borders(Excel.XlBordersIndex.xlEdgeBottom).Weight = Excel.XlBorderWeight.xlMedium
815: xlsApp.Range("A4:E4").Borders(Excel.XlBordersIndex.xlEdgeBottom).ColorIndex = Excel.Constants.xlAutomatic
		
820: xlsApp.Range("A4:E4").Borders(Excel.XlBordersIndex.xlInsideVertical).LineStyle = Excel.XlLineStyle.xlContinuous
825: xlsApp.Range("A4:E4").Borders(Excel.XlBordersIndex.xlInsideVertical).Weight = Excel.XlBorderWeight.xlMedium
830: xlsApp.Range("A4:E4").Borders(Excel.XlBordersIndex.xlInsideVertical).ColorIndex = Excel.Constants.xlAutomatic
		
835: iCompteur = 5
		
840: Do While Not rstImpListePiece.EOF
845: xlsApp.Range("A" & iCompteur)._Default = rstImpListePiece.Fields("Qté").Value
			
850: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If IsDbNull(rstImpListePiece.Fields("Section").Value) Then
855: xlsApp.Range("B" & iCompteur)._Default = rstImpListePiece.Fields("NumItem").Value
860: Else
865: xlsApp.Range("B" & iCompteur)._Default = rstImpListePiece.Fields("Section").Value
870: xlsApp.Range("B" & iCompteur).Font.Bold = True
875: End If
			
880: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If IsDbNull(rstImpListePiece.Fields("SousSection").Value) Then
885: xlsApp.Range("C" & iCompteur)._Default = rstImpListePiece.Fields("Description").Value
890: Else
895: xlsApp.Range("C" & iCompteur)._Default = rstImpListePiece.Fields("SousSection").Value
900: xlsApp.Range("C" & iCompteur).Font.Bold = True
905: End If
			
910: xlsApp.Range("D" & iCompteur)._Default = rstImpListePiece.Fields("Manufact").Value
915: xlsApp.Range("E" & iCompteur)._Default = rstImpListePiece.Fields("ID").Value
			
920: xlsApp.Range("A" & iCompteur & ":E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlContinuous
925: xlsApp.Range("A" & iCompteur & ":E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).Weight = Excel.XlBorderWeight.xlThin
930: xlsApp.Range("A" & iCompteur & ":E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).ColorIndex = Excel.Constants.xlAutomatic
			
935: xlsApp.Range("A" & iCompteur & ":E" & iCompteur).Borders(Excel.XlBordersIndex.xlInsideVertical).LineStyle = Excel.XlLineStyle.xlContinuous
940: xlsApp.Range("A" & iCompteur & ":E" & iCompteur).Borders(Excel.XlBordersIndex.xlInsideVertical).Weight = Excel.XlBorderWeight.xlThin
945: xlsApp.Range("A" & iCompteur & ":E" & iCompteur).Borders(Excel.XlBordersIndex.xlInsideVertical).ColorIndex = Excel.Constants.xlAutomatic
			
950: Call rstImpListePiece.MoveNext()
			
955: iCompteur = iCompteur + 1
960: Loop 
		
965: iCompteur = iCompteur - 1
		
970: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlContinuous
975: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).Weight = Excel.XlBorderWeight.xlMedium
980: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeBottom).ColorIndex = Excel.Constants.xlAutomatic
		
985: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeTop).LineStyle = Excel.XlLineStyle.xlContinuous
990: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeTop).Weight = Excel.XlBorderWeight.xlMedium
995: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeTop).ColorIndex = Excel.Constants.xlAutomatic
		
1000: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeLeft).LineStyle = Excel.XlLineStyle.xlContinuous
1005: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeLeft).Weight = Excel.XlBorderWeight.xlMedium
1010: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeLeft).ColorIndex = Excel.Constants.xlAutomatic
		
1015: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeRight).LineStyle = Excel.XlLineStyle.xlContinuous
1020: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeRight).Weight = Excel.XlBorderWeight.xlMedium
1025: xlsApp.Range("A4:E" & iCompteur).Borders(Excel.XlBordersIndex.xlEdgeRight).ColorIndex = Excel.Constants.xlAutomatic
		
1030: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("A:A").EntireColumn.AutoFit()
1035: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("B:B").EntireColumn.AutoFit()
1040: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("C:C").EntireColumn.AutoFit()
1045: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("D:D").EntireColumn.AutoFit()
1050: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.Columns().EntireColumn. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call xlsApp.Columns._Default("E:E").EntireColumn.AutoFit()
		
1055: Call rstImpListePiece.Close()
1060: 'UPGRADE_NOTE: Object rstImpListePiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpListePiece = Nothing
		
1065: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
1070: 'UPGRADE_WARNING: Couldn't resolve default property of object xlsApp.GetSaveAsFilename(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sSaveAsFileName = xlsApp.GetSaveAsFilename(txtNoProjSoum.Text & ".xls", "Fichiers Excel (*.xlx), *.xls")
		
1075: If sSaveAsFileName <> "Faux" Then
1080: Call xlsWorkBook.SaveAs(sSaveAsFileName)
1085: End If
		
1090: xlsWorkBook.Saved = True
		
1095: Call xlsWorkBook.Close()
		
1100: 'UPGRADE_NOTE: Object xlsWorkBook may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		xlsWorkBook = Nothing
		
1105: Call xlsApp.Quit()
		
1110: 'UPGRADE_NOTE: Object xlsApp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		xlsApp = Nothing
		
1115: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
1120: Exit Sub
		
AfficherErreur: 
		
1125: Call AfficherErreur("frmProjSoumElec", "ExporterListePieces", Err, Erl())
	End Sub
	
	Private Sub cmdOKCommentaire_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKCommentaire.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
			lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_COMMENTAIRE).Text = txtcommentaire.Text
		Else
			lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, txtcommentaire.Text))
		End If
		
15: fraCommentaire.Visible = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "cmdOKCommentaire_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKDateRequise_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKDateRequise.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim datDate As Date
		
15: datDate = DateSerial(mvwDateRequise.Year, mvwDateRequise.Month, mvwDateRequise.Day)
		
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
			lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text = ConvertDate(datDate)
		Else
			lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ConvertDate(datDate)))
		End If
		
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_ORANGE)
		
30: fraDateRequise.Visible = False
		
35: m_bMonthViewHasFocus = False
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumElec", "cmdOKDateRequise_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerFRS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerFRS.Click
		
5: On Error GoTo AfficherErreur
		
10: frafournisseur.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmdAnnulerFRS_Click", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerPieceTrouve_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerPieceTrouve.Click
		
5: On Error GoTo AfficherErreur
		
10: fraPieceTrouve.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmdAnnulerPieceTrouve", Err, Erl())
	End Sub
	
	Private Sub cmdBonCommande_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdBonCommande.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
25: Call MsgBox("Vous ne pouvez pas commander de pièce à partir de ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
30: Exit Sub
35: End If
		
40: rstProjSoum = New ADODB.Recordset
		
45: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
50: If rstProjSoum.Fields("Ouvert").Value = True And rstProjSoum.Fields("Verrouillé").Value = False Then
55: If VerifierSiOuvert(sUser) = False Then
60: If lvwSoumission.Items.Count > 0 Then
65: Call frmChoixBonCommande.Afficher(txtNoProjSoum.Text, Me, m_eLangage)
70: Else
75: Call MsgBox("Il n'y a pas de pièces à commander pour ce projet!", MsgBoxStyle.OKOnly, "Erreur")
80: End If
85: Else
90: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
95: End If
100: Else
105: If rstProjSoum.Fields("Ouvert").Value = False Then
110: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
115: Else
120: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
125: End If
130: End If
		
135: Call rstProjSoum.Close()
140: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
145: If m_bModifFournisseurBC = True Then
150: Call cmbProjSoum_SelectedIndexChanged(cmbProjSoum, New System.EventArgs())
155: End If
		
160: Exit Sub
		
AfficherErreur: 
		
165: Call AfficherErreur("frmProjSoumElec", "cmdBonCommande_Click", Err, Erl())
	End Sub
	
	Public Sub Commande()
		Dim DR_Commande As Object
		
5: On Error GoTo AfficherErreur
		
		'Change la valeur du champs "Commandé" pour la pièce à true
10: Dim rstProjet As ADODB.Recordset
15: Dim rstPiece As ADODB.Recordset
20: Dim rstBCPiece As ADODB.Recordset
25: Dim rstBC As ADODB.Recordset
30: Dim rstFRS As ADODB.Recordset
35: Dim iIDFRS As Short
40: Dim sFRS As String
45: Dim sNoBC As String
50: Dim sWherePiece As String
55: Dim sWhereNoLigne As String
60: Dim sWhere As String
65: Dim sDateRequise As String
70: Dim sNoLigne As String
75: Dim bPremier As Boolean
80: Dim bPremierNoLigne As Boolean
		
85: rstProjet = New ADODB.Recordset
		
90: Call rstProjet.Open("SELECT ProchaineCommande FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
95: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjet.Fields("ProchaineCommande").Value) Then
100: rstProjet.Fields("ProchaineCommande").Value = rstProjet.Fields("ProchaineCommande").Value + 1
			
105: Call rstProjet.Update()
110: End If
		
115: Call rstProjet.Close()
120: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Commande.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sFRS = DR_Commande.Sections("Section2").Controls("lblFournisseur").Caption
130: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Commande.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sNoBC = DR_Commande.Sections("Section2").Controls("lblNoBC").Caption
		
135: rstBC = New ADODB.Recordset
140: rstFRS = New ADODB.Recordset
145: rstPiece = New ADODB.Recordset
150: rstBCPiece = New ADODB.Recordset
		
155: Call rstBC.Open("SELECT * FROM GRB_BonsCommandes WHERE NoBonCommande = '" & sNoBC & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
160: Do While Not rstBC.EOF
165: Call rstFRS.Open("SELECT IDFRS, NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstBC.Fields("NoFournisseur").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
170: If rstFRS.Fields("NomFournisseur").Value = sFRS Then
175: iIDFRS = rstFRS.Fields("IDFRS").Value
				
180: sDateRequise = rstBC.Fields("DateRequise").Value
				
185: Call rstFRS.Close()
				
190: Exit Do
195: End If
			
200: Call rstFRS.Close()
			
205: Call rstBC.MoveNext()
210: Loop 
		
215: Call rstBC.Close()
220: 'UPGRADE_NOTE: Object rstBC may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBC = Nothing
		
225: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
		
		'Ouverture du recordset du Bon de commande pour savoir quelles pièces
		'ont été commandées
230: Call rstBCPiece.Open("SELECT NoItem, NuméroLigne FROM GRB_BonsCommandes_Pieces WHERE NoFournisseur = " & iIDFRS & " AND NoBonCommande = '" & sNoBC & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Tant que ce n'est pas la fin des enregistrements
235: sWhere = "(IDProjet = '" & txtNoProjSoum.Text & "')"
		
240: sWherePiece = "NumItem In ("
245: sWhereNoLigne = "NuméroLigne In ("
		
250: bPremier = True
		
255: Do While Not rstBCPiece.EOF
260: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstBCPiece.Fields("NoItem").Value) Then
265: sNoLigne = rstBCPiece.Fields("NuméroLigne").Value
				
270: If bPremier = True Then
275: If InStr(1, sNoLigne, ",") = 0 Then
280: sWherePiece = sWherePiece & "'" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "'"
285: sWhereNoLigne = sWhereNoLigne & rstBCPiece.Fields("NuméroLigne").Value
290: Else
295: bPremierNoLigne = True
						
300: Do While InStr(1, sNoLigne, ",") > 0
305: If bPremierNoLigne = True Then
310: sWherePiece = sWherePiece & "'" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "'"
315: sWhereNoLigne = sWhereNoLigne & VB.Left(sNoLigne, InStr(1, sNoLigne, ",") - 1)
								
320: bPremierNoLigne = False
325: Else
330: sWherePiece = sWherePiece & ", '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "'"
335: sWhereNoLigne = sWhereNoLigne & ", " & VB.Left(sNoLigne, InStr(1, sNoLigne, ",") - 1)
340: End If
							
345: sNoLigne = VB.Right(sNoLigne, Len(sNoLigne) - (InStr(1, sNoLigne, ",") + 1))
350: Loop 
						
355: If Trim(sNoLigne) <> "" Then
360: sWherePiece = sWherePiece & ", '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "'"
365: sWhereNoLigne = sWhereNoLigne & ", " & sNoLigne
370: End If
375: End If
					
380: bPremier = False
385: Else
390: If InStr(1, sNoLigne, ",") = 0 Then
395: sWherePiece = sWherePiece & ", '" & rstBCPiece.Fields("NoItem").Value & "'"
400: sWhereNoLigne = sWhereNoLigne & ", " & rstBCPiece.Fields("NuméroLigne").Value
405: Else
410: Do While InStr(1, sNoLigne, ",") > 0
415: sWherePiece = sWherePiece & ", '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "'"
420: sWhereNoLigne = sWhereNoLigne & ", " & VB.Left(sNoLigne, InStr(1, sNoLigne, ",") - 1)
							
425: sNoLigne = VB.Right(sNoLigne, Len(sNoLigne) - (InStr(1, sNoLigne, ",") + 1))
430: Loop 
						
435: If Trim(sNoLigne) <> "" Then
440: sWherePiece = sWherePiece & ", '" & Replace(rstBCPiece.Fields("NoItem").Value, "'", "''") & "'"
445: sWhereNoLigne = sWhereNoLigne & ", " & sNoLigne
450: End If
455: End If
460: End If
465: End If
			
470: Call rstBCPiece.MoveNext()
475: Loop 
		
480: sWherePiece = sWherePiece & ")"
485: sWhereNoLigne = sWhereNoLigne & ")"
		
490: sWhere = sWhere & " AND " & sWherePiece & " AND " & sWhereNoLigne
		
495: Call rstBCPiece.Close()
500: 'UPGRADE_NOTE: Object rstBCPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBCPiece = Nothing
		
505: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE " & sWhere, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
510: Do While Not rstPiece.EOF
515: rstPiece.Fields("Commandé").Value = True
			
520: rstPiece.Fields("DateCommande").Value = ConvertDate(Today)
			
525: rstPiece.Fields("DateRequise").Value = sDateRequise
			
530: rstPiece.Fields("NomCommande").Value = g_sEmploye
			
535: rstPiece.Fields("NoSéquentiel").Value = VB.Right(sNoBC, 3)
			
540: Call rstPiece.Update()
			
545: Call rstPiece.MoveNext()
550: Loop 
		
555: Call rstPiece.Close()
560: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
565: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
570: Exit Sub
		
AfficherErreur: 
		
575: Call AfficherErreur("frmProjSoumElec", "Commande", Err, Erl())
	End Sub
	
	Private Sub cmdCatalogue_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdCatalogue.Click
		
5: On Error GoTo AfficherErreur
		
		'Pour ouvrir le catalogue électrique
10: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
15: Call FrmCatalogueElec.AfficherForm(cmbPieces.Text, "", "")
		
20: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumElec", "cmdCatalogue_Click", Err, Erl())
	End Sub
	
	Private Sub cmdForfait_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdForfait.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim sMontant As String
		
15: sMontant = InputBox("Quel est le montant du forfait?")
		
20: If Trim(sMontant) <> "" Then
25: sMontant = Replace(sMontant, ".", ",")
			
30: If IsNumeric(sMontant) Then
35: txtForfait.Text = Conversion_Renamed(sMontant, ModuleMain.enumConvert.MODE_ARGENT)
				
40: lblForfaitInitiale.Text = g_sInitiale
45: Else
50: Call MsgBox("Montant non numérique!", MsgBoxStyle.OKOnly, "Erreur")
55: End If
60: End If
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumElec", "cmdForfait_Click", Err, Erl())
	End Sub
	
	Private Sub cmdMauvaisPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdMauvaisPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MauvaisPrix()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmdMauvaisPrix_Click", Err, Erl())
	End Sub
	
	Private Sub MauvaisPrix()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: If lvwSoumission.Items.Count > 0 Then
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
				'Si ce n'est pas une section
25: If lvwSoumission.FocusedItem.Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
						'Si ce n'est pas du texte
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la quantité est plus grande que 0
40: If CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) > 0 Then
45: Call ViderChamps_frs()
								
50: Call RemplirComboFournisseur()
								
55: For iCompteur = 0 To cmbfrs.Items.Count - 1
60: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If VB6.GetItemData(cmbfrs, iCompteur) = lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).Tag Then
65: cmbfrs.SelectedIndex = iCompteur
										
70: Exit For
75: End If
80: Next 
								
85: 'UPGRADE_ISSUE: ComboBox property cmbfrs.Locked was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
								cmbfrs.Locked = True
								
90: fraPrixPiece.Tag = lvwSoumission.FocusedItem.Index
								
95: m_bMauvaisPrix = True
								
100: fraPrixPiece.Visible = True
								
105: Call txtPrixList.Focus()
110: Else
115: Call MsgBox("La quantité est déjà dans le négatif!", MsgBoxStyle.OKOnly, "Erreur")
120: End If
125: End If
130: End If
135: End If
140: Else
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
150: End If
155: End If
		
160: Exit Sub
		
AfficherErreur: 
		
165: Call AfficherErreur("frmProjSoumElec", "MauvaisPrix", Err, Erl())
	End Sub
	
	Private Sub cmdMaterielInutile_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdMaterielInutile.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MaterielInutile()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmdMaterielInutile_Click", Err, Erl())
	End Sub
	
	Private Sub MaterielInutile()
		
5: On Error GoTo AfficherErreur
		
10: Dim itmProjet As System.Windows.Forms.ListViewItem
		
15: If lvwSoumission.Items.Count > 0 Then
20: itmProjet = lvwSoumission.FocusedItem
			
25: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_ROSE And System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BLEU Then
				'Si ce n'est pas une section
30: If itmProjet.Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
35: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
						'Si ce n'est pas du texte
40: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la quantité est plus grande que 0
45: If CDbl(Replace(itmProjet.Text, "*", vbNullString)) > 0 Then
50: m_bPieceInutile = True
55: m_bRecherchePiece = False
60: m_bChangementFRS = False
								
65: Call AfficherListeFournisseurs()
								
70: If lvwfournisseur.Items.Count = 0 Then
75: Call MsgBox("Il n'y a aucun fournisseur pour cette pièce!", MsgBoxStyle.OKOnly, "Erreur")
									
80: Exit Sub
85: Else
90: frafournisseur.Visible = True
95: End If
100: Else
105: Call MsgBox("La quantité est déjà dans le négatif!", MsgBoxStyle.OKOnly, "Erreur")
110: End If
115: End If
120: End If
125: End If
130: Else
135: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Cette commande doit être faite dans le projet " & itmProjet.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
140: End If
145: End If
		
150: Exit Sub
		
AfficherErreur: 
		
155: Call AfficherErreur("frmProjSoumElec", "MaterielInutile", Err, Erl())
	End Sub
	
	Private Sub cmdCopier_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdCopier.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sNoProjSoum As String
20: Dim sUser As String
25: Dim bExiste As Boolean
30: Dim bVariables As Boolean
35: Dim bTauxHoraire As Boolean
40: Dim bPrixPieces As Boolean
45: Dim bNoValide As Boolean
		
		'Si le combo n'est pas vide
50: If cmbProjSoum.Items.Count > 0 Then
55: If VerifierSiOuvert(sUser) = False Then
				'Demande du numéro
60: sNoProjSoum = InputBox("Quel est le numéro de la soumission?")
				
65: If Trim(sNoProjSoum) <> vbNullString Then
70: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
					
75: bNoValide = True
					
80: If ValiderFormatNumeroProjSoum(sNoProjSoum) = False Then
85: bNoValide = False
90: End If
					
95: If bNoValide = True Then
100: If ValiderFormatElectrique(sNoProjSoum) = False Then
105: bNoValide = False
110: End If
115: End If
					
120: If bNoValide = True Then
125: If ValiderFormatSoumission(sNoProjSoum) = False Then
130: bNoValide = False
135: End If
140: End If
					
145: If bNoValide = False Then
150: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
155: Exit Sub
160: End If
					
165: sNoProjSoum = UCase(sNoProjSoum)
					
170: rstProjSoum = New ADODB.Recordset
					
175: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
180: If rstProjSoum.EOF Then
185: bExiste = False
190: Else
195: bExiste = True
						
200: Call MsgBox("Ce numéro existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
205: End If
					
210: Call rstProjSoum.Close()
					
215: If bExiste = False Then
220: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
225: If rstProjSoum.EOF Then
230: bExiste = False
235: Else
240: bExiste = True
							
245: Call MsgBox("Ce numéro existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
250: End If
						
255: Call rstProjSoum.Close()
260: End If
					
265: If bExiste = False Then
270: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
275: If rstProjSoum.EOF Then
280: bExiste = False
285: Else
290: bExiste = True
							
295: Call MsgBox("Ce numéro existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
300: End If
						
305: Call rstProjSoum.Close()
310: End If
					
315: If bExiste = False Then
320: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
325: If rstProjSoum.EOF Then
330: bExiste = False
335: Else
340: bExiste = True
							
345: Call MsgBox("Ce numéro existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
350: End If
						
355: Call rstProjSoum.Close()
360: End If
					
					'S'il n'existe pas, on l'ajoute
365: If bExiste = False Then
370: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
375: If Not rstProjSoum.EOF Then
380: If rstProjSoum.Fields("Ouvert").Value = False Then
385: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
								
390: Call rstProjSoum.Close()
395: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
								rstProjSoum = Nothing
								
400: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
								System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
								
405: Exit Sub
410: End If
415: End If
						
420: Call rstProjSoum.Close()
425: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
430: If MsgBox("Voulez-vous mettre à jour les variables systèmes?" & vbNewLine & "-  % Profit" & vbNewLine & "-  % Commission" & vbNewLine & "-  % Imprévu" & vbNewLine & "-  $ Pages manuel", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
435: bVariables = True
440: Else
445: bVariables = False
450: End If
						
455: If MsgBox("Voulez-vous mettre à jour les taux horaires?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
460: bTauxHoraire = True
465: Else
470: bTauxHoraire = False
475: End If
						
480: If MsgBox("Voulez-vous mettre à jour le prix des pièces?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
485: bPrixPieces = True
490: Else
495: bPrixPieces = False
500: End If
						
505: m_bModeAjout = True
510: m_bModeAffichage = False
						
515: m_bTempsDejaOuvert = True
						
520: If bVariables = True Then
							'On ré-initialise les variables
525: Call InitialiserVariables(sNoProjSoum)
530: End If
						
535: If bTauxHoraire = True Then
540: Call InitialiserNouveauxTaux()
545: End If
						
						'Rapetisse le listview de la soumission pour afficher le lvwPiece
550: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
555: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
						
						'On met en mode modif
560: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
						
565: If bPrixPieces = True Then
							'On recalcul le prix des pièces
570: Call UpdatePieces()
575: End If
						
580: Call UpdateOrdre()
						
585: If bVariables = True Or bTauxHoraire = True Or bPrixPieces = True Then
							'On recalcul le prix total
590: Call CalculerPrix()
595: End If
						
600: Call BarrerChamps(False)
						
605: txtNoProjSoum.Text = sNoProjSoum
610: txtNoSoumission.Text = vbNullString
615: End If
					
620: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
625: End If
630: Else
635: If m_eType = enumType.TYPE_PROJET Then
640: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
645: Else
650: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
655: End If
660: End If
665: End If
		
670: Exit Sub
		
AfficherErreur: 
		
675: Call AfficherErreur("frmProjSoumElec", "cmdCopier_Click", Err, Erl())
	End Sub
	
	Private Sub UpdateOrdre()
		
5: On Error GoTo AfficherErreur
		
		'Cette procédure sert à changer l'ordre des sections dans la soumission
10: Dim rstOrdre As ADODB.Recordset
15: Dim rstCount As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim iCompteur2 As Short
35: Dim iIndexCopie As Short
40: Dim iSection As Short
45: Dim iIndex As Short
50: Dim iNbreSection As Short
55: Dim bPremier As Boolean
60: Dim itmProjSoum As System.Windows.Forms.ListViewItem
65: Dim sSection As String
		
70: rstOrdre = New ADODB.Recordset
		
		'Boucle pour changer la valeur de l'ordre dans le ListItem
75: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si ce n'est pas une section
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstOrdre.Open("SELECT Ordre FROM GRB_SoumProjSectionElec WHERE IDSection = " & lvwSoumission.Items.Item(iCompteur).Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_MANUFACT).Tag = rstOrdre.Fields("Ordre").Value
				
95: Call rstOrdre.Close()
100: End If
105: Next 
		
110: 'UPGRADE_NOTE: Object rstOrdre may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstOrdre = Nothing
		
115: rstCount = New ADODB.Recordset
		
120: Call rstCount.Open("SELECT COUNT(IDSection) as NbreSection FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
125: iNbreSection = rstCount.Fields("NbreSection").Value
		
130: Call rstCount.Close()
135: 'UPGRADE_NOTE: Object rstCount may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstCount = Nothing
		
		'Il faut enlever les sections car ils n'ont pas d'ordre et il ne font
		'que nuire
140: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si c'est une section
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur - iSection).Tag = vbNullString Then
				'On l'enlève
150: Call lvwSoumission.Items.RemoveAt(iCompteur - iSection)
				
155: iSection = iSection + 1
160: End If
165: Next 
		
170: iIndex = 1
		
175: rstSection = New ADODB.Recordset
		
		'Boucle pour replacer le ListItem à la bonne place
180: For iCompteur = 1 To iNbreSection
185: bPremier = True
			
190: iCompteur2 = iIndex
			
195: Do While iCompteur2 <= lvwSoumission.Items.Count
				'Si le tag est la premiere ordre
200: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur2).SubItems.Item(I_COL_SOUM_MANUFACT).Tag = iCompteur Then
					'Si la première fois qu'on trouve cette ordre
205: If bPremier = True Then
						'on ajoute la section
210: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum = lvwSoumission.Items.Insert(iIndex, "")
						
215: Call ValeurParDefaut(itmProjSoum)
						
220: If m_eLangage = enumLangage.ANGLAIS Then
225: sSection = "NomSectionEN"
230: Else
235: sSection = "NomSectionFR"
240: End If
						
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & lvwSoumission.Items.Item(iCompteur2 + 1).Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
250: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
						If Not IsDbNull(rstSection.Fields(sSection).Value) Then
255: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
								itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
							End If
260: Else
265: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
								itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
270: End If
						
275: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
						
280: Call rstSection.Close()
						
285: iIndex = iIndex + 1
290: iCompteur2 = iCompteur2 + 1
						
295: bPremier = False
300: End If
					
					'On ajoute la pièce
305: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum = lvwSoumission.Items.Insert(iIndex, "")
					
310: iIndexCopie = iCompteur2 + 1
					
315: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Checked = lvwSoumission.Items.Item(iIndexCopie).Checked
					
320: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Text = lvwSoumission.Items.Item(iIndexCopie).Text
					
325: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.ForeColor = lvwSoumission.Items.Item(iIndexCopie).ForeColor
					
330: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Tag = lvwSoumission.Items.Item(iIndexCopie).Tag
					
335: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, lvwSoumission.Items.Item(iIndexCopie).Font.Bold)
					
340: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PIECE).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PIECE).Text))
					End If
345: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PIECE).Tag
					
350: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PIECE).ForeColor
					
355: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PIECE).Font.Bold)
					
360: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DESCR).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DESCR).Text))
					End If
365: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DESCR).Tag
					
370: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DESCR).ForeColor
					
375: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DESCR).Font.Bold = True)
					
380: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
						itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_MANUFACT).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_MANUFACT).Text))
					End If
385: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
					
390: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor
					
395: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MANUFACT).Font.Bold)
					
400: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_LIST).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_LIST).Text))
					End If
405: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
					
410: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor
					
415: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_LIST).Font.Bold)
					
420: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_ESCOMPTE).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_ESCOMPTE).Text))
					End If
					
425: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor
					
430: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_ESCOMPTE).Font.Bold)
					
435: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_NET).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PRIX_NET).Text))
					End If
					
440: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor
					
445: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_NET).Font.Bold)
					
450: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
					
455: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
						itmProjSoum.SubItems(I_COL_SOUM_TEMPS).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_TEMPS).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_TEMPS).Text))
					End If
					
460: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_TEMPS).ForeColor
					
465: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_TEMPS).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_TEMPS).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_TEMPS).Font.Bold)
					
470: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
						itmProjSoum.SubItems(I_COL_SOUM_MONTAGE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_MONTAGE).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_MONTAGE).Text))
					End If
					
475: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor
					
480: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MONTAGE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_MONTAGE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_MONTAGE).Font.Bold)
					
485: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
						itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_TOTAL).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_TOTAL).Text))
					End If
					
490: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_TOTAL).ForeColor
					
495: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_TOTAL).Font.Bold)
					
500: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_TOTAL).Tag
					
505: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROFIT).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROFIT).Text))
					End If
					
510: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROFIT).ForeColor
					
515: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROFIT).Font.Bold)
					
520: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROFIT).Tag
					
525: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DISTRIB).Text
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DISTRIB).Text))
					End If
530: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DISTRIB).Tag
					
535: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor
					
540: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DISTRIB).Font.Bold)
					
545: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_COMMENTAIRE).Text = "" Then
550: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
							itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
555: Else
560: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
							itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_COMMENTAIRE).Text
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_COMMENTAIRE).Text))
						End If
565: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor
570: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font.Bold)
575: End If
					
580: If m_eType = enumType.TYPE_PROJET Then
585: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
590: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_ID Then
								itmProjSoum.SubItems(I_COL_SOUM_ID).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_ID).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_ID).Text))
							End If
							
595: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_ID).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_ID).ForeColor
							
600: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_ID).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_ID).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_ID).Font.Bold)
							
605: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text))
							End If
							
610: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_FACTURATION).Text = "" Then
615: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_FACTURATION).Tag = ""
620: Else
625: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_FACTURATION).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_FACTURATION).Tag
630: End If
							
635: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_COMMANDE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_COMMANDE).Text))
							End If
							
640: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text <> "" Then
645: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor
650: End If
							
655: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font.Bold)
							
660: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag
							
665: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_REQUISE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_DATE_REQUISE).Text))
							End If
							
670: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor
							
675: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font.Bold)
							
680: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag
							
685: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NOM_COMMANDE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NOM_COMMANDE).Text))
							End If
							
690: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor
							
695: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font.Bold)
							
700: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
								itmProjSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text))
							End If
							
705: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor
							
710: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font.Bold)
							
715: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROVENANCE).Text
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwSoumission.Items.Item(iIndexCopie).SubItems(I_COL_SOUM_PROVENANCE).Text))
							End If
							
720: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor = lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor
							
725: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font, lvwSoumission.Items.Item(iIndexCopie).SubItems.Item(I_COL_SOUM_PROVENANCE).Font.Bold)
730: End If
735: End If
					
740: Call lvwSoumission.Items.RemoveAt(iIndexCopie)
					
745: Call lvwSoumission.Refresh()
					
750: iIndex = iIndex + 1
755: End If
				
760: iCompteur2 = iCompteur2 + 1
765: Loop 
770: Next iCompteur
		
775: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
780: If lvwSoumission.Items.Count > 0 Then
785: Call Deselect()
			
790: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.Items.Item(1).Selected = True
795: End If
		
800: Exit Sub
		
AfficherErreur: 
		
805: Call AfficherErreur("frmProjSoumElec", "UpdateOrdre", Err, Erl())
	End Sub
	
	Private Sub UpdatePieces()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPieceFRS As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim itmPiece As System.Windows.Forms.ListViewItem
25: Dim iCompteur As Short
30: Dim sTauxUSA As String
35: Dim sTauxSPA As String
		
40: rstPieceFRS = New ADODB.Recordset
		
45: rstConfig = New ADODB.Recordset
		
50: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
55: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
60: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
65: Call rstConfig.Close()
70: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
75: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si ce n'est pas une section
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
				'Si ce n'est pas une sous-section
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmPiece = lvwSoumission.Items.Item(iCompteur)
					
95: Call ValeurParDefaut(itmPiece)
					
100: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmPiece.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
105: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						Call rstPieceFRS.Open("SELECT PRIX_LIST, PRIX_SP, PRIX_NET, ESCOMPTE, DeviseMonétaire FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(itmPiece.SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' AND IDFRS = " & itmPiece.SubItems.Item(I_COL_SOUM_DISTRIB).Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
110: If Not rstPieceFRS.EOF Then
115: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
							If Not IsDbNull(rstPieceFRS.Fields("PRIX_LIST").Value) Then
120: If Trim(rstPieceFRS.Fields("PRIX_LIST").Value) <> "" Then
125: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
130: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
											itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
										Else
											itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
										End If
135: Else
140: If rstPieceFRS.Fields("DeviseMonétaire").Value = "SPA" Then
145: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
												itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
											Else
												itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(rstPieceFRS.Fields("PRIX_LIST").Value) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
											End If
150: Else
155: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
												itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(rstPieceFRS.Fields("PRIX_LIST"), ModuleMain.enumConvert.MODE_ARGENT, 4)
											Else
												itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("PRIX_LIST"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
											End If
160: End If
165: End If
170: Else
175: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
180: End If
185: Else
190: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
195: End If
							
							
200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
							If Not IsDbNull(rstPieceFRS.Fields("PRIX_NET").Value) Then
205: If Trim(rstPieceFRS.Fields("PRIX_NET").Value) <> vbNullString Then
210: If rstPieceFRS.Fields("ESCOMPTE").Value <> vbNullString Then
215: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If itmPiece.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
											itmPiece.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(rstPieceFRS.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)
										Else
											itmPiece.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)))
										End If
220: End If
									
225: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstPieceFRS.Fields("PRIX_NET"), ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("PRIX_NET"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
230: Else
235: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
									If Not IsDbNull(rstPieceFRS.Fields("PRIX_SP").Value) Then
240: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
											itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstPieceFRS.Fields("PRIX_SP"), ModuleMain.enumConvert.MODE_ARGENT, 4)
										Else
											itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("PRIX_SP"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
										End If
245: Else
250: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
											itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = ""
										Else
											itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
										End If
255: End If
260: End If
265: Else
270: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstPieceFRS.Fields("PRIX_SP").Value) Then
275: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstPieceFRS.Fields("PRIX_SP"), ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstPieceFRS.Fields("PRIX_SP"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
280: Else
285: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = ""
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
									End If
290: End If
295: End If
							
							
300: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
305: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
310: Else
315: If rstPieceFRS.Fields("DeviseMonétaire").Value = "SPA" Then
320: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
325: Else
330: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
335: End If
340: End If
							
							'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
345: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_TOTAL Then
								itmPiece.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(CStr(CDbl(Replace(itmPiece.Text, "*", vbNullString)) * CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit)), ModuleMain.enumConvert.MODE_ARGENT)
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(CDbl(Replace(itmPiece.Text, "*", vbNullString)) * CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit)), ModuleMain.enumConvert.MODE_ARGENT)))
							End If
							
							'Pour le profit, c'est le prix total - (prix net * quantité)
350: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_PROFIT Then
								itmPiece.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(CDbl(itmPiece.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmPiece.Text, "*", vbNullString)))), ModuleMain.enumConvert.MODE_ARGENT)
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(CDbl(itmPiece.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmPiece.Text, "*", vbNullString)))), ModuleMain.enumConvert.MODE_ARGENT)))
							End If
							
							'Pour garder en mémoire le prix d'origine, je le mets dans le
							'tag de la colonne Prix Listé
355: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If Trim(itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text) = vbNullString Then
360: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmPiece.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
								Else
									itmPiece.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
								End If
365: End If
							
370: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
							If Not IsDbNull(rstPieceFRS.Fields("PRIX_NET").Value) Then
375: If Trim(rstPieceFRS.Fields("PRIX_NET").Value) <> vbNullString Then
380: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstPieceFRS.Fields("PRIX_LIST").Value
385: Else
390: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstPieceFRS.Fields("PRIX_SP").Value
395: End If
400: Else
405: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstPieceFRS.Fields("PRIX_SP").Value
410: End If
415: Else
420: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							Call MsgBox("Il n'y a pas de prix du fournisseur " & itmPiece.SubItems(I_COL_SOUM_DISTRIB).Text & " pour la pièce " & itmPiece.SubItems(I_COL_SOUM_PIECE).Text & " ou la pièce n'existe plus!", MsgBoxStyle.OKOnly, "Erreur")
425: End If
						
430: Call rstPieceFRS.Close()
435: End If
440: End If
445: End If
450: Next 
		
455: 'UPGRADE_NOTE: Object rstPieceFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceFRS = Nothing
		
460: Exit Sub
		
AfficherErreur: 
		
465: Call AfficherErreur("frmProjSoumElec", "UpdatePieces", Err, Erl())
	End Sub
	
	Private Sub cmdCreerProjet_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdCreerProjet.Click
		
5: On Error GoTo AfficherErreur
		
		'Créé un projet à partir d'une soumission
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sNoProjet As String
20: Dim sUser As String
25: Dim iCompteur As Short
30: Dim bExiste As Boolean
35: Dim bNoValide As Boolean
40: Dim sLiaison As String
		
45: If cmbProjSoum.Items.Count > 0 Then
50: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
55: Call MsgBox("Impossible de créer un projet à partir de cette soumission!", MsgBoxStyle.OKOnly, "Erreur")
				
60: Exit Sub
65: End If
			
70: rstProjSoum = New ADODB.Recordset
			
75: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
80: If rstProjSoum.Fields("Ouvert").Value = False Or rstProjSoum.Fields("Verrouillé").Value = True Then
85: If rstProjSoum.Fields("Ouvert").Value = False Then
90: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly, "Erreur")
95: Else
100: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly, "Erreur")
105: End If
				
110: Call rstProjSoum.Close()
115: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
120: Exit Sub
125: End If
			
130: Call rstProjSoum.Close()
			
135: If VerifierSiOuvert(sUser) = False Then
				'Demande du numéro de projet
140: sNoProjet = InputBox("Quel est le numéro du projet?")
				
145: If Trim(sNoProjet) <> vbNullString Then
150: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
					
155: bNoValide = True
					
160: If ValiderFormatNumeroProjSoum(sNoProjet) = False Then
165: bNoValide = False
170: End If
					
175: If bNoValide = True Then
180: If ValiderFormatElectrique(sNoProjet) = False Then
185: bNoValide = False
190: End If
195: End If
					
200: If bNoValide = True Then
205: If ValiderFormatJobAvecSoum(sNoProjet) = False Then
210: bNoValide = False
215: End If
220: End If
					
225: If bNoValide = False Then
230: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
235: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
240: Exit Sub
245: End If
					
250: sNoProjet = UCase(sNoProjet)
					
255: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
260: If rstProjSoum.EOF Then
265: bExiste = False
270: Else
275: bExiste = True
						
280: Call MsgBox("Ce numéro existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
285: End If
					
290: Call rstProjSoum.Close()
					
295: If bExiste = False Then
300: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
305: If rstProjSoum.EOF Then
310: bExiste = False
315: Else
320: bExiste = True
							
325: Call MsgBox("Ce numéro existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
330: End If
						
335: Call rstProjSoum.Close()
340: End If
					
345: If bExiste = False Then
350: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
355: If rstProjSoum.EOF Then
360: bExiste = False
365: Else
370: bExiste = True
							
375: Call MsgBox("Ce numéro existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
380: End If
						
385: Call rstProjSoum.Close()
390: End If
					
395: If bExiste = False Then
400: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
405: If rstProjSoum.EOF Then
410: bExiste = False
415: Else
420: bExiste = True
							
425: Call MsgBox("Ce numéro existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
430: End If
						
435: Call rstProjSoum.Close()
440: End If
					
445: If bExiste = True Then
450: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
455: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
460: Exit Sub
465: End If
					
470: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
475: If Not rstProjSoum.EOF Then
480: If rstProjSoum.Fields("Ouvert").Value = False Then
485: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
							
490: Call rstProjSoum.Close()
495: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
							rstProjSoum = Nothing
							
500: Exit Sub
505: End If
510: End If
					
515: Call rstProjSoum.Close()
520: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjSoum = Nothing
					
525: If CDbl(VB.Right(sNoProjet, 2)) >= 60 And CDbl(VB.Right(sNoProjet, 2)) <= 98 Then
530: sLiaison = InputBox("Quelle est l'extention du projet " & VB.Left(sNoProjet, 6) & " auquel ce projet sera lié?")
535: End If
					
540: Call frmChoixTransfertJob.Afficher(txtNoProjSoum.Text, "E")
					
545: If m_bTransfertJobCancel = False Then
						'Appel de la méthode pour créer le projet
550: Call TransfererSoumDansProjet(sNoProjet, sLiaison)
						
						'On affiche le projet qui vient d'être créé
555: If m_bComboChoix = True Then
560: cmbChoix.SelectedIndex = I_IDX_PROJET
							
565: For iCompteur = 0 To cmbProjSoum.Items.Count - 1
570: If VB6.GetItemString(cmbProjSoum, iCompteur) = sNoProjet Then
575: cmbProjSoum.SelectedIndex = iCompteur
									
580: Exit For
585: End If
590: Next 
							
595: If sLiaison <> "" Then
600: For iCompteur = 1 To lvwSoumission.Items.Count
									'Si pas une section
605: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.Items.Item(iCompteur).Tag <> "" Then
										'Si pas une sous-section
610: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "" Then
615: If CDbl(VB.Right(sNoProjet, 2)) >= 60 And CDbl(VB.Right(sNoProjet, 2)) <= 79 Then
620: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												Call AjouterPiecesExtraChargeableDansJob(lvwSoumission.Items.Item(iCompteur), sLiaison)
625: Else
630: If CDbl(VB.Right(sNoProjet, 2)) >= 80 And CDbl(VB.Right(sNoProjet, 2)) <= 98 Then
635: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
													Call AjouterPiecesExtraDansJob(lvwSoumission.Items.Item(iCompteur), sLiaison)
640: End If
645: End If
650: End If
655: End If
									
660: Call CalculerTotalRecordset(sNoProjet)
665: Next 
670: End If
							
675: Call AjouterProjetAuCumulatif()
680: End If
						
						'Il faut enlever le bouton puisqu'on ne peut pas créer plus
						'd'un projet avec une soumission
685: cmdCreerProjet.Visible = False
690: End If
					
695: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
700: Else
705: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjSoum = Nothing
					
710: Exit Sub
715: End If
720: Else
725: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
730: End If
735: End If
		
740: Exit Sub
		
AfficherErreur: 
		
745: Call AfficherErreur("frmProjSoumElec", "cmdCreerProjet_Click", Err, Erl())
	End Sub
	
	Private Function VerifierSiDejaProjet() As Boolean
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui sert à vérifier si une soumission est déjà assignée à un projet
10: Dim rstProjet As ADODB.Recordset
		
15: rstProjet = New ADODB.Recordset
		
20: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
25: If Not rstProjet.EOF Then
30: VerifierSiDejaProjet = True
35: End If
		
40: Call rstProjet.Close()
45: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
50: Exit Function
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumElec", "VerifierSiDejaProjet", Err, Erl())
	End Function
	
	Private Sub TransfererSoumDansProjet(ByVal sNoProjet As String, ByVal sLiaison As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui transfère les données de la soumission dans les tables
		'GRB_Projet et GRB_pièces
10: Dim rstSoum As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSoumPiece As ADODB.Recordset
25: Dim rstProjetPiece As ADODB.Recordset
30: Dim rstEmploye As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim rstConfig As ADODB.Recordset
45: Dim iCompteur As Short
		
50: rstSoum = New ADODB.Recordset
55: rstProjet = New ADODB.Recordset
60: rstSoumPiece = New ADODB.Recordset
65: rstProjetPiece = New ADODB.Recordset
70: rstEmploye = New ADODB.Recordset
75: rstProjSoum = New ADODB.Recordset
		
		'Ouverture de la soumission
80: Call rstSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
85: Call rstSoumPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "' AND Type = 'E' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Ouverture du projet
90: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
95: Call rstProjetPiece.Open("SELECT * FROM GRB_Projet_Pieces", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
100: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
105: If rstProjSoum.EOF Then
110: Call rstProjSoum.AddNew()
			
115: rstProjSoum.Fields("IDProjSoum").Value = sNoProjet
120: rstProjSoum.Fields("NoClient").Value = rstSoum.Fields("IDClient").Value
125: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
130: rstProjSoum.Fields("Description").Value = rstSoum.Fields("Description").Value
135: rstProjSoum.Fields("Ouvert").Value = True
140: rstProjSoum.Fields("Type").Value = "P"
			
145: Call rstProjSoum.Update()
150: End If
		
155: Call rstProjSoum.Close()
		
160: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
165: rstProjSoum.Fields("Ouvert").Value = False
		
170: Call rstProjSoum.Update()
		
175: Call rstProjSoum.Close()
180: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'On l'ajoute
185: Call rstProjet.AddNew()
		
190: rstProjet.Fields("IDProjet").Value = sNoProjet
195: rstProjet.Fields("IDSoumission").Value = rstSoum.Fields("IDSoumission").Value
200: rstProjet.Fields("IDClient").Value = rstSoum.Fields("IDClient").Value
205: rstProjet.Fields("IDContact").Value = rstSoum.Fields("IDContact").Value
210: rstProjet.Fields("Description").Value = rstSoum.Fields("Description").Value
215: rstProjet.Fields("Panneau_aire").Value = rstSoum.Fields("Panneau_aire").Value
220: rstProjet.Fields("panneau_espace").Value = rstSoum.Fields("panneau_espace").Value
225: rstProjet.Fields("NbreManuel").Value = rstSoum.Fields("NbreManuel").Value
230: rstProjet.Fields("transport").Value = rstSoum.Fields("transport").Value
235: rstProjet.Fields("csa").Value = rstSoum.Fields("csa").Value
240: rstProjet.Fields("cul").Value = rstSoum.Fields("cul").Value
245: rstProjet.Fields("cur").Value = rstSoum.Fields("cur").Value
250: rstProjet.Fields("ul").Value = rstSoum.Fields("ul").Value
255: rstProjet.Fields("ur").Value = rstSoum.Fields("ur").Value
260: rstProjet.Fields("ce").Value = rstSoum.Fields("ce").Value
265: rstProjet.Fields("Delais").Value = rstSoum.Fields("Delais").Value
270: rstProjet.Fields("Creer").Value = ConvertDate(Today)
275: rstProjet.Fields("CheminPhotos").Value = rstSoum.Fields("CheminPhotos").Value
		
280: If sLiaison <> "" Then
285: rstProjet.Fields("LiaisonChargeable").Value = sLiaison
290: End If
		
295: Call rstEmploye.Open("SELECT noEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
300: rstProjet.Fields("Creer_Par").Value = rstEmploye.Fields("noEmploye").Value
		
305: Call rstEmploye.Close()
310: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
315: rstProjet.Fields("TempsDessin").Value = rstSoum.Fields("TempsDessin").Value
320: rstProjet.Fields("TempsFabrication").Value = rstSoum.Fields("TempsFabrication").Value
325: rstProjet.Fields("TempsAssemblage").Value = rstSoum.Fields("TempsAssemblage").Value
330: rstProjet.Fields("TempsProgInterface").Value = rstSoum.Fields("TempsProgInterface").Value
335: rstProjet.Fields("TempsProgAutomate").Value = rstSoum.Fields("TempsProgAutomate").Value
340: rstProjet.Fields("TempsProgRobot").Value = rstSoum.Fields("TempsProgRobot").Value
345: rstProjet.Fields("TempsVision").Value = rstSoum.Fields("TempsVision").Value
350: rstProjet.Fields("TempsTest").Value = rstSoum.Fields("TempsTest").Value
355: rstProjet.Fields("TempsInstallation").Value = 0
360: rstProjet.Fields("TempsMiseService").Value = 0
365: rstProjet.Fields("TempsFormation").Value = rstSoum.Fields("TempsFormation").Value
370: rstProjet.Fields("TempsGestion").Value = rstSoum.Fields("TempsGestion").Value
375: rstProjet.Fields("TempsShipping").Value = rstSoum.Fields("TempsShipping").Value
		
380: rstConfig = New ADODB.Recordset
		
385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxDessin").Value) Then
390: rstProjet.Fields("TauxDessin").Value = rstSoum.Fields("TauxDessin").Value
395: Else
400: Call rstConfig.Open("SELECT TauxDessinElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
405: rstProjet.Fields("TauxDessin").Value = rstConfig.Fields("TauxDessinElec").Value
			
410: Call rstConfig.Close()
415: End If
		
420: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxFabrication").Value) Then
425: rstProjet.Fields("TauxFabrication").Value = rstSoum.Fields("TauxFabrication").Value
430: Else
435: Call rstConfig.Open("SELECT TauxFabrication FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
440: rstProjet.Fields("TauxFabrication").Value = rstConfig.Fields("TauxFabrication").Value
			
445: Call rstConfig.Close()
450: End If
		
455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxAssemblage").Value) Then
460: rstProjet.Fields("TauxAssemblage").Value = rstSoum.Fields("TauxAssemblage").Value
465: Else
470: Call rstConfig.Open("SELECT TauxAssemblageElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
475: rstProjet.Fields("TauxAssemblage").Value = rstConfig.Fields("TauxAssemblageElec").Value
			
480: Call rstConfig.Close()
485: End If
		
490: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxProgInterface").Value) Then
495: rstProjet.Fields("TauxProgInterface").Value = rstSoum.Fields("TauxProgInterface").Value
500: Else
505: Call rstConfig.Open("SELECT TauxProgInterface FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
510: rstProjet.Fields("TauxProgInterface").Value = rstConfig.Fields("TauxProgInterface").Value
			
515: Call rstConfig.Close()
520: End If
		
525: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxProgAutomate").Value) Then
530: rstProjet.Fields("TauxProgAutomate").Value = rstSoum.Fields("TauxProgAutomate").Value
535: Else
540: Call rstConfig.Open("SELECT TauxProgAutomate FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
545: rstProjet.Fields("TauxProgAutomate").Value = rstConfig.Fields("TauxProgAutomate").Value
			
550: Call rstConfig.Close()
555: End If
		
560: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxProgRobot").Value) Then
565: rstProjet.Fields("TauxProgRobot").Value = rstSoum.Fields("TauxProgRobot").Value
570: Else
575: Call rstConfig.Open("SELECT TauxProgRobot FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
580: rstProjet.Fields("TauxProgRobot").Value = rstConfig.Fields("TauxProgRobot").Value
			
585: Call rstConfig.Close()
590: End If
		
595: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxVision").Value) Then
600: rstProjet.Fields("TauxVision").Value = rstSoum.Fields("TauxVision").Value
605: Else
610: Call rstConfig.Open("SELECT TauxVision FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
615: rstProjet.Fields("TauxVision").Value = rstConfig.Fields("TauxVision").Value
			
620: Call rstConfig.Close()
625: End If
		
630: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxTest").Value) Then
635: rstProjet.Fields("TauxTest").Value = rstSoum.Fields("TauxTest").Value
640: Else
645: Call rstConfig.Open("SELECT TauxTestElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
650: rstProjet.Fields("TauxTest").Value = rstConfig.Fields("TauxTestElec").Value
			
655: Call rstConfig.Close()
660: End If
		
665: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxInstallation").Value) Then
670: rstProjet.Fields("TauxInstallation").Value = rstSoum.Fields("TauxInstallation").Value
675: Else
680: Call rstConfig.Open("SELECT TauxInstallationElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
685: rstProjet.Fields("TauxInstallation").Value = rstConfig.Fields("TauxInstallationElec").Value
			
690: Call rstConfig.Close()
695: End If
		
700: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxMiseService").Value) Then
705: rstProjet.Fields("TauxMiseService").Value = rstSoum.Fields("TauxMiseService").Value
710: Else
715: Call rstConfig.Open("SELECT TauxMiseService FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
720: rstProjet.Fields("TauxMiseService").Value = rstConfig.Fields("TauxMiseService").Value
			
725: Call rstConfig.Close()
730: End If
		
735: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxFormation").Value) Then
740: rstProjet.Fields("TauxFormation").Value = rstSoum.Fields("TauxFormation").Value
745: Else
750: Call rstConfig.Open("SELECT TauxFormationElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
755: rstProjet.Fields("TauxFormation").Value = rstConfig.Fields("TauxFormationElec").Value
			
760: Call rstConfig.Close()
765: End If
		
770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxGestion").Value) Then
775: rstProjet.Fields("TauxGestion").Value = rstSoum.Fields("TauxGestion").Value
780: Else
785: Call rstConfig.Open("SELECT TauxGestionProjetsElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
790: rstProjet.Fields("TauxGestion").Value = rstConfig.Fields("TauxGestionProjetsElec").Value
			
795: Call rstConfig.Close()
800: End If
		
805: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstSoum.Fields("TauxShipping").Value) Then
810: rstProjet.Fields("TauxShipping").Value = rstSoum.Fields("TauxShipping").Value
815: Else
820: Call rstConfig.Open("SELECT TauxShippingElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
825: rstProjet.Fields("TauxShipping").Value = rstConfig.Fields("TauxShippingElec").Value
			
830: Call rstConfig.Close()
835: End If
		
840: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
845: rstProjet.Fields("PrixEmballage").Value = rstSoum.Fields("PrixEmballage").Value
		
850: rstProjet.Fields("imprevue").Value = rstSoum.Fields("imprevue").Value
855: rstProjet.Fields("commission").Value = rstSoum.Fields("commission").Value
860: rstProjet.Fields("Profit").Value = rstSoum.Fields("Profit").Value
865: rstProjet.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
870: rstProjet.Fields("total_commission").Value = rstSoum.Fields("total_Commission").Value
875: rstProjet.Fields("total_profit").Value = rstSoum.Fields("Total_Profit").Value
880: rstProjet.Fields("PrixTotal").Value = rstSoum.Fields("PrixTotal").Value
885: rstProjet.Fields("total_piece").Value = rstSoum.Fields("Total_piece").Value
890: rstProjet.Fields("total_imprevue").Value = rstSoum.Fields("total_imprevue").Value
895: rstProjet.Fields("total_temps").Value = rstSoum.Fields("total_temps").Value
900: rstProjet.Fields("SansTemps").Value = rstSoum.Fields("SansTemps").Value
905: rstProjet.Fields("MontantForfait").Value = rstSoum.Fields("MontantForfait").Value
910: rstProjet.Fields("InitialeForfait").Value = rstSoum.Fields("InitialeForfait").Value
915: rstProjet.Fields("ProchaineCommande").Value = 1
		
920: Call rstProjet.Update()
		
		'Ajout des pièces
925: Do While Not rstSoumPiece.EOF
930: If rstSoumPiece.Fields("TransfertJob").Value = True Then
935: Call rstProjetPiece.AddNew()
				
940: rstProjetPiece.Fields("Type").Value = "E"
				
945: rstProjetPiece.Fields("IDProjet").Value = sNoProjet
950: rstProjetPiece.Fields("IDSection").Value = rstSoumPiece.Fields("IDSection").Value
955: rstProjetPiece.Fields("NumItem").Value = rstSoumPiece.Fields("NumItem").Value
960: rstProjetPiece.Fields("Qté").Value = rstSoumPiece.Fields("Qté").Value
965: rstProjetPiece.Fields("Desc_FR").Value = rstSoumPiece.Fields("Desc_FR").Value
970: rstProjetPiece.Fields("Desc_EN").Value = rstSoumPiece.Fields("Desc_EN").Value
975: rstProjetPiece.Fields("Manufact").Value = rstSoumPiece.Fields("Manufact").Value
980: rstProjetPiece.Fields("Prix_List").Value = rstSoumPiece.Fields("Prix_list").Value
985: rstProjetPiece.Fields("Escompte").Value = rstSoumPiece.Fields("Escompte").Value
990: rstProjetPiece.Fields("Prix_net").Value = rstSoumPiece.Fields("Prix_net").Value
995: rstProjetPiece.Fields("OrdreSection").Value = rstSoumPiece.Fields("OrdreSection").Value
1000: rstProjetPiece.Fields("NuméroLigne").Value = rstSoumPiece.Fields("NuméroLigne").Value
1005: rstProjetPiece.Fields("IDFRS").Value = rstSoumPiece.Fields("IDFRS").Value
1010: rstProjetPiece.Fields("Temps").Value = rstSoumPiece.Fields("Temps").Value
1015: rstProjetPiece.Fields("Temps_total").Value = rstSoumPiece.Fields("Temps_Total").Value
1020: rstProjetPiece.Fields("Prix_total").Value = rstSoumPiece.Fields("Prix_Total").Value
1025: rstProjetPiece.Fields("Profit_argent").Value = rstSoumPiece.Fields("Profit_argent").Value
1030: rstProjetPiece.Fields("SousSection").Value = rstSoumPiece.Fields("SousSection").Value
1035: rstProjetPiece.Fields("PrixOrigine").Value = rstSoumPiece.Fields("PrixOrigine").Value
1040: rstProjetPiece.Fields("Visible").Value = rstSoumPiece.Fields("Visible").Value
1045: rstProjetPiece.Fields("Commentaire").Value = rstSoumPiece.Fields("Commentaire").Value
1050: rstProjetPiece.Fields("Quoté").Value = rstSoumPiece.Fields("Quoté").Value
1055: rstProjetPiece.Fields("Devise").Value = rstSoumPiece.Fields("Devise").Value
				
1060: Call rstProjetPiece.Update()
				
1065: If sLiaison <> "" Then
1070: If VB.Right(sNoProjet, 2) >= "60" And CDbl(VB.Right(sNoProjet, 2)) <= 79 Then
1075: 
1080: Else
1085: If CDbl(VB.Right(sNoProjet, 2)) >= 80 And CDbl(VB.Right(sNoProjet, 2)) <= 98 Then
1090: 
1095: End If
1100: End If
1105: End If
1110: End If
			
1115: Call rstSoumPiece.MoveNext()
1120: Loop 
		
1125: m_eType = enumType.TYPE_PROJET
		
1130: If CDbl(rstSoum.Fields("TempsInstallation").Value) > 0 Or CDbl(rstSoum.Fields("TempsMiseService").Value) > 0 Then
1135: Call CreerProjetInstallation(VB.Left(sNoProjet, 7) & "51")
1140: End If
		
1145: Call rstSoum.Close()
1150: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoum = Nothing
		
1155: Call rstProjet.Close()
1160: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
1165: Call rstSoumPiece.Close()
1170: 'UPGRADE_NOTE: Object rstSoumPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoumPiece = Nothing
		
1175: Call rstProjetPiece.Close()
1180: 'UPGRADE_NOTE: Object rstProjetPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjetPiece = Nothing
		
1185: Call CalculerTotalRecordset(sNoProjet)
		
1190: Exit Sub
		
AfficherErreur: 
		
1195: Call AfficherErreur("frmProjSoumElec", "TransfererSoumDansProjet", Err, Erl())
	End Sub
	
	Private Sub CreerProjetInstallation(ByVal sNoProjet As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstSoum As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstEmploye As ADODB.Recordset
25: Dim rstProjSoum As ADODB.Recordset
30: Dim rstConfig As ADODB.Recordset
35: Dim iCompteur As Short
		
40: rstSoum = New ADODB.Recordset
45: rstProjet = New ADODB.Recordset
50: rstEmploye = New ADODB.Recordset
55: rstProjSoum = New ADODB.Recordset
		
		'Ouverture de la soumission
60: Call rstSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Ouverture du projet
65: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
70: If rstProjet.EOF Then
75: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
80: If rstProjSoum.EOF Then
85: Call rstProjSoum.AddNew()
				
90: rstProjSoum.Fields("IDProjSoum").Value = sNoProjet
95: rstProjSoum.Fields("NoClient").Value = rstSoum.Fields("IDClient").Value
100: rstProjSoum.Fields("Description").Value = rstSoum.Fields("Description").Value
105: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
110: rstProjSoum.Fields("Ouvert").Value = True
115: rstProjSoum.Fields("Type").Value = "P"
				
120: Call rstProjSoum.Update()
125: End If
			
130: Call rstProjSoum.Close()
135: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
			'On l'ajoute
140: Call rstProjet.AddNew()
			
145: rstProjet.Fields("IDProjet").Value = sNoProjet
150: rstProjet.Fields("IDSoumission").Value = vbNullString
155: rstProjet.Fields("IDClient").Value = rstSoum.Fields("IDClient").Value
160: rstProjet.Fields("IDContact").Value = rstSoum.Fields("IDContact").Value
165: rstProjet.Fields("Description").Value = rstSoum.Fields("Description").Value
170: rstProjet.Fields("Panneau_aire").Value = rstSoum.Fields("Panneau_aire").Value
175: rstProjet.Fields("panneau_espace").Value = rstSoum.Fields("panneau_espace").Value
180: rstProjet.Fields("NbreManuel").Value = rstSoum.Fields("NbreManuel").Value
185: rstProjet.Fields("transport").Value = rstSoum.Fields("transport").Value
190: rstProjet.Fields("csa").Value = rstSoum.Fields("csa").Value
195: rstProjet.Fields("cul").Value = rstSoum.Fields("cul").Value
200: rstProjet.Fields("cur").Value = rstSoum.Fields("cur").Value
205: rstProjet.Fields("ul").Value = rstSoum.Fields("ul").Value
210: rstProjet.Fields("ur").Value = rstSoum.Fields("ur").Value
215: rstProjet.Fields("ce").Value = rstSoum.Fields("ce").Value
220: rstProjet.Fields("Delais").Value = rstSoum.Fields("Delais").Value
225: rstProjet.Fields("Creer").Value = ConvertDate(Today)
230: rstProjet.Fields("CheminPhotos").Value = rstSoum.Fields("CheminPhotos").Value
			
235: Call rstEmploye.Open("SELECT noEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
240: rstProjet.Fields("Creer_Par").Value = rstEmploye.Fields("noEmploye").Value
			
245: Call rstEmploye.Close()
250: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstEmploye = Nothing
			
255: rstProjet.Fields("TempsDessin").Value = 0
260: rstProjet.Fields("TempsFabrication").Value = 0
265: rstProjet.Fields("TempsAssemblage").Value = 0
270: rstProjet.Fields("TempsProgInterface").Value = 0
275: rstProjet.Fields("TempsProgAutomate").Value = 0
280: rstProjet.Fields("TempsProgRobot").Value = 0
285: rstProjet.Fields("TempsVision").Value = 0
290: rstProjet.Fields("TempsTest").Value = 0
295: rstProjet.Fields("TempsInstallation").Value = rstSoum.Fields("TempsInstallation").Value
300: rstProjet.Fields("TempsMiseService").Value = rstSoum.Fields("TempsMiseService").Value
305: rstProjet.Fields("TempsFormation").Value = 0
310: rstProjet.Fields("TempsGestion").Value = 0
315: rstProjet.Fields("TempsShipping").Value = 0
			
320: rstConfig = New ADODB.Recordset
			
325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxDessin").Value) Then
330: rstProjet.Fields("TauxDessin").Value = rstSoum.Fields("TauxDessin").Value
335: Else
340: Call rstConfig.Open("SELECT TauxDessinElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
345: rstProjet.Fields("TauxDessin").Value = rstConfig.Fields("TauxDessinElec").Value
				
350: Call rstConfig.Close()
355: End If
			
360: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxFabrication").Value) Then
365: rstProjet.Fields("TauxFabrication").Value = rstSoum.Fields("TauxFabrication").Value
370: Else
375: Call rstConfig.Open("SELECT TauxFabrication FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
380: rstProjet.Fields("TauxFabrication").Value = rstConfig.Fields("TauxFabrication").Value
				
385: Call rstConfig.Close()
390: End If
			
395: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxAssemblage").Value) Then
400: rstProjet.Fields("TauxAssemblage").Value = rstSoum.Fields("TauxAssemblage").Value
405: Else
410: Call rstConfig.Open("SELECT TauxAssemblageElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
415: rstProjet.Fields("TauxAssemblage").Value = rstConfig.Fields("TauxAssemblageElec").Value
				
420: Call rstConfig.Close()
425: End If
			
430: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxProgInterface").Value) Then
435: rstProjet.Fields("TauxProgInterface").Value = rstSoum.Fields("TauxProgInterface").Value
440: Else
445: Call rstConfig.Open("SELECT TauxProgInterface FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
450: rstProjet.Fields("TauxProgInterface").Value = rstConfig.Fields("TauxProgInterface").Value
				
455: Call rstConfig.Close()
460: End If
			
465: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxProgAutomate").Value) Then
470: rstProjet.Fields("TauxProgAutomate").Value = rstSoum.Fields("TauxProgAutomate").Value
475: Else
480: Call rstConfig.Open("SELECT TauxProgAutomate FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
485: rstProjet.Fields("TauxProgAutomate").Value = rstConfig.Fields("TauxProgAutomate").Value
				
490: Call rstConfig.Close()
495: End If
			
500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxProgRobot").Value) Then
505: rstProjet.Fields("TauxProgRobot").Value = rstSoum.Fields("TauxProgRobot").Value
510: Else
515: Call rstConfig.Open("SELECT TauxProgRobot FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
520: rstProjet.Fields("TauxProgRobot").Value = rstConfig.Fields("TauxProgRobot").Value
				
525: Call rstConfig.Close()
530: End If
			
535: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxVision").Value) Then
540: rstProjet.Fields("TauxVision").Value = rstSoum.Fields("TauxVision").Value
545: Else
550: Call rstConfig.Open("SELECT TauxVision FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
555: rstProjet.Fields("TauxVision").Value = rstConfig.Fields("TauxVision").Value
				
560: Call rstConfig.Close()
565: End If
			
570: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxTest").Value) Then
575: rstProjet.Fields("TauxTest").Value = rstSoum.Fields("TauxTest").Value
580: Else
585: Call rstConfig.Open("SELECT TauxTestElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
590: rstProjet.Fields("TauxTest").Value = rstConfig.Fields("TauxTestElec").Value
				
595: Call rstConfig.Close()
600: End If
			
605: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxInstallation").Value) Then
610: rstProjet.Fields("TauxInstallation").Value = rstSoum.Fields("TauxInstallation").Value
615: Else
620: Call rstConfig.Open("SELECT TauxInstallationElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
625: rstProjet.Fields("TauxInstallation").Value = rstConfig.Fields("TauxInstallationElec").Value
				
630: Call rstConfig.Close()
635: End If
			
640: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxMiseService").Value) Then
645: rstProjet.Fields("TauxMiseService").Value = rstSoum.Fields("TauxMiseService").Value
650: Else
655: Call rstConfig.Open("SELECT TauxMiseService FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
660: rstProjet.Fields("TauxMiseService").Value = rstConfig.Fields("TauxMiseService").Value
				
665: Call rstConfig.Close()
670: End If
			
675: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxFormation").Value) Then
680: rstProjet.Fields("TauxFormation").Value = rstSoum.Fields("TauxFormation").Value
685: Else
690: Call rstConfig.Open("SELECT TauxFormationElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
695: rstProjet.Fields("TauxFormation").Value = rstConfig.Fields("TauxFormationElec").Value
				
700: Call rstConfig.Close()
705: End If
			
710: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxGestion").Value) Then
715: rstProjet.Fields("TauxGestion").Value = rstSoum.Fields("TauxGestion").Value
720: Else
725: Call rstConfig.Open("SELECT TauxGestionProjetsElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
730: rstProjet.Fields("TauxGestion").Value = rstConfig.Fields("TauxGestionProjetsElec").Value
				
735: Call rstConfig.Close()
740: End If
			
745: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSoum.Fields("TauxShipping").Value) Then
750: rstProjet.Fields("TauxShipping").Value = rstSoum.Fields("TauxShipping").Value
755: Else
760: Call rstConfig.Open("SELECT TauxShippingElec FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
765: rstProjet.Fields("TauxShipping").Value = rstConfig.Fields("TauxShippingElec").Value
				
770: Call rstConfig.Close()
775: End If
			
780: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstConfig = Nothing
			
785: rstProjet.Fields("PrixEmballage").Value = 0
			
790: rstProjet.Fields("imprevue").Value = rstSoum.Fields("imprevue").Value
795: rstProjet.Fields("commission").Value = rstSoum.Fields("commission").Value
800: rstProjet.Fields("Profit").Value = rstSoum.Fields("Profit").Value
805: rstProjet.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
810: rstProjet.Fields("total_commission").Value = rstSoum.Fields("total_Commission").Value
815: rstProjet.Fields("total_profit").Value = rstSoum.Fields("Total_Profit").Value
820: rstProjet.Fields("PrixTotal").Value = rstSoum.Fields("PrixTotal").Value
825: rstProjet.Fields("total_piece").Value = rstSoum.Fields("Total_piece").Value
830: rstProjet.Fields("total_imprevue").Value = rstSoum.Fields("total_imprevue").Value
835: rstProjet.Fields("total_temps").Value = rstSoum.Fields("total_temps").Value
840: rstProjet.Fields("SansTemps").Value = rstSoum.Fields("SansTemps").Value
845: rstProjet.Fields("ProchaineCommande").Value = 1
			
850: Call rstProjet.Update()
855: End If
		
860: Call rstSoum.Close()
865: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoum = Nothing
		
870: Call rstProjet.Close()
875: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
880: Call CalculerTotalRecordset(sNoProjet)
		
885: Exit Sub
		
AfficherErreur: 
		
890: Call AfficherErreur("frmProjSoumElec", "CreerProjetInstallation", Err, Erl())
	End Sub
	
	Private Sub cmdDate_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdDate.Click
		
5: On Error GoTo AfficherErreur
		
		'Ouverture du calendrier
10: If Trim(txtDelais.Text) <> vbNullString Then
15: mvwDate.Value = CDate(txtDelais.Text)
20: Else
25: mvwDate.Value = Today
30: End If
		
35: mvwDate.Visible = True
		
40: Call mvwDate.Focus()
		
45: Exit Sub
		
AfficherErreur: 
		
50: Call AfficherErreur("frmProjSoumElec", "cmdDate_Click", Err, Erl())
	End Sub
	
	Private Sub cmdDateFacturation_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdDateFacturation.Click
		
5: On Error GoTo AfficherErreur
		
		'Ouverture du calendrier
10: If txtDateFacturation.Text <> vbNullString Then
15: mvwDateFacturation.Value = CDate(txtDateFacturation.Text)
20: Else
25: mvwDateFacturation.Value = Today
35: End If
		
40: mvwDateFacturation.Visible = True
		
45: Call mvwDateFacturation.Focus()
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumElec", "cmdDateFacturation_Click", Err, Erl())
	End Sub
	
	Private Sub cmdDemande_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdDemande.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
25: Call MsgBox("Vous ne pouvez pas commander de pièce à partir de ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
30: Exit Sub
35: End If
		
40: rstProjSoum = New ADODB.Recordset
		
45: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
50: If rstProjSoum.Fields("Ouvert").Value = True And rstProjSoum.Fields("Verrouillé").Value = False Then
55: If VerifierSiOuvert(sUser) = False Then
60: Call frmChoixDemande.AfficherProjetSoumission(txtNoProjSoum.Text, ModuleMain.enumCatalogue.ELECTRIQUE, frmChoixDemande.enumModeDemande.MODE_PIECE, m_eType)
65: Else
70: If m_eType = enumType.TYPE_PROJET Then
75: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
80: Else
85: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
90: End If
95: End If
100: Else
105: If rstProjSoum.Fields("Ouvert").Value = False Then
110: If m_eType = enumType.TYPE_PROJET Then
115: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
120: Else
125: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly, "Erreur")
130: End If
135: Else
140: If m_eType = enumType.TYPE_PROJET Then
145: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
150: Else
155: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly, "Erreur")
160: End If
165: End If
170: End If
		
175: Call rstProjSoum.Close()
180: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
185: Exit Sub
		
AfficherErreur: 
		
190: Call AfficherErreur("frmProjSoumElec", "cmdDemande_Click", Err, Erl())
	End Sub
	
	Private Sub cmdExtra_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdExtra.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim sNumero As String
15: Dim rstProjSoum As ADODB.Recordset
20: Dim bExiste As Boolean
25: Dim sExtension As String
30: Dim bNoValide As Boolean
		
35: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
40: Call MsgBox("Vous ne pouvez pas faire un extra à partir de ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
45: Exit Sub
50: End If
		
55: sExtension = VB.Right(txtNoProjSoum.Text, 2)
		
60: sNumero = InputBox("Quel est l'extension à ajouter au numéro " & VB.Left(txtNoProjSoum.Text, 6) & "?")
		
65: If sNumero <> vbNullString Then
70: If Not IsNumeric(sNumero) Then
75: Call MsgBox("Numéro non numérique!", MsgBoxStyle.OKOnly, "Erreur")
				
80: Exit Sub
85: End If
			
90: sNumero = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & sNumero
			
95: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
			
100: bNoValide = True
			
105: If ValiderFormatNumeroProjSoum(sNumero) = False Then
110: bNoValide = False
115: End If
			
120: If bNoValide = True Then
125: If ValiderFormatElectrique(sNumero) = False Then
130: bNoValide = False
135: End If
140: End If
			
145: If bNoValide = True Then
150: If ValiderFormatJobExtra(sNumero) = False Then
155: bNoValide = False
160: End If
165: End If
			
170: If bNoValide = False Then
175: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
180: Exit Sub
185: End If
			
190: sNumero = UCase(sNumero)
			
195: rstProjSoum = New ADODB.Recordset
			
200: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
205: If rstProjSoum.EOF Then
210: bExiste = False
215: Else
220: bExiste = True
				
225: Call MsgBox("Ce numéro existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
230: End If
			
235: Call rstProjSoum.Close()
			
240: If bExiste = False Then
245: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
250: If rstProjSoum.EOF Then
255: bExiste = False
260: Else
265: bExiste = True
					
270: Call MsgBox("Ce numéro existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
275: End If
				
280: Call rstProjSoum.Close()
285: End If
			
290: If bExiste = False Then
295: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
300: If rstProjSoum.EOF Then
305: bExiste = False
310: Else
315: bExiste = True
					
320: Call MsgBox("Ce numéro existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
325: End If
				
330: Call rstProjSoum.Close()
335: End If
			
340: If bExiste = False Then
345: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
350: If rstProjSoum.EOF Then
355: bExiste = False
360: Else
365: bExiste = True
					
370: Call MsgBox("Ce numéro existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
375: End If
				
380: Call rstProjSoum.Close()
385: End If
			
			'Si le projet ou la soumission n'existe pas
390: If bExiste = False Then
				'Pour pouvoir réafficher l'élément affiché avant l'ajout au cas où la personne
				'annule l'ajout
395: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
400: If Not rstProjSoum.EOF Then
405: If rstProjSoum.Fields("Ouvert").Value = False Then
410: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
						
415: Call rstProjSoum.Close()
420: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
425: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
430: Exit Sub
435: End If
440: End If
				
445: Call rstProjSoum.Close()
450: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
455: m_sAncienProjSoum = txtNoProjSoum.Text
				
460: Call InitialiserVariables(txtNoProjSoum.Text)
				
				'Affiche le nouveau numéro
465: txtNoProjSoum.Text = sNumero
				
470: If CDbl(VB.Right(sNumero, 2)) >= 60 And CDbl(VB.Right(sNumero, 2)) <= 98 Then
475: m_sLiaison = InputBox("Quelle est l'extention au projet " & VB.Left(txtNoProjSoum.Text, 6) & " auquel ce projet sera lié?",  , sExtension)
480: End If
				
485: m_bModeAjout = True
				
				'Vide le listview
490: Call lvwSoumission.Items.Clear()
				
				'On recalcul le prix
495: Call CalculerPrix()
				
				'Débarre les champs
500: Call BarrerChamps(False)
				
505: m_sTempsDessin = "0"
510: m_sTempsFabrication = "0"
515: m_sTempsAssemblage = "0"
520: m_sTempsProgInterface = "0"
525: m_sTempsProgAutomate = "0"
530: m_sTempsProgRobot = "0"
535: m_sTempsVision = "0"
540: m_sTempsTest = "0"
545: m_sTempsInstallation = "0"
550: m_sTempsMiseService = "0"
555: m_sTempsFormation = "0"
560: m_sTempsGestion = "0"
565: m_sTempsShipping = "0"
				
570: m_sNbrePersonne = "0"
575: m_sTempsHebergement = "0"
580: m_sTempsRepas = "0"
585: m_sTempsTransport = "0"
590: m_sTempsUniteMobile = "0"
595: m_sPrixEmballage = "0"
				
600: txtNbreManuel.Text = "0"
605: txtPrixManuel.Text = "0"
				
610: txtForfait.Text = ""
615: lblForfaitInitiale.Text = ""
				
620: txtPrixReception.Text = "0"
625: txtPrixSoumission.Text = "0"
				
630: txtPrixTotal.Text = "0"
635: txtProfit.Text = "0"
640: txtCommission.Text = "0"
645: txtTotalTemps.Text = "0"
650: txtTotalPieces.Text = "0"
655: txtImprevus.Text = "0"
660: txtNoSoumission.Text = vbNullString
				
				'Vide la valeur par défaut si demande Sous-Section
665: m_sSousSection = vbNullString
				
670: txtProjet.Text = vbNullString
				
675: m_bModeAjout = True
680: m_bModeAffichage = False
685: m_bExtra = True
				
690: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
695: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
				
				'Met le form en mode ajout/modif
700: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
705: End If
710: End If
		
715: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
720: Exit Sub
		
AfficherErreur: 
		
725: Call AfficherErreur("frmProjSoumElec", "cmdExtra_Click", Err, Erl())
	End Sub
	
	Private Sub cmdHistorique_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdHistorique.Click
		
5: On Error GoTo AfficherErreur
		
		'Ouverture de l'historique des modifications
10: If cmbProjSoum.Items.Count > 0 Then
15: Call RemplirListViewModifications()
			
20: lvwHistorique.Visible = True
			
25: Call lvwHistorique.Focus()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "cmdHistorique_Click", Err, Erl())
	End Sub
	
	Private Sub cmdBavards_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdBavards.Click
		
5: On Error GoTo AfficherErreur
		
		'Ouverture de l'historique des suppressions de pièces
10: If cmbProjSoum.Items.Count > 0 Then
15: Call RemplirListViewSuppression()
			
20: lvwBavard.Visible = True
			
25: Call lvwBavard.Focus()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "cmdBavards_Click", Err, Erl())
	End Sub
	
	Private Sub cmdLegende_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdLegende.Click
		
5: On Error GoTo AfficherErreur
		
10: Call OuvrirForm(frmLegende, True)
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmdLegende_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKDateRequise_MouseUp(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles cmdOKDateRequise.MouseUp
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.PixelsToTwipsX(eventArgs.X)
		Dim Y As Single = VB6.PixelsToTwipsY(eventArgs.Y)
		
5: On Error GoTo AfficherErreur
		
10: If m_bMonthViewHasFocus = True Then
15: Call cmdOKDateRequise_Click(cmdOKDateRequise, New System.EventArgs())
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumElec", "cmdOKDateRequise_MouseUp", Err, Erl())
	End Sub
	
	Private Sub cmdOKFRS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKFRS.Click
		
5: On Error GoTo AfficherErreur
		
10: If m_bPieceInutile = True Or m_bChangementFRS = True Then
15: Call ChoisirFournisseurMateriel()
20: Else
25: Call ChoisirFournisseur()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "cmdOKFRS_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKPieceTrouve_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKPieceTrouve.Click
		
5: On Error GoTo AfficherErreur
		
10: m_bRecherchePiece = True
15: m_bPieceInutile = False
		
		'On affiche lvwFournisseur selon la pièce choisie
		'Rempli les fournisseurs de la pièce choisie
20: Call AfficherListeFournisseurs()
		
		'si le listview n'est pas vide
25: If lvwfournisseur.Items.Count = 1 Then
30: If MsgBox("Il n'y a aucun fournisseur pour cette pièce!" & vbNewLine & "Voulez-vous en ajouter?", MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
35: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				
				'On ouvre le catalogue sur cet enregistrement
40: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call FrmCatalogueElec.AfficherForm(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_CATEGORIE).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text)
				
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
				'On rappelle la méthode
50: Call AfficherListeFournisseurs()
55: End If
60: End If
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumElec", "cmdOKPieceTrouve_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRafraichir_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRafraichir.Click
		
5: On Error GoTo AfficherErreur
		
10: If m_sTri <> vbNullString Then
15: m_sTri = vbNullString
			
20: Call RemplirListViewPieces()
25: End If
		
30: Exit Sub
		
AfficherErreur: 
		
35: Call AfficherErreur("frmProjSoumElec", "cmdRafraichir_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRapportFACT_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRapportFACT.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
20: Dim sNoFacture As String
		
25: If lvwSoumission.Items.Count > 0 Then
30: If txtNoProjSoum.Text <> vbNullString Then
35: If VerifierSiOuvert(sUser) = False Then
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					sNoFacture = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text
					
45: If VB.Left(sNoFacture, 2) = "F-" Or sNoFacture = "NC" Then
50: rstProjSoum = New ADODB.Recordset
						
						'Ouvre les tables
55: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "' ORDER BY IDProjet", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
						'***********************************************************************************
						'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
						'***********************************************************************************
						If MsgBox("Désirez-vous afficher les dates de réception et de commande?", MsgBoxStyle.YesNo, "Date de réception et de commande") = MsgBoxResult.Yes Then
							bFlag = True
						Else
							bFlag = False
						End If
						'***********************************************************************************
						
60: Call ImprimerProjSoumFacturation(rstProjSoum, sNoFacture)
65: Call ImprimerListePiecesFacturation(rstProjSoum, sNoFacture)
						
70: 'Call rstProjSoum.MoveNext
						
75: Call rstProjSoum.Close()
80: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
85: Else
90: Call MsgBox("La ligne sélectionnée ne contient aucune facture!", MsgBoxStyle.OKOnly, "Erreur")
95: End If
100: Else
105: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
110: End If
115: End If
120: Else
125: Call MsgBox("Ce projet ne contient aucune pièce à imprimer!", MsgBoxStyle.OKOnly, "Erreur")
130: End If
		
135: Exit Sub
		
AfficherErreur: 
		
140: Call AfficherErreur("frmProjSoumElec", "cmdImprimer_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRechercherClient_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRechercherClient.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim sRecherche As String
		
15: sRecherche = InputBox("Entrez le texte à rechercher.")
		
20: 'UPGRADE_ISSUE: StrPtr function is not supported. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="367764E5-F3F8-4E43-AC3E-7FE0B5E074E2"'
		If StrPtr(sRecherche) <> 0 Then
25: Call RemplirComboClients(sRecherche)
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "cmdRechercherClient_Click", Err, Erl())
	End Sub
	
	Private Sub cmdReset_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdReset.Click
		'Permet d'effacer le champs Modification et Par si c'est le user actuel
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
		
15: If MsgBox("Êtes-vous certains de ne pas être en modification sur un autre ordinateur?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
20: rstProjSoum = New ADODB.Recordset
			
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
			
50: rstProjSoum.Fields("Modification").Value = False
55: rstProjSoum.Fields("Par").Value = ""
			
60: Call rstProjSoum.Update()
			
65: Call rstProjSoum.Close()
70: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
75: cmdReset.Visible = False
80: End If
		
85: Exit Sub
		
AfficherErreur: 
		
90: Call AfficherErreur("frmProjSoumElec", "cmdReset_Click", Err, Erl())
	End Sub
	
	Private Sub cmdRetour_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdRetour.Click
		
5: On Error GoTo AfficherErreur
		
10: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
15: Call MsgBox("Vous ne pouvez pas faire de retour dans ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
20: Exit Sub
25: End If
		
30: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
35: Call frmRetourMarchandise.Afficher(txtNoProjSoum.Text, g_sUserID)
		
40: Call cmbProjSoum_SelectedIndexChanged(cmbProjSoum, New System.EventArgs())
		
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumElec", "cmdRetour_Click", Err, Erl())
	End Sub
	
	Private Sub cmdSortieMagasin_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdSortieMagasin.Click
		
5: On Error GoTo AfficherErreur
		
10: Call SortieMagasin()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "cmdSortieMagasin_Click", Err, Erl())
	End Sub
	
	Private Sub ChangerQuantite()
		
5: On Error GoTo AfficherErreur
		
10: Dim sQuantite As String
15: Dim itmSoum As System.Windows.Forms.ListViewItem
		
20: sQuantite = InputBox("Quelle est la nouvelle quantité?")
		
25: If IsNumeric(sQuantite) Then
30: itmSoum = lvwSoumission.FocusedItem
			
35: itmSoum.Text = sQuantite
			
40: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text) <> vbNullString Then
				'On calcul le temps * quantité pour la colonne montage
45: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))))
				End If
50: Else
55: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
60: End If
			
			'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
65: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
			End If
			
			'Pour le profit, c'est le prix total - (prix net * quantité)
70: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
75: Call CalculerTempsFabrication()
			
80: Call CalculerPrix()
85: End If
		
90: Exit Sub
		
AfficherErreur: 
		
95: Call AfficherErreur("frmProjSoumElec", "ChangerQuantite", Err, Erl())
	End Sub
	
	Private Sub SortieMagasin()
		
5: On Error GoTo AfficherErreur
		
10: Dim lColor As Integer
15: Dim sTag As String
		
20: If lvwSoumission.Items.Count > 0 Then
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
				'Si pas une section
30: If lvwSoumission.FocusedItem.Tag <> "" Then
					'Si pas une sous-section
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "" Then
						'Si ce n'est pas du Texte
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la pièce est noire ou gris
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_GRIS Then
								'Si la pièce est noire
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Then
									'On la met grise
55: lColor = COLOR_ORANGE
									
60: sTag = Replace(lvwSoumission.FocusedItem.Text, "*", "")
65: Else
70: lColor = COLOR_NOIR
									
75: sTag = ""
80: End If
								
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
100: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
135: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
								
140: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text = "" Then
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_FACTURATION Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text = " "
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
									End If
150: End If
								
155: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_FACTURATION).Tag = sTag
								
160: Call lvwSoumission.Refresh()
								
165: Call CalculerPrixReception()
170: End If
175: End If
180: End If
185: End If
190: Else
195: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
200: End If
205: End If
		
210: Exit Sub
		
AfficherErreur: 
		
215: Call AfficherErreur("frmProjSoumElec", "SortieMagasin", Err, Erl())
	End Sub
	
	Private Sub CalculerPrixReception()
		
5: On Error GoTo AfficherErreur
		
10: Dim dblPrixReception As Double
15: Dim iCompteur As Short
20: Dim itmProjet As System.Windows.Forms.ListViewItem
		
25: If m_bDroitPrix = True Then
			'Pour chaque ListItems du ListView
30: For iCompteur = 1 To lvwSoumission.Items.Count
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjet = lvwSoumission.Items.Item(iCompteur)
				
				'Si ce n'est pas une section
40: If itmProjet.Tag <> "" Then
					'Si ce n'est pas une sous-section
45: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "" Then
						'Si c'est pas du texte
50: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjet.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si c'est une réception
55: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_GRIS Then
60: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmProjet.SubItems.Item(I_COL_SOUM_FACTURATION).Tag <> "" Then
									'On ajoute le montant
65: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									dblPrixReception = System.Math.Round(dblPrixReception + (CDbl(itmProjet.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmProjet.SubItems.Item(I_COL_SOUM_FACTURATION).Tag, "*", ""))), 2)
70: Else
75: dblPrixReception = System.Math.Round(dblPrixReception, 2)
80: End If
85: Else
								'Si c'est un retour
90: 'UPGRADE_WARNING: Lower bound of collection itmProjet.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If System.Drawing.ColorTranslator.ToOle(itmProjet.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ROUGE Then
									'On soustrait le montant
95: 'UPGRADE_WARNING: Lower bound of collection itmProjet has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									dblPrixReception = System.Math.Round(dblPrixReception - (CDbl(itmProjet.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(Replace(itmProjet.Text, "-", ""), "*", ""))), 2)
100: End If
105: End If
110: End If
115: End If
120: End If
125: Next 
			
130: txtPrixReception.Text = Conversion_Renamed(dblPrixReception, ModuleMain.enumConvert.MODE_ARGENT)
135: Else
140: txtPrixReception.Text = ""
145: End If
		
150: Exit Sub
		
AfficherErreur: 
		
155: Call AfficherErreur("frmProjSoumElec", "CalculerPrixReception", Err, Erl())
	End Sub
	
	Private Sub cmdSupprimerFRS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdSupprimerFRS.Click
		'Permet d'effacer un Fournisseur
5: On Error GoTo AfficherErreur
		
10: Dim sPiece As String
		
		'Si c'est pas "Choisir ultérieurement"
15: If lvwfournisseur.FocusedItem.Text <> "CHOISIR ULTÉRIEUREMENT" Then
20: If m_bPieceInutile = True Then
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				sPiece = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text
30: Else
35: If m_bRecherchePiece = True Then
40: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					sPiece = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
45: Else
50: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					sPiece = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
55: End If
60: End If
			
65: If MsgBox("Voulez-vous vraiment supprimer le fournisseur " & lvwfournisseur.FocusedItem.Text & " pour la pièce " & sPiece & "?", MsgBoxStyle.YesNo, "Suppression") = MsgBoxResult.Yes Then
70: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call g_connData.Execute("DELETE * FROM GRB_PiecesFRS WHERE NoEnreg = " & lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_ENTRER_PAR).Tag)
				
75: Call RemplirListViewFournisseur()
				
80: frafournisseur.Visible = True
				
85: Call lvwfournisseur.Focus()
90: End If
95: End If
		
100: Exit Sub
		
AfficherErreur: 
		
105: Call AfficherErreur("frmProjSoumElec", "cmdSupprimerFRS_Click", Err, Erl())
	End Sub
	
	Private Sub cmdTemps_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdTemps.Click
		
5: On Error GoTo AfficherErreur
		
10: If cmbProjSoum.Items.Count > 0 Then
15: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
20: If m_bModeAjout = True Then
25: If m_bExtra = True Then
30: Call frmProjSoumElecTemps.Afficher(txtNoProjSoum.Text, m_eType, m_eMode, False)
35: Else
40: Call frmProjSoumElecTemps.Afficher(txtNoProjSoum.Text, m_eType, m_eMode, True)
45: End If
50: Else
55: Call frmProjSoumElecTemps.Afficher(txtNoProjSoum.Text, m_eType, m_eMode, False)
60: End If
65: Else
70: Call frmProjSoumElecTemps.Afficher(txtNoProjSoum.Text, m_eType, m_eMode, False)
75: End If
80: End If
		
85: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
90: Call CalculerPrix()
95: End If
		
100: m_bTempsDejaOuvert = True
		
105: Exit Sub
		
AfficherErreur: 
		
110: Call AfficherErreur("frmProjSoumElec", "cmdTemps_Click", Err, Erl())
	End Sub
	
	Private Sub cmdTexte_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdTexte.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim iIndex As Short
15: Dim sSousSection As String
20: Dim sTexte As String
		
		'Ajout de texte dans la soumission
25: If lvwSoumission.Items.Count > 0 Then
30: If lvwSoumission.FocusedItem.Index = 1 Then
35: sSousSection = InputBox("Quelle est la sous-section?")
				
40: If Trim(sSousSection) = "" Then
45: sSousSection = S_PAS_SOUS_SECTION
50: End If
				
55: sTexte = InputBox("Quel est le texte?")
				
60: If Trim(sTexte) <> "" Then
65: If Len(sTexte) > 255 Then
70: Call MsgBox("Le texte ne doit pas dépasser 255 caractères!", MsgBoxStyle.OKOnly, "Erreur")
75: Else
80: iIndex = TrouverIndexSection(sSousSection)
						
85: Call AjouterTexte(iIndex, sTexte, sSousSection)
90: End If
95: End If
100: Else
105: sTexte = InputBox("Quel est le texte?")
				
110: If Trim(sTexte) <> "" Then
115: If Len(sTexte) > 255 Then
120: Call MsgBox("Le texte ne doit pas dépasser 255 caractères!", MsgBoxStyle.OKOnly, "Erreur")
125: Else
130: iIndex = lvwSoumission.FocusedItem.Index
						
135: Call AjouterTexte(iIndex, sTexte, "")
140: End If
145: End If
150: End If
155: End If
		
160: Exit Sub
		
AfficherErreur: 
		
165: Call AfficherErreur("frmProjSoumElec", "cmdTexte_Click", Err, Erl())
	End Sub
	
	Private Sub AjouterTexte(ByVal iIndex As Short, ByVal sTexte As String, ByVal sNomSousSection As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour ajouter le texte
10: Dim sSousSection As String
15: Dim sOrdre As String
20: Dim sIDSection As String
		
		'S'il faut l'ajouter à la fin, on prend les infos du dernier enregistrement
25: If iIndex > lvwSoumission.Items.Count Then
30: If sNomSousSection = "" Then
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSousSection = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
40: Else
45: sSousSection = sNomSousSection
50: End If
			
55: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			sOrdre = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
60: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			sIDSection = lvwSoumission.Items.Item(iIndex - 1).Tag
65: Else
			'Si c'est une section
70: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iIndex).Tag = vbNullString Then
75: If sNomSousSection = "" Then
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sSousSection = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
85: Else
90: sSousSection = sNomSousSection
95: End If
				
100: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sOrdre = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sIDSection = lvwSoumission.Items.Item(iIndex - 1).Tag
110: Else
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
					'Si c'est pas la première sous-section
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iIndex - 1).Tag <> vbNullString Then
125: If sNomSousSection = "" Then
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							sSousSection = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
135: Else
140: sSousSection = sNomSousSection
145: End If
						
150: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sOrdre = lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
155: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sIDSection = lvwSoumission.Items.Item(iIndex).Tag
160: Else
165: Call MsgBox("Vous ne pouvez pas mettre du texte entre une section et une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
						
170: Exit Sub
175: End If
180: Else
185: If sNomSousSection = "" Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sSousSection = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_PIECE).Tag
195: Else
200: sSousSection = sNomSousSection
205: End If
					
210: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sOrdre = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
215: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sIDSection = lvwSoumission.Items.Item(iIndex).Tag
220: End If
225: End If
230: End If
		
235: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call lvwSoumission.Items.Insert(iIndex, "")
		
240: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call ValeurParDefaut(lvwSoumission.Items.Item(iIndex))
		
245: If m_eLangage = enumLangage.ANGLAIS Then
250: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_PIECE Then
				lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text = "Text"
			Else
				lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Text"))
			End If
255: Else
260: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_PIECE Then
				lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text = "Texte"
			Else
				lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Texte"))
			End If
265: End If
		
270: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_DESCR Then
			lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_DESCR).Text = sTexte
		Else
			lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sTexte))
		End If
		
		'ID de la section
275: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.Items.Item(iIndex).Tag = sIDSection
		
		'On ne peut pas écrire dans le tag si c'est vide
280: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.Items.Item(iIndex).SubItems.Count > I_COL_SOUM_MANUFACT Then
			lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_MANUFACT).Text = " "
		Else
			lvwSoumission.Items.Item(iIndex).SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
		End If
		
		'Ordre de la section
285: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_MANUFACT).Tag = sOrdre
		
		'Nom de la sous-section
290: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
		
295: Exit Sub
		
AfficherErreur: 
		
300: Call AfficherErreur("frmProjSoumElec", "AjouterTexte", Err, Erl())
	End Sub
	
	Private Sub cmdTri_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdTri.Click
		
5: On Error GoTo AfficherErreur
		
10: m_sTri = InputBox("Quel est le texte à trier?")
		
15: m_iCol = cmbTri.SelectedIndex
		
20: If m_sTri <> vbNullString Then
25: Call RemplirListViewPieces()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "cmdTri_Click", Err, Erl())
	End Sub
	
	Private Sub cmdPhotos_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdPhotos.Click
		
5: On Error GoTo AfficherErreur
		
10: If txtCheminPhotos.Text <> vbNullString Then
15: Call frmPhotoProjSoum.Afficher(txtCheminPhotos.Text)
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumElec", "cmdPhotos_Click", Err, Erl())
	End Sub
	
	Private Sub cmdReception_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdReception.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
15: Dim bOuvert As Boolean
		
20: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
25: Call MsgBox("Vous ne pouvez pas faire de réception pour ce projet!", MsgBoxStyle.OKOnly, "Erreur")
			
30: Exit Sub
35: End If
		
40: For iCompteur = 0 To My.Application.OpenForms.Count - 1
45: If My.Application.OpenForms.Item(iCompteur).Name = "FrmReceptionElec" Then
50: bOuvert = True
				
55: Exit For
60: End If
65: Next 
		
70: If bOuvert = True Then
75: Call FrmReceptionElec.Close()
80: End If
		
85: Call FrmReceptionElec.AfficherProjet(g_sUserID, txtNoProjSoum.Text)
		
90: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
95: Exit Sub
		
AfficherErreur: 
		
100: Call AfficherErreur("frmProjSoumElec", "cmdReception_Click", Err, Erl())
	End Sub
	
	Private Sub cmdBrowse_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdBrowse.Click
		
5: On Error GoTo AfficherErreur
		
10: Call OuvrirForm(frmChoixDossier, True)
		
15: If m_bAnnulerChemin = False Then
20: txtCheminPhotos.Text = m_sChemin
25: End If
		
30: Exit Sub
		
AfficherErreur: 
		
35: Call AfficherErreur("frmProjSoumElec", "cmdBrowse_Click", Err, Erl())
	End Sub
	
	Private Sub FrmProjSoumElec_FormClosing(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
		Dim Cancel As Boolean = eventArgs.Cancel
		Dim UnloadMode As System.Windows.Forms.CloseReason = eventArgs.CloseReason
		
5: On Error GoTo AfficherErreur
		
10: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
15: Call MsgBox("Veuillez enregistrer ou annuler avant de fermer!", MsgBoxStyle.OKOnly, "Erreur")
			
20: Cancel = 1
25: End If
		
30: Exit Sub
		
AfficherErreur: 
		
35: Call AfficherErreur("frmProjSoumElec", "Form_QueryUnload", Err, Erl())
		eventArgs.Cancel = Cancel
	End Sub
	
	'UPGRADE_WARNING: Event FrmProjSoumElec.Resize may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub FrmProjSoumElec_Resize(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles MyBase.Resize
		
5: On Error GoTo AfficherErreur
		
10: If VB6.PixelsToTwipsY(Me.Height) > I_HEIGHT_AFFICHAGE Then
15: If m_eMode = enumMode.MODE_INACTIF Then
20: lvwPieces.Width = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 375)
25: lvwSoumission.Width = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 375)
				
30: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - I_HEIGHT_AFFICHAGE)
35: lvwPieces.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
40: End If
			
45: cmdImprimer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
50: Cmdajouter.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
55: cmdModifier.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
60: cmdsupprimer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
65: Cmdfermer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
70: cmdEnregistrer.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
75: cmdAnnuler.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
80: cmdTexte.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
85: cmdCreerProjet.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
90: cmdCopier.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
95: cmdRetour.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
100: cmdBonCommande.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
105: cmdDemande.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
110: cmdAnglaisFrancais.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
115: cmdExtra.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
120: cmdCatalogue.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
125: cmdMaterielInutile.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
130: cmdReset.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
135: cmdMauvaisPrix.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
140: cmdRapportFACT.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
145: cmdSortieMagasin.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
150: cmdReception.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(Me.Height) - 825)
155: End If
		
160: Call PositionnerBoutons()
		
165: Exit Sub
		
AfficherErreur: 
		
170: Call AfficherErreur("frmProjSoumElec", "Form_Resize", Err, Erl())
	End Sub
	
	Private Sub PositionnerBoutons()
		
5: On Error GoTo AfficherErreur
		
10: Cmdfermer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 1230)
15: cmdModifier.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 2310)
20: cmdAnnuler.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 2310)
25: cmdEnregistrer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
30: cmdCatalogue.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
		
35: If m_eType = enumType.TYPE_PROJET Then
40: cmdMaterielInutile.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
45: cmdMauvaisPrix.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 8790)
50: cmdSortieMagasin.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 9870)
			
55: If m_bSupprimer = True Then
60: cmdsupprimer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
65: Cmdajouter.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 4470)
70: cmdBonCommande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 5550)
75: cmdDemande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
80: cmdExtra.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
85: cmdRetour.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 8790)
90: cmdReception.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 9870)
95: Else
100: Cmdajouter.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
105: cmdBonCommande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 4470)
110: cmdDemande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 5550)
115: cmdExtra.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
120: cmdRetour.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
125: cmdReception.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 8790)
130: End If
135: Else
140: cmdsupprimer.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 3390)
145: Cmdajouter.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 4470)
150: cmdCopier.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 5550)
155: cmdMauvaisPrix.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
160: cmdDemande.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 6630)
165: cmdCreerProjet.Left = VB6.TwipsToPixelsX(VB6.PixelsToTwipsX(Me.Width) - 7710)
170: End If
		
175: Exit Sub
		
AfficherErreur: 
		
180: Call AfficherErreur("frmProjSoumElec", "PositionnerBoutons", Err, Erl())
	End Sub
	
	Private Sub FrmProjSoumElec_FormClosed(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.FormClosedEventArgs) Handles Me.FormClosed
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_NOTE: Object FrmProjSoumElec may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		Me = Nothing
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "Form_Unload", Err, Erl())
	End Sub
	
	Private Sub lvwHistorique_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwHistorique.Leave
		
5: On Error GoTo AfficherErreur
		
		'Lorsque l'historique perd le focus, on l'enlève
10: lvwHistorique.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "lvwHistorique_LostFocus", Err, Erl())
	End Sub
	
	Private Sub lvwBavard_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwBavard.Leave
		
5: On Error GoTo AfficherErreur
		
		'Lorsque le bavard perd le focus, on l'enlève
10: lvwBavard.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "lvwBavard_LostFocus", Err, Erl())
	End Sub
	
	Private Sub lvwfournisseur_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles lvwfournisseur.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		'Permet d'effacer un Fournisseur
5: On Error GoTo AfficherErreur
		
10: Dim sPiece As String
		
15: If KeyCode = System.Windows.Forms.Keys.Delete Then
20: If g_bModificationCatalogueElec = True Then
				'Si c'est pas Choisir Ultérieurement
25: If lvwfournisseur.FocusedItem.Text <> "CHOISIR ULTÉRIEUREMENT" Then
30: If m_bPieceInutile = True Then
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						sPiece = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text
40: Else
45: If m_bRecherchePiece = True Then
50: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							sPiece = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
55: Else
60: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							sPiece = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
65: End If
70: End If
					
75: If MsgBox("Voulez-vous vraiment supprimer le fournisseur " & lvwfournisseur.FocusedItem.Text & " pour la pièce " & sPiece & "?", MsgBoxStyle.YesNo, "Suppression") = MsgBoxResult.Yes Then
80: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						Call g_connData.Execute("DELETE * FROM GRB_PiecesFRS WHERE NoEnreg = " & lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_ENTRER_PAR).Tag)
						
85: Call RemplirListViewFournisseur()
						
90: frafournisseur.Visible = True
						
95: Call lvwfournisseur.Focus()
100: End If
105: End If
110: End If
115: End If
		
120: Exit Sub
		
AfficherErreur: 
		
125: Call AfficherErreur("frmProjSoumElec", "lvwFournisseur_KeyDown", Err, Erl())
	End Sub
	
	Private Sub lvwPieces_ColumnClick(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.ColumnClickEventArgs) Handles lvwPieces.ColumnClick
		Dim ColumnHeader As System.Windows.Forms.ColumnHeader = lvwPieces.Columns(eventArgs.Column)
		
5: On Error GoTo AfficherErreur
		
10: Dim sTexte As String
		
15: sTexte = InputBox("Quel est le texte à rechercher?")
		
20: If Trim(sTexte) <> vbNullString Then
25: If Len(Trim(sTexte)) >= 2 Then
30: Call RemplirListViewRecherche(ColumnHeader.Index - 1, sTexte)
				
35: If lvwPieceTrouve.Items.Count > 0 Then
40: fraPieceTrouve.Visible = True
45: Else
50: Call MsgBox("Aucun enregistrements trouvés!", MsgBoxStyle.OKOnly, "Erreur")
55: End If
60: Else
65: Call MsgBox("Il faut un minimum de 2 caractères pour rechercher!", MsgBoxStyle.OKOnly, "Erreur")
70: End If
75: End If
		
80: Exit Sub
		
AfficherErreur: 
		
85: Call AfficherErreur("frmProjSoumElec", "lvwPieces_ColumnClick", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewRecherche(ByVal iIndexColumn As Short, ByVal sTexte As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim itmPiece As System.Windows.Forms.ListViewItem
20: Dim iCompteur As Short
25: Dim sChamps As String
30: Dim sRecherche As String
35: Dim sLettre As String
		
40: Call lvwPieceTrouve.Items.Clear()
		
45: If iIndexColumn = I_COL_PIECES_NO_ITEM Then
50: For iCompteur = 1 To Len(sTexte)
55: sLettre = Mid(sTexte, iCompteur, 1)
				
60: If (Asc(sLettre) >= 48 And Asc(sLettre) <= 57) Or (Asc(sLettre) >= 65 And Asc(sLettre) <= 90) Or (Asc(sLettre) >= 97 And Asc(sLettre) <= 122) Then
65: sRecherche = sRecherche & sLettre
70: End If
75: Next 
80: End If
		
		'Attribue le nom du champs selon la colonne cliquée
85: Select Case iIndexColumn
			Case I_COL_PIECES_PIECE_GRB : sChamps = "PIECE_GRB"
90: Case I_COL_PIECES_NO_ITEM : sChamps = "PIECE_MODIF"
95: Case I_COL_PIECES_DESCR_EN : sChamps = "DESC_EN"
100: Case I_COL_PIECES_DESCR_FR : sChamps = "DESC_FR"
105: Case I_COL_PIECES_MANUFACT : sChamps = "FABRICANT"
110: End Select
		
115: rstPiece = New ADODB.Recordset
		
120: If iIndexColumn = I_COL_PIECES_NO_ITEM Then
125: Call rstPiece.Open("SELECT * FROM GRB_CatalogueElec WHERE INSTR(1," & sChamps & ",'" & sRecherche & "') > 0 ", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
130: Else
135: Call rstPiece.Open("SELECT * FROM GRB_CatalogueElec WHERE INSTR(1," & sChamps & ",'" & Replace(sTexte, "'", "''") & "')> 0 ", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
140: End If
		
		'Pour chaque enregistrement
145: Do While Not rstPiece.EOF
			'On ajoute dans le ListView
150: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwPieceTrouve.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmPiece = lvwPieceTrouve.Items.Add()
			
155: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("TEMPS").Value) Then
160: itmPiece.Tag = rstPiece.Fields("TEMPS").Value
165: Else
170: itmPiece.Tag = vbNullString
175: End If
			
180: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("PIECE_GRB").Value) Then
185: itmPiece.Text = rstPiece.Fields("PIECE_GRB").Value
190: Else
195: itmPiece.Text = ""
200: End If
			
205: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmPiece.SubItems.Count > I_COL_RECH_NO_ITEM Then
				itmPiece.SubItems(I_COL_RECH_NO_ITEM).Text = rstPiece.Fields("PIECE").Value
			Else
				itmPiece.SubItems.Insert(I_COL_RECH_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("PIECE").Value))
			End If
210: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmPiece.SubItems.Count > I_COL_RECH_CATEGORIE Then
				itmPiece.SubItems(I_COL_RECH_CATEGORIE).Text = rstPiece.Fields("CATEGORIE").Value
			Else
				itmPiece.SubItems.Insert(I_COL_RECH_CATEGORIE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("CATEGORIE").Value))
			End If
			
215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("FABRICANT").Value) Then
220: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_MANUFACT Then
					itmPiece.SubItems(I_COL_RECH_MANUFACT).Text = rstPiece.Fields("FABRICANT").Value
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("FABRICANT").Value))
				End If
225: Else
230: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_MANUFACT Then
					itmPiece.SubItems(I_COL_RECH_MANUFACT).Text = ""
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
				End If
235: End If
			
240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("DESC_EN").Value) Then
245: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_EN Then
					itmPiece.SubItems(I_COL_RECH_DESCR_EN).Text = rstPiece.Fields("DESC_EN").Value
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("DESC_EN").Value))
				End If
250: Else
255: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_EN Then
					itmPiece.SubItems(I_COL_RECH_DESCR_EN).Text = ""
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
				End If
260: End If
			
265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPiece.Fields("DESC_FR").Value) Then
270: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_FR Then
					itmPiece.SubItems(I_COL_RECH_DESCR_FR).Text = rstPiece.Fields("DESC_FR").Value
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPiece.Fields("DESC_FR").Value))
				End If
275: Else
280: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmPiece.SubItems.Count > I_COL_RECH_DESCR_FR Then
					itmPiece.SubItems(I_COL_RECH_DESCR_FR).Text = ""
				Else
					itmPiece.SubItems.Insert(I_COL_RECH_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
				End If
285: End If
			
290: Call rstPiece.MoveNext()
295: Loop 
		
300: Call rstPiece.Close()
		
305: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
310: Exit Sub
		
AfficherErreur: 
		
315: Call AfficherErreur("frmProjSoumElec", "RemplirListViewRecherche", Err, Erl())
	End Sub
	
	Private Sub lvwPieces_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles lvwPieces.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
10: Dim sTexte As String
		
15: If Shift = VB6.ShiftConstants.CtrlMask Then
20: If KeyCode = System.Windows.Forms.Keys.F Then
25: sTexte = InputBox("Quel est le texte à rechercher?")
				
30: If Trim(sTexte) <> vbNullString Then
35: If Len(Trim(sTexte)) >= 2 Then
40: Call RemplirListViewRecherche(1, sTexte)
						
45: If lvwPieceTrouve.Items.Count > 0 Then
50: fraPieceTrouve.Visible = True
55: Else
60: Call MsgBox("Aucun enregistrements trouvés!", MsgBoxStyle.OKOnly, "Erreur")
65: End If
70: Else
75: Call MsgBox("Il faut un minimum de 2 caractères pour rechercher!", MsgBoxStyle.OKOnly, "Erreur")
80: End If
85: End If
90: End If
95: Else
100: If KeyCode = System.Windows.Forms.Keys.Return Then
105: Call lvwPieces_DoubleClick(lvwPieces, New System.EventArgs())
110: End If
115: End If
		
120: Exit Sub
		
AfficherErreur: 
		
125: Call AfficherErreur("frmProjSoumElec", "lvwPieces_KeyDown", Err, Erl())
	End Sub
	
	Private Sub lvwPieceTrouve_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwPieceTrouve.DoubleClick
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: m_bRecherchePiece = True
20: m_bPieceInutile = False
25: m_bChangementFRS = False
		
		'On affiche lvwFournisseur selon la pièce choisie
		'Rempli les fournisseurs de la pièce choisie
30: Call AfficherListeFournisseurs()
		
		'si le listview n'est pas vide
35: If lvwfournisseur.Items.Count = 1 Then
40: If MsgBox("Il n'y a aucun fournisseur pour cette pièce!" & vbNewLine & "Voulez-vous en ajouter?", MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
45: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				
				'On ouvre le catalogue sur cet enregistrement
50: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call FrmCatalogueElec.AfficherForm(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_CATEGORIE).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text)
				
55: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
				'On rappelle la méthode
60: Call AfficherListeFournisseurs()
65: End If
70: End If
		
75: Exit Sub
		
AfficherErreur: 
		
80: Call AfficherErreur("frmProjSoumElec", "lvwPieceTrouve_DblClick", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwSoumission.DoubleClick
		
5: On Error GoTo AfficherErreur
		
		'Si il y a des enregistrements
10: If lvwSoumission.Items.Count > 0 Then
15: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
				'Si c'est une sous-section
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
25: Call ModifierSousSection()
30: Else
					'Si c'est une pièce
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.FocusedItem.Tag <> vbNullString Then
						'Si la pièce n'est pas un Text ou Texte
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
							'Si la pièce n'a pas de fournisseur
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString Then
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = "" Then
55: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PROFIT Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = " "
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
									End If
60: End If
								
65: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
70: Call AjouterPrix()
75: Else
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
85: End If
90: Else
								'Si la pièce est en commande
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ORANGE Then
100: If MsgBox("Voulez-vous annuler cette commande?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
105: Call AnnulerCommande()
110: End If
115: Else
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
125: Call ChangerFournisseurRetour()
130: End If
135: End If
140: End If
145: Else
150: Call ModifierTexte()
155: End If
160: End If
165: End If
170: End If
175: End If
		
180: Exit Sub
		
AfficherErreur: 
		
185: Call AfficherErreur("frmProjSoumElec", "lvwSoumission_DblClick", Err, Erl())
	End Sub
	
	Private Sub AjouterPrix()
		
5: On Error GoTo AfficherErreur
		
10: Call ViderChamps_frs()
		
		'Rempli le combo des fournisseurs
15: Call RemplirComboFournisseur()
		
20: 'UPGRADE_ISSUE: ComboBox property cmbfrs.Locked was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		cmbfrs.Locked = False
		
25: m_bMauvaisPrix = False
		
		'Positionne le frame
30: fraPrixPiece.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Top) + 500)
		
		'Montre le frame
35: fraPrixPiece.Visible = True
		
		'Met le numéro de la pièce dans le tag
40: fraPrixPiece.Tag = lvwSoumission.FocusedItem.Index
		
		'Donne le focus au combo
45: Call cmbfrs.Focus()
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumElec", "AjouterPrix", Err, Erl())
	End Sub
	
	Private Sub ModifierTexte()
		
5: On Error GoTo AfficherErreur
		
10: Dim sTexte As String
		
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		sTexte = InputBox("Quel est le nouveau texte?",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text)
		
20: If sTexte <> "" Then
25: If Len(sTexte) > 255 Then
30: Call MsgBox("Le texte ne pas dépasser 255 caractères!", MsgBoxStyle.OKOnly, "Erreur")
35: Else
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DESCR Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text = sTexte
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sTexte))
				End If
45: End If
50: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumElec", "ModifierTexte", Err, Erl())
	End Sub
	
	Private Sub ModifierSousSection()
		
5: On Error GoTo AfficherErreur
		
10: Dim sSousSection As String
15: Dim sAncienneSS As String
20: Dim sTag As String
25: Dim iCompteur As Short
		
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		sSousSection = InputBox("Quel est le nouveau nom de la sous-section?",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text)
		
35: 'UPGRADE_ISSUE: StrPtr function is not supported. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="367764E5-F3F8-4E43-AC3E-7FE0B5E074E2"'
		If StrPtr(sSousSection) <> 0 Then
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			sAncienneSS = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text
			
45: If sAncienneSS = vbNullString Then
50: sAncienneSS = S_PAS_SOUS_SECTION
55: End If
			
60: If Trim(sSousSection) = vbNullString Then
65: sTag = S_PAS_SOUS_SECTION
70: sSousSection = vbNullString
75: Else
80: sTag = sSousSection
85: End If
			
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DESCR Then
				lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
			Else
				lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
			End If
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
			
100: For iCompteur = lvwSoumission.FocusedItem.Index + 1 To lvwSoumission.Items.Count
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag = sAncienneSS Then
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag = sTag
115: Else
120: Exit For
125: End If
130: Next 
135: End If
		
140: Exit Sub
		
AfficherErreur: 
		
145: Call AfficherErreur("frmProjSoumElec", "ModifierSousSection", Err, Erl())
	End Sub
	
	Private Sub ChangerFournisseurRetour()
		
5: On Error GoTo AfficherErreur
		
		'10      m_bPieceInutile = True
15: m_bRecherchePiece = False
20: m_bChangementFRS = True
		
25: Call AfficherListeFournisseurs()
		
30: If lvwfournisseur.Items.Count = 0 Then
35: Call MsgBox("Il n'y a aucun fournisseur pour cette pièce!", MsgBoxStyle.OKOnly, "Erreur")
			
40: Exit Sub
45: Else
50: frafournisseur.Visible = True
55: End If
		
60: Exit Sub
		
AfficherErreur: 
		
65: Call AfficherErreur("frmProjSoumElec", "ChangerFournisseurRetour", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_ItemCheck(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.ItemCheckEventArgs) Handles lvwSoumission.ItemCheck
		Dim Item As System.Windows.Forms.ListViewItem = lvwSoumission.Items(eventArgs.Index)
		
5: On Error GoTo AfficherErreur
		
		'Si le programme n'est pas en mode ajout ou modif
10: If m_eMode = enumMode.MODE_INACTIF Then
			'On annule le ItemCheck
15: Item.Checked = Not Item.Checked
20: Else
			'Si c'est une section, une sous-section ou du texte
25: 'UPGRADE_WARNING: Lower bound of collection Item has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Item.Tag = vbNullString Or Item.SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
				'On annule le ItemCheck
30: Item.Checked = Not Item.Checked
35: End If
40: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumElec", "lvwSoumission_ItemCheck", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_MouseDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.MouseEventArgs) Handles lvwSoumission.MouseDown
		Dim Button As Short = eventArgs.Button \ &H100000
		Dim Shift As Short = System.Windows.Forms.Control.ModifierKeys \ &H10000
		Dim X As Single = VB6.PixelsToTwipsX(eventArgs.X)
		Dim Y As Single = VB6.PixelsToTwipsY(eventArgs.Y)
		
5: On Error GoTo AfficherErreur
		
10: Dim iNbreSelected As Short
15: Dim iIndexSelected As Short
20: Dim iCompteur As Short
25: Dim bAfficherMenu As Boolean
		
30: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
35: If Button = VB6.MouseButtonConstants.RightButton Then
40: If lvwSoumission.Items.Count > 0 Then
					'S'il y a plusieurs items de sélectionnés, c'est parce que l'utilisateur
					'a sélectionné plusieurs items
					'Donc, on ne désélectionne pas
45: For iCompteur = 1 To lvwSoumission.Items.Count
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).Selected = True Then
55: iNbreSelected = iNbreSelected + 1
							
60: iIndexSelected = iCompteur
65: End If
70: Next 
					
75: If iNbreSelected = 1 Then
80: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.Items.Item(iIndexSelected).Selected = False
85: End If
					
90: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					lvwSoumission.DropHighlight = lvwSoumission.GetItemAt(X, Y)
					
95: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					If Not lvwSoumission.DropHighlight Is Nothing Then
100: If iNbreSelected = 1 Then
105: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							lvwSoumission.DropHighlight.Selected = True
							
110: If lvwSoumission.FocusedItem.Tag <> "" Then
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = "" Then
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PROFIT Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = " "
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
									End If
125: End If
								
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
135: bAfficherMenu = True
140: Else
145: bAfficherMenu = False
150: End If
155: End If
160: Else
165: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
							If lvwSoumission.DropHighlight.Selected = True Then
170: If lvwSoumission.FocusedItem.Tag <> "" Then
175: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
180: If g_bModificationFacturation = True Then
185: bAfficherMenu = True
190: Else
195: bAfficherMenu = False
200: End If
205: Else
210: bAfficherMenu = False
215: End If
220: Else
225: bAfficherMenu = False
230: End If
235: End If
240: End If
245: Else
250: bAfficherMenu = False
255: End If
					
260: If bAfficherMenu = True Then
265: Call RemplirOptionsMenuRightClick(iNbreSelected)
						
270: 'UPGRADE_ISSUE: Form method FrmProjSoumElec.PopupMenu was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						Call PopupMenu(mnuRightClick)
275: End If
280: End If
285: Else
290: If Shift <> VB6.ShiftConstants.CtrlMask And Shift <> VB6.ShiftConstants.ShiftMask Then
295: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					'UPGRADE_NOTE: Object lvwSoumission.DropHighlight may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					lvwSoumission.DropHighlight = Nothing
300: End If
305: End If
310: End If
		
315: Exit Sub
		
AfficherErreur: 
		
320: Call AfficherErreur("frmProjSoumElec", "lvwSoumission_MouseDown", Err, Erl())
	End Sub
	
	Private Sub RemplirOptionsMenuRightClick(ByVal iNbreSelected As Short)
		
5: On Error GoTo AfficherErreur
		
10: Dim bFacturer As Boolean
15: Dim bNC As Boolean
20: Dim bDateRequise As Boolean
25: Dim bCommentaire As Boolean
30: Dim bID As Boolean
35: Dim bMauvaisPrix As Boolean
40: Dim bMaterielInutile As Boolean
45: Dim bTexte As Boolean
50: Dim bSousSection As Boolean
55: Dim bFournisseur As Boolean
60: Dim bAnnulerCommande As Boolean
65: Dim bSupprimer As Boolean
70: Dim bAjouterPrix As Boolean
75: Dim bSortieMagasin As Boolean
80: Dim bChangerQuantite As Boolean
		
85: If iNbreSelected > 1 Then
90: If m_eType = enumType.TYPE_PROJET Then
95: If g_bModificationFacturation = True Then
100: bFacturer = True
105: bNC = True
110: bSupprimer = True
115: End If
120: Else
125: bSupprimer = True
130: End If
135: Else
			'Si c'est une sous-section
140: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = "" Then
145: bSousSection = True
150: Else
155: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
160: bTexte = True
					
165: If (m_eType = enumType.TYPE_SOUMISSION) Or ((m_eType = enumType.TYPE_PROJET) And (CDbl(VB.Right(txtNoProjSoum.Text, 2)) > 19)) Then
170: bSupprimer = True
175: End If
180: Else
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = -2147483640 Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(0)
195: End If
					
200: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					Select Case System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor)
						Case COLOR_ORANGE
205: If g_bModificationFacturation = True Then
210: bFacturer = True
215: bNC = True
220: End If
							
225: bID = True
230: bDateRequise = True
235: bCommentaire = True
240: bAnnulerCommande = True
245: bMauvaisPrix = True
							
						Case COLOR_BRUN
250: bCommentaire = True
255: bFournisseur = True
							
260: If (m_eType = enumType.TYPE_SOUMISSION) Or ((m_eType = enumType.TYPE_PROJET) And (CDbl(VB.Right(txtNoProjSoum.Text, 2)) > 19)) Then
265: bSupprimer = True
270: End If
							
						Case COLOR_GRIS
275: If g_bModificationFacturation = True Then
280: bFacturer = True
285: bNC = True
290: End If
							
295: bCommentaire = True
300: bID = True
305: bMauvaisPrix = True
310: bMaterielInutile = True
							
						Case COLOR_VERT_FORET
315: bCommentaire = True
							
320: If (m_eType = enumType.TYPE_SOUMISSION) Or ((m_eType = enumType.TYPE_PROJET) And (CDbl(VB.Right(txtNoProjSoum.Text, 2)) > 19)) Then
325: bSupprimer = True
330: End If
							
						Case COLOR_ROUGE
335: bCommentaire = True
							
						Case COLOR_MAGENTA
340: bCommentaire = True
345: bAjouterPrix = True
							
350: If m_eType = enumType.TYPE_PROJET Then
355: bID = True
360: End If
							
365: If m_eType = enumType.TYPE_SOUMISSION Then
370: bChangerQuantite = True
375: End If
							
						Case COLOR_NOIR
380: If m_eType = enumType.TYPE_PROJET Then
385: If g_bModificationFacturation = True Then
390: bFacturer = True
395: bNC = True
400: End If
								
405: bID = True
410: bMaterielInutile = True
415: bSortieMagasin = True
420: Else
425: bChangerQuantite = True
430: End If
							
435: bCommentaire = True
440: bMauvaisPrix = True
445: bFournisseur = True
450: bSupprimer = True
455: End Select
460: End If
465: End If
470: End If
		
		'Pour empeche que tous les éléments deviennent invisible, je les mets visible au
		'début
475: mnuFacturer.Visible = True
480: mnuNC.Visible = True
485: mnuDateRequise.Visible = True
490: mnuCommentaire.Visible = True
495: mnuID.Visible = True
500: mnuMauvaisPrix.Visible = True
505: mnuInutile.Visible = True
510: mnuTexte.Visible = True
515: mnuChangerSS.Visible = True
520: mnuFournisseur.Visible = True
525: mnuAnnulerCommande.Visible = True
530: mnuSupprimer.Visible = True
535: mnuAjouterPrix.Visible = True
540: mnuSortieMagasin.Visible = True
545: mnuQuantite.Visible = True
		
550: mnuFacturer.Visible = bFacturer
555: mnuNC.Visible = bNC
560: mnuDateRequise.Visible = bDateRequise
565: mnuCommentaire.Visible = bCommentaire
570: mnuID.Visible = bID
575: mnuMauvaisPrix.Visible = bMauvaisPrix
580: mnuInutile.Visible = bMaterielInutile
585: mnuTexte.Visible = bTexte
590: mnuChangerSS.Visible = bSousSection
595: mnuFournisseur.Visible = bFournisseur
600: mnuAnnulerCommande.Visible = bAnnulerCommande
605: mnuSupprimer.Visible = bSupprimer
610: mnuAjouterPrix.Visible = bAjouterPrix
615: mnuSortieMagasin.Visible = bSortieMagasin
620: mnuQuantite.Visible = bChangerQuantite
		
625: Exit Sub
		
AfficherErreur: 
		
630: Call AfficherErreur("frmProjSoumElec", "RemplirOptionsMenuRightClick", Err, Erl())
	End Sub
	
	Public Sub mnuAjouterPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuAjouterPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: Call AjouterPrix()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuAjouterPrix_Click", Err, Erl())
	End Sub
	
	Public Sub mnuAnnulerCommande_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuAnnulerCommande.Click
		
5: On Error GoTo AfficherErreur
		
10: Call AnnulerCommande()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuAnnulerCommande_Click", Err, Erl())
	End Sub
	
	Public Sub mnuChangerSS_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuChangerSS.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ModifierSousSection()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuChangerSS_Click", Err, Erl())
	End Sub
	
	Public Sub mnuDateRequise_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuDateRequise.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If Trim(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text) = "" Then
15: mvwDateRequise.Year = Year(Today)
20: mvwDateRequise.Month = Month(Today)
25: mvwDateRequise.Day = VB.Day(Today)
30: Else
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			mvwDateRequise.Year = CShort(VB.Left(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text, 4))
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			mvwDateRequise.Month = CShort(Mid(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text, 6, 2))
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			mvwDateRequise.Day = CShort(VB.Right(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DATE_REQUISE).Text, 2))
50: End If
		
55: fraDateRequise.Top = lvwSoumission.Top
		
60: fraDateRequise.Visible = True
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumElec", "mnuDateRequise_Click", Err, Erl())
	End Sub
	
	Public Sub mnuCommentaire_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuCommentaire.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		txtcommentaire.Text = lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_COMMENTAIRE).Text
		
15: fraCommentaire.Top = lvwSoumission.Top
		
20: fraCommentaire.Visible = True
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumElec", "mnuCommentaire_Click", Err, Erl())
	End Sub
	
	Public Sub mnuFacturer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuFacturer.Click
		
5: On Error GoTo AfficherErreur
		
10: Call FacturerDate()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuFacturer_Click", Err, Erl())
	End Sub
	
	Public Sub mnuFournisseur_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuFournisseur.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ChangerFournisseurRetour()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuFournisseur_Click", Err, Erl())
	End Sub
	
	Public Sub mnuID_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuID.Click
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ID Then
			lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ID).Text = InputBox("Quel est l'ID",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ID).Text)
		Else
			lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, InputBox("Quel est l'ID",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ID).Text)))
		End If
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuID_Click", Err, Erl())
	End Sub
	
	Public Sub mnuInutile_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuInutile.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MaterielInutile()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuInutile_Click", Err, Erl())
	End Sub
	
	Public Sub mnuMauvaisPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuMauvaisPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: Call MauvaisPrix()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuMauvaisPrix", Err, Erl())
	End Sub
	
	Public Sub mnuNC_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuNC.Click
		
5: On Error GoTo AfficherErreur
		
10: Call FacturerNC()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuNC_Click", Err, Erl())
	End Sub
	
	Public Sub mnuQuantite_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuQuantite.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ChangerQuantite()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuQuantite_Click", Err, Erl())
	End Sub
	
	Public Sub mnuSortieMagasin_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuSortieMagasin.Click
		
5: On Error GoTo AfficherErreur
		
10: Call SortieMagasin()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuSortieMagasin_Click", Err, Erl())
	End Sub
	
	Public Sub mnuSupprimer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuSupprimer.Click
		
5: On Error GoTo AfficherErreur
		
10: Call EffacerItemListViewSoumission()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuSupprimer_Click", Err, Erl())
	End Sub
	
	Public Sub mnuTexte_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mnuTexte.Click
		
5: On Error GoTo AfficherErreur
		
10: Call ModifierTexte()
		
15: Call EnleverSelection()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mnuTexte_Click", Err, Erl())
	End Sub
	
	Private Sub EnleverSelection()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: 'UPGRADE_ISSUE: MSComctlLib.ListView property lvwSoumission.DropHighlight was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		'UPGRADE_NOTE: Object lvwSoumission.DropHighlight may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		lvwSoumission.DropHighlight = Nothing
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "EnleverSelection", Err, Erl())
	End Sub
	
	Private Sub mvwDate_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mvwDate.Leave
		
5: On Error GoTo AfficherErreur
		
		'Quand le calendrier perd le focus, il faut l'enlever
10: mvwDate.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "mvwDate_LostFocus", Err, Erl())
	End Sub
	
	Private Sub mvwDateFacturation_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mvwDateFacturation.Leave
		
5: On Error GoTo AfficherErreur
		
		'Quand le calendrier perd le focus, il faut l'enlever
10: mvwDateFacturation.Visible = False
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "mvwDateFacturation_LostFocus", Err, Erl())
	End Sub
	
	Private Sub mvwDate_DateClick(ByVal eventSender As System.Object, ByVal eventArgs As AxMSComCtl2.DMonthViewEvents_DateClickEvent) Handles mvwDate.DateClick
		
5: On Error GoTo AfficherErreur
		
		'Affiche la date dans le TextBox sous le format AAAA-MM-JJ
10: txtDelais.Text = ConvertDate(eventArgs.DateClicked)
		
		'Enlever le calendrier
15: mvwDate.Visible = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mvwDate_DateClick", Err, Erl())
	End Sub
	
	Private Sub mvwDateFacturation_DateClick(ByVal eventSender As System.Object, ByVal eventArgs As AxMSComCtl2.DMonthViewEvents_DateClickEvent) Handles mvwDateFacturation.DateClick
		
5: On Error GoTo AfficherErreur
		
		'Affiche la date dans le TextBox sous le format AAAA-MM-JJ
10: txtDateFacturation.Text = ConvertDate(eventArgs.DateClicked)
		
		'Enlever le calendrier
15: mvwDateFacturation.Visible = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "mvwDateFacturation_DateClick", Err, Erl())
	End Sub
	
	Private Sub cmdEnregistrer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdEnregistrer.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim objControl As System.Windows.Forms.Control
15: Dim sMessage As String
		
20: frafournisseur.Visible = False
25: fraPieceTrouve.Visible = False
30: fraCommentaire.Visible = False
35: fraDateRequise.Visible = False
		
		'Vérification des textbox
40: For	Each objControl In Me.Controls
45: 'UPGRADE_WARNING: TypeOf has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
			If TypeOf objControl Is System.Windows.Forms.TextBox Then
50: If objControl.Visible = True Then
55: If objControl.Name <> "txtNoSoumission" And objControl.Name <> "txtCheminPhotos" And objControl.Name <> "txtPrixReception" And objControl.Name <> "txtDateFacturation" And objControl.Name <> "txtPrixSoumission" And objControl.Name <> "txtDelais" And objControl.Name <> "txtForfait" Then
60: If Trim(objControl.Text) = vbNullString Then
65: Call MsgBox("Vous devez remplir tous les champs!", MsgBoxStyle.OKOnly, "Erreur")
							
70: Exit Sub
75: End If
80: End If
85: End If
90: Else
95: 'UPGRADE_WARNING: TypeOf has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="9B7D5ADD-D8FE-4819-A36C-6DEDAF088CC7"'
				If TypeOf objControl Is System.Windows.Forms.ComboBox Then
100: If objControl.Visible = True Then
105: 'UPGRADE_WARNING: Couldn't resolve default property of object objControl.ListIndex. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If objControl.ListIndex = -1 Then
110: If objControl.Name <> "cmbTri" And objControl.Name <> "cmbSections" And objControl.Name <> "cmbPieces" Then
115: Call MsgBox("Vous devez remplir tous les champs!", MsgBoxStyle.OKOnly, "Erreur")
								
120: Exit Sub
125: End If
130: End If
135: End If
140: End If
145: End If
150: Next objControl
		
		'Vérification du transport
155: If cmbtransport.SelectedIndex = -1 Then
160: Call MsgBox("Vous devez choisir le transport!", MsgBoxStyle.OKOnly, "Erreur")
			
165: Exit Sub
170: End If
		
175: If m_eType = enumType.TYPE_SOUMISSION Then
180: If CDbl(m_sTempsTest) = 0 Or CDbl(m_sTempsDessin) = 0 Then
185: If MsgBox("Les temps de dessin ou de test sont vides" & vbNewLine & "Voulez - vous l'enregistrer?", MsgBoxStyle.YesNo) = MsgBoxResult.No Then
190: Exit Sub
195: End If
200: End If
205: End If
		
210: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
215: If BackupPieces(txtNoProjSoum.Text) = False Then
220: If m_eType = enumType.TYPE_PROJET Then
225: sMessage = "Une erreur est survenue lors de la copie de sauvegarde du projet en cours!"
230: Else
235: sMessage = "Une erreur est survenue lors de la copie de sauvegarde de la soumission en cours!"
240: End If
			
245: sMessage = sMessage & vbNewLine & vbNewLine & "Voulez-vous continuer ?"
			
250: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
			
255: If MsgBox(sMessage, MsgBoxStyle.YesNo) = MsgBoxResult.No Then
260: Exit Sub
265: Else
270: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
275: End If
280: End If
		
		'Enregistre la soumission
285: Call EnregistrerProjSoum(txtNoProjSoum.Text)
		
290: Call OuvrirProjSoum(False)
		
		'Remet en mode inactif
295: Call AfficherControles(enumMode.MODE_INACTIF)
		
300: m_bEnregistrement = True
		
		'Affiche la soumission actuel
305: Call AfficherProjSoum(txtNoProjSoum.Text)
		
310: m_bEnregistrement = False
		
315: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
320: Exit Sub
		
AfficherErreur: 
		
325: Call AfficherErreur("frmProjSoumElec", "cmdEnregistrer_Click", Err, Erl())
	End Sub
	
	Private Sub EnregistrerFACT(ByVal sNoProjet As String)
		'Calcul le total de chaque facture dans le projet
5: On Error GoTo AfficherErreur
		
10: Dim rstModif As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim sPrixTotal As String
25: Dim sProfit As String
30: Dim sCommission As String
35: Dim sNoFacture As String
40: Dim sTempsFab As String
45: Dim sTotalPiece As String
50: Dim sImprevue As String
55: Dim sTotalTemps As String
60: Dim sManuel As String
65: Dim iCompteur As Short
70: Dim iIndexFacture As Short
75: Dim collFacture As Collection
80: Dim bExiste As Boolean
		
85: collFacture = New Collection
		
90: Call g_connData.Execute("DELETE * FROM GRB_Projet_Modif WHERE IDProjet = '" & sNoProjet & "' AND Type = 'E' AND TypeModif = 'FACTURATION'")
		
95: If lvwSoumission.Items.Count > 0 Then
100: rstModif = New ADODB.Recordset
105: rstEmploye = New ADODB.Recordset
			
110: For iCompteur = 1 To lvwSoumission.Items.Count
115: bExiste = False
				
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				sNoFacture = lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text
				
125: If Trim(sNoFacture) <> "" Then
130: For iIndexFacture = 1 To collFacture.Count()
135: 'UPGRADE_WARNING: Couldn't resolve default property of object collFacture(iIndexFacture). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						If collFacture.Item(iIndexFacture) = sNoFacture Then
140: bExiste = True
							
145: Exit For
150: End If
155: Next 
					
160: If bExiste = False Then
165: Call collFacture.Add(sNoFacture)
						
170: Call CalculerPrixFacturation(sNoFacture, sCommission, sPrixTotal, sProfit, sTempsFab, sTotalPiece, sImprevue, sTotalTemps, sManuel)
						
175: Call rstModif.Open("SELECT * FROM GRB_Projet_Modif WHERE [Date] = '" & Replace(sNoFacture, "F-", "") & "' AND TypeModif = 'FACTURATION'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
180: If rstModif.EOF Then
185: Call rstModif.AddNew()
190: End If
						
195: rstModif.Fields("IDProjet").Value = txtNoProjSoum.Text
						
200: Call rstEmploye.Open("SELECT * FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
205: rstModif.Fields("NoEmployé").Value = rstEmploye.Fields("NoEmploye").Value
						
210: Call rstEmploye.Close()
						
215: rstModif.Fields("Date").Value = Replace(sNoFacture, "F-", "")
220: rstModif.Fields("Heure").Value = " "
225: rstModif.Fields("Type").Value = "E"
230: rstModif.Fields("TypeModif").Value = "FACTURATION"
235: rstModif.Fields("Valeur").Value = sPrixTotal
						
240: Call rstModif.Update()
						
245: Call rstModif.Close()
250: End If
255: End If
260: Next 
			
265: 'UPGRADE_NOTE: Object rstModif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstModif = Nothing
270: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstEmploye = Nothing
275: End If
		
280: Exit Sub
		
AfficherErreur: 
		
285: Call AfficherErreur("frmProjSoumElec", "EnregistrerFACT", Err, Erl())
	End Sub
	
	Private Function BackupPieces(ByVal sNoProjSoum As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstProjSoumBackup As ADODB.Recordset
20: Dim sDateCopie As String
		
25: rstProjSoum = New ADODB.Recordset
30: rstProjSoumBackup = New ADODB.Recordset
		
35: If m_eType = enumType.TYPE_PROJET Then
40: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
45: Call rstProjSoumBackup.Open("SELECT * FROM GRB_Projet_Pieces_Tampon", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: Else
55: Call rstProjSoum.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
60: Call rstProjSoumBackup.Open("SELECT * FROM GRB_Soumission_Pieces_Tampon", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
65: End If
		
70: sDateCopie = ConvertDate(Today) & " " & TimeOfDay
		
75: Do While Not rstProjSoum.EOF
80: Call rstProjSoumBackup.AddNew()
			
85: rstProjSoumBackup.Fields("DateCopie").Value = sDateCopie
			
90: If m_eType = enumType.TYPE_PROJET Then
95: rstProjSoumBackup.Fields("IDProjet").Value = rstProjSoum.Fields("IDProjet").Value
100: Else
105: rstProjSoumBackup.Fields("IDSoumission").Value = rstProjSoum.Fields("IDSoumission").Value
110: End If
			
115: rstProjSoumBackup.Fields("Initiales").Value = g_sInitiale
120: rstProjSoumBackup.Fields("IDSection").Value = rstProjSoum.Fields("IDSection").Value
125: rstProjSoumBackup.Fields("NumItem").Value = rstProjSoum.Fields("NumItem").Value
130: rstProjSoumBackup.Fields("Qté").Value = rstProjSoum.Fields("Qté").Value
135: rstProjSoumBackup.Fields("Desc_FR").Value = rstProjSoum.Fields("Desc_FR").Value
140: rstProjSoumBackup.Fields("Desc_EN").Value = rstProjSoum.Fields("Desc_EN").Value
145: rstProjSoumBackup.Fields("Manufact").Value = rstProjSoum.Fields("Manufact").Value
150: rstProjSoumBackup.Fields("Prix_list").Value = rstProjSoum.Fields("Prix_list").Value
155: rstProjSoumBackup.Fields("Escompte").Value = rstProjSoum.Fields("Escompte").Value
160: rstProjSoumBackup.Fields("Prix_net").Value = rstProjSoum.Fields("Prix_net").Value
165: rstProjSoumBackup.Fields("IDFRS").Value = rstProjSoum.Fields("IDFRS").Value
170: rstProjSoumBackup.Fields("Temps").Value = rstProjSoum.Fields("Temps").Value
175: rstProjSoumBackup.Fields("Temps_total").Value = rstProjSoum.Fields("Temps_total").Value
180: rstProjSoumBackup.Fields("Prix_total").Value = rstProjSoum.Fields("Prix_total").Value
185: rstProjSoumBackup.Fields("Profit_Argent").Value = rstProjSoum.Fields("Profit_Argent").Value
190: rstProjSoumBackup.Fields("sousSection").Value = rstProjSoum.Fields("sousSection").Value
195: rstProjSoumBackup.Fields("OrdreSection").Value = rstProjSoum.Fields("OrdreSection").Value
200: rstProjSoumBackup.Fields("NuméroLigne").Value = rstProjSoum.Fields("NuméroLigne").Value
205: rstProjSoumBackup.Fields("PrixOrigine").Value = rstProjSoum.Fields("PrixOrigine").Value
210: rstProjSoumBackup.Fields("Type").Value = rstProjSoum.Fields("Type").Value
215: rstProjSoumBackup.Fields("Visible").Value = rstProjSoum.Fields("Visible").Value
220: rstProjSoumBackup.Fields("Commandé").Value = rstProjSoum.Fields("Commandé").Value
225: rstProjSoumBackup.Fields("Quoté").Value = rstProjSoum.Fields("Quoté").Value
230: rstProjSoumBackup.Fields("Recu").Value = rstProjSoum.Fields("Recu").Value
235: rstProjSoumBackup.Fields("Retour").Value = rstProjSoum.Fields("Retour").Value
240: rstProjSoumBackup.Fields("CommandeAnnulée").Value = rstProjSoum.Fields("CommandeAnnulée").Value
245: rstProjSoumBackup.Fields("ID").Value = rstProjSoum.Fields("ID").Value
250: rstProjSoumBackup.Fields("PieceExtra").Value = rstProjSoum.Fields("PieceExtra").Value
255: rstProjSoumBackup.Fields("PieceExtraChargeable").Value = rstProjSoum.Fields("PieceExtraChargeable").Value
260: rstProjSoumBackup.Fields("PieceExtraNonChargeable").Value = rstProjSoum.Fields("PieceExtraNonChargeable").Value
265: rstProjSoumBackup.Fields("MatérielInutile").Value = rstProjSoum.Fields("MatérielInutile").Value
270: rstProjSoumBackup.Fields("Commentaire").Value = rstProjSoum.Fields("Commentaire").Value
275: rstProjSoumBackup.Fields("Devise").Value = rstProjSoum.Fields("Devise").Value
			
280: If m_eType = enumType.TYPE_PROJET Then
285: rstProjSoumBackup.Fields("NoRetour").Value = rstProjSoum.Fields("NoRetour").Value
290: rstProjSoumBackup.Fields("DateRéception").Value = rstProjSoum.Fields("DateRéception").Value
295: rstProjSoumBackup.Fields("QuantitéRecue").Value = rstProjSoum.Fields("QuantitéRecue").Value
300: rstProjSoumBackup.Fields("Facturation").Value = rstProjSoum.Fields("Facturation").Value
305: rstProjSoumBackup.Fields("DateCommande").Value = rstProjSoum.Fields("DateCommande").Value
310: rstProjSoumBackup.Fields("DateRequise").Value = rstProjSoum.Fields("DateRequise").Value
315: rstProjSoumBackup.Fields("NomCommande").Value = rstProjSoum.Fields("NomCommande").Value
320: rstProjSoumBackup.Fields("NoSéquentiel").Value = rstProjSoum.Fields("NoSéquentiel").Value
325: rstProjSoumBackup.Fields("DateRetour").Value = rstProjSoum.Fields("DateRetour").Value
330: End If
			
335: rstProjSoumBackup.Fields("Provenance").Value = rstProjSoum.Fields("Provenance").Value
			
340: Call rstProjSoumBackup.Update()
			
345: Call rstProjSoum.MoveNext()
350: Loop 
		
355: Call rstProjSoum.Close()
360: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
365: Call rstProjSoumBackup.Close()
370: 'UPGRADE_NOTE: Object rstProjSoumBackup may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoumBackup = Nothing
		
375: BackupPieces = True
		
380: Exit Function
		
AfficherErreur: 
		
385: Call AfficherErreur("frmProjSoumElec", "BackupPieces", Err, Erl())
	End Function
	
	Private Sub EnregistrerProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstPiece As ADODB.Recordset
20: Dim rstEmploye As ADODB.Recordset
25: Dim rstModif As ADODB.Recordset
30: Dim rstOuvert As ADODB.Recordset
35: Dim rstSection As ADODB.Recordset
40: Dim rstPunch As ADODB.Recordset
45: Dim iCompteur As Short
50: Dim itmPiece As System.Windows.Forms.ListViewItem
55: Dim sTable As String
60: Dim sTableModif As String
65: Dim sTablePiece As String
70: Dim sChamps As String
75: Dim sSection As String
80: Dim sExtra As String
85: Dim bCalculExtra As Boolean
90: Dim collExtra As Collection
95: Dim iCompteurExtra As Short
100: Dim bExiste As Boolean
105: Dim bAjoutCommande As Boolean
110: Dim dblNbrePers As Double
115: Dim dblJoursHebergement As Double
120: Dim dblJoursRepas As Double
125: Dim dblHebergement1 As Double
130: Dim dblHebergement2 As Double
135: Dim dblRepas As Double
140: Dim dblTotalHebergement As Double
		
145: rstProjSoum = New ADODB.Recordset
150: rstPiece = New ADODB.Recordset
155: rstEmploye = New ADODB.Recordset
160: rstModif = New ADODB.Recordset
165: rstOuvert = New ADODB.Recordset
170: rstSection = New ADODB.Recordset
		
175: collExtra = New Collection
		
180: Call rstEmploye.Open("SELECT noEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si c'est un projet
185: If m_eType = enumType.TYPE_PROJET Then
190: sTable = "GRB_ProjetElec"
195: sTableModif = "GRB_Projet_Modif"
200: sTablePiece = "GRB_Projet_Pieces"
205: sChamps = "IDProjet"
210: Else
215: sTable = "GRB_SoumissionElec"
220: sTableModif = "GRB_Soumission_Modif"
225: sTablePiece = "GRB_Soumission_Pieces"
230: sChamps = "IDSoumission"
235: End If
		
		'Si c'est un ajout
240: If m_bModeAjout = True Then
			'On ouvre le recordset selon le type
245: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
250: If m_eType = enumType.TYPE_PROJET Then
255: If rstProjSoum.EOF Then
260: bAjoutCommande = True
265: Else
270: bAjoutCommande = False
275: End If
280: Else
285: bAjoutCommande = False
290: End If
			
295: Call rstProjSoum.AddNew()
			
300: If m_eType = enumType.TYPE_PROJET Then
305: rstProjSoum.Fields("LiaisonChargeable").Value = m_sLiaison
310: End If
			
315: rstProjSoum.Fields("Creer").Value = ConvertDate(Today)
320: rstProjSoum.Fields("Creer_Par").Value = rstEmploye.Fields("noEmploye").Value
			
325: rstProjSoum.Fields(sChamps).Value = sNoProjSoum
			
330: If m_eType = enumType.TYPE_PROJET Then
335: rstProjSoum.Fields("IDSoumission").Value = txtNoSoumission.Text
340: End If
			
345: Call rstOuvert.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
350: If rstOuvert.EOF Then
355: Call rstOuvert.AddNew()
				
360: rstOuvert.Fields("IDProjSoum").Value = sNoProjSoum
365: rstOuvert.Fields("NoClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
370: rstOuvert.Fields("Description").Value = txtProjet.Text
375: rstOuvert.Fields("DateOuverture").Value = ConvertDate(Today)
380: rstOuvert.Fields("Ouvert").Value = True
				
385: If m_eType = enumType.TYPE_PROJET Then
390: rstOuvert.Fields("Type").Value = "P"
395: Else
400: rstOuvert.Fields("Type").Value = "S"
405: End If
				
410: Call rstOuvert.Update()
415: End If
			
420: Call rstOuvert.Close()
425: 'UPGRADE_NOTE: Object rstOuvert may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstOuvert = Nothing
			
430: m_bModeAjout = False
435: Else
440: Call EnregistrerSuppression()
			
445: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
450: Call rstModif.Open("SELECT * FROM " & sTableModif, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
455: Call rstModif.AddNew()
			
460: rstModif.Fields("Type").Value = "E"
465: rstModif.Fields(sChamps).Value = sNoProjSoum
470: rstModif.Fields("noEmployé").Value = rstEmploye.Fields("noEmploye").Value
475: rstModif.Fields("Date").Value = ConvertDate(Today)
480: rstModif.Fields("Heure").Value = TimeOfDay
485: rstModif.Fields("TypeModif").Value = "MODIFICATION"
			
490: Call rstModif.Update()
			
495: Call rstModif.Close()
500: 'UPGRADE_NOTE: Object rstModif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstModif = Nothing
			
505: Call rstOuvert.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
510: If rstOuvert.Fields("NoClient").Value <> VB6.GetItemData(cmbclient, cmbclient.SelectedIndex) Then
515: rstOuvert.Fields("NoClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
				
520: rstPunch = New ADODB.Recordset
				
525: Call rstPunch.Open("SELECT * FROM GRB_Punch WHERE NoProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
530: If Not rstPunch.EOF Then
535: If MsgBox("Le client a été modifié, voulez-vous changer les punch de ce projet ?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
						
540: Do While Not rstPunch.EOF
545: rstPunch.Fields("NoClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
							
550: Call rstPunch.Update()
							
555: Call rstPunch.MoveNext()
560: Loop 
565: End If
570: End If
				
575: Call rstPunch.Close()
580: 'UPGRADE_NOTE: Object rstPunch may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstPunch = Nothing
585: End If
			
590: rstOuvert.Fields("Description").Value = txtProjet.Text
			
595: Call rstOuvert.Update()
			
600: Call rstOuvert.Close()
605: 'UPGRADE_NOTE: Object rstOuvert may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstOuvert = Nothing
			
			'Si c'est une modification, il faut effacer les pieces et remplir les nouvelles
610: Call g_connData.Execute("DELETE * FROM " & sTablePiece & " WHERE " & sChamps & " = '" & sNoProjSoum & "' AND Type = 'E'")
			
615: If m_eType = enumType.TYPE_PROJET Then
620: If CDbl(VB.Right(sNoProjSoum, 2)) >= 60 And CDbl(VB.Right(sNoProjSoum, 2)) <= 98 Then
625: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(sNoProjSoum, 6) & "-" & rstProjSoum.Fields("LiaisonChargeable").Value & "' AND Type = 'E' AND (PieceExtraChargeable = True OR PieceExtraNonChargeable = True) AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
630: End If
635: End If
640: End If
		
		'Enregistrement de la soumission
		'Pour savoir que c'est une soumission ou un projet électrique
645: rstProjSoum.Fields("IDClient").Value = VB6.GetItemData(cmbclient, cmbclient.SelectedIndex)
650: rstProjSoum.Fields("IDContact").Value = VB6.GetItemData(cmbContact, cmbContact.SelectedIndex)
655: rstProjSoum.Fields("description").Value = txtProjet.Text
660: rstProjSoum.Fields("NbreManuel").Value = txtNbreManuel.Text
665: rstProjSoum.Fields("transport").Value = cmbtransport.Text
670: rstProjSoum.Fields("CSA").Value = chkCSA.CheckState
675: rstProjSoum.Fields("CUL").Value = chkCUL.CheckState
680: rstProjSoum.Fields("UL").Value = chkUL.CheckState
685: rstProjSoum.Fields("CUR").Value = chkCUR.CheckState
690: rstProjSoum.Fields("UR").Value = chkUR.CheckState
695: rstProjSoum.Fields("CE").Value = chkCE.CheckState
		
700: If txtDelais.Text <> "" Then
705: rstProjSoum.Fields("Delais").Value = txtDelais.Text
710: Else
715: rstProjSoum.Fields("Delais").Value = " "
720: End If
		
725: If m_eType = enumType.TYPE_SOUMISSION Then
730: rstProjSoum.Fields("TempsDessin").Value = m_sTempsDessin
735: rstProjSoum.Fields("TempsFabrication").Value = m_sTempsFabrication
740: rstProjSoum.Fields("TempsAssemblage").Value = m_sTempsAssemblage
745: rstProjSoum.Fields("TempsProgInterface").Value = m_sTempsProgInterface
750: rstProjSoum.Fields("TempsProgAutomate").Value = m_sTempsProgAutomate
755: rstProjSoum.Fields("TempsProgRobot").Value = m_sTempsProgRobot
760: rstProjSoum.Fields("TempsVision").Value = m_sTempsVision
765: rstProjSoum.Fields("TempsTest").Value = m_sTempsTest
770: rstProjSoum.Fields("TempsInstallation").Value = m_sTempsInstallation
775: rstProjSoum.Fields("TempsMiseService").Value = m_sTempsMiseService
780: rstProjSoum.Fields("TempsFormation").Value = m_sTempsFormation
785: rstProjSoum.Fields("TempsGestion").Value = m_sTempsGestion
790: rstProjSoum.Fields("TempsShipping").Value = m_sTempsShipping
795: End If
		
800: rstProjSoum.Fields("NbrePersonne").Value = m_sNbrePersonne
805: rstProjSoum.Fields("TempsHebergement").Value = m_sTempsHebergement
810: rstProjSoum.Fields("TempsRepas").Value = m_sTempsRepas
815: rstProjSoum.Fields("TempsTransport").Value = m_sTempsTransport
820: rstProjSoum.Fields("TempsUniteMobile").Value = m_sTempsUniteMobile
825: rstProjSoum.Fields("PrixEmballage").Value = m_sPrixEmballage
		
830: rstProjSoum.Fields("TauxHebergement1").Value = m_sTauxHebergement1
835: rstProjSoum.Fields("TauxHebergement2").Value = m_sTauxHebergement2
840: rstProjSoum.Fields("TauxRepas").Value = m_sTauxRepas
845: rstProjSoum.Fields("TauxTransport").Value = m_sTauxTransport
850: rstProjSoum.Fields("TauxUniteMobile").Value = m_sTauxUniteMobile
		
855: rstProjSoum.Fields("TauxDessin").Value = m_sTauxDessin
860: rstProjSoum.Fields("TauxFabrication").Value = m_sTauxFabrication
865: rstProjSoum.Fields("TauxAssemblage").Value = m_sTauxAssemblage
870: rstProjSoum.Fields("TauxProgInterface").Value = m_sTauxProgInterface
875: rstProjSoum.Fields("TauxProgAutomate").Value = m_sTauxProgAutomate
880: rstProjSoum.Fields("TauxProgRobot").Value = m_sTauxProgRobot
885: rstProjSoum.Fields("TauxVision").Value = m_sTauxVision
890: rstProjSoum.Fields("TauxTest").Value = m_sTauxTest
895: rstProjSoum.Fields("TauxInstallation").Value = m_sTauxInstallation
900: rstProjSoum.Fields("TauxMiseService").Value = m_sTauxMiseService
905: rstProjSoum.Fields("TauxFormation").Value = m_sTauxFormation
910: rstProjSoum.Fields("TauxGestion").Value = m_sTauxGestion
915: rstProjSoum.Fields("TauxShipping").Value = m_sTauxShipping
		
920: rstProjSoum.Fields("imprevue").Value = m_sImprevue
925: rstProjSoum.Fields("commission").Value = m_sCommission
930: rstProjSoum.Fields("Profit").Value = m_sProfit
935: rstProjSoum.Fields("SansTemps").Value = m_bSansTemps
940: rstProjSoum.Fields("CheminPhotos").Value = txtCheminPhotos.Text
945: rstProjSoum.Fields("MontantForfait").Value = txtForfait.Text
950: rstProjSoum.Fields("InitialeForfait").Value = Trim(Replace(lblForfaitInitiale.Text, "Par :", ""))
		
955: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
960: dblNbrePers = CDbl(rstProjSoum.Fields("NbrePersonne").Value)
965: Else
970: dblNbrePers = 0
975: End If
		
980: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
985: dblJoursHebergement = CDbl(rstProjSoum.Fields("TempsHebergement").Value)
990: Else
995: dblJoursHebergement = 0
1000: End If
		
1005: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
1010: dblJoursRepas = CDbl(rstProjSoum.Fields("TempsRepas").Value)
1015: Else
1020: dblJoursRepas = 0
1025: End If
		
1030: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
1035: dblHebergement1 = CDbl(rstProjSoum.Fields("TauxHebergement1").Value)
1040: Else
1045: dblHebergement1 = 0
1050: End If
		
1055: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
1060: dblHebergement2 = CDbl(rstProjSoum.Fields("TauxHebergement2").Value)
1065: Else
1070: dblHebergement2 = 0
1075: End If
		
1080: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
1085: dblRepas = CDbl(rstProjSoum.Fields("TauxRepas").Value)
1090: Else
1095: dblRepas = 0
1100: End If
		
1105: rstProjSoum.Fields("TotalRepas").Value = dblNbrePers * dblJoursRepas * dblRepas
		
1110: dblTotalHebergement = 0
		
1115: Do While dblNbrePers > 0
1120: If dblNbrePers >= 2 Then
1125: dblTotalHebergement = dblTotalHebergement + (dblJoursHebergement * dblHebergement2)
				
1130: dblNbrePers = dblNbrePers - 2
1135: Else
1140: dblTotalHebergement = dblTotalHebergement + (dblJoursHebergement * dblHebergement1)
				
1145: dblNbrePers = dblNbrePers - 1
1150: End If
1155: Loop 
		
1160: rstProjSoum.Fields("TotalHebergement").Value = dblTotalHebergement
		
1165: If bAjoutCommande = True Then
1170: rstProjSoum.Fields("ProchaineCommande").Value = 1
1175: End If
		
		'Si c'est un projet, il faut enregistrer le prix de réception
1180: If m_eType = enumType.TYPE_PROJET Then
1185: rstProjSoum.Fields("PrixRéception").Value = txtPrixReception.Text
1190: End If
		
1195: If IsNumeric(txtPrixManuel.Text) Then
1200: rstProjSoum.Fields("Total_Manuel").Value = txtPrixManuel.Text
1205: Else
1210: rstProjSoum.Fields("Total_Manuel").Value = "0"
1215: End If
		
1220: rstProjSoum.Fields("total_Commission").Value = txtCommission.Text
1225: rstProjSoum.Fields("Total_Profit").Value = txtProfit.Text
1230: rstProjSoum.Fields("PrixTotal").Value = txtPrixTotal.Text
1235: rstProjSoum.Fields("Total_piece").Value = txtTotalPieces.Text
1240: rstProjSoum.Fields("total_imprevue").Value = txtImprevus.Text
		
1245: rstProjSoum.Fields("PrixTotal").Value = txtPrixTotal.Text
		
1250: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
		
1255: If m_eType = enumType.TYPE_PROJET Then
1260: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
1265: Else
1270: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
1275: End If
		
1280: If m_eType = enumType.TYPE_PROJET Then
1285: If g_bModificationFacturation = True Then
1290: Call EnregistrerFACT(sNoProjSoum)
1295: End If
1300: End If
		
		'Enregistrement des pièces
1305: For iCompteur = 1 To lvwSoumission.Items.Count
1310: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
1315: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
1320: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmPiece = lvwSoumission.Items.Item(iCompteur)
					
1325: Call rstPiece.AddNew()
					
1330: If m_eType = enumType.TYPE_PROJET Then
1335: rstPiece.Fields("IDProjet").Value = sNoProjSoum
1340: Else
1345: rstPiece.Fields("IDSoumission").Value = sNoProjSoum
1350: End If
					
1355: rstPiece.Fields("Type").Value = "E"
					
1360: If itmPiece.Checked = True Then
1365: rstPiece.Fields("Visible").Value = True
1370: Else
1375: rstPiece.Fields("Visible").Value = False
1380: End If
					
1385: If m_eType = enumType.TYPE_PROJET Then
1390: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("Facturation").Value = itmPiece.SubItems(I_COL_SOUM_FACTURATION).Text
						
1395: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_FACTURATION).Text = "" Then
1400: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmPiece.SubItems(I_COL_SOUM_FACTURATION).Text = " "
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1405: End If
						
1410: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = "" Then
1415: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmPiece.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1420: End If
						
1425: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("NoRetour").Value = itmPiece.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag
						
1430: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("DateRéception").Value = itmPiece.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
1435: End If
					
1440: 'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rstPiece.Fields("IDSection").Value = itmPiece.Tag
1445: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("NumItem").Value = Trim(itmPiece.SubItems(I_COL_SOUM_PIECE).Text)
1450: rstPiece.Fields("Qté").Value = Replace(itmPiece.Text, "*", vbNullString)
					
1455: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or itmPiece.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
1460: rstPiece.Fields("DESC_EN").Value = ""
1465: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("DESC_FR").Value = Trim(itmPiece.SubItems(I_COL_SOUM_DESCR).Text)
1470: Else
1475: If m_eLangage = enumLangage.ANGLAIS Then
1480: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("DESC_EN").Value = Trim(itmPiece.SubItems(I_COL_SOUM_DESCR).Text)
1485: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("DESC_FR").Value = Trim(itmPiece.SubItems.Item(I_COL_SOUM_DESCR).Tag)
1490: Else
1495: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("DESC_FR").Value = Trim(itmPiece.SubItems(I_COL_SOUM_DESCR).Text)
1500: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("DESC_EN").Value = Trim(itmPiece.SubItems.Item(I_COL_SOUM_DESCR).Tag)
1505: End If
1510: End If
					
1515: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Manufact").Value = Trim(itmPiece.SubItems(I_COL_SOUM_MANUFACT).Text)
1520: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
					
1525: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(itmPiece.SubItems(I_COL_SOUM_ESCOMPTE).Text) <> "" Then
1530: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("Escompte").Value = Conversion_Renamed(CDbl(Replace(itmPiece.SubItems(I_COL_SOUM_ESCOMPTE).Text, "%", "")) / 100, ModuleMain.enumConvert.MODE_PAS_FORMAT)
1535: Else
1540: rstPiece.Fields("Escompte").Value = ""
1545: End If
					
1550: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
					
1555: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					rstPiece.Fields("OrdreSection").Value = itmPiece.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
1560: rstPiece.Fields("NuméroLigne").Value = iCompteur
					
					'Si le listItem est COLOR_ORANGE
1565: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ORANGE Then
1570: rstPiece.Fields("Commandé").Value = True
1575: Else
1580: rstPiece.Fields("Commandé").Value = False
1585: End If
					
1590: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_GRIS Then
1595: rstPiece.Fields("Recu").Value = True
1600: Else
1605: rstPiece.Fields("Recu").Value = False
1610: End If
					
1615: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ROUGE Then
1620: rstPiece.Fields("Retour").Value = True
1625: Else
1630: rstPiece.Fields("Retour").Value = False
1635: End If
					
1640: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_VERT_FORET And itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Font.Bold = True Then
1645: rstPiece.Fields("CommandeAnnulée").Value = True
1650: Else
1655: rstPiece.Fields("CommandeAnnulée").Value = False
1660: End If
					
1665: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
1670: rstPiece.Fields("MatérielInutile").Value = True
1675: Else
1680: rstPiece.Fields("MatérielInutile").Value = False
1685: End If
					
1690: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
1695: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("IDFRS").Value = itmPiece.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
1700: End If
					
1705: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Temps").Value = Trim(itmPiece.SubItems(I_COL_SOUM_TEMPS).Text)
1710: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Temps_Total").Value = itmPiece.SubItems(I_COL_SOUM_MONTAGE).Text
1715: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
1720: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmPiece.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
					
1725: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Len(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Tag) <= 50 Then
1730: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("SousSection").Value = itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Tag
1735: Else
1740: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("SousSection").Value = VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).Tag, 50)
1745: End If
					
1750: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
1755: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
1760: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmPiece.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 4)), ".", ",")
1765: Else
1770: rstPiece.Fields("PrixOrigine").Value = "0"
1775: End If
1780: Else
1785: rstPiece.Fields("PrixOrigine").Value = "0"
1790: End If
					
1795: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPiece.SubItems(I_COL_SOUM_TOTAL).Text <> "" Then
1800: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("Devise").Value = itmPiece.SubItems.Item(I_COL_SOUM_TOTAL).Tag
1805: Else
1810: rstPiece.Fields("Devise").Value = ""
1815: End If
					
1820: If InStr(1, itmPiece.Text, "*") > 0 Then
1825: rstPiece.Fields("Quoté").Value = True
1830: Else
1835: rstPiece.Fields("Quoté").Value = False
1840: End If
					
1845: If m_eType = enumType.TYPE_PROJET Then
1850: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If CBool(Trim(CStr(itmPiece.SubItems(I_COL_SOUM_ID).Text <> vbNullString))) Then
1855: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("ID").Value = itmPiece.SubItems(I_COL_SOUM_ID).Text
1860: End If
						
1865: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("DateCommande").Value = itmPiece.SubItems(I_COL_SOUM_DATE_COMMANDE).Text
1870: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("DateRequise").Value = itmPiece.SubItems(I_COL_SOUM_DATE_REQUISE).Text
						
1875: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_DATE_REQUISE).Text = "" Then
1880: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmPiece.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmPiece.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
							Else
								itmPiece.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1885: End If
						
1890: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						rstPiece.Fields("DateRetour").Value = itmPiece.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag
						
1895: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("NomCommande").Value = itmPiece.SubItems(I_COL_SOUM_NOM_COMMANDE).Text
						
1900: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						rstPiece.Fields("NoSéquentiel").Value = itmPiece.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text
1905: End If
					
1910: If m_eType = enumType.TYPE_PROJET Then
1915: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_ROSE Then
1920: rstPiece.Fields("PieceExtraNonChargeable").Value = True
1925: rstPiece.Fields("PieceExtraChargeable").Value = False
1930: Else
1935: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If System.Drawing.ColorTranslator.ToOle(itmPiece.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BLEU Then
1940: rstPiece.Fields("PieceExtraChargeable").Value = True
1945: rstPiece.Fields("PieceExtraNonChargeable").Value = False
1950: Else
1955: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 6) = "RETOUR" Or VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 10) = "ANNULATION" Then
1960: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									sExtra = VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2)
									
1965: If sExtra >= "80" And sExtra <= "98" Then
1970: rstPiece.Fields("PieceExtraNonChargeable").Value = True
1975: rstPiece.Fields("PieceExtraChargeable").Value = False
1980: Else
1985: rstPiece.Fields("PieceExtraChargeable").Value = True
1990: rstPiece.Fields("PieceExtraNonChargeable").Value = False
1995: End If
2000: End If
2005: End If
2010: End If
						
2015: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmPiece.SubItems(I_COL_SOUM_PROVENANCE).Text <> "" Then
2020: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							rstPiece.Fields("Provenance").Value = VB.Right(itmPiece.SubItems(I_COL_SOUM_PROVENANCE).Text, 2)
2025: Else
2030: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 6) = "RETOUR" Or VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 10) = "ANNULATION" Then
2035: rstPiece.Fields("Provenance").Value = sExtra
2040: End If
2045: End If
2050: End If
					
2055: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("Commentaire").Value = itmPiece.SubItems(I_COL_SOUM_COMMENTAIRE).Text
					
2060: Call rstPiece.Update()
					
2065: If m_eType = enumType.TYPE_PROJET Then
2070: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 80 Then
2075: Call AjouterPiecesExtraDansJob(itmPiece, rstProjSoum.Fields("LiaisonChargeable").Value)
2080: Else
2085: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 79 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 Then
2090: Call AjouterPiecesExtraChargeableDansJob(itmPiece, rstProjSoum.Fields("LiaisonChargeable").Value)
2095: Else
2100: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 6) = "RETOUR" Then
2105: Call AjouterInutileDansExtra(itmPiece, sExtra)
									
2110: bCalculExtra = True
									
2115: bExiste = False
									
2120: For iCompteurExtra = 1 To collExtra.Count()
2125: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Couldn't resolve default property of object collExtra(iCompteurExtra). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
										If collExtra.Item(iCompteurExtra) = VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2) Then
2130: bExiste = True
											
2135: Exit For
2140: End If
2145: Next 
									
2150: If bExiste = False Then
2155: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										Call collExtra.Add(VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2))
2160: End If
2165: Else
2170: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If VB.Left(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 10) = "ANNULATION" Then
2175: Call AjouterAnnulationDansExtra(itmPiece, sExtra)
										
2180: bCalculExtra = True
										
2185: bExiste = False
										
2190: For iCompteurExtra = 1 To collExtra.Count()
2195: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											'UPGRADE_WARNING: Couldn't resolve default property of object collExtra(iCompteurExtra). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
											If collExtra.Item(iCompteurExtra) = VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2) Then
2200: bExiste = True
												
2205: Exit For
2210: End If
2215: Next 
										
2220: If bExiste = False Then
2225: 'UPGRADE_WARNING: Lower bound of collection itmPiece.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											Call collExtra.Add(VB.Right(itmPiece.SubItems.Item(I_COL_SOUM_PROFIT).Tag, 2))
2230: End If
2235: End If
2240: End If
2245: End If
2250: End If
2255: End If
2260: End If
2265: End If
2270: Next 
		
2275: If m_eType = enumType.TYPE_PROJET Then
2280: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 Then
2285: Call CalculerTotalRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & rstProjSoum.Fields("LiaisonChargeable").Value)
2290: End If
2295: End If
		
2300: If bCalculExtra = True Then
2305: For iCompteurExtra = 1 To collExtra.Count()
2310: 'UPGRADE_WARNING: Couldn't resolve default property of object collExtra(iCompteurExtra). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				Call CalculerTotalRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & collExtra.Item(iCompteurExtra))
2315: Next 
2320: End If
		
2325: rstProjSoum.Fields("total_temps").Value = txtTotalTemps.Text
		
2330: Call rstProjSoum.Update()
		
2335: Call rstProjSoum.Close()
2340: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
2345: Call rstPiece.Close()
2350: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
2355: If m_eType = enumType.TYPE_SOUMISSION Then
2360: Call AjouterSoumissionAuCumulatif()
2365: Else
2370: Call AjouterProjetAuCumulatif()
2375: End If
		
2380: Exit Sub
		
AfficherErreur: 
		
2385: Call AfficherErreur("frmProjSoumElec", "EnregistrerProjSoum", Err, Erl(), sNoProjSoum)
		
		'Si un erreur se produit dans l'enregistrement des pièces, il faut avertir
		'l'utilisateur de quelle pièce il s'agit et continuer avec un Resume Next
2390: If Erl() >= 1310 And Erl() <= 2265 Then
2395: If m_eLangage = enumLangage.ANGLAIS Then
2400: Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
2405: If Not rstSection.EOF Then
2410: sSection = rstSection.Fields("NomSectionEN").Value
2415: Else
2420: 'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sSection = itmPiece.Tag
2425: End If
2430: Else
2435: Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
2440: If Not rstSection.EOF Then
2445: sSection = rstSection.Fields("NomSectionFR").Value
2450: Else
2455: 'UPGRADE_WARNING: Couldn't resolve default property of object itmPiece.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					sSection = itmPiece.Tag
2460: End If
2465: End If
			
2470: Call rstSection.Close()
2475: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstSection = Nothing
			
2480: 'UPGRADE_WARNING: Lower bound of collection itmPiece has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call MsgBox("La pièce " & itmPiece.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs." & vbNewLine & "Il se peut qu'elle ne soit plus présente dans la liste.")
2485: End If
		
2490: Resume Next
	End Sub
	
	Private Sub InitialiserNouveauxTaux()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstConfig As ADODB.Recordset
		
15: rstConfig = New ADODB.Recordset
		
20: Call rstConfig.Open("SELECT TauxDessinElec, TauxFabrication, TauxAssemblageElec, TauxProgInterface, TauxProgAutomate, TauxProgRobot, TauxVision, TauxTestElec, TauxInstallationElec, TauxMiseService, TauxFormationElec, TauxGestionProjetsElec, TauxShippingElec, Hebergement1, Hebergement2, Repas, Standard, UniteMobile FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
25: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxDessinElec").Value) Then
30: m_sTauxDessin = rstConfig.Fields("TauxDessinElec").Value
35: Else
40: m_sTauxDessin = "0"
45: End If
		
50: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxFabrication").Value) Then
55: m_sTauxFabrication = rstConfig.Fields("TauxFabrication").Value
60: Else
65: m_sTauxFabrication = "0"
70: End If
		
75: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxAssemblageElec").Value) Then
80: m_sTauxAssemblage = rstConfig.Fields("TauxAssemblageElec").Value
85: Else
90: m_sTauxAssemblage = "0"
95: End If
		
100: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxProgInterface").Value) Then
105: m_sTauxProgInterface = rstConfig.Fields("TauxProgInterface").Value
110: Else
115: m_sTauxProgInterface = "0"
120: End If
		
125: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxProgAutomate").Value) Then
130: m_sTauxProgAutomate = rstConfig.Fields("TauxProgAutomate").Value
135: Else
140: m_sTauxProgAutomate = "0"
145: End If
		
150: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxProgRobot").Value) Then
155: m_sTauxProgRobot = rstConfig.Fields("TauxProgRobot").Value
160: Else
165: m_sTauxProgRobot = "0"
170: End If
		
175: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxVision").Value) Then
180: m_sTauxVision = rstConfig.Fields("TauxVision").Value
185: Else
190: m_sTauxVision = "0"
195: End If
		
200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxTestElec").Value) Then
205: m_sTauxTest = rstConfig.Fields("TauxTestElec").Value
210: Else
215: m_sTauxTest = "0"
220: End If
		
225: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxInstallationElec").Value) Then
230: m_sTauxInstallation = rstConfig.Fields("TauxInstallationElec").Value
235: Else
240: m_sTauxInstallation = "0"
245: End If
		
250: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxMiseService").Value) Then
255: m_sTauxMiseService = rstConfig.Fields("TauxMiseService").Value
260: Else
265: m_sTauxMiseService = "0"
270: End If
		
275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxFormationElec").Value) Then
280: m_sTauxFormation = rstConfig.Fields("TauxFormationElec").Value
285: Else
290: m_sTauxFormation = "0"
295: End If
		
300: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxGestionProjetsElec").Value) Then
305: m_sTauxGestion = rstConfig.Fields("TauxGestionProjetsElec").Value
310: Else
315: m_sTauxGestion = "0"
320: End If
		
325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstConfig.Fields("TauxShippingElec").Value) Then
330: m_sTauxShipping = rstConfig.Fields("TauxShippingElec").Value
335: Else
340: m_sTauxShipping = "0"
345: End If
		
350: If m_eType = enumType.TYPE_PROJET Then
355: m_sTauxHebergement1 = "0"
360: m_sTauxHebergement2 = "0"
365: m_sTauxRepas = "0"
370: m_sTauxTransport = "0"
375: m_sTauxUniteMobile = "0"
380: Else
385: m_sTauxHebergement1 = rstConfig.Fields("Hebergement1").Value
390: m_sTauxHebergement2 = rstConfig.Fields("Hebergement2").Value
395: m_sTauxRepas = rstConfig.Fields("Repas").Value
400: m_sTauxTransport = rstConfig.Fields("Standard").Value
405: m_sTauxUniteMobile = rstConfig.Fields("UniteMobile").Value
410: End If
		
415: Call rstConfig.Close()
420: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
425: Exit Sub
		
AfficherErreur: 
		
430: Call AfficherErreur("frmProjSoumElec", "InitialiserNouveauxTaux", Err, Erl())
	End Sub
	
	Private Sub AjouterPiecesExtraChargeableDansJob(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sLiaison As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
55: If Not rstProjet.EOF Then
			'Ouverture du recordset sur le projet original
60: rstPiece = New ADODB.Recordset
			
65: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
70: If Not rstPiece.EOF Then
75: Call rstPiece.MoveLast()
				
80: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
85: Else
90: iCompteur = 1
95: End If
			
100: Call rstPiece.AddNew()
			
105: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison
			
110: rstPiece.Fields("Type").Value = "E"
			
115: If itmSource.Checked = True Then
120: rstPiece.Fields("Visible").Value = True
125: Else
130: rstPiece.Fields("Visible").Value = False
135: End If
			
140: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Facturation").Value = itmSource.SubItems(I_COL_SOUM_FACTURATION).Text
			
145: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
150: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
155: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", vbNullString)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
165: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
180: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
185: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
190: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
195: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
200: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
205: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("IDFRS").Value = itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
210: End If
			
215: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps").Value = Trim(itmSource.SubItems(I_COL_SOUM_TEMPS).Text)
220: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps_Total").Value = itmSource.SubItems(I_COL_SOUM_MONTAGE).Text
225: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
230: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
235: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
240: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
245: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
250: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 4)), ".", ",")
255: Else
260: rstPiece.Fields("PrixOrigine").Value = "0"
265: End If
270: Else
275: rstPiece.Fields("PrixOrigine").Value = "0"
280: End If
			
285: If InStr(1, itmSource.Text, "*") > 0 Then
290: rstPiece.Fields("Quoté").Value = True
295: Else
300: rstPiece.Fields("Quoté").Value = False
305: End If
			
310: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If CBool(Trim(CStr(itmSource.SubItems(I_COL_SOUM_ID).Text <> vbNullString))) Then
315: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("ID").Value = itmSource.SubItems(I_COL_SOUM_ID).Text
320: End If
			
325: rstPiece.Fields("PieceExtraChargeable").Value = True
330: rstPiece.Fields("Provenance").Value = VB.Right(txtNoProjSoum.Text, 2)
			
335: Call rstPiece.Update()
			
340: Call rstPiece.Close()
			
345: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
350: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
355: Do While Not rstPiece.EOF
360: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If rstPiece.Fields("PieceExtraChargeable").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
365: bSkip = True
370: Else
375: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
					
380: Call rstPiece.Update()
385: End If
				
390: Call rstPiece.MoveNext()
395: Loop 
			
400: Call rstPiece.Close()
405: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
			
410: Call CalculerTempsFabricationRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison)
415: End If
		
420: Call rstProjet.Close()
425: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
430: Exit Sub
		
AfficherErreur: 
		
435: Call AfficherErreur("frmProjSoumElec", "AjouterPiecesExtraDansJob", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub AjouterPiecesExtraDansJob(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sLiaison As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
50: If Not rstProjet.EOF Then
			'Ouverture du recordset sur le projet original
55: rstPiece = New ADODB.Recordset
			
60: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: If Not rstPiece.EOF Then
70: Call rstPiece.MoveLast()
				
75: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
80: Else
85: iCompteur = 1
90: End If
			
95: Call rstPiece.AddNew()
			
100: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison
			
105: rstPiece.Fields("Type").Value = "E"
			
110: If itmSource.Checked = True Then
115: rstPiece.Fields("Visible").Value = True
120: Else
125: rstPiece.Fields("Visible").Value = False
130: End If
			
135: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Facturation").Value = itmSource.SubItems(I_COL_SOUM_FACTURATION).Text
			
140: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
145: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
150: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", vbNullString)
155: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Desc_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
165: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
180: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
185: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
190: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
195: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
200: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("IDFRS").Value = itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
205: End If
			
210: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps").Value = Trim(itmSource.SubItems(I_COL_SOUM_TEMPS).Text)
215: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps_Total").Value = itmSource.SubItems(I_COL_SOUM_MONTAGE).Text
220: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
225: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
230: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
235: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
240: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
245: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 2)), ".", ",")
250: Else
255: rstPiece.Fields("PrixOrigine").Value = "0"
260: End If
265: Else
270: rstPiece.Fields("PrixOrigine").Value = "0"
275: End If
			
280: If InStr(1, itmSource.Text, "*") > 0 Then
285: rstPiece.Fields("Quoté").Value = True
290: Else
295: rstPiece.Fields("Quoté").Value = False
300: End If
			
305: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If CBool(Trim(CStr(itmSource.SubItems(I_COL_SOUM_ID).Text <> vbNullString))) Then
310: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("ID").Value = itmSource.SubItems(I_COL_SOUM_ID).Text
315: End If
			
320: rstPiece.Fields("PieceExtraNonChargeable").Value = True
325: rstPiece.Fields("Provenance").Value = VB.Right(txtNoProjSoum.Text, 2)
			
330: Call rstPiece.Update()
			
335: Call rstPiece.Close()
			
340: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
345: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
350: Do While Not rstPiece.EOF
355: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If rstPiece.Fields("PieceExtraNonChargeable").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
360: bSkip = True
365: Else
370: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
					
375: Call rstPiece.Update()
380: End If
				
385: Call rstPiece.MoveNext()
390: Loop 
			
395: Call rstPiece.Close()
400: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
			
405: Call CalculerTempsFabricationRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sLiaison)
410: End If
		
415: Call rstProjet.Close()
420: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
425: Exit Sub
		
AfficherErreur: 
		
430: Call AfficherErreur("frmProjSoumElec", "AjouterPiecesExtraDansJob", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & sLiaison & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub AjouterInutileDansExtra(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sExtra As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
50: If Not rstProjet.EOF Then
			'Ouverture du recordset sur le projet original
55: rstPiece = New ADODB.Recordset
			
60: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: If Not rstPiece.EOF Then
70: Call rstPiece.MoveLast()
				
75: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
80: Else
85: iCompteur = 1
90: End If
			
95: Call rstPiece.AddNew()
			
100: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra
			
105: rstPiece.Fields("Type").Value = "E"
			
110: If itmSource.Checked = True Then
115: rstPiece.Fields("Visible").Value = True
120: Else
125: rstPiece.Fields("Visible").Value = False
130: End If
			
135: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
140: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
145: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", vbNullString)
			
150: If m_eLangage = enumLangage.ANGLAIS Then
155: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
165: Else
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
180: End If
			
185: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
190: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
195: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
200: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
			
205: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
210: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
215: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If System.Drawing.ColorTranslator.ToOle(itmSource.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Then
220: rstPiece.Fields("MatérielInutile").Value = False
225: Else
230: rstPiece.Fields("MatérielInutile").Value = True
235: End If
			
240: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
245: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("IDFRS").Value = itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
250: End If
			
255: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps").Value = Trim(itmSource.SubItems(I_COL_SOUM_TEMPS).Text)
260: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps_Total").Value = itmSource.SubItems(I_COL_SOUM_MONTAGE).Text
265: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
270: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
275: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
280: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
285: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
290: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 4)), ".", ",")
295: Else
300: rstPiece.Fields("PrixOrigine").Value = "0"
305: End If
310: Else
315: rstPiece.Fields("PrixOrigine").Value = "0"
320: End If
			
325: If InStr(1, itmSource.Text, "*") > 0 Then
330: rstPiece.Fields("Quoté").Value = True
335: Else
340: rstPiece.Fields("Quoté").Value = False
345: End If
			
350: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("DateRetour").Value = itmSource.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag
			
355: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Commentaire").Value = itmSource.SubItems(I_COL_SOUM_COMMENTAIRE).Text
			
360: Call rstPiece.Update()
			
365: Call rstPiece.Close()
			
370: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
375: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
380: Do While Not rstPiece.EOF
385: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(itmSource.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
390: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If rstPiece.Fields("MatérielInutile").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
395: bSkip = True
400: Else
405: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
						
410: Call rstPiece.Update()
415: End If
420: Else
425: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If rstPiece.Fields("MatérielInutile").Value = False And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
430: bSkip = True
435: Else
440: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
						
445: Call rstPiece.Update()
450: End If
455: End If
				
460: Call rstPiece.MoveNext()
465: Loop 
			
470: Call rstPiece.Close()
475: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
			
480: Call CalculerTempsFabricationRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra)
485: End If
		
490: Call rstProjet.Close()
495: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
500: Exit Sub
		
AfficherErreur: 
		
505: Call AfficherErreur("frmProjSoumElec", "AjouterInutileDansExtra", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & VB.Right("0" & CDbl(VB.Right(txtNoProjSoum.Text, 2)) + 80, 2) & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub AjouterAnnulationDansExtra(ByVal itmSource As System.Windows.Forms.ListViewItem, ByVal sExtra As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPiece As ADODB.Recordset
15: Dim rstProjet As ADODB.Recordset
20: Dim rstSection As ADODB.Recordset
25: Dim iCompteur As Short
30: Dim sSection As String
35: Dim bSkip As Boolean
		
40: rstProjet = New ADODB.Recordset
		
45: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Si le projet existe
50: If Not rstProjet.EOF Then
			'Ouverture du recordset sur le projet original
55: rstPiece = New ADODB.Recordset
			
60: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND IDSection = " & itmSource.Tag & " AND SousSection = '" & Replace(itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag, "'", "''") & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
65: If Not rstPiece.EOF Then
70: Call rstPiece.MoveLast()
				
75: iCompteur = rstPiece.Fields("NuméroLigne").Value + 1
80: Else
85: iCompteur = 1
90: End If
			
95: Call rstPiece.AddNew()
			
100: rstPiece.Fields("IDProjet").Value = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra
			
105: rstPiece.Fields("Type").Value = "E"
			
110: If itmSource.Checked = True Then
115: rstPiece.Fields("Visible").Value = True
120: Else
125: rstPiece.Fields("Visible").Value = False
130: End If
			
135: 'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("IDSection").Value = itmSource.Tag
140: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("NumItem").Value = Trim(itmSource.SubItems(I_COL_SOUM_PIECE).Text)
145: rstPiece.Fields("Qté").Value = Replace(itmSource.Text, "*", vbNullString)
			
150: If m_eLangage = enumLangage.ANGLAIS Then
155: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
160: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
165: Else
170: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_FR").Value = Trim(itmSource.SubItems(I_COL_SOUM_DESCR).Text)
175: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPiece.Fields("DESC_EN").Value = Trim(itmSource.SubItems.Item(I_COL_SOUM_DESCR).Tag)
180: End If
			
185: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Manufact").Value = Trim(itmSource.SubItems(I_COL_SOUM_MANUFACT).Text)
190: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_list").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
195: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Escompte").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
200: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_net").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PRIX_NET).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT, 4)
			
205: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("OrdreSection").Value = itmSource.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
210: rstPiece.Fields("NuméroLigne").Value = iCompteur
			
215: rstPiece.Fields("CommandeAnnulée").Value = True
			
220: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
225: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				rstPiece.Fields("IDFRS").Value = itmSource.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
230: End If
			
235: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps").Value = Trim(itmSource.SubItems(I_COL_SOUM_TEMPS).Text)
240: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Temps_Total").Value = itmSource.SubItems(I_COL_SOUM_MONTAGE).Text
245: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Prix_Total").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_TOTAL).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
250: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Profit_argent").Value = Conversion_Renamed(itmSource.SubItems(I_COL_SOUM_PROFIT).Text, ModuleMain.enumConvert.MODE_PAS_FORMAT)
255: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstPiece.Fields("SousSection").Value = itmSource.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
260: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSource.SubItems(I_COL_SOUM_PRIX_LIST).Text <> vbNullString Then
265: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag <> vbNullString Then
270: 'UPGRADE_WARNING: Lower bound of collection itmSource.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					rstPiece.Fields("PrixOrigine").Value = Replace(CStr(System.Math.Round(CDbl(Replace(itmSource.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag, ".", ",")), 2)), ".", ",")
275: Else
280: rstPiece.Fields("PrixOrigine").Value = "0"
285: End If
290: Else
295: rstPiece.Fields("PrixOrigine").Value = "0"
300: End If
			
305: If InStr(1, itmSource.Text, "*") > 0 Then
310: rstPiece.Fields("Quoté").Value = True
315: Else
320: rstPiece.Fields("Quoté").Value = False
325: End If
			
330: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			rstPiece.Fields("Commentaire").Value = itmSource.SubItems(I_COL_SOUM_COMMENTAIRE).Text
			
335: Call rstPiece.Update()
			
340: Call rstPiece.Close()
			
345: rstPiece.CursorLocation = ADODB.CursorLocationEnum.adUseServer
			
350: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "' AND NuméroLigne >= " & iCompteur & " ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Tant qu'il y a des enregistrements dans le recordset
355: Do While Not rstPiece.EOF
360: 'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If rstPiece.Fields("CommandeAnnulée").Value = True And rstPiece.Fields("Qté").Value = itmSource.Text And rstPiece.Fields("NumItem").Value = itmSource.SubItems(I_COL_SOUM_PIECE).Text And bSkip = False Then
365: bSkip = True
370: Else
375: rstPiece.Fields("NuméroLigne").Value = rstPiece.Fields("NuméroLigne").Value + 1
					
380: Call rstPiece.Update()
385: End If
				
390: Call rstPiece.MoveNext()
395: Loop 
			
400: Call rstPiece.Close()
405: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
			
410: Call CalculerTempsFabricationRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra)
415: End If
		
420: Call rstProjet.Close()
425: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
430: Exit Sub
		
AfficherErreur: 
		
435: Call AfficherErreur("frmProjSoumElec", "AjouterAnnulationDansExtra", Err, Erl())
		
		rstSection = New ADODB.Recordset
		
		If m_eLangage = enumLangage.ANGLAIS Then
			Call rstSection.Open("SELECT NomSectionEN FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionEN").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		Else
			Call rstSection.Open("SELECT NomSectionFR FROM GRB_SoumProjSectionElec", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			If Not rstSection.EOF Then
				sSection = rstSection.Fields("NomSectionFR").Value
			Else
				'UPGRADE_WARNING: Couldn't resolve default property of object itmSource.Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				sSection = itmSource.Tag
			End If
		End If
		
		Call rstSection.Close()
		'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'UPGRADE_WARNING: Lower bound of collection itmSource has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call MsgBox("La pièce " & itmSource.SubItems(I_COL_SOUM_PIECE).Text & " de la section " & sSection & " risque de contenir des erreurs dans le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & VB.Right("0" & CDbl(VB.Right(txtNoProjSoum.Text, 2)) + 80, 2) & "." & vbNewLine & "Il se peut qu'elle ne soit pas ajoutée dans le projet.")
		
		Resume Next
	End Sub
	
	Private Sub Cmdfermer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles Cmdfermer.Click
		
5: On Error GoTo AfficherErreur
		
		'Fermeture de la fenêtre
10: m_bResize = False
		
15: Call Me.Close()
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "cmdFermer_Click", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewModifications()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le lvwHistorique
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim rstCreation As ADODB.Recordset
25: Dim sChamps As String
30: Dim sTable As String
35: Dim sTableCreer As String
40: Dim itmModif As System.Windows.Forms.ListViewItem
		
45: rstProjSoum = New ADODB.Recordset
50: rstEmploye = New ADODB.Recordset
55: rstCreation = New ADODB.Recordset
		
		'Il faut le vider avant de le remplir
60: Call lvwHistorique.Items.Clear()
		
65: If m_eType = enumType.TYPE_PROJET Then
70: sChamps = "IDProjet"
75: sTable = "GRB_Projet_Modif"
80: sTableCreer = "GRB_ProjetElec"
85: Else
90: sChamps = "IDSoumission"
95: sTable = "GRB_Soumission_Modif"
100: sTableCreer = "GRB_SoumissionElec"
105: End If
		
		'Ouverture du recordset selon le type
110: Call rstCreation.Open("SELECT creer, creer_par FROM " & sTableCreer & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Ajout de la section "Création"
115: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		itmModif = lvwHistorique.Items.Add()
		
120: itmModif.Text = "Création"
		
125: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
		
		'Ajout du nom de celui qui l'a créé
130: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
		itmModif = lvwHistorique.Items.Add()
		
135: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstCreation.Fields("creer_par").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
140: itmModif.Text = rstEmploye.Fields("Employe").Value
		
145: Call rstEmploye.Close()
		
		'Date
150: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
			itmModif.SubItems(I_COL_MODIF_DATE).Text = rstCreation.Fields("creer").Value
		Else
			itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstCreation.Fields("creer").Value))
		End If
		
155: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
			itmModif.SubItems(I_COL_MODIF_HEURE).Text = vbNullString
		Else
			itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
		End If
		
160: Call rstCreation.Close()
165: 'UPGRADE_NOTE: Object rstCreation may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstCreation = Nothing
		
170: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'E' AND TypeModif = 'MODIFICATION' ORDER BY [Date], Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
175: If Not rstProjSoum.EOF Then
			'Ajout de la section "Modifications"
180: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
185: itmModif.Text = "Modifications"
			
190: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
195: Do While Not rstProjSoum.EOF
				'Ajout des modifications
200: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
205: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Employé
210: itmModif.Text = rstEmploye.Fields("Employe").Value
				
215: Call rstEmploye.Close()
				
				'Date
220: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
225: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
230: Call rstProjSoum.MoveNext()
235: Loop 
240: End If
		
245: Call rstProjSoum.Close()
		
250: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'E' AND TypeModif = 'RECEPTION' ORDER BY [Date], Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
255: If Not rstProjSoum.EOF Then
			'Ajout de la section "Réception"
260: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
265: itmModif.Text = "Réception"
			
270: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
275: Do While Not rstProjSoum.EOF
				'Ajout des modifications
280: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
285: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Employé
290: itmModif.Text = rstEmploye.Fields("Employe").Value
				
295: Call rstEmploye.Close()
				
				'Date
300: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
305: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
310: Call rstProjSoum.MoveNext()
315: Loop 
320: End If
		
325: Call rstProjSoum.Close()
		
330: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'E' AND TypeModif = 'RETOUR' ORDER BY [Date], Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
335: If Not rstProjSoum.EOF Then
			'Ajout de la section "Retour de marchandise"
340: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
345: itmModif.Text = "Retour de marchandise"
			
350: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
355: Do While Not rstProjSoum.EOF
				'Ajout des retours de marchandise
360: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
365: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Employé
370: itmModif.Text = rstEmploye.Fields("Employe").Value
				
375: Call rstEmploye.Close()
				
				'Date
380: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
385: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
390: Call rstProjSoum.MoveNext()
395: Loop 
400: End If
		
405: Call rstProjSoum.Close()
		
410: Call rstProjSoum.Open("SELECT * FROM " & sTable & " WHERE " & sChamps & " = '" & txtNoProjSoum.Text & "' AND Type = 'E' AND TypeModif = 'FACTURATION' ORDER BY [Date], Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
415: If Not rstProjSoum.EOF Then
			'Ajout de la section "Modifications"
420: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmModif = lvwHistorique.Items.Add()
			
425: itmModif.Text = "Facturation"
			
430: itmModif.Font = VB6.FontChangeBold(itmModif.Font, True)
			
435: Do While Not rstProjSoum.EOF
				'Ajout des modifications
440: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwHistorique.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmModif = lvwHistorique.Items.Add()
				
445: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE noEmploye = " & rstProjSoum.Fields("NoEmployé").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Employé
450: itmModif.Text = rstEmploye.Fields("Employe").Value
				
455: Call rstEmploye.Close()
				
				'Date
460: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_DATE Then
					itmModif.SubItems(I_COL_MODIF_DATE).Text = rstProjSoum.Fields("Date").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Date").Value))
				End If
				
				'Heure
465: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_HEURE Then
					itmModif.SubItems(I_COL_MODIF_HEURE).Text = rstProjSoum.Fields("Heure").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Heure").Value))
				End If
				
				'Montant
470: 'UPGRADE_WARNING: Lower bound of collection itmModif has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmModif.SubItems.Count > I_COL_MODIF_MONTANT Then
					itmModif.SubItems(I_COL_MODIF_MONTANT).Text = rstProjSoum.Fields("Valeur").Value
				Else
					itmModif.SubItems.Insert(I_COL_MODIF_MONTANT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Valeur").Value))
				End If
				
475: Call rstProjSoum.MoveNext()
480: Loop 
485: End If
		
490: Call rstProjSoum.Close()
495: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
500: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
505: Exit Sub
		
AfficherErreur: 
		
510: Call AfficherErreur("frmProjSoumElec", "RemplirListViewModifications", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewSuppression()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le listView avec les pièces supprimées
10: Dim rstBavard As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim itmBavard As System.Windows.Forms.ListViewItem
		
25: Call lvwBavard.Items.Clear()
		
30: rstBavard = New ADODB.Recordset
35: rstEmploye = New ADODB.Recordset
		
40: Call rstBavard.Open("SELECT * FROM GRB_BavardSuppression WHERE NoProjSoum = '" & txtNoProjSoum.Text & "' AND Type = 'E' ORDER BY [Date], Heure", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
45: Do While Not rstBavard.EOF
50: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwBavard.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmBavard = lvwBavard.Items.Add()
			
55: Call rstEmploye.Open("SELECT Employe FROM GRB_Employés WHERE NoEmploye = " & rstBavard.Fields("IDUser").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
60: itmBavard.Text = rstEmploye.Fields("Employe").Value
			
65: Call rstEmploye.Close()
			
70: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_DATE Then
				itmBavard.SubItems(I_COL_SUPP_DATE).Text = rstBavard.Fields("Date").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("Date").Value))
			End If
75: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_HEURE Then
				itmBavard.SubItems(I_COL_SUPP_HEURE).Text = rstBavard.Fields("Heure").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_HEURE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("Heure").Value))
			End If
80: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_QTE Then
				itmBavard.SubItems(I_COL_SUPP_QTE).Text = rstBavard.Fields("Qté").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_QTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("Qté").Value))
			End If
85: 'UPGRADE_WARNING: Lower bound of collection itmBavard has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmBavard.SubItems.Count > I_COL_SUPP_NO_ITEM Then
				itmBavard.SubItems(I_COL_SUPP_NO_ITEM).Text = rstBavard.Fields("No Item").Value
			Else
				itmBavard.SubItems.Insert(I_COL_SUPP_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstBavard.Fields("No Item").Value))
			End If
			
90: Call rstBavard.MoveNext()
95: Loop 
		
100: Call rstBavard.Close()
105: 'UPGRADE_NOTE: Object rstBavard may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBavard = Nothing
		
110: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
115: Exit Sub
		
AfficherErreur: 
		
120: Call AfficherErreur("frmProjSoumElec", "RemplirListViewSuppression", Err, Erl())
	End Sub
	
	Private Sub Cmdajouter_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles Cmdajouter.Click
		
5: On Error GoTo AfficherErreur
		
		'Ajoute une soumission ou un projet
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sNumero As String
20: Dim sNoProjet As String
25: Dim bExiste As Boolean
30: Dim bProjet As Boolean
35: Dim bContinuer As Boolean
40: Dim bNoValide As Boolean
		
		'Affiche le message de saisie selon le type
45: If m_eType = enumType.TYPE_PROJET Then
50: sNumero = InputBox("Veuillez entrer le numéro du projet")
55: Else
60: If MsgBox("Voulez-vous créer une nouvelle soumission?" & vbNewLine & "Oui - Nouvelle soumission" & vbNewLine & "Non - Copie d'un projet dans une soumission", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
65: sNumero = InputBox("Veuillez entrer le numéro de la soumission")
70: Else
75: sNumero = InputBox("Veuillez entrer le numéro de la soumission")
				
80: sNoProjet = InputBox("À partir de quel projet voulez-vous créer cette soumission?")
				
85: bProjet = True
90: End If
95: End If
		
100: If bProjet = True Then
105: If sNumero <> vbNullString And sNoProjet <> vbNullString Then
110: bContinuer = True
115: End If
120: Else
125: If sNumero <> vbNullString Then
130: bContinuer = True
135: End If
140: End If
		
145: If bContinuer = True Then
150: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
			
155: bNoValide = True
			
160: If ValiderFormatNumeroProjSoum(sNumero) = False Then
165: bNoValide = False
170: End If
			
175: If bNoValide = True Then
180: If ValiderFormatElectrique(sNumero) = False Then
185: bNoValide = False
190: End If
195: End If
			
200: If bNoValide = True Then
205: If m_eType = enumType.TYPE_PROJET Then
210: If ValiderFormatJobSansSoum(sNumero) = False Then
215: bNoValide = False
220: End If
225: Else
230: If ValiderFormatSoumission(sNumero) = False Then
235: bNoValide = False
240: End If
245: End If
250: End If
			
255: If bNoValide = False Then
260: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
				
265: Exit Sub
270: End If
			
275: sNumero = UCase(sNumero)
			
280: rstProjSoum = New ADODB.Recordset
			
			'Ouvre le recordset selon le type
285: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockPessimistic)
			
290: If rstProjSoum.EOF Then
295: bExiste = False
300: Else
305: bExiste = True
				
310: Call MsgBox("Le numéro " & sNumero & " existe dans les soumissions électriques!", MsgBoxStyle.OKOnly, "Erreur")
315: End If
			
320: Call rstProjSoum.Close()
			
325: If bExiste = False Then
330: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
335: If rstProjSoum.EOF Then
340: bExiste = False
345: Else
350: bExiste = True
					
355: Call MsgBox("Le numéro " & sNumero & " existe dans les projets électriques!", MsgBoxStyle.OKOnly, "Erreur")
360: End If
				
365: Call rstProjSoum.Close()
370: End If
			
375: If bExiste = False Then
380: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionMec WHERE IDSoumission = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
385: If rstProjSoum.EOF Then
390: bExiste = False
395: Else
400: bExiste = True
					
405: Call MsgBox("Le numéro " & sNumero & " existe dans les soumissions mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
410: End If
				
415: Call rstProjSoum.Close()
420: End If
			
425: If bExiste = False Then
430: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetMec WHERE IDProjet = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
435: If rstProjSoum.EOF Then
440: bExiste = False
445: Else
450: bExiste = True
					
455: Call MsgBox("Le numéro " & sNumero & " existe dans les projets mécaniques!", MsgBoxStyle.OKOnly, "Erreur")
460: End If
				
465: Call rstProjSoum.Close()
470: End If
			
			'Si le projet ou la soumission n'existe pas
475: If bExiste = False Then
				'Pour pouvoir réafficher l'élément affiché avant l'ajout au cas où la personne
				'annule l'ajout
480: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNumero & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
485: If Not rstProjSoum.EOF Then
490: If rstProjSoum.Fields("Ouvert").Value = False Then
495: Call MsgBox("Ce numéro est fermé!", MsgBoxStyle.OKOnly, "Erreur")
						
500: Call rstProjSoum.Close()
505: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
						
510: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
515: Exit Sub
520: End If
525: End If
				
530: Call rstProjSoum.Close()
535: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
540: If bProjet = False Then
545: Call InitialiserTempsTaux(True)
					
550: Call InitialiserNouveauxTaux()
					
555: m_sAncienProjSoum = txtNoProjSoum.Text
					
					'Affiche le nouveau numéro
560: txtNoProjSoum.Text = sNumero
					
565: Call InitialiserVariables(txtNoProjSoum.Text)
					
					'Débarre les champs
570: Call BarrerChamps(False)
					
					'Vide les champs
575: Call ViderChamps()
580: Else
585: If VerifierProjet(sNoProjet) = True Then
						'Débarre les champs
590: Call BarrerChamps(False)
						
						'Vide les champs
595: Call ViderChamps()
						
600: txtNoProjSoum.Text = sNumero
						
605: Call RemplirSoumissionProjet(sNumero, sNoProjet)
610: Else
615: Call MsgBox("Le projet " & sNoProjet & " n'existe pas!", MsgBoxStyle.OKOnly, "Erreur")
						
620: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
						System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
						
625: Exit Sub
630: End If
635: End If
				
				'Vide la valeur par défaut si demande Sous-Section
640: m_sSousSection = vbNullString
				
645: m_bModeAjout = True
650: m_bModeAffichage = False
				
655: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
660: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
				
				'Met le form en mode ajout/modif
665: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
670: End If
675: End If
		
680: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
685: Exit Sub
		
AfficherErreur: 
		
690: Call AfficherErreur("frmProjSoumElec", "cmdAjouter_Click", Err, Erl())
	End Sub
	
	Private Function VerifierProjet(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjet As ADODB.Recordset
15: Dim bExiste As Boolean
		
20: rstProjet = New ADODB.Recordset
		
25: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
30: If Not rstProjet.EOF Then
35: bExiste = True
40: Else
45: bExiste = False
50: End If
		
55: Call rstProjet.Close()
60: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
65: VerifierProjet = bExiste
		
70: Exit Function
		
AfficherErreur: 
		
75: Call AfficherErreur("frmProjSoumElec", "VerifierProjet", Err, Erl())
	End Function
	
	Private Sub RemplirSoumissionProjet(ByVal sNoSoumission As String, ByVal sNoProjet As String)
		
5: On Error GoTo AfficherErreur
		
		'Affiche le projet ou la soumission choisie
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim bVariables As Boolean
25: Dim bTauxHoraire As Boolean
30: Dim bPrixPieces As Boolean
		
35: rstProjSoum = New ADODB.Recordset
40: rstConfig = New ADODB.Recordset
		
45: If MsgBox("Voulez-vous mettre à jour les variables systèmes?" & vbNewLine & "-  % Profit" & vbNewLine & "-  % Commission" & vbNewLine & "-  % Imprévu" & vbNewLine & "-  $ Pages manuel", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
50: bVariables = True
55: Else
60: bVariables = False
65: End If
		
70: If MsgBox("Voulez-vous mettre à jour les taux horaires?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
75: bTauxHoraire = True
80: Else
85: bTauxHoraire = False
90: End If
		
95: If MsgBox("Voulez-vous mettre à jour le prix des pièces?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
100: bPrixPieces = True
105: Else
110: bPrixPieces = False
115: End If
		
120: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjet & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
125: m_bSansTemps = rstProjSoum.Fields("SansTemps").Value
		
130: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
135: m_sTempsDessin = rstProjSoum.Fields("TempsDessin").Value
140: Else
145: m_sTempsDessin = "0"
150: End If
		
155: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsFabrication").Value) Then
160: m_sTempsFabrication = rstProjSoum.Fields("TempsFabrication").Value
165: Else
170: m_sTempsFabrication = "0"
175: End If
		
180: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
185: m_sTempsAssemblage = rstProjSoum.Fields("TempsAssemblage").Value
190: Else
195: m_sTempsAssemblage = "0"
200: End If
		
205: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgInterface").Value) Then
210: m_sTempsProgInterface = rstProjSoum.Fields("TempsProgInterface").Value
215: Else
220: m_sTempsProgInterface = "0"
225: End If
		
230: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgAutomate").Value) Then
235: m_sTempsProgAutomate = rstProjSoum.Fields("TempsProgAutomate").Value
240: Else
245: m_sTempsProgAutomate = "0"
250: End If
		
255: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgRobot").Value) Then
260: m_sTempsProgRobot = rstProjSoum.Fields("TempsProgRobot").Value
265: Else
270: m_sTempsProgRobot = "0"
275: End If
		
280: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsVision").Value) Then
285: m_sTempsVision = rstProjSoum.Fields("TempsVision").Value
290: Else
295: m_sTempsVision = "0"
300: End If
		
305: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
310: m_sTempsTest = rstProjSoum.Fields("TempsTest").Value
315: Else
320: m_sTempsTest = "0"
325: End If
		
330: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
335: m_sTempsInstallation = rstProjSoum.Fields("TempsInstallation").Value
340: Else
345: m_sTempsInstallation = "0"
350: End If
		
355: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsMiseService").Value) Then
360: m_sTempsMiseService = rstProjSoum.Fields("TempsMiseService").Value
365: Else
370: m_sTempsMiseService = "0"
375: End If
		
380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
385: m_sTempsFormation = rstProjSoum.Fields("TempsFormation").Value
390: Else
395: m_sTempsFormation = "0"
400: End If
		
405: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
410: m_sTempsGestion = rstProjSoum.Fields("TempsGestion").Value
415: Else
420: m_sTempsGestion = "0"
425: End If
		
430: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
435: m_sTempsShipping = rstProjSoum.Fields("TempsShipping").Value
440: Else
445: m_sTempsShipping = "0"
450: End If
		
455: Call rstConfig.Open("SELECT * FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
460: If bTauxHoraire = True Then
465: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxDessinElec").Value) Then
470: m_sTauxDessin = rstConfig.Fields("TauxDessinElec").Value
475: Else
480: m_sTauxDessin = "0"
485: End If
			
490: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxFabrication").Value) Then
495: m_sTauxFabrication = rstConfig.Fields("TauxFabrication").Value
500: Else
505: m_sTauxFabrication = "0"
510: End If
			
515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxAssemblageElec").Value) Then
520: m_sTauxAssemblage = rstConfig.Fields("TauxAssemblageElec").Value
525: Else
530: m_sTauxAssemblage = "0"
535: End If
			
540: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxProgInterface").Value) Then
545: m_sTauxProgInterface = rstConfig.Fields("TauxProgInterface").Value
550: Else
555: m_sTauxProgInterface = "0"
560: End If
			
565: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxProgAutomate").Value) Then
570: m_sTauxProgAutomate = rstConfig.Fields("TauxProgAutomate").Value
575: Else
580: m_sTauxProgAutomate = "0"
585: End If
			
590: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxProgRobot").Value) Then
595: m_sTauxProgRobot = rstConfig.Fields("TauxProgRobot").Value
600: Else
605: m_sTauxProgRobot = "0"
610: End If
			
615: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxVision").Value) Then
620: m_sTauxVision = rstConfig.Fields("TauxVision").Value
625: Else
630: m_sTauxVision = "0"
635: End If
			
640: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxTestElec").Value) Then
645: m_sTauxTest = rstConfig.Fields("TauxTestElec").Value
650: Else
655: m_sTauxTest = "0"
660: End If
			
665: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxInstallationElec").Value) Then
670: m_sTauxInstallation = rstConfig.Fields("TauxInstallationElec").Value
675: Else
680: m_sTauxInstallation = "0"
685: End If
			
690: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxMiseService").Value) Then
695: m_sTauxMiseService = rstConfig.Fields("TauxMiseService").Value
700: Else
705: m_sTauxMiseService = "0"
710: End If
			
715: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxFormationElec").Value) Then
720: m_sTauxFormation = rstConfig.Fields("TauxFormationElec").Value
725: Else
730: m_sTauxFormation = "0"
735: End If
			
740: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxGestionProjetsElec").Value) Then
745: m_sTauxGestion = rstConfig.Fields("TauxGestionProjetsElec").Value
750: Else
755: m_sTauxGestion = "0"
760: End If
			
765: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstConfig.Fields("TauxShippingElec").Value) Then
770: m_sTauxShipping = rstConfig.Fields("TauxShippingElec").Value
775: Else
780: m_sTauxShipping = "0"
785: End If
790: Else
795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
800: m_sTauxDessin = rstProjSoum.Fields("TauxDessin").Value
805: Else
810: m_sTauxDessin = "0"
815: End If
			
820: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFabrication").Value) Then
825: m_sTauxFabrication = rstProjSoum.Fields("TauxFabrication").Value
830: Else
835: m_sTauxFabrication = "0"
840: End If
			
845: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
850: m_sTauxAssemblage = rstProjSoum.Fields("TauxAssemblage").Value
855: Else
860: m_sTauxAssemblage = "0"
865: End If
			
870: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxProgInterface").Value) Then
875: m_sTauxProgInterface = rstProjSoum.Fields("TauxProgInterface").Value
880: Else
885: m_sTauxProgInterface = "0"
890: End If
			
895: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxProgAutomate").Value) Then
900: m_sTauxProgAutomate = rstProjSoum.Fields("TauxProgAutomate").Value
905: Else
910: m_sTauxProgAutomate = "0"
915: End If
			
920: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxProgRobot").Value) Then
925: m_sTauxProgRobot = rstProjSoum.Fields("TauxProgRobot").Value
930: Else
935: m_sTauxProgRobot = "0"
940: End If
			
945: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxVision").Value) Then
950: m_sTauxVision = rstProjSoum.Fields("TauxVision").Value
955: Else
960: m_sTauxVision = "0"
965: End If
			
970: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
975: m_sTauxTest = rstProjSoum.Fields("TauxTest").Value
980: Else
985: m_sTauxTest = "0"
990: End If
			
995: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
1000: m_sTauxInstallation = rstProjSoum.Fields("TauxInstallation").Value
1005: Else
1010: m_sTauxInstallation = "0"
1015: End If
			
1020: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxMiseService").Value) Then
1025: m_sTauxMiseService = rstProjSoum.Fields("TauxMiseService").Value
1030: Else
1035: m_sTauxMiseService = "0"
1040: End If
			
1045: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
1050: m_sTauxFormation = rstProjSoum.Fields("TauxFormation").Value
1055: Else
1060: m_sTauxFormation = "0"
1065: End If
			
1070: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
1075: m_sTauxGestion = rstProjSoum.Fields("TauxGestion").Value
1080: Else
1085: m_sTauxGestion = "0"
1090: End If
			
1095: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1100: m_sTauxShipping = rstProjSoum.Fields("TauxShipping").Value
1105: Else
1110: m_sTauxShipping = "0"
1115: End If
1120: End If
		
1125: If bVariables = True Then
1130: m_sProfit = rstConfig.Fields("ProfitElec").Value
1135: m_sCommission = rstConfig.Fields("Commission").Value
1140: m_sImprevue = rstConfig.Fields("Imprévus").Value
1145: Else
1150: m_sProfit = rstProjSoum.Fields("Profit").Value
1155: m_sCommission = rstProjSoum.Fields("Commission").Value
1160: m_sImprevue = rstProjSoum.Fields("Imprevue").Value
1165: End If
		
1170: Call rstConfig.Close()
1175: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
1180: txtProjet.Text = rstProjSoum.Fields("Description").Value
1185: txtNbreManuel.Text = rstProjSoum.Fields("NbreManuel").Value
1190: txtPrixManuel.Text = rstProjSoum.Fields("total_manuel").Value
1195: txtTransport.Text = rstProjSoum.Fields("transport").Value
		
1200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("CheminPhotos").Value) Then
1205: txtCheminPhotos.Text = rstProjSoum.Fields("CheminPhotos").Value
1210: Else
1215: txtCheminPhotos.Text = vbNullString
1220: End If
		
1225: chkCSA.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CSA").Value))
1230: chkCUL.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CUL").Value))
1235: chkUL.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("UL").Value))
1240: chkCUR.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CUR").Value))
1245: chkUR.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("UR").Value))
1250: chkCE.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CE").Value))
		
1255: txtPrixTotal.Text = rstProjSoum.Fields("PrixTotal").Value
1260: txtProfit.Text = rstProjSoum.Fields("total_profit").Value
		
1265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("Delais").Value) Then
1270: txtDelais.Text = rstProjSoum.Fields("Delais").Value
1275: Else
1280: txtDelais.Text = "0"
1285: End If
		
1290: txtCommission.Text = rstProjSoum.Fields("total_commission").Value
		
1295: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("MontantForfait").Value) Then
1300: txtForfait.Text = rstProjSoum.Fields("MontantForfait").Value
			
1305: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("InitialeForfait").Value) Then
1310: lblForfaitInitiale.Text = rstProjSoum.Fields("InitialeForfait").Value
1315: Else
1320: lblForfaitInitiale.Text = ""
1325: End If
1330: Else
1335: txtForfait.Text = ""
1340: lblForfaitInitiale.Text = ""
1345: End If
		
1350: Call rstProjSoum.Close()
1355: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'Affiche les pieces de la soumission
1360: Call RemplirListViewSoumissionProjet(sNoProjet)
		
1365: If bPrixPieces = True Then
1370: Call UpdatePieces()
1375: End If
		
1380: m_bModeAffichage = False
		
1385: Call CalculerPrix()
		
1390: Exit Sub
		
AfficherErreur: 
		
1395: Call AfficherErreur("frmProjSoumElec", "RemplirProjSoum", Err, Erl())
	End Sub
	
	Private Sub RechercherProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui recherche une soumission ou un projet dans le combo
		'et qui le sélectionne
10: Dim iCompteur As Short
		
		'Pour chaque élément du combo
15: For iCompteur = 0 To cmbProjSoum.Items.Count - 1
			'Si le texte de l'élément du combo est égal au numéro recherché
20: If VB6.GetItemString(cmbProjSoum, iCompteur) = sNoProjSoum Then
				'On le sélectionne
25: cmbProjSoum.SelectedIndex = iCompteur
				
30: Exit For
35: End If
40: Next 
		
45: Exit Sub
		
AfficherErreur: 
		
50: Call AfficherErreur("frmProjSoumElec", "RechercherProjSoum", Err, Erl())
	End Sub
	
	Private Sub RemplirProjSoum()
		
5: On Error GoTo AfficherErreur
		
		'Affiche le projet ou la soumission choisie
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstSoum As ADODB.Recordset
20: Dim rstClient As ADODB.Recordset
25: Dim rstContact As ADODB.Recordset
		
30: rstProjSoum = New ADODB.Recordset
35: rstSoum = New ADODB.Recordset
40: rstClient = New ADODB.Recordset
45: rstContact = New ADODB.Recordset
		
		'Ouvre le recordset selon le type
50: If m_eType = enumType.TYPE_PROJET Then
55: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
60: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
65: txtNoSoumission.Text = rstProjSoum.Fields("IDSoumission").Value
70: Else
75: txtNoSoumission.Text = vbNullString
80: End If
			
85: If VB.Right(txtNoProjSoum.Text, 2) >= "60" And VB.Right(txtNoProjSoum.Text, 2) <= "98" Then
90: If Trim(rstProjSoum.Fields("LiaisonChargeable").Value) <> "" Then
95: m_sLiaison = rstProjSoum.Fields("LiaisonChargeable").Value
100: Else
105: m_sLiaison = vbNullString
					
110: Do While Trim(m_sLiaison) = vbNullString
115: m_sLiaison = InputBox("Quelle est l'extention au projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & " auquel ce projet sera lié?")
120: Loop 
					
125: rstProjSoum.Fields("LiaisonChargeable").Value = m_sLiaison
					
130: Call rstProjSoum.Update()
135: End If
140: End If
145: Else
150: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
155: End If
		
160: m_bSansTemps = rstProjSoum.Fields("SansTemps").Value
		
		'Recordset pour avoir le nom du client
165: Call rstClient.Open("SELECT NomClient, IDClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Recordset pour avoir le nom du contact
170: Call rstContact.Open("SELECT NomContact, IDContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
175: txtClient.Text = rstClient.Fields("NomClient").Value
		
180: txtcontact.Text = rstContact.Fields("NomContact").Value
		
185: Call rstClient.Close()
190: 'UPGRADE_NOTE: Object rstClient may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstClient = Nothing
		
195: Call rstContact.Close()
200: 'UPGRADE_NOTE: Object rstContact may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstContact = Nothing
		
205: txtProjet.Text = rstProjSoum.Fields("Description").Value
210: txtNbreManuel.Text = rstProjSoum.Fields("NbreManuel").Value
215: txtPrixManuel.Text = Conversion_Renamed(rstProjSoum.Fields("total_manuel"), ModuleMain.enumConvert.MODE_PAS_FORMAT)
220: txtTransport.Text = rstProjSoum.Fields("transport").Value
		
225: txtTotalPieces.Text = Conversion_Renamed(rstProjSoum.Fields("Total_Piece"), ModuleMain.enumConvert.MODE_ARGENT)
230: txtTotalTemps.Text = Conversion_Renamed(rstProjSoum.Fields("Total_Temps"), ModuleMain.enumConvert.MODE_ARGENT)
235: txtPrixTotal.Text = Conversion_Renamed(rstProjSoum.Fields("PrixTotal"), ModuleMain.enumConvert.MODE_ARGENT)
240: txtImprevus.Text = Conversion_Renamed(rstProjSoum.Fields("Total_Imprevue"), ModuleMain.enumConvert.MODE_ARGENT)
245: txtProfit.Text = Conversion_Renamed(rstProjSoum.Fields("total_profit"), ModuleMain.enumConvert.MODE_ARGENT)
250: txtCommission.Text = Conversion_Renamed(rstProjSoum.Fields("total_commission"), ModuleMain.enumConvert.MODE_ARGENT)
		
255: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("CheminPhotos").Value) Then
260: txtCheminPhotos.Text = rstProjSoum.Fields("CheminPhotos").Value
265: Else
270: txtCheminPhotos.Text = vbNullString
275: End If
		
280: chkCSA.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CSA").Value))
285: chkCUL.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CUL").Value))
290: chkUL.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("UL").Value))
295: chkCUR.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CUR").Value))
300: chkUR.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("UR").Value))
305: chkCE.CheckState = System.Math.Abs(CShort(rstProjSoum.Fields("CE").Value))
		
310: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("Delais").Value) Then
315: txtDelais.Text = Trim(rstProjSoum.Fields("Delais").Value)
320: Else
325: txtDelais.Text = ""
330: End If
		
335: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("MontantForfait").Value) Then
340: txtForfait.Text = Conversion_Renamed(rstProjSoum.Fields("MontantForfait"), ModuleMain.enumConvert.MODE_ARGENT)
			
345: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("InitialeForfait").Value) Then
350: lblForfaitInitiale.Text = rstProjSoum.Fields("InitialeForfait").Value
355: Else
360: lblForfaitInitiale.Text = ""
365: End If
370: Else
375: txtForfait.Text = ""
380: lblForfaitInitiale.Text = ""
385: End If
		
390: If m_eType = enumType.TYPE_PROJET Then
395: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("PrixRéception").Value) Then
400: If Trim(rstProjSoum.Fields("PrixRéception").Value) <> "" Then
405: txtPrixReception.Text = Conversion_Renamed(rstProjSoum.Fields("PrixRéception"), ModuleMain.enumConvert.MODE_ARGENT)
410: Else
415: txtPrixReception.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
420: End If
425: Else
430: txtPrixReception.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
435: End If
			
440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
445: Call rstSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & rstProjSoum.Fields("IDSoumission").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
450: If Not rstSoum.EOF Then
455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("PrixTotal").Value) Then
460: If Trim(rstSoum.Fields("PrixTotal").Value) <> "" Then
465: txtPrixSoumission.Text = Conversion_Renamed(rstSoum.Fields("PrixTotal"), ModuleMain.enumConvert.MODE_ARGENT)
470: Else
475: txtPrixSoumission.Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
480: End If
485: Else
490: txtPrixSoumission.Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
495: End If
500: Else
505: txtPrixSoumission.Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
510: End If
				
515: Call rstSoum.Close()
520: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstSoum = Nothing
525: End If
530: End If
		
535: Call rstProjSoum.Close()
540: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'Affiche les pieces de la soumission
545: Call RemplirListViewProjSoum(txtNoProjSoum.Text)
		
550: Exit Sub
		
AfficherErreur: 
		
555: Call AfficherErreur("frmProjSoumElec", "RemplirProjSoum", Err, Erl())
	End Sub
	
	Private Sub RemplirComboCategoriesPieces()
		
5: On Error GoTo AfficherErreur
		
		'Remplir le combo des tables (Pièces)
10: Dim rstCatalogueElec As ADODB.Recordset
		
		'Il faut vider le combo avant de le remplir
15: Call cmbPieces.Items.Clear()
		
		'Cette méthode crée un recordset contenant les categorie
		'le nom de toutes les tables de la BD
20: rstCatalogueElec = New ADODB.Recordset
		
25: Call rstCatalogueElec.Open("SELECT DISTINCT CATEGORIE FROM GRB_CatalogueElec ORDER BY CATEGORIE", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Tant que ce n'est pas la fin des enregistrements
30: Do While Not rstCatalogueElec.EOF
35: Call cmbPieces.Items.Add(rstCatalogueElec.Fields("CATEGORIE").Value)
			
40: Call rstCatalogueElec.MoveNext()
45: Loop 
		
50: Call rstCatalogueElec.Close()
55: 'UPGRADE_NOTE: Object rstCatalogueElec may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstCatalogueElec = Nothing
		
60: If cmbPieces.Items.Count > 0 Then
65: cmbPieces.SelectedIndex = 0
70: End If
		
75: Exit Sub
		
AfficherErreur: 
		
80: Call AfficherErreur("frmProjSoumElec", "RemplirComboCategoriesPieces", Err, Erl())
	End Sub
	
	Private Sub RemplirComboClients(ByVal sRecherche As String)
		
5: On Error GoTo AfficherErreur
		
		'Remplit le combo des clients
10: Dim rstClient As ADODB.Recordset
		
15: Call cmbclient.Items.Clear()
		
20: rstClient = New ADODB.Recordset
		
25: Call rstClient.Open("SELECT NomClient, IDClient FROM GRB_Client WHERE Instr(1, NomClient, '" & Replace(sRecherche, "'", "''") & "') > 0 AND Supprimé = False", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
30: Do While Not rstClient.EOF
			'on met le nom du client dans le combo
35: Call cmbclient.Items.Add(rstClient.Fields("NomClient").Value)
			
			'on met l'id du client dans l'itemdata
40: 'UPGRADE_ISSUE: ComboBox property cmbclient.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
			VB6.SetItemData(cmbclient, cmbclient.NewIndex, rstClient.Fields("IDClient").Value)
			
45: Call rstClient.MoveNext()
50: Loop 
		
55: Call rstClient.Close()
60: 'UPGRADE_NOTE: Object rstClient may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstClient = Nothing
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumElec", "RemplirComboClients", Err, Erl())
	End Sub
	
	Private Sub RemplirComboContacts()
		
5: On Error GoTo AfficherErreur
		
		'Remplis le combo des contacts selon le client choisi
10: Dim rstContact As ADODB.Recordset
		
15: Call cmbContact.Items.Clear()
		
20: If cmbclient.SelectedIndex > -1 Then
25: rstContact = New ADODB.Recordset
			
30: Call rstContact.Open("SELECT NomContact, IDContact FROM GRB_Contact INNER JOIN GRB_ContactClient ON GRB_Contact.IDContact = GRB_ContactClient.NoContact WHERE GRB_ContactClient.noClient = " & VB6.GetItemData(cmbclient, cmbclient.SelectedIndex), g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
			'Si il n'y a aucun contact pour le client choisi
35: If rstContact.EOF Then
				'On ajoute tous les contacts
40: Call rstContact.Close()
				
45: Call rstContact.Open("SELECT NomContact, IDContact FROM GRB_Contact WHERE Supprimé = False", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: End If
			
55: Do While Not rstContact.EOF
				'On ajoute le nom du contact dans le combo
60: Call cmbContact.Items.Add(rstContact.Fields("NomContact").Value)
				
				'On ajoute l'id du contact dans l'itemdata du combo
65: 'UPGRADE_ISSUE: ComboBox property cmbContact.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
				VB6.SetItemData(cmbContact, cmbContact.NewIndex, rstContact.Fields("IDContact").Value)
				
70: Call rstContact.MoveNext()
75: Loop 
			
80: Call rstContact.Close()
85: 'UPGRADE_NOTE: Object rstContact may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstContact = Nothing
			
			'Si le combo n'est pas vide, on sélectionne le premier élément
90: If cmbContact.Items.Count > 0 Then
95: cmbContact.SelectedIndex = 0
100: End If
105: End If
		
110: Exit Sub
		
AfficherErreur: 
		
115: Call AfficherErreur("frmProjSoumElec", "RemplirComboContacts", Err, Erl())
	End Sub
	
	Private Sub RemplirComboSections()
		
5: On Error GoTo AfficherErreur
		
		'Remplis le combo des sections
10: Dim rstSection As ADODB.Recordset
15: Dim sChamps As String
		
20: Call cmbSections.Items.Clear()
		
25: rstSection = New ADODB.Recordset
		
		'Il faut le remplir selon l'ordre
30: Call rstSection.Open("SELECT * FROM GRB_SoumProjSectionElec ORDER BY Ordre", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
35: If m_eLangage = enumLangage.ANGLAIS Then
40: sChamps = "NomSectionEN"
45: Else
50: sChamps = "NomSectionFR"
55: End If
		
60: Do While Not rstSection.EOF
			'On met le nom de la section dans le combo
65: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstSection.Fields(sChamps).Value) Then
70: Call cmbSections.Items.Add(rstSection.Fields(sChamps).Value)
75: Else
80: Call cmbSections.Items.Add(vbNullString)
85: End If
			
			'On met l'id de la section dans l'itemdata du combo
90: 'UPGRADE_ISSUE: ComboBox property cmbSections.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
			VB6.SetItemData(cmbSections, cmbSections.NewIndex, rstSection.Fields("IDSection").Value)
			
95: Call rstSection.MoveNext()
100: Loop 
		
105: Call rstSection.Close()
110: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
		'Si le combo n'est pas vide, on sélectionne le premier élément
115: If cmbSections.Items.Count > 0 Then
120: cmbSections.SelectedIndex = 0
125: End If
		
130: Exit Sub
		
AfficherErreur: 
		
135: Call AfficherErreur("frmProjSoumElec", "RemplirComboSections", Err, Erl())
	End Sub
	
	Private Sub cmdImprimer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdImprimer.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: If txtNoProjSoum.Text <> vbNullString Then
25: If VerifierSiOuvert(sUser) = False Then
				
30: rstProjSoum = New ADODB.Recordset
				
				'Ouvre les tables
35: If m_eType = enumType.TYPE_PROJET Then
40: If MsgBox("Voulez-vous faire imprimer le projet et tous les extras associés à ce projet?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
45: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE Left(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' ORDER BY IDProjet", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: Else
55: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "' ORDER BY IDProjet", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
60: End If
65: Else
70: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "' ORDER BY IDSoumission", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
75: End If
				
76: bTrigger = False
77: intdummie = 0
				
				'***********************************************************************************
				'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
				'***********************************************************************************
				If MsgBox("Désirez-vous afficher les dates de réception et de commande?", MsgBoxStyle.YesNo, "Date de réception et de commande") = MsgBoxResult.Yes Then
					bFlag = True
				Else
					bFlag = False
				End If
				'***********************************************************************************
				
80: Do While Not rstProjSoum.EOF
85: If m_eType = enumType.TYPE_PROJET Then
90: Call CalculerTotalRecordset(rstProjSoum.Fields("IDProjet").Value)
95: End If
					
100: Call ImprimerProjSoum(rstProjSoum)
101: If Not intdummie = MsgBoxResult.Yes Then
105: Call ImprimerListePieces(rstProjSoum)
106: End If
					
110: Call rstProjSoum.MoveNext()
115: Loop 
				
120: Call rstProjSoum.Close()
125: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
130: Else
135: If m_eType = enumType.TYPE_PROJET Then
140: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
145: Else
150: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
155: End If
160: End If
165: End If
		
170: Exit Sub
		
AfficherErreur: 
		
175: Call AfficherErreur("frmProjSoumElec", "cmdImprimer_Click", Err, Erl())
	End Sub
	
	Private Sub ImprimerProjSoum(ByVal rstProjSoum As ADODB.Recordset)
		Dim DR_SoumissionElec As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de soumission
10: Dim rstPiece As ADODB.Recordset
15: Dim rstPrixSoum As ADODB.Recordset
20: Dim rstTemp As ADODB.Recordset
25: Dim rstImpProjSoum As ADODB.Recordset
30: Dim rstSoum As ADODB.Recordset
35: Dim sOrdreSection As String
40: Dim iCompteurSoum As Short
45: Dim sSousSection As String
50: Dim sSousSectionRS As String
55: Dim dblTempsDessin As Double
60: Dim dblTempsFabrication As Double
65: Dim dblTempsAssemblage As Double
70: Dim dblTempsProgInterface As Double
75: Dim dblTempsProgAutomate As Double
80: Dim dblTempsProgRobot As Double
85: Dim dblTempsVision As Double
90: Dim dblTempsTest As Double
95: Dim dblTempsInstallation As Double
100: Dim dblTempsMiseService As Double
105: Dim dblTempsFormation As Double
110: Dim dblTempsGestion As Double
115: Dim dblTempsShipping As Double
120: Dim dblTotalTemps As Double
125: Dim dblTotalAutre As Double
130: Dim dblTotalReste As Double
135: Dim dblTotalHebergement As Double
140: Dim dblTotalRepas As Double
145: Dim dblTotalTransport As Double
150: Dim dblTotalUniteMobile As Double
155: Dim sChampsSection As String
160: Dim sNoProjet As String
165: Dim sNoSoumission As String
170: Dim dblPrixEmballage As Double
		
		'Supprime les données de l'impression
175: Call g_connData.Execute("DELETE * FROM GRB_impression_soumission")
		
180: iCompteurSoum = 1
		
185: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
190: rstImpProjSoum = New ADODB.Recordset
		
195: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_soumission", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
200: sOrdreSection = vbNullString
		
205: rstPiece = New ADODB.Recordset
		
210: If m_eType = enumType.TYPE_PROJET Then
215: sNoProjet = rstProjSoum.Fields("IDProjet").Value
			
220: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
225: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
230: Else
235: sNoSoumission = vbNullString
240: End If
			
245: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' And Type = 'E' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
250: Else
255: sNoProjet = vbNullString
260: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
265: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoSoumission & "' And Type = 'E' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
270: End If
		
275: rstTemp = New ADODB.Recordset
		
280: Do While Not rstPiece.EOF
285: sSousSectionRS = rstPiece.Fields("SousSection").Value
			
290: If sSousSectionRS = S_PAS_SOUS_SECTION Then
295: sSousSectionRS = " "
300: End If
			
305: If sOrdreSection <> rstPiece.Fields("OrdreSection").Value Then
				'remplis la table impression_soumission
				'ajoute seulement la section
310: sOrdreSection = rstPiece.Fields("OrdreSection").Value
				
315: If m_eLangage = enumLangage.ANGLAIS Then
320: sChampsSection = "NomSectionEN"
325: Else
330: sChampsSection = "NomSectionFR"
335: End If
				
340: Call rstTemp.Open("SELECT " & sChampsSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajoute la section dans la soumission
345: Call rstImpProjSoum.AddNew()
				
350: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
355: If m_eType = enumType.TYPE_PROJET Then
360: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
365: Else
370: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
375: End If
				
380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstTemp.Fields(sChampsSection).Value) Then
385: rstImpProjSoum.Fields("NomSection").Value = rstTemp.Fields(sChampsSection).Value
390: Else
395: rstImpProjSoum.Fields("NomSection").Value = " "
400: End If
				
405: Call rstImpProjSoum.Update()
				
410: iCompteurSoum = iCompteurSoum + 1
				
415: Call rstTemp.Close()
				
420: sSousSection = rstPiece.Fields("SousSection").Value
				
425: If sSousSection = S_PAS_SOUS_SECTION Or sSousSection = "" Then
430: sSousSection = " "
435: End If
				
440: Call rstImpProjSoum.AddNew()
				
445: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
450: If m_eType = enumType.TYPE_PROJET Then
455: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
460: Else
465: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
470: End If
				
475: rstImpProjSoum.Fields("SousSection").Value = sSousSection
				
480: Call rstImpProjSoum.Update()
				
485: iCompteurSoum = iCompteurSoum + 1
490: Else
				'ajoute une soussection dans impression_soum
495: If sSousSection <> sSousSectionRS Then
500: sSousSection = sSousSectionRS
					
505: Call rstImpProjSoum.AddNew()
					
510: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
					
515: If m_eType = enumType.TYPE_PROJET Then
520: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
525: Else
530: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
535: End If
					
540: rstImpProjSoum.Fields("SousSection").Value = sSousSectionRS
					
545: Call rstImpProjSoum.Update()
					
550: iCompteurSoum = iCompteurSoum + 1
555: End If
560: End If
			
			'ajoute une piece dans impression_soum
565: Call rstImpProjSoum.AddNew()
			
570: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
			
575: If m_eType = enumType.TYPE_PROJET Then
580: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
585: Else
590: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
595: End If
			
600: rstImpProjSoum.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value
605: rstImpProjSoum.Fields("Qté").Value = rstPiece.Fields("Qté").Value
			
610: If m_eLangage = enumLangage.ANGLAIS Then
615: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_EN").Value
620: Else
625: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_FR").Value
630: End If
			
			
			'************************************************************************************************
			'SECTION MODIFIER PAR GAÉTAN GINGRAS LE 6 FÉVRIER 2010
			'************************************************************************************************
			
635: rstImpProjSoum.Fields("MANUFACT").Value = rstPiece.Fields("MANUFACT").Value
640: 'rstImpProjSoum.Fields("PRIX_LIST") = rstPiece.Fields("PRIX_LIST")
			
645: 'If Trim(rstPiece.Fields("ESCOMPTE")) <> vbNullString Then
650: '  rstImpProjSoum.Fields("ESCOMPTE") = Conversion(Replace(rstPiece.Fields("ESCOMPTE"), ".", ","), MODE_POURCENT)
655: 'Else
660: '  rstImpProjSoum.Fields("ESCOMPTE") = Conversion(0, MODE_POURCENT)
665: 'End If
			
670: rstImpProjSoum.Fields("PRIX_NET").Value = rstPiece.Fields("PRIX_NET").Value
			
675: Call rstTemp.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstPiece.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
680: If Not rstTemp.EOF Then
685: rstImpProjSoum.Fields("NomFournisseur").Value = rstTemp.Fields("NomFournisseur").Value
690: End If
			
695: Call rstTemp.Close()
			
700: 'rstImpProjSoum.Fields("TEMPS") = rstPiece.Fields("TEMPS")
705: 'rstImpProjSoum.Fields("TEMPS_TOTAL") = rstPiece.Fields("TEMPS_TOTAL")
710: rstImpProjSoum.Fields("PRIX_TOTAL").Value = rstPiece.Fields("PRIX_TOTAL").Value
712: rstImpProjSoum.Fields("PROFIT_ARGENT").Value = rstPiece.Fields("PROFIT_ARGENT").Value
			
			
			''''''''''''''''''''''''''''''''''''''''''''''''''''
			'' ajout du Numéros sequentiel de commande dans impression
			''''''''''''''''''''''''''''''''
			rstImpProjSoum.Fields("NoSéquentiel").Value = rstPiece.Fields("NoSéquentiel").Value
			
			'AJOUT DE CETTE SECTION PAR GAÉTAN GINGRAS LE 6 FÉVRIER 2010
			'*************************************************************
			If m_eType = enumType.TYPE_PROJET Then
				If Trim(rstPiece.Fields("DateRéception").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateReception").Value = rstPiece.Fields("DateRéception").Value
				Else
					rstImpProjSoum.Fields("DateReception").Value = ""
				End If
				If Trim(rstPiece.Fields("DateCommande").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateCommande").Value = rstPiece.Fields("DateCommande").Value
				Else
					rstImpProjSoum.Fields("DateCommande").Value = ""
				End If
			Else 'il n'y a pas de champ date de réception et de commande dans la table GRB_Soumission_Pièces
				rstImpProjSoum.Fields("DateReception").Value = ""
				rstImpProjSoum.Fields("DateCommande").Value = ""
			End If
			'************************************************************************************************
			'FIN DE LA SECTION DE MODIFICATION
			'************************************************************************************************
			
713: Call rstImpProjSoum.Update()
			
714: iCompteurSoum = iCompteurSoum + 1
			
			'prochaine enreg
715: Call rstPiece.MoveNext()
716: Loop 
		
		'ferme les tables
717: Call rstImpProjSoum.Close()
		
		''''''''''''''''''''''''''''''''''
		' rapport soumission, met dans l'ordre de ligne
		''''''''''''''''''''''''''''''''''''
		
718: Dim sProjet As String
		
719: If m_eType = enumType.TYPE_PROJET Then
720: sProjet = sNoProjet
721: Else
722: sProjet = sNoSoumission
723: End If
		
724: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_Soumission WHERE IDSoumission = '" & sProjet & "' ORDER BY NoLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
725: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.DataSource = rstImpProjSoum
		
		'***********************************************************************
		'Pour cas d'urgence, la fonction d'exporter dans Excel va être ici.
		'Nous pourrons plus tard le mettre à un meilleur endroit.
		'Gaétan Gingras le 14 mai 2009
		'***********************************************************************
		
726: If bTrigger = False Then
727: bTrigger = True
728: intdummie = MsgBox("Désirez-vous exporter les données dans Excel, SEULEMENT ?", MsgBoxStyle.YesNo + MsgBoxStyle.Information, "Exportation dans Excel")
729: End If
730: Dim sqlstr As String
		Dim rstExport As ADODB.Recordset
		If intdummie = MsgBoxResult.Yes Then
742: 743: 744: rstExport = New ADODB.Recordset
745: 'sqlstr = "SELECT GRB_impression_soumission.IDSoumission, CDbl([Qté]) AS Quantité, GRB_impression_soumission.NumItem, GRB_impression_soumission.Description, GRB_impression_soumission.Manufact, CDbl([Prix_list]) AS PrixdeListe, CDbl(Left([escompte],Len([escompte])-1)) AS Escomptes, CDbl([Prix_net]) AS prix_nette, GRB_impression_soumission.NomFournisseur, GRB_impression_soumission.DateReception , GRB_impression_soumission.DateCommande "
746: sqlstr = "SELECT GRB_impression_soumission.IDSoumission, CDbl([Qté]) AS Quantité, GRB_impression_soumission.NumItem, GRB_impression_soumission.Description, GRB_impression_soumission.Manufact, CDbl([Prix_list]) AS PrixdeListe, CDbl(Left([escompte],Len([escompte])-1)) AS Escomptes, CDbl([Prix_net]) AS prix_nette, GRB_impression_soumission.Prix_total - GRB_impression_soumission.Profit_Argent AS Prix_Total ,GRB_impression_soumission.NomFournisseur, GRB_impression_soumission.DateReception , GRB_impression_soumission.DateCommande ,  GRB_impression_soumission.NoSéquentiel "
			
			sqlstr = sqlstr & "FROM GRB_impression_soumission "
747: sqlstr = sqlstr & "WHERE (((GRB_impression_soumission.IDSoumission)='" & sProjet & "') AND ((GRB_impression_soumission.NumItem) Is Not Null)) "
748: sqlstr = sqlstr & "ORDER BY GRB_impression_soumission.noligne"
749: Call rstExport.Open(sqlstr, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
750: Call ExportdansExcel(rstExport)
751: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
			System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
752: Exit Sub
753: End If
		'***********************************************************************
		
775: Call TraduireImpressionSoumission()
		
780: If m_eType = enumType.TYPE_PROJET Then
785: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("shpCadrePrixReception").Visible = True
790: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixReception").Visible = True
795: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixReception").Visible = True
			
800: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("shpCadrePrixSoumission").Visible = True
805: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixSoumission").Visible = True
810: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixSoumission").Visible = True
815: Else
820: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("shpCadrePrixReception").Visible = False
825: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixReception").Visible = False
830: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixReception").Visible = False
			
835: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("shpCadrePrixSoumission").Visible = False
840: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixSoumission").Visible = False
845: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixSoumission").Visible = False
850: End If
		
		'affiche la date
		'**************************************************
		'ajout par Gaétan Gingras le 20 mai 2009
854: If MsgBox("Désirez-vous afficher la date en bas de page ?", MsgBoxStyle.YesNo + MsgBoxStyle.Information, "Affichage de la date") = MsgBoxResult.Yes Then
855: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("section3").Controls("lbldate").Caption = ConvertDate(Today)
856: Else
857: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("section3").Controls("lbldate").Caption = " "
858: End If
		'**************************************************
		
		'affiche entete
860: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
865: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblSoumission").Caption = rstProjSoum.Fields("IDSoumission").Value
870: Else
875: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblSoumission").Caption = vbNullString
880: End If
		
885: If m_eType = enumType.TYPE_PROJET Then
890: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblprojet").Caption = rstProjSoum.Fields("IDProjet").Value
895: Else
900: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblProjet").Caption = vbNullString
905: End If
		
910: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lbldescription").Caption = rstProjSoum.Fields("Description").Value
		
915: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
920: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblclient").Caption = rstTemp.Fields("NomClient").Value
		
925: Call rstTemp.Close()
		
930: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
935: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblcontact").Caption = rstTemp.Fields("NomContact").Value
		
940: Call rstTemp.Close()
		
		'Affiche pied d'état
		
		'Temps
945: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
950: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxDessin").Caption = rstProjSoum.Fields("TauxDessin").Value
955: Else
960: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxDessin").Caption = "0"
965: End If
		
970: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxFabrication").Value) Then
975: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFabrication").Caption = rstProjSoum.Fields("TauxFabrication").Value
980: Else
985: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFabrication").Caption = "0"
990: End If
		
995: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
1000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxAssemblage").Caption = rstProjSoum.Fields("TauxAssemblage").Value
1005: Else
1010: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxAssemblage").Caption = "0"
1015: End If
		
1020: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxProgInterface").Value) Then
1025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgInterface").Caption = rstProjSoum.Fields("TauxProgInterface").Value
1030: Else
1035: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgInterface").Caption = "0"
1040: End If
		
1045: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxProgAutomate").Value) Then
1050: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgAutomate").Caption = rstProjSoum.Fields("TauxProgAutomate").Value
1055: Else
1060: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgAutomate").Caption = "0"
1065: End If
		
1070: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxProgRobot").Value) Then
1075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgRobot").Caption = rstProjSoum.Fields("TauxProgRobot").Value
1080: Else
1085: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgRobot").Caption = "0"
1090: End If
		
1095: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxVision").Value) Then
1100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxVision").Caption = rstProjSoum.Fields("TauxVision").Value
1105: Else
1110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxVision").Caption = "0"
1115: End If
		
1120: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
1125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxTest").Caption = rstProjSoum.Fields("TauxTest").Value
1130: Else
1135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxTest").Caption = "0"
1140: End If
		
1145: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
1150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxInstallation").Caption = rstProjSoum.Fields("TauxInstallation").Value
1155: Else
1160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxInstallation").Caption = "0"
1165: End If
		
1170: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxMiseService").Value) Then
1175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxMiseService").Caption = rstProjSoum.Fields("TauxMiseService").Value
1180: Else
1185: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxMiseService").Caption = "0"
1190: End If
		
1195: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
1200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFormation").Caption = rstProjSoum.Fields("TauxFormation").Value
1205: Else
1210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFormation").Caption = "0"
1215: End If
		
1220: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
1225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxGestion").Caption = rstProjSoum.Fields("TauxGestion").Value
1230: Else
1235: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxGestion").Caption = "0"
1240: End If
		
1245: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxShipping").Caption = rstProjSoum.Fields("TauxShipping").Value
1255: Else
1260: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxShipping").Caption = "0"
1265: End If
		
1270: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
1275: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = rstProjSoum.Fields("TempsDessin").Value
1280: Else
1285: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "0"
1290: End If
		
1295: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsFabrication").Value) Then
1300: If rstProjSoum.Fields("SansTemps").Value = False Then
1305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsFabricationSoum").Caption = rstProjSoum.Fields("TempsFabrication").Value
1310: Else
1315: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsFabricationSoum").Caption = "0"
1320: End If
1325: Else
1330: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsFabricationSoum").Caption = "0"
1335: End If
		
1340: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
1345: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = rstProjSoum.Fields("TempsAssemblage").Value
1350: Else
1355: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "0"
1360: End If
		
1365: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgInterface").Value) Then
1370: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgInterfaceSoum").Caption = rstProjSoum.Fields("TempsProgInterface").Value
1375: Else
1380: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgInterfaceSoum").Caption = "0"
1385: End If
		
1390: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgAutomate").Value) Then
1395: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgAutomateSoum").Caption = rstProjSoum.Fields("TempsProgAutomate").Value
1400: Else
1405: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgAutomateSoum").Caption = "0"
1410: End If
		
1415: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgRobot").Value) Then
1420: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgRobotSoum").Caption = rstProjSoum.Fields("TempsProgRobot").Value
1425: Else
1430: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgRobotSoum").Caption = "0"
1435: End If
		
1440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsVision").Value) Then
1445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsVisionSoum").Caption = rstProjSoum.Fields("TempsVision").Value
1450: Else
1455: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsVisionSoum").Caption = "0"
1460: End If
		
1465: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
1470: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsTestSoum").Caption = rstProjSoum.Fields("TempsTest").Value
1475: Else
1480: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "0"
1485: End If
		
1490: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
1495: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = rstProjSoum.Fields("TempsInstallation").Value
1500: Else
1505: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "0"
1510: End If
		
1515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsMiseService").Value) Then
1520: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsMiseServiceSoum").Caption = rstProjSoum.Fields("TempsMiseService").Value
1525: Else
1530: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsMiseServiceSoum").Caption = "0"
1535: End If
		
1540: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
1545: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = rstProjSoum.Fields("TempsFormation").Value
1550: Else
1555: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "0"
1560: End If
		
1565: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
1570: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = rstProjSoum.Fields("TempsGestion").Value
1575: Else
1580: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "0"
1585: End If
		
1590: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
1595: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = rstProjSoum.Fields("TempsShipping").Value
1600: Else
1605: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "0"
1610: End If
		
1615: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
1620: If IsNumeric(rstProjSoum.Fields("TempsDessin").Value) Then
1625: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessin").Value)
1630: Else
1635: dblTempsDessin = 0
1640: End If
1645: Else
1650: dblTempsDessin = 0
1655: End If
		
1660: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsFabrication").Value) Then
1665: If rstProjSoum.Fields("SansTemps").Value = False Then
1670: If IsNumeric(rstProjSoum.Fields("TempsFabrication").Value) Then
1675: dblTempsFabrication = CDbl(rstProjSoum.Fields("TempsFabrication").Value)
1680: Else
1685: dblTempsFabrication = 0
1690: End If
1695: Else
1700: dblTempsFabrication = 0
1705: End If
1710: Else
1715: dblTempsFabrication = 0
1720: End If
		
1725: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
1730: If IsNumeric(rstProjSoum.Fields("TempsAssemblage").Value) Then
1735: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblage").Value)
1740: Else
1745: dblTempsAssemblage = 0
1750: End If
1755: Else
1760: dblTempsAssemblage = 0
1765: End If
		
1770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgInterface").Value) Then
1775: If IsNumeric(rstProjSoum.Fields("TempsProgInterface").Value) Then
1780: dblTempsProgInterface = CDbl(rstProjSoum.Fields("TempsProgInterface").Value)
1785: Else
1790: dblTempsProgInterface = 0
1795: End If
1800: Else
1805: dblTempsProgInterface = 0
1810: End If
		
1815: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgAutomate").Value) Then
1820: If IsNumeric(rstProjSoum.Fields("TempsProgAutomate").Value) Then
1825: dblTempsProgAutomate = CDbl(rstProjSoum.Fields("TempsProgAutomate").Value)
1830: Else
1835: dblTempsProgAutomate = 0
1840: End If
1845: Else
1850: dblTempsProgAutomate = 0
1855: End If
		
1860: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgRobot").Value) Then
1865: If IsNumeric(rstProjSoum.Fields("TempsProgRobot").Value) Then
1870: dblTempsProgRobot = CDbl(rstProjSoum.Fields("TempsProgRobot").Value)
1875: Else
1880: dblTempsProgRobot = 0
1885: End If
1890: Else
1895: dblTempsProgRobot = 0
1900: End If
		
1905: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsVision").Value) Then
1910: If IsNumeric(rstProjSoum.Fields("TempsVision").Value) Then
1915: dblTempsVision = CDbl(rstProjSoum.Fields("TempsVision").Value)
1920: Else
1925: dblTempsVision = 0
1930: End If
1935: Else
1940: dblTempsVision = 0
1945: End If
		
1950: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
1955: If IsNumeric(rstProjSoum.Fields("TempsTest").Value) Then
1960: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTest").Value)
1965: Else
1970: dblTempsTest = 0
1975: End If
1980: Else
1985: dblTempsTest = 0
1990: End If
		
1995: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
2000: If IsNumeric(rstProjSoum.Fields("TempsInstallation").Value) Then
2005: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallation").Value)
2010: Else
2015: dblTempsInstallation = 0
2020: End If
2025: Else
2030: dblTempsInstallation = 0
2035: End If
		
2040: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsMiseService").Value) Then
2045: If IsNumeric(rstProjSoum.Fields("TempsMiseService").Value) Then
2050: dblTempsMiseService = CDbl(rstProjSoum.Fields("TempsMiseService").Value)
2055: Else
2060: dblTempsMiseService = 0
2065: End If
2070: Else
2075: dblTempsMiseService = 0
2080: End If
		
2085: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
2090: If IsNumeric(rstProjSoum.Fields("TempsFormation").Value) Then
2095: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormation").Value)
2100: Else
2105: dblTempsFormation = 0
2110: End If
2115: Else
2120: dblTempsFormation = 0
2125: End If
		
2130: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
2135: If IsNumeric(rstProjSoum.Fields("TempsGestion").Value) Then
2140: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestion").Value)
2145: Else
2150: dblTempsGestion = 0
2155: End If
2160: Else
2165: dblTempsGestion = 0
2170: End If
		
2175: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
2180: If IsNumeric(rstProjSoum.Fields("TempsShipping").Value) Then
2185: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShipping").Value)
2190: Else
2195: dblTempsShipping = 0
2200: End If
2205: Else
2210: dblTempsShipping = 0
2215: End If
		
2220: dblTotalTemps = dblTempsDessin + dblTempsFabrication + dblTempsAssemblage + dblTempsProgInterface + dblTempsProgAutomate + dblTempsProgRobot + dblTempsVision + dblTempsTest + dblTempsInstallation + dblTempsMiseService + dblTempsFormation + dblTempsGestion + dblTempsShipping
		
2225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = dblTotalTemps
		
2230: If m_eType = enumType.TYPE_PROJET Then
2235: Call CalculerTempsReelsImpression(rstProjSoum.Fields("IDProjet").Value)
2240: End If
		
		'Autres frais
2245: If m_eType = enumType.TYPE_PROJET Then
2250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblNbrePersonne").Caption = "0"
2255: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsHebergement").Caption = "0"
2260: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement1").Caption = "0"
2265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement2").Caption = "0"
2270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsRepas").Caption = "0"
2275: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxRepas").Caption = "0"
2280: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsTransport").Caption = "0"
2285: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxTransport").Caption = "0"
2290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = "0"
2295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = "0"
2300: Else
2305: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
2310: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblNbrePersonne").Caption = rstProjSoum.Fields("NbrePersonne").Value
2315: Else
2320: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblNbrePersonne").Caption = "0"
2325: End If
			
2330: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
2335: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsHebergement").Caption = rstProjSoum.Fields("TempsHebergement").Value
2340: Else
2345: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsHebergement").Caption = "0"
2350: End If
			
2355: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
2360: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement1").Caption = rstProjSoum.Fields("TauxHebergement1").Value
2365: Else
2370: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement1").Caption = "0"
2375: End If
			
2380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
2385: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement2").Caption = rstProjSoum.Fields("TauxHebergement2").Value
2390: Else
2395: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement2").Caption = "0"
2400: End If
			
2405: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
2410: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsRepas").Caption = rstProjSoum.Fields("TempsRepas").Value
2415: Else
2420: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsRepas").Caption = "0"
2425: End If
			
2430: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
2435: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxRepas").Caption = rstProjSoum.Fields("TauxRepas").Value
2440: Else
2445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxRepas").Caption = "0"
2450: End If
			
2455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
2460: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsTransport").Caption = rstProjSoum.Fields("TempsTransport").Value
2465: Else
2470: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsTransport").Caption = "0"
2475: End If
			
2480: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
2485: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxTransport").Caption = rstProjSoum.Fields("TauxTransport").Value
2490: Else
2495: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxTransport").Caption = "0"
2500: End If
			
2505: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
2510: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = rstProjSoum.Fields("TempsUniteMobile").Value
2515: Else
2520: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = "0"
2525: End If
			
2530: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
2535: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = rstProjSoum.Fields("TauxUniteMobile").Value
2540: Else
2545: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = "0"
2550: End If
2555: End If
		
2560: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("PrixEmballage").Value) Then
2565: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixEmballage").Caption = rstProjSoum.Fields("PrixEmballage").Value
2570: Else
2575: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixEmballage").Caption = "0"
2580: End If
		
2585: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblPrixManuel").Caption = rstProjSoum.Fields("Total_manuel").Value
		
2590: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalTempsAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_temps"), ModuleMain.enumConvert.MODE_ARGENT)
2595: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalPieceAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_piece"), ModuleMain.enumConvert.MODE_ARGENT)
2600: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblProfit").Caption = Conversion_Renamed((rstProjSoum.Fields("profit").Value - 1) * 100, ModuleMain.enumConvert.MODE_POURCENT)
2605: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalProfit").Caption = Conversion_Renamed(rstProjSoum.Fields("total_profit"), ModuleMain.enumConvert.MODE_ARGENT)
2610: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblImprevue").Caption = Conversion_Renamed(rstProjSoum.Fields("imprevue"), ModuleMain.enumConvert.MODE_POURCENT)
2615: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblImprevueAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_imprevue"), ModuleMain.enumConvert.MODE_ARGENT)
2620: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblCommission").Caption = Conversion_Renamed(rstProjSoum.Fields("commission"), ModuleMain.enumConvert.MODE_POURCENT)
2625: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblCommissionAR").Caption = Conversion_Renamed(rstProjSoum.Fields("total_commission"), ModuleMain.enumConvert.MODE_ARGENT)
		
2630: If m_eType = enumType.TYPE_PROJET Then
2635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("PrixRéception").Value) Then
2640: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblPrixReception").Caption = Conversion_Renamed(rstProjSoum.Fields("PrixRéception"), ModuleMain.enumConvert.MODE_ARGENT)
2645: Else
2650: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblPrixReception").Caption = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_ARGENT)
2655: End If
			
2660: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
2665: rstPrixSoum = New ADODB.Recordset
				
2670: Call rstPrixSoum.Open("SELECT PrixTotal FROM GRB_SoumissionElec WHERE IDSoumission = '" & rstProjSoum.Fields("IDSoumission").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
2675: If Not rstPrixSoum.EOF Then
2680: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstPrixSoum.Fields("PrixTotal").Value) Then
2685: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed(rstPrixSoum.Fields("PrixTotal"), ModuleMain.enumConvert.MODE_ARGENT)
2690: Else
2695: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
2700: End If
2705: Else
2710: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
					DR_SoumissionElec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
2715: End If
				
2720: Call rstPrixSoum.Close()
2725: 'UPGRADE_NOTE: Object rstPrixSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstPrixSoum = Nothing
2730: Else
2735: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section5").Controls("lblPrixSoumission").Caption = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
2740: End If
2745: End If
		
2750: If m_eType = enumType.TYPE_PROJET Then
2755: dblTotalHebergement = 0
2760: dblTotalRepas = 0
2765: dblTotalTransport = 0
2770: dblTotalUniteMobile = 0
2775: Else
2780: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TotalHebergement").Value) Then
2785: dblTotalHebergement = rstProjSoum.Fields("TotalHebergement").Value
2790: End If
			
2795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TotalRepas").Value) Then
2800: dblTotalRepas = rstProjSoum.Fields("TotalRepas").Value
2805: End If
			
2810: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) And Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
2815: dblTotalTransport = CDbl(rstProjSoum.Fields("TempsTransport").Value) * CDbl(rstProjSoum.Fields("TauxTransport").Value)
2820: Else
2825: dblTotalTransport = 0
2830: End If
			
2835: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) And Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
2840: dblTotalUniteMobile = CDbl(rstProjSoum.Fields("TempsUniteMobile").Value) * CDbl(rstProjSoum.Fields("TauxUniteMobile").Value)
2845: Else
2850: dblTotalUniteMobile = 0
2855: End If
2860: End If
		
2865: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("PrixEmballage").Value) Then
2870: dblPrixEmballage = CDbl(Replace(rstProjSoum.Fields("PrixEmballage").Value, ".", ","))
2875: Else
2880: dblPrixEmballage = 0
2885: End If
		
2890: dblTotalReste = dblTotalHebergement + dblTotalRepas + dblTotalTransport + dblTotalUniteMobile + dblPrixEmballage
		
2895: dblTotalAutre = dblTotalReste + CDbl(rstProjSoum.Fields("total_manuel").Value)
		
2900: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblAutre").Caption = Conversion_Renamed(CStr(dblTotalAutre), ModuleMain.enumConvert.MODE_ARGENT)
		
2905: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblGrandTotalAR").Caption = Conversion_Renamed(rstProjSoum.Fields("prixtotal"), ModuleMain.enumConvert.MODE_ARGENT)
		
2910: If rstProjSoum.Fields("MontantForfait").Value <> "" Then
2915: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("shpCadreForfait").Visible = True
2920: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreForfait").Visible = True
2925: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblForfait").Visible = True
			
2930: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreForfait").Caption = DR_SoumissionElec.Sections("Section5").Controls("lblTitreForfait").Caption & " ( " & rstProjSoum.Fields("InitialeForfait").Value & " )"
2935: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblForfait").Caption = rstProjSoum.Fields("MontantForfait").Value
2940: Else
2945: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("shpCadreForfait").Visible = False
2950: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreForfait").Visible = False
2955: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblForfait").Visible = False
2960: End If
		
		'************************************************************************************************
		'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 7 FÉVRIER 2010
		'************************************************************************************************
		If bFlag = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateReception").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateReception").Visible = True
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateReception").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateReception").Visible = False
		End If
		'************************************************************************************************
		'FIN DE LA SECTION MODIFIÉ
		'************************************************************************************************
		
		
		'Affiche le rapport soumission
		'2965    DR_SoumissionElec.Orientation = rptOrientLandscape
		
2970: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_SoumissionElec.Show(VB6.FormShowConstants.Modal)
		
2975: Call rstImpProjSoum.Close()
2980: 'UPGRADE_NOTE: Object rstImpProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpProjSoum = Nothing
		
2985: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
2990: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
2995: Exit Sub
		
AfficherErreur: 
		
3000: Call AfficherErreur("frmProjSoumElec", "ImprimerProjSoum", Err, Erl())
	End Sub
	
	Private Sub ImprimerListePieces(ByVal rstProjSoum As ADODB.Recordset)
		Dim DR_Liste_piece As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de la liste des pièces
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpListePiece As ADODB.Recordset
25: Dim iCompteurPiece As Short
30: Dim sSousSection As String
35: Dim sSection As String
40: Dim sNoProjet As String
45: Dim sNoSoumission As String
50: Dim bAjouterSection As Boolean
55: Dim bAjouterSousSection As Boolean
60: Dim bAjouterPiece As Boolean
		
65: rstPiece = New ADODB.Recordset
70: rstTemp = New ADODB.Recordset
75: rstImpListePiece = New ADODB.Recordset
		
80: Call g_connData.Execute("DELETE * FROM GRB_impression_listepiece")
		
85: iCompteurPiece = 1
		
90: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
		'Ouverture du recordset
95: If m_eType = enumType.TYPE_PROJET Then
100: sNoProjet = rstProjSoum.Fields("IDProjet").Value
			
105: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDSoumission").Value) Then
110: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
115: Else
120: sNoSoumission = vbNullString
125: End If
			
130: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND Type = 'E' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
135: Else
140: sNoProjet = vbNullString
145: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
			
150: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoSoumission & "' AND Type = 'E' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
155: End If
		
160: Do While Not rstPiece.EOF
165: If rstPiece.Fields("Visible").Value = True Then
170: bAjouterSection = True
175: bAjouterSousSection = True
180: bAjouterPiece = True
				
185: rstImpListePiece.CursorLocation = ADODB.CursorLocationEnum.adUseClient
				
190: Call rstImpListePiece.Open("SELECT * FROM GRB_Impression_ListePiece WHERE IDSection = '" & rstPiece.Fields("IDSection").Value & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
195: If Not rstImpListePiece.EOF Then
200: bAjouterSection = False
					
205: Do While Not rstImpListePiece.EOF
210: If rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value Then
215: bAjouterSousSection = False
							
220: If rstPiece.Fields("NumItem").Value <> "Texte" And rstPiece.Fields("NumItem").Value <> "Text" Then
225: If rstImpListePiece.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value Then
230: bAjouterPiece = False
									
235: rstImpListePiece.Fields("Qté").Value = Replace(CStr(CDbl(rstImpListePiece.Fields("Qté").Value) + CDbl(rstPiece.Fields("Qté").Value)), ".", ",")
									
240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
									If Not IsDbNull(rstImpListePiece.Fields("ID").Value) Then
245: If rstImpListePiece.Fields("ID").Value <> "" Then
250: rstImpListePiece.Fields("ID").Value = rstImpListePiece.Fields("ID").Value & ", " & rstPiece.Fields("ID").Value
255: Else
260: rstImpListePiece.Fields("ID").Value = rstPiece.Fields("ID").Value
265: End If
270: Else
275: rstImpListePiece.Fields("ID").Value = rstPiece.Fields("ID").Value
280: End If
									
285: Call rstImpListePiece.Update()
									
290: If rstImpListePiece.Fields("Qté").Value = 0 Then
295: Call rstImpListePiece.Delete()
										
300: rstImpListePiece.Filter = "NomSousSection = '" & Replace(rstPiece.Fields("SousSection").Value, "'", "''") & "'"
										
305: If rstImpListePiece.RecordCount = 1 Then
310: Call rstImpListePiece.Delete()
											
315: rstImpListePiece.Filter = "IDSection = '" & rstPiece.Fields("IDSection").Value & "'"
											
320: If rstImpListePiece.RecordCount = 1 Then
325: Call rstImpListePiece.Delete()
330: End If
335: End If
										
340: rstImpListePiece.Filter = ""
										
345: End If
									
350: Exit Do
355: End If
360: Else
365: Exit Do
370: End If
375: End If
						
380: Call rstImpListePiece.MoveNext()
385: Loop 
390: End If
				
395: If bAjouterSection = True Then
400: If m_eLangage = enumLangage.ANGLAIS Then
405: sSection = "NomSectionEN"
410: Else
415: sSection = "NomSectionFR"
420: End If
					
425: Call rstTemp.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
					'Ajoute la section dans la liste de pièces
430: Call rstImpListePiece.AddNew()
					
435: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
440: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
					
445: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstTemp.Fields(sSection).Value) Then
450: rstImpListePiece.Fields("Section").Value = rstTemp.Fields(sSection).Value
455: Else
460: rstImpListePiece.Fields("Section").Value = " "
465: End If
					
470: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
475: Call rstImpListePiece.Update()
					
480: iCompteurPiece = iCompteurPiece + 1
					
485: Call rstTemp.Close()
490: End If
				
495: If bAjouterSousSection = True Then
500: sSousSection = rstPiece.Fields("SousSection").Value
					
505: If sSousSection = S_PAS_SOUS_SECTION Then
510: sSousSection = " "
515: End If
					
520: Call rstImpListePiece.AddNew()
					
525: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
530: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
535: rstImpListePiece.Fields("SousSection").Value = sSousSection
540: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
545: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
					
550: Call rstImpListePiece.Update()
					
555: iCompteurPiece = iCompteurPiece + 1
560: End If
				
565: If bAjouterPiece = True Then
					'Ajoute la pièce à la liste de pièces
570: Call rstImpListePiece.AddNew()
					
575: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
580: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
585: rstImpListePiece.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value
590: rstImpListePiece.Fields("Qté").Value = rstPiece.Fields("Qté").Value
					
595: If m_eLangage = enumLangage.ANGLAIS Then
600: rstImpListePiece.Fields("Description").Value = rstPiece.Fields("Desc_EN").Value
605: Else
610: rstImpListePiece.Fields("Description").Value = rstPiece.Fields("Desc_FR").Value
615: End If
					
620: rstImpListePiece.Fields("Manufact").Value = rstPiece.Fields("Manufact").Value
					
625: If m_eType = enumType.TYPE_PROJET Then
630: rstImpListePiece.Fields("ID").Value = rstPiece.Fields("ID").Value
635: End If
					
640: rstImpListePiece.Fields("IDSection").Value = rstPiece.Fields("IDSection").Value
645: rstImpListePiece.Fields("NomSousSection").Value = rstPiece.Fields("SousSection").Value
					
650: Call rstImpListePiece.Update()
					
655: iCompteurPiece = iCompteurPiece + 1
660: End If
				
665: Call rstImpListePiece.Close()
670: End If
			
			'Prochaine enregistrement
675: Call rstPiece.MoveNext()
680: Loop 
		
		''''''''''''''''''''''''''''''''''''''''''''''''''
		' Rapport liste pièce, met dans l'ordre de ligne '
		''''''''''''''''''''''''''''''''''''''''''''''''''
685: rstImpListePiece.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
690: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_Listepiece WHERE TRIM(IDSoumission) = '" & Trim(sNoSoumission) & "' ORDER BY noligne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
695: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.DataSource = rstImpListePiece
		
700: Call TraduireImpressionListePiece()
		
		'Affiche la date
705: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section3").Controls("lblDate").Caption = ConvertDate(Today)
		
710: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblProjet").Caption = sNoProjet
		
		'Affiche l 'entête
715: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblSoumission").Caption = sNoSoumission
		
720: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblDescription").Caption = rstProjSoum.Fields("Description").Value
		
725: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
730: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblClient").Caption = rstTemp.Fields("NomClient").Value
		
735: Call rstTemp.Close()
		
740: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
745: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblContact").Caption = rstTemp.Fields("nomcontact").Value
		
750: Call rstTemp.Close()
		
		'Affiche le rapport liste des pieces
755: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Orientation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Orientation = MSDataReportLib.OrientationConstants.rptOrientPortrait
		
760: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_Liste_piece.Show(VB6.FormShowConstants.Modal)
		
765: Call rstImpListePiece.Close()
770: 'UPGRADE_NOTE: Object rstImpListePiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpListePiece = Nothing
		
775: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
780: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
785: Exit Sub
		
AfficherErreur: 
		
790: Call AfficherErreur("frmProjSoumElec", "ImprimerListePieces", Err, Erl())
	End Sub
	
	Private Sub CalculerTempsReelsImpression(ByVal sNoProjet As String)
		Dim DR_SoumissionElec As Object
		
5: On Error GoTo AfficherErreur
		
10: Dim rstTotal As ADODB.Recordset
15: Dim sDateDebut As String
20: Dim sDateFin As String
25: Dim sTotal As String
30: Dim sFilterNoProjet As String
		
35: If VB.Right(sNoProjet, 2) = "99" Then
40: sFilterNoProjet = "LEFT(NoProjet, 6) = '" & VB.Left(sNoProjet, 6) & "'"
45: Else
50: sFilterNoProjet = "NoProjet = '" & sNoProjet & "'"
55: End If
		
60: rstTotal = New ADODB.Recordset
		
65: sDateDebut = "TIMESERIAL(Left(GRB_Punch.HeureDébut,2),RIGHT(GRB_Punch.HeureDébut,2),0)"
		
70: sDateFin = "TIMESERIAL(Left(GRB_Punch.HeureFin,2),RIGHT(GRB_Punch.HeureFin,2),0)"
		
75: sTotal = "(SUM(" & sDateFin & " - " & sDateDebut & ") * 24) As Total"
		
80: rstTotal.CursorLocation = ADODB.CursorLocationEnum.adUseServer
		
85: Call rstTotal.Open("SELECT Type, " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null GROUP BY Type", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
90: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsDessinReel").Caption = "0"
95: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsFabricationReel").Caption = "0"
100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsAssemblageReel").Caption = "0"
105: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgInterfaceReel").Caption = "0"
110: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgAutomateReel").Caption = "0"
115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgRobotReel").Caption = "0"
120: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsVisionReel").Caption = "0"
125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsTestReel").Caption = "0"
130: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsInstallationReel").Caption = "0"
135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsMiseServiceReel").Caption = "0"
140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsFormationReel").Caption = "0"
145: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsGestionReel").Caption = "0"
150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsShippingReel").Caption = "0"
		
155: Do While Not rstTotal.EOF
160: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstTotal.Fields("Total").Value) Then
165: Select Case rstTotal.Fields("Type").Value
					Case "Dessin"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsDessinReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
170: Case "Fabrication"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsFabricationReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
175: Case "Assemblage"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsAssemblageReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
180: Case "ProgInterface"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgInterfaceReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
185: Case "ProgAutomate"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgAutomateReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
190: Case "ProgRobot"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgRobotReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
195: Case "Vision"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsVisionReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
200: Case "Test"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsTestReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
205: Case "Installation"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsInstallationReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
210: Case "MiseService"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsMiseServiceReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
215: Case "Formation"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsFormationReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
220: Case "Gestion"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsGestionReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
225: Case "Shipping"
						'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						DR_SoumissionElec.Sections("Section5").Controls("lblTempsShippingReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
230: End Select
235: End If
			
240: Call rstTotal.MoveNext()
245: Loop 
		
250: Call rstTotal.Close()
		
255: Call rstTotal.Open("SELECT " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
260: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstTotal.Fields("Total").Value) Then
265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTotalTempsRHReel").Caption = System.Math.Round(rstTotal.Fields("Total").Value, 2)
270: Else
275: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTotalTempsRHReel").Caption = "0"
280: End If
		
285: Call rstTotal.Close()
290: 'UPGRADE_NOTE: Object rstTotal may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTotal = Nothing
		
295: Exit Sub
		
AfficherErreur: 
		
300: Call AfficherErreur("frmProjSoumElec", "CalculerTempsReels", Err, Erl())
	End Sub
	
	Private Sub ImprimerProjSoumFacturation(ByVal rstProjSoum As ADODB.Recordset, ByVal sNoFacture As String)
		Dim DR_SoumissionElec As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de soumission
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpProjSoum As ADODB.Recordset
25: Dim sOrdreSection As String
30: Dim iCompteurSoum As Short
35: Dim sSousSection As String
40: Dim sSousSectionRS As String
45: Dim sSection As String
50: Dim sNoProjet As String
55: Dim sNoSoumission As String
60: Dim sCommission As String
65: Dim sPrixTotal As String
70: Dim sProfit As String
75: Dim sTempsFabrication As String
80: Dim sTotalPiece As String
85: Dim sImprevue As String
90: Dim sTotalTemps As String
95: Dim sManuel As String
100: Dim dblTotalTemps As Double
105: Dim dblTempsDessin As Double
110: Dim dblTempsFabrication As Double
115: Dim dblTempsAssemblage As Double
120: Dim dblTempsProgInterface As Double
125: Dim dblTempsProgAutomate As Double
130: Dim dblTempsProgRobot As Double
135: Dim dblTempsVision As Double
140: Dim dblTempsTest As Double
145: Dim dblTempsInstallation As Double
150: Dim dblTempsMiseService As Double
155: Dim dblTempsFormation As Double
160: Dim dblTempsGestion As Double
165: Dim dblTempsShipping As Double
170: Dim dblTotalHebergement As Double
175: Dim dblTotalRepas As Double
180: Dim dblTotalTransport As Double
185: Dim dblTotalUniteMobile As Double
190: Dim dblPrixEmballage As Double
195: Dim dblTotalReste As Double
200: Dim dblTotalAutre As Double
		
205: rstPiece = New ADODB.Recordset
210: rstTemp = New ADODB.Recordset
215: rstImpProjSoum = New ADODB.Recordset
		
		'Supprime les données de l'impression
220: Call g_connData.Execute("DELETE * FROM GRB_impression_soumission")
		
225: iCompteurSoum = 1
		
230: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
235: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_soumission", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Ouverture du recordset
240: sNoProjet = rstProjSoum.Fields("IDProjet").Value
245: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
		
250: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND Type = 'E' AND Facturation = '" & sNoFacture & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
255: Do While Not rstPiece.EOF
260: sSousSectionRS = rstPiece.Fields("SousSection").Value
			
265: If sSousSectionRS = S_PAS_SOUS_SECTION Then
270: sSousSectionRS = " "
275: End If
			
280: If sOrdreSection <> rstPiece.Fields("OrdreSection").Value Then
				'Remplis la table impression_soumission
				'Ajoute seulement la section
285: sOrdreSection = rstPiece.Fields("OrdreSection").Value
				
290: If m_eLangage = enumLangage.ANGLAIS Then
295: sSection = "NomSectionEN"
300: Else
305: sSection = "NomSectionFR"
310: End If
				
315: Call rstTemp.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajoute la section dans la soumission
320: Call rstImpProjSoum.AddNew()
				
325: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
330: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
				
335: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstTemp.Fields(sSection).Value) Then
340: rstImpProjSoum.Fields("NomSection").Value = rstTemp.Fields(sSection).Value
345: Else
350: rstImpProjSoum.Fields("NomSection").Value = " "
355: End If
				
360: Call rstImpProjSoum.Update()
				
365: iCompteurSoum = iCompteurSoum + 1
				
370: Call rstTemp.Close()
				
375: sSousSection = rstPiece.Fields("SousSection").Value
				
380: If sSousSection = S_PAS_SOUS_SECTION Then
385: sSousSection = " "
390: End If
				
395: Call rstImpProjSoum.AddNew()
				
400: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
				
405: If m_eType = enumType.TYPE_PROJET Then
410: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
415: Else
420: rstImpProjSoum.Fields("IDSoumission").Value = sNoSoumission
425: End If
				
430: rstImpProjSoum.Fields("SousSection").Value = sSousSection
				
435: Call rstImpProjSoum.Update()
				
440: iCompteurSoum = iCompteurSoum + 1
445: Else
				'Ajoute une soussection dans impression_soum
450: If sSousSection <> sSousSectionRS Then
455: sSousSection = sSousSectionRS
					
460: Call rstImpProjSoum.AddNew()
					
465: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
					
470: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
					
475: rstImpProjSoum.Fields("SousSection").Value = sSousSectionRS
					
480: Call rstImpProjSoum.Update()
					
485: iCompteurSoum = iCompteurSoum + 1
490: End If
495: End If
			
			'Ajoute une piece dans impression_soum
500: Call rstImpProjSoum.AddNew()
			
505: rstImpProjSoum.Fields("NoLigne").Value = iCompteurSoum
			
510: rstImpProjSoum.Fields("IDSoumission").Value = sNoProjet
			
515: rstImpProjSoum.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value
520: rstImpProjSoum.Fields("Qté").Value = rstPiece.Fields("Qté").Value
			
525: If m_eLangage = enumLangage.ANGLAIS Then
530: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_EN").Value
535: Else
540: rstImpProjSoum.Fields("Description").Value = rstPiece.Fields("DESC_FR").Value
545: End If
			
			'************************************************************************************************
			'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
			'************************************************************************************************
550: rstImpProjSoum.Fields("MANUFACT").Value = rstPiece.Fields("MANUFACT").Value
555: 'rstImpProjSoum.Fields("PRIX_LIST") = rstPiece.Fields("PRIX_LIST")
			
560: 'If Not IsNull(rstPiece.Fields("ESCOMPTE")) And Trim(rstPiece.Fields("ESCOMPTE")) <> vbNullString Then
565: '  If rstPiece.Fields("ESCOMPTE") > 0 Then
570: '    rstImpProjSoum.Fields("ESCOMPTE") = Conversion(Replace(rstPiece.Fields("escompte"), ".", ","), MODE_POURCENT)
575: '  Else
580: '    rstImpProjSoum.Fields("ESCOMPTE") = Conversion(Replace(rstPiece.Fields("escompte"), ".", ",") * 100, MODE_POURCENT)
585: '  End If
590: 'Else
595: '  rstImpProjSoum.Fields("ESCOMPTE") = Conversion(0, MODE_POURCENT)
600: 'End If
			
605: rstImpProjSoum.Fields("PRIX_NET").Value = rstPiece.Fields("PRIX_NET").Value
			
610: Call rstTemp.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstPiece.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
615: If Not rstTemp.EOF Then
620: rstImpProjSoum.Fields("NomFournisseur").Value = rstTemp.Fields("NomFournisseur").Value
625: End If
			
630: Call rstTemp.Close()
			
635: 'rstImpProjSoum.Fields("TEMPS") = rstPiece.Fields("TEMPS")
640: 'rstImpProjSoum.Fields("TEMPS_TOTAL") = rstPiece.Fields("TEMPS_TOTAL")
645: rstImpProjSoum.Fields("PRIX_TOTAL").Value = rstPiece.Fields("PRIX_TOTAL").Value
650: rstImpProjSoum.Fields("PROFIT_ARGENT").Value = rstPiece.Fields("PROFIT_ARGENT").Value
			
			'AJOUT DE CETTE SECTION PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
			'*************************************************************
			If m_eType = enumType.TYPE_PROJET Then
				If Trim(rstPiece.Fields("DateRéception").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateReception").Value = rstPiece.Fields("DateRéception").Value
				Else
					rstImpProjSoum.Fields("DateReception").Value = ""
				End If
				If Trim(rstPiece.Fields("DateCommande").Value) <> vbNullString Then
					rstImpProjSoum.Fields("DateCommande").Value = rstPiece.Fields("DateCommande").Value
				Else
					rstImpProjSoum.Fields("DateCommande").Value = ""
				End If
			Else 'il n'y a pas de champ date de réception et de commande dans la table GRB_Soumission_Pièces
				rstImpProjSoum.Fields("DateReception").Value = ""
				rstImpProjSoum.Fields("DateCommande").Value = ""
			End If
			'************************************************************************************************
			'FIN DE LA SECTION DE MODIFICATION
			'************************************************************************************************
			
655: Call rstImpProjSoum.Update()
			
660: iCompteurSoum = iCompteurSoum + 1
			
			'Prochaine enreg
665: Call rstPiece.MoveNext()
670: Loop 
		
		'Ferme les tables
675: Call rstImpProjSoum.Close()
		
		'''''''''''''''''''''''''''''''''''''''''''''''''
		' Rapport soumission, met dans l'ordre de ligne '
		'''''''''''''''''''''''''''''''''''''''''''''''''
		
680: Call rstImpProjSoum.Open("SELECT * FROM GRB_impression_soumission WHERE IDSoumission = '" & sNoProjet & "' ORDER BY NoLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
685: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.DataSource = rstImpProjSoum
		
690: Call CalculerPrixFacturation(sNoFacture, sCommission, sPrixTotal, sProfit, sTempsFabrication, sTotalPiece, sImprevue, sTotalTemps, sManuel)
		
695: Call TraduireImpressionSoumission()
		
700: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("shpCadrePrixReception").Visible = False
705: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixReception").Visible = False
710: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblPrixReception").Visible = False
		
715: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("shpCadrePrixSoumission").Visible = False
720: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixSoumission").Visible = False
725: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblPrixSoumission").Visible = False
		
730: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("shpCadreForfait").Visible = False
735: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTitreForfait").Visible = False
740: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblForfait").Visible = False
		
745: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblTitreNoFacture").Visible = True
750: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblNoFacture").Visible = True
		
755: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblNoFacture").Caption = sNoFacture
		
		'Affiche la date
760: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section3").Controls("lbldate").Caption = ConvertDate(Today)
		
		'Affiche entete
765: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblSoumission").Caption = sNoSoumission
		
770: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblprojet").Caption = sNoProjet
		
775: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lbldescription").Caption = rstProjSoum.Fields("Description").Value
		
780: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
785: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblclient").Caption = rstTemp.Fields("NomClient").Value
		
790: Call rstTemp.Close()
		
795: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
800: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section2").Controls("lblcontact").Caption = rstTemp.Fields("NomContact").Value
		
805: Call rstTemp.Close()
		
		'affiche pied d'etat
810: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
815: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxDessin").Caption = rstProjSoum.Fields("TauxDessin").Value
820: Else
825: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxDessin").Caption = "0"
830: End If
		
835: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxFabrication").Value) Then
840: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFabrication").Caption = rstProjSoum.Fields("TauxFabrication").Value
845: Else
850: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFabrication").Caption = "0"
855: End If
		
860: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
865: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxAssemblage").Caption = rstProjSoum.Fields("TauxAssemblage").Value
870: Else
875: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxAssemblage").Caption = "0"
880: End If
		
885: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxProgInterface").Value) Then
890: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgInterface").Caption = rstProjSoum.Fields("TauxProgInterface").Value
895: Else
900: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgInterface").Caption = "0"
905: End If
		
910: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxProgAutomate").Value) Then
915: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgAutomate").Caption = rstProjSoum.Fields("TauxProgAutomate").Value
920: Else
925: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgAutomate").Caption = "0"
930: End If
		
935: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxProgRobot").Value) Then
940: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgRobot").Caption = rstProjSoum.Fields("TauxProgRobot").Value
945: Else
950: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxProgRobot").Caption = "0"
955: End If
		
960: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxVision").Value) Then
965: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxVision").Caption = rstProjSoum.Fields("TauxVision").Value
970: Else
975: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxVision").Caption = "0"
980: End If
		
985: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
990: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxTest").Caption = rstProjSoum.Fields("TauxTest").Value
995: Else
1000: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxTest").Caption = "0"
1005: End If
		
1010: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
1015: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxInstallation").Caption = rstProjSoum.Fields("TauxInstallation").Value
1020: Else
1025: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxInstallation").Caption = "0"
1030: End If
		
1035: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxMiseService").Value) Then
1040: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxMiseService").Caption = rstProjSoum.Fields("TauxMiseService").Value
1045: Else
1050: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxMiseService").Caption = "0"
1055: End If
		
1060: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
1065: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFormation").Caption = rstProjSoum.Fields("TauxFormation").Value
1070: Else
1075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxFormation").Caption = "0"
1080: End If
		
1085: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
1090: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxGestion").Caption = rstProjSoum.Fields("TauxGestion").Value
1095: Else
1100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxGestion").Caption = "0"
1105: End If
		
1110: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1115: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxShipping").Caption = rstProjSoum.Fields("TauxShipping").Value
1120: Else
1125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxShipping").Caption = "0"
1130: End If
		
1135: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) Then
1140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = rstProjSoum.Fields("TempsDessin").Value
1145: Else
1150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsDessinSoum").Caption = "0"
1155: End If
		
1160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTempsFabricationSoum").Caption = sTempsFabrication
		
1165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) Then
1170: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = rstProjSoum.Fields("TempsAssemblage").Value
1175: Else
1180: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsAssemblageSoum").Caption = "0"
1185: End If
		
1190: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgInterface").Value) Then
1195: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgInterfaceSoum").Caption = rstProjSoum.Fields("TempsProgInterface").Value
1200: Else
1205: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgInterfaceSoum").Caption = "0"
1210: End If
		
1215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgAutomate").Value) Then
1220: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgAutomateSoum").Caption = rstProjSoum.Fields("TempsProgAutomate").Value
1225: Else
1230: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgAutomateSoum").Caption = "0"
1235: End If
		
1240: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsProgRobot").Value) Then
1245: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgRobotSoum").Caption = rstProjSoum.Fields("TempsProgRobot").Value
1250: Else
1255: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsProgRobotSoum").Caption = "0"
1260: End If
		
1265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsVision").Value) Then
1270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsVisionSoum").Caption = rstProjSoum.Fields("TempsVision").Value
1275: Else
1280: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsVisionSoum").Caption = "0"
1285: End If
		
1290: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) Then
1295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsTestSoum").Caption = rstProjSoum.Fields("TempsTest").Value
1300: Else
1305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsTestSoum").Caption = "0"
1310: End If
		
1315: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) Then
1320: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = rstProjSoum.Fields("TempsInstallation").Value
1325: Else
1330: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsInstallationSoum").Caption = "0"
1335: End If
		
1340: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsMiseService").Value) Then
1345: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsMiseServiceSoum").Caption = rstProjSoum.Fields("TempsMiseService").Value
1350: Else
1355: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsMiseServiceSoum").Caption = "0"
1360: End If
		
1365: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) Then
1370: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = rstProjSoum.Fields("TempsFormation").Value
1375: Else
1380: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsFormationSoum").Caption = "0"
1385: End If
		
1390: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) Then
1395: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = rstProjSoum.Fields("TempsGestion").Value
1400: Else
1405: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsGestionSoum").Caption = "0"
1410: End If
		
1415: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) Then
1420: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = rstProjSoum.Fields("TempsShipping").Value
1425: Else
1430: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsShippingSoum").Caption = "0"
1435: End If
		
1440: If IsNumeric(rstProjSoum.Fields("TempsDessin").Value) Then
1445: dblTempsDessin = CDbl(rstProjSoum.Fields("TempsDessin").Value)
1450: Else
1455: dblTempsDessin = 0
1460: End If
		
1465: If IsNumeric(sTempsFabrication) Then
1470: dblTempsFabrication = CDbl(sTempsFabrication)
1475: Else
1480: dblTempsFabrication = 0
1485: End If
		
1490: If IsNumeric(rstProjSoum.Fields("TempsAssemblage").Value) Then
1495: dblTempsAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblage").Value)
1500: Else
1505: dblTempsAssemblage = 0
1510: End If
		
1515: If IsNumeric(rstProjSoum.Fields("TempsProgInterface").Value) Then
1520: dblTempsProgInterface = CDbl(rstProjSoum.Fields("TempsProgInterface").Value)
1525: Else
1530: dblTempsProgInterface = 0
1535: End If
		
1540: If IsNumeric(rstProjSoum.Fields("TempsProgAutomate").Value) Then
1545: dblTempsProgAutomate = CDbl(rstProjSoum.Fields("TempsProgAutomate").Value)
1550: Else
1555: dblTempsProgAutomate = 0
1560: End If
		
1565: If IsNumeric(rstProjSoum.Fields("TempsProgRobot").Value) Then
1570: dblTempsProgRobot = CDbl(rstProjSoum.Fields("TempsProgRobot").Value)
1575: Else
1580: dblTempsProgRobot = 0
1585: End If
		
1590: If IsNumeric(rstProjSoum.Fields("TempsVision").Value) Then
1595: dblTempsVision = CDbl(rstProjSoum.Fields("TempsVision").Value)
1600: Else
1605: dblTempsVision = 0
1610: End If
		
1615: If IsNumeric(rstProjSoum.Fields("TempsTest").Value) Then
1620: dblTempsTest = CDbl(rstProjSoum.Fields("TempsTest").Value)
1625: Else
1630: dblTempsTest = 0
1635: End If
		
1640: If IsNumeric(rstProjSoum.Fields("TempsInstallation").Value) Then
1645: dblTempsInstallation = CDbl(rstProjSoum.Fields("TempsInstallation").Value)
1650: Else
1655: dblTempsInstallation = 0
1660: End If
		
1665: If IsNumeric(rstProjSoum.Fields("TempsMiseService").Value) Then
1670: dblTempsMiseService = CDbl(rstProjSoum.Fields("TempsMiseService").Value)
1675: Else
1680: dblTempsMiseService = 0
1685: End If
		
1690: If IsNumeric(rstProjSoum.Fields("TempsFormation").Value) Then
1695: dblTempsFormation = CDbl(rstProjSoum.Fields("TempsFormation").Value)
1700: Else
1705: dblTempsFormation = 0
1710: End If
		
1715: If IsNumeric(rstProjSoum.Fields("TempsGestion").Value) Then
1720: dblTempsGestion = CDbl(rstProjSoum.Fields("TempsGestion").Value)
1725: Else
1730: dblTempsGestion = 0
1735: End If
		
1740: If IsNumeric(rstProjSoum.Fields("TempsShipping").Value) Then
1745: dblTempsShipping = CDbl(rstProjSoum.Fields("TempsShipping").Value)
1750: Else
1755: dblTempsShipping = 0
1760: End If
		
1765: dblTotalTemps = dblTempsDessin + dblTempsFabrication + dblTempsAssemblage + dblTempsProgInterface + dblTempsProgAutomate + dblTempsProgRobot + dblTempsVision + dblTempsTest + dblTempsInstallation + dblTempsMiseService + dblTempsFormation + dblTempsGestion + dblTempsShipping
		
1770: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalTempsRHSoum").Caption = dblTotalTemps
		
1775: Call CalculerTempsReelsImpression(rstProjSoum.Fields("IDProjet").Value)
		
		'Autres frais
1780: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("NbrePersonne").Value) Then
1785: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblNbrePersonne").Caption = rstProjSoum.Fields("NbrePersonne").Value
1790: Else
1795: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblNbrePersonne").Caption = "0"
1800: End If
		
1805: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsHebergement").Value) Then
1810: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsHebergement").Caption = rstProjSoum.Fields("TempsHebergement").Value
1815: Else
1820: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsHebergement").Caption = "0"
1825: End If
		
1830: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxHebergement1").Value) Then
1835: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement1").Caption = rstProjSoum.Fields("TauxHebergement1").Value
1840: Else
1845: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement1").Caption = "0"
1850: End If
		
1855: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxHebergement2").Value) Then
1860: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement2").Caption = rstProjSoum.Fields("TauxHebergement2").Value
1865: Else
1870: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxHebergement2").Caption = "0"
1875: End If
		
1880: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsRepas").Value) Then
1885: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsRepas").Caption = rstProjSoum.Fields("TempsRepas").Value
1890: Else
1895: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsRepas").Caption = "0"
1900: End If
		
1905: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxRepas").Value) Then
1910: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxRepas").Caption = rstProjSoum.Fields("TauxRepas").Value
1915: Else
1920: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxRepas").Caption = "0"
1925: End If
		
1930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
1935: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsTransport").Caption = rstProjSoum.Fields("TempsTransport").Value
1940: Else
1945: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsTransport").Caption = "0"
1950: End If
		
1955: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
1960: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxTransport").Caption = rstProjSoum.Fields("TauxTransport").Value
1965: Else
1970: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxTransport").Caption = "0"
1975: End If
		
1980: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
1985: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = rstProjSoum.Fields("TempsUniteMobile").Value
1990: Else
1995: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTempsUniteMobile").Caption = "0"
2000: End If
		
2005: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
2010: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = rstProjSoum.Fields("TauxUniteMobile").Value
2015: Else
2020: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTauxUniteMobile").Caption = "0"
2025: End If
		
2030: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("PrixEmballage").Value) Then
2035: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixEmballage").Caption = rstProjSoum.Fields("PrixEmballage").Value
2040: Else
2045: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblPrixEmballage").Caption = "0"
2050: End If
		
2055: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblPrixManuel").Caption = rstProjSoum.Fields("Total_Manuel").Value
		
2060: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalPieceAR").Caption = Conversion_Renamed(sTotalPiece, ModuleMain.enumConvert.MODE_ARGENT)
2065: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblImprevue").Caption = Conversion_Renamed(rstProjSoum.Fields("imprevue"), ModuleMain.enumConvert.MODE_POURCENT)
2070: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblImprevueAR").Caption = Conversion_Renamed(sImprevue, ModuleMain.enumConvert.MODE_ARGENT)
2075: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalTempsAR").Caption = Conversion_Renamed(sTotalTemps, ModuleMain.enumConvert.MODE_ARGENT)
2080: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblCommission").Caption = Conversion_Renamed(rstProjSoum.Fields("commission"), ModuleMain.enumConvert.MODE_POURCENT)
2085: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblCommissionAR").Caption = Conversion_Renamed(sCommission, ModuleMain.enumConvert.MODE_ARGENT)
2090: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblGrandTotalAR").Caption = Conversion_Renamed(sPrixTotal, ModuleMain.enumConvert.MODE_ARGENT)
2095: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblProfit").Caption = Conversion_Renamed(rstProjSoum.Fields("profit").Value * 100, ModuleMain.enumConvert.MODE_POURCENT)
2100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblTotalProfit").Caption = Conversion_Renamed(sProfit, ModuleMain.enumConvert.MODE_ARGENT)
		
2105: dblTotalHebergement = CDbl(rstProjSoum.Fields("TotalHebergement").Value)
		
2110: dblTotalRepas = CDbl(rstProjSoum.Fields("TotalRepas").Value)
		
2115: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) And Not IsDbNull(rstProjSoum.Fields("TauxTransport").Value) Then
2120: dblTotalTransport = CDbl(rstProjSoum.Fields("TempsTransport").Value) * CDbl(rstProjSoum.Fields("TauxTransport").Value)
2125: Else
2130: dblTotalTransport = 0
2135: End If
		
2140: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) And Not IsDbNull(rstProjSoum.Fields("TauxUniteMobile").Value) Then
2145: dblTotalUniteMobile = CDbl(rstProjSoum.Fields("TempsUniteMobile").Value) * CDbl(rstProjSoum.Fields("TauxUniteMobile").Value)
2150: Else
2155: dblTotalUniteMobile = 0
2160: End If
		
2165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
		If Not IsDbNull(rstProjSoum.Fields("PrixEmballage").Value) Then
2170: dblPrixEmballage = CDbl(Replace(rstProjSoum.Fields("PrixEmballage").Value, ".", ","))
2175: Else
2180: dblPrixEmballage = 0
2185: End If
		
2190: dblTotalReste = dblTotalHebergement + dblTotalRepas + dblTotalTransport + dblTotalUniteMobile + dblPrixEmballage
		
2195: dblTotalAutre = dblTotalReste + CDbl(rstProjSoum.Fields("total_manuel").Value)
		
2200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_SoumissionElec.Sections("Section5").Controls("lblAutre").Caption = Conversion_Renamed(CStr(dblTotalAutre), ModuleMain.enumConvert.MODE_ARGENT)
		
		'************************************************************************************************
		'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
		'************************************************************************************************
		If bFlag = True Then
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateReception").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateCommande").Visible = True
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateReception").Visible = True
		Else
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateReception").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateCommande").Visible = False
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section1").Controls("txt_DateReception").Visible = False
		End If
		'************************************************************************************************
		'FIN DE LA SECTION MODIFIÉ
		'************************************************************************************************
		
		'Affiche le rapport soumission
		'2205    DR_SoumissionElec.Orientation = rptOrientLandscape
		
2210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_SoumissionElec.Show(VB6.FormShowConstants.Modal)
		
2215: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
2220: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
2225: Exit Sub
		
AfficherErreur: 
		
2230: Call AfficherErreur("frmProjSoumElec", "ImprimerProjSoum", Err, Erl())
	End Sub
	
	Private Sub ImprimerListePiecesFacturation(ByVal rstProjSoum As ADODB.Recordset, ByVal sNoFacture As String)
		Dim DR_Liste_piece As Object
		
5: On Error GoTo AfficherErreur
		
		'Impression de la feuille de la liste des pièces
10: Dim rstPiece As ADODB.Recordset
15: Dim rstTemp As ADODB.Recordset
20: Dim rstImpListePiece As ADODB.Recordset
25: Dim sOrdreSection As String
30: Dim iCompteurPiece As Short
35: Dim sSousSection As String
40: Dim sSousSectionRS As String
45: Dim sSection As String
50: Dim sNoProjet As String
55: Dim sNoSoumission As String
		
60: rstPiece = New ADODB.Recordset
65: rstTemp = New ADODB.Recordset
70: rstImpListePiece = New ADODB.Recordset
		
75: Call g_connData.Execute("DELETE * FROM GRB_impression_listepiece")
		
80: iCompteurPiece = 1
		
85: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
90: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_listepiece", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
95: sOrdreSection = vbNullString
		
		'Ouverture du recordset
100: sNoProjet = rstProjSoum.Fields("IDProjet").Value
105: sNoSoumission = rstProjSoum.Fields("IDSoumission").Value
		
110: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND Type = 'E' AND Facturation = '" & sNoFacture & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
115: Do While Not rstPiece.EOF
120: If rstPiece.Fields("Visible").Value = True Then
125: sSousSectionRS = rstPiece.Fields("SousSection").Value
				
130: If sSousSectionRS = S_PAS_SOUS_SECTION Then
135: sSousSectionRS = " "
140: End If
				
145: If sOrdreSection <> rstPiece.Fields("OrdreSection").Value Then
					'remplis la table impression_soumission
					'ajoute seulement la section
150: sOrdreSection = rstPiece.Fields("OrdreSection").Value
					
155: If m_eLangage = enumLangage.ANGLAIS Then
160: sSection = "NomSectionEN"
165: Else
170: sSection = "NomSectionFR"
175: End If
					
180: Call rstTemp.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstPiece.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
					'Ajoute la section dans la liste de pièces
185: Call rstImpListePiece.AddNew()
					
190: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
195: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
					
200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstTemp.Fields(sSection).Value) Then
205: rstImpListePiece.Fields("NomSection").Value = rstTemp.Fields(sSection).Value
210: Else
215: rstImpListePiece.Fields("NomSection").Value = " "
220: End If
					
225: Call rstImpListePiece.Update()
					
230: iCompteurPiece = iCompteurPiece + 1
					
235: Call rstTemp.Close()
					
240: sSousSection = rstPiece.Fields("SousSection").Value
					
245: If sSousSection = S_PAS_SOUS_SECTION Then
250: sSousSection = " "
255: End If
					
260: Call rstImpListePiece.AddNew()
					
265: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
270: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
275: rstImpListePiece.Fields("SousSection").Value = sSousSection
					
280: Call rstImpListePiece.Update()
					
285: iCompteurPiece = iCompteurPiece + 1
290: Else
					'ajoute une soussection dans impression_soum
295: If sSousSection <> sSousSectionRS Then
300: sSousSection = sSousSectionRS
						
						'ajoute une sous-section dans impression_piece
305: Call rstImpListePiece.AddNew()
						
310: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
315: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
320: rstImpListePiece.Fields("SousSection").Value = sSousSection
						
325: Call rstImpListePiece.Update()
						
330: iCompteurPiece = iCompteurPiece + 1
335: End If
340: End If
				
				'Ajoute la pièce à la liste de pièces
345: Call rstImpListePiece.AddNew()
				
350: rstImpListePiece.Fields("NoLigne").Value = iCompteurPiece
355: rstImpListePiece.Fields("IDSoumission").Value = sNoSoumission
360: rstImpListePiece.Fields("NumItem").Value = rstPiece.Fields("NumItem").Value
365: rstImpListePiece.Fields("Qté").Value = rstPiece.Fields("Qté").Value
				
370: If m_eLangage = enumLangage.ANGLAIS Then
375: rstImpListePiece.Fields("Description").Value = rstPiece.Fields("Desc_EN").Value
380: Else
385: rstImpListePiece.Fields("Description").Value = rstPiece.Fields("Desc_FR").Value
390: End If
				
395: rstImpListePiece.Fields("Manufact").Value = rstPiece.Fields("Manufact").Value
				
400: Call rstImpListePiece.Update()
				
405: iCompteurPiece = iCompteurPiece + 1
410: End If
			
			'Prochaine enreg
415: Call rstPiece.MoveNext()
420: Loop 
		
425: Call rstImpListePiece.Close()
		
		''''''''''''''''''''''''''''''''''''''''''''''''''
		' rapport liste piece, met dans l'ordre de ligne '
		''''''''''''''''''''''''''''''''''''''''''''''''''
		
430: Call rstImpListePiece.Open("SELECT * FROM GRB_impression_Listepiece WHERE IDSoumission = '" & sNoSoumission & "' ORDER BY noligne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
435: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.DataSource. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.DataSource = rstImpListePiece
		
440: Call TraduireImpressionListePiece()
		
445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblTitreNoFacture").Visible = True
450: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblNoFacture").Visible = True
		
455: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblNoFacture").Caption = sNoFacture
		
		'Affiche la date
460: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section3").Controls("lbldate").Caption = ConvertDate(Today)
		
465: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblprojet").Caption = sNoProjet
		
		'affiche l 'entête
470: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("Section4").Controls("lblsoumission").Caption = sNoSoumission
		
475: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lbldescription").Caption = rstProjSoum.Fields("Description").Value
		
480: Call rstTemp.Open("SELECT NomClient FROM GRB_Client WHERE IDClient = " & rstProjSoum.Fields("IDClient").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
485: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblclient").Caption = rstTemp.Fields("NomClient").Value
		
490: Call rstTemp.Close()
		
495: Call rstTemp.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstProjSoum.Fields("IDContact").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
500: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Sections("section4").Controls("lblcontact").Caption = rstTemp.Fields("nomcontact").Value
		
505: Call rstTemp.Close()
		
		'Affiche le rapport liste des pieces
510: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Orientation. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		DR_Liste_piece.Orientation = MSDataReportLib.OrientationConstants.rptOrientPortrait
		
515: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Show. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		Call DR_Liste_piece.Show(VB6.FormShowConstants.Modal)
		
520: Call rstImpListePiece.Close()
525: 'UPGRADE_NOTE: Object rstImpListePiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstImpListePiece = Nothing
		
530: 'UPGRADE_NOTE: Object rstTemp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstTemp = Nothing
		
535: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
540: Exit Sub
		
AfficherErreur: 
		
545: Call AfficherErreur("frmProjSoumElec", "ImprimerListePieces", Err, Erl())
	End Sub
	
	Private Sub TraduireImpressionListePiece()
		Dim DR_Liste_piece As Object
		
5: On Error GoTo AfficherErreur
		
10: If m_eLangage = enumLangage.ANGLAIS Then
15: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreProjet").Caption = "Project:"
20: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreSoumission").Caption = "Quote:"
			
25: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qty"
30: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreNoItem").Caption = "Item No."
35: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturer"
40: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreID").Caption = "ID #"
			
45: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section3").Controls("lblNoPage").Caption = "Page %p of %P"
50: Else
55: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreProjet").Caption = "Projet:"
60: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section4").Controls("lblTitreSoumission").Caption = "Soumission:"
			
65: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qté"
70: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreNoItem").Caption = "No. Item"
75: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturier"
80: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section2").Controls("lblTitreID").Caption = "# ID"
			
85: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_Liste_piece.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_Liste_piece.Sections("Section3").Controls("lblNoPage").Caption = "Page %p de %P"
90: End If
		
95: Exit Sub
		
AfficherErreur: 
		
100: Call AfficherErreur("frmProjSoumElec", "TraduireImpressionListePiece", Err, Erl())
	End Sub
	
	Private Sub TraduireImpressionSoumission()
		Dim DR_SoumissionElec As Object
		
5: On Error GoTo AfficherErreur
		
10: If m_eLangage = enumLangage.ANGLAIS Then
15: If m_eType = enumType.TYPE_PROJET Then
20: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Caption = "Electrical Project"
25: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section2").Controls("lblGrosTitre").Caption = "Electrical Project"
30: Else
35: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Caption = "Electrical Quote"
40: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section2").Controls("lblGrosTitre").Caption = "Electrical Quote"
45: End If
			
50: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreProjet").Caption = "Project :"
55: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreSoumission").Caption = "Quote :"
60: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreClient").Caption = "Client :"
65: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreContact").Caption = "Contact :"
			
			'************************************************************************************************
			'SECTION MODIFIÉ PAR GAÉTAN GINGRAS LE 07 FÉVRIER 2010
			'************************************************************************************************
			
70: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qty"
75: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreNoItem").Caption = "Item No."
80: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreDescription").Caption = "Description"
85: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturer"
90: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitrePrixListe").Caption = "Listed Price"
95: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitreEscompte").Caption = "Discount"
100: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreCoutant").Caption = "Cost"
105: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreFournisseur").Caption = "Supplier"
110: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitreTempsMontage").Caption = "Time"
115: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitreMontage").Caption = "Fixing Time"
120: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreTotal").Caption = "Total"
			
			'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
			'****************************************************************************************
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateCommande").Caption = "Order Date"
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateReception").Caption = "Reception Date"
			'****************************************************************************************
			
125: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreDessin").Caption = "Drafting :"
130: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreFabrication").Caption = "Manufacturing :"
135: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreAssemblage").Caption = "Assembling :"
140: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreProgInterface").Caption = "Interface programming :"
145: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreProgAutomate").Caption = "PLC programming :"
150: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreProgRobot").Caption = "Robot programming :"
155: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreVision").Caption = "Vision :"
160: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTest").Caption = "Test :"
165: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreInstallation").Caption = "Installation :"
170: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreMiseService").Caption = "Activation :"
175: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreFormation").Caption = "Training :"
180: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreGestion").Caption = "Project management :"
185: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreShipping").Caption = "Shipping :"
			
190: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTauxHoraire").Caption = "Rate / Hours"
195: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTemps").Caption = "Time (Hour)"
200: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTotalPiece").Caption = "Parts Total:"
205: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreImprevue").Caption = "Unforeseen:"
210: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTotalTemps").Caption = "Time Total:"
215: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreGrandTotal").Caption = "Final Price:"
			
220: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section3").Controls("lblNoPage").Caption = "Page %p of %P"
225: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixReception").Caption = "Receiving up to date"
230: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixSoumission").Caption = "Quote Price"
235: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreForfait").Caption = "Package Deal"
240: Else
245: If m_eType = enumType.TYPE_PROJET Then
250: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Caption = "Projet Électrique"
255: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section2").Controls("lblGrosTitre").Caption = "Projet Électrique"
260: Else
265: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Caption. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Caption = "Soumission Électrique"
270: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				DR_SoumissionElec.Sections("Section2").Controls("lblGrosTitre").Caption = "Soumission Électrique"
275: End If
			
280: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreProjet").Caption = "Projet:"
285: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreSoumission").Caption = "Soumission:"
290: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreClient").Caption = "Client:"
295: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreContact").Caption = "Contact:"
			
300: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreQuantite").Caption = "Qté"
305: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreNoItem").Caption = "No. Item"
310: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreDescription").Caption = "Description"
315: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreManufacturier").Caption = "Manufacturier"
320: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitrePrixListe").Caption = "Prix listé"
325: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitreEscompte").Caption = "Escompte"
330: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreCoutant").Caption = "Coûtant"
335: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreFournisseur").Caption = "Fournisseur"
340: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitreTempsMontage").Caption = "Temps"
345: 'DR_SoumissionElec.Sections("Section2").Controls("lblTitreMontage").Caption = "Montage"
350: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lblTitreTotal").Caption = "Total"
			
			'AJOUT PAR GAÉTAN GINGRAS 07 FÉVRIER 2010
			'****************************************************************************************
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateCommande").Caption = "Date commandé"
			'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section2").Controls("lbl_DateReception").Caption = "Date reçu"
			'****************************************************************************************
			
			'************************************************************************************************
			'FIN DE LA SECTION DE MODIFICATION
			'************************************************************************************************
			
355: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreDessin").Caption = "Dessin :"
360: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreFabrication").Caption = "Fabrication :"
365: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreAssemblage").Caption = "Assemblage :"
370: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreProgInterface").Caption = "Programmation d'interface :"
375: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreProgAutomate").Caption = "Programmation d'automate :"
380: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreProgRobot").Caption = "Programmation de robot :"
385: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreVision").Caption = "Vision :"
390: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTest").Caption = "Test :"
395: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreInstallation").Caption = "Installation :"
400: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreMiseService").Caption = "Mise en service :"
405: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreFormation").Caption = "Formation du personnel :"
410: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreGestion").Caption = "Gestion du projet :"
415: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreShipping").Caption = "Expédition :"
			
420: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTauxHoraire").Caption = "Taux Horaire"
425: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTemps").Caption = "Temps (Heure)"
430: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTotalPiece").Caption = "Total pièce:"
435: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreImprevue").Caption = "Imprévue:"
440: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreTotalTemps").Caption = "Total temps:"
445: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreGrandTotal").Caption = "Grand total:"
			
450: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section3").Controls("lblNoPage").Caption = "Page %p de %P"
455: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixReception").Caption = "Réception jusqu'à maintenant"
460: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitrePrixSoumission").Caption = "$ Soumission"
465: 'UPGRADE_WARNING: Couldn't resolve default property of object DR_SoumissionElec.Sections. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			DR_SoumissionElec.Sections("Section5").Controls("lblTitreForfait").Caption = "Forfait"
470: End If
		
475: Exit Sub
		
AfficherErreur: 
		
480: Call AfficherErreur("frmProjSoumElec", "TraduireImpressionSoumission", Err, Erl())
	End Sub
	
	Private Sub cmdModifier_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdModifier.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim sUser As String
		
20: m_collQteSupp = New Collection
25: m_collDateSupp = New Collection
30: m_collHeureSupp = New Collection
35: m_collNoItemSupp = New Collection
		
		'Modifier une soumission
40: If cmbProjSoum.SelectedIndex > -1 Then
45: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
50: If m_eType = enumType.TYPE_PROJET Then
55: Call MsgBox("Ce projet ne peut pas être modifié!", MsgBoxStyle.OKOnly, "Erreur")
60: Else
65: Call MsgBox("Cette soumission ne peut pas être modifiée!", MsgBoxStyle.OKOnly, "Erreur")
70: End If
				
75: Exit Sub
80: End If
			
85: If m_eType = enumType.TYPE_SOUMISSION Then
90: If VerifierSiDejaProjet = True Then
95: Call MsgBox("Vous ne pouvez pas modifier cette soumission, le projet a déjà été créé!", MsgBoxStyle.OKOnly, "Erreur")
					
100: Exit Sub
105: End If
110: End If
			
115: rstProjSoum = New ADODB.Recordset
			
120: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum ='" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
125: If rstProjSoum.Fields("Ouvert").Value = False Or rstProjSoum.Fields("Verrouillé").Value = True Then
130: If rstProjSoum.Fields("Ouvert").Value = False Then
135: If m_eType = enumType.TYPE_PROJET Then
140: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
145: Else
150: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly, "Erreur")
155: End If
160: Else
165: If m_eType = enumType.TYPE_PROJET Then
170: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
175: Else
180: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly, "Erreur")
185: End If
190: End If
				
195: Call rstProjSoum.Close()
200: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
205: Exit Sub
210: End If
			
215: Call rstProjSoum.Close()
220: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
225: If VerifierSiOuvert(sUser) = False Then
230: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				
				'Débarre les champs
235: Call BarrerChamps(False)
				
				'Pour pouvoir afficher le dernier enregistrement affiché quand la personne va
				'enregistrer ou annuler
240: m_sAncienProjSoum = txtNoProjSoum.Text
				
245: m_bModeAjout = False
250: m_bModeAffichage = False
				
				'Rapetisse le listview de la soumission pour afficher le lvwPiece
255: lvwSoumission.Height = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.49)
260: lvwSoumission.Top = VB6.TwipsToPixelsY(VB6.PixelsToTwipsY(lvwPieces.Top) + VB6.PixelsToTwipsY(lvwPieces.Height) + (VB6.PixelsToTwipsY(lvwSoumission.Height) * 0.02))
				
265: Call RemplirProjSoum()
				
270: Call AfficherControles(enumMode.MODE_AJOUT_MODIF)
				
275: Call UpdateOrdre()
				
				'On recalcul le prix total
280: Call CalculerPrix()
				
285: Call lvwSoumission.Refresh()
				
290: Call OuvrirProjSoum(True)
				
295: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
300: Else
305: If m_eType = enumType.TYPE_PROJET Then
310: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
315: Else
320: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
325: End If
330: End If
335: End If
		
340: Exit Sub
		
AfficherErreur: 
		
345: Call AfficherErreur("frmProjSoumElec", "cmdModifier_Click", Err, Erl())
	End Sub
	
	Private Sub cmdsupprimer_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdsupprimer.Click
		
5: On Error GoTo AfficherErreur
		
10: Dim iReponse As Short
15: Dim rstProjSoum As ADODB.Recordset
20: Dim rstProjet As ADODB.Recordset
25: Dim sSoumission As String
30: Dim sUser As String
35: Dim iExtension As Short
		
		'Si il y a des enregistrements
40: If cmbProjSoum.Items.Count > 0 Then
45: If VB.Right(txtNoProjSoum.Text, 2) = "99" Then
50: If m_eType = enumType.TYPE_PROJET Then
55: Call MsgBox("Vous ne pouvez pas supprimer ce projet!", MsgBoxStyle.OKOnly, "Erreur")
60: Else
65: Call MsgBox("Vous ne pouvez pas supprimer cette soumission!", MsgBoxStyle.OKOnly, "Erreur")
70: End If
				
75: Exit Sub
80: End If
			
85: rstProjSoum = New ADODB.Recordset
			
90: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
95: If rstProjSoum.Fields("Ouvert").Value = False Or rstProjSoum.Fields("Verrouillé").Value = True Then
100: If rstProjSoum.Fields("Ouvert").Value = False Then
105: If m_eType = enumType.TYPE_PROJET Then
110: Call MsgBox("Ce projet est fermé!", MsgBoxStyle.OKOnly, "Erreur")
115: Else
120: Call MsgBox("Cette soumission est fermée!", MsgBoxStyle.OKOnly, "Erreur")
125: End If
130: Else
135: If m_eType = enumType.TYPE_PROJET Then
140: Call MsgBox("Ce projet est verrouillé!", MsgBoxStyle.OKOnly, "Erreur")
145: Else
150: Call MsgBox("Cette soumission est verrouillée!", MsgBoxStyle.OKOnly, "Erreur")
155: End If
160: End If
				
165: Call rstProjSoum.Close()
170: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjSoum = Nothing
				
175: Exit Sub
180: End If
			
185: Call rstProjSoum.Close()
190: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
			
195: If m_eType = enumType.TYPE_SOUMISSION Then
200: If VerifierSiDejaProjet = True Then
205: Call MsgBox("Vous ne pouvez pas supprimer cette soumission, le projet a déjà été créé!", MsgBoxStyle.OKOnly, "Erreur")
					
210: Exit Sub
215: End If
220: End If
			
225: If VerifierSiOuvert(sUser) = False Then
				'Valider le choix
230: If m_eType = enumType.TYPE_PROJET Then
235: iReponse = MsgBox("Voulez-vous vraiment EFFACER LE PROJET " & txtNoProjSoum.Text & "?", MsgBoxStyle.YesNo)
					
240: If iReponse = MsgBoxResult.Yes Then
245: Call frmValiderSuppression.Afficher(True, txtNoProjSoum.Text, Me)
						
250: If m_bValide = True Then
255: iReponse = MsgBoxResult.Yes
260: Else
265: iReponse = MsgBoxResult.No
270: End If
275: End If
280: Else
285: iReponse = MsgBox("Voulez-vous vraiment EFFACER LA SOUMISSION " & txtNoProjSoum.Text & "?", MsgBoxStyle.YesNo)
					
290: If iReponse = MsgBoxResult.Yes Then
295: Call frmValiderSuppression.Afficher(False, txtNoProjSoum.Text, Me)
						
300: If m_bValide = True Then
305: iReponse = MsgBoxResult.Yes
310: Else
315: iReponse = MsgBoxResult.No
320: End If
325: End If
330: End If
				
				'S'il veut vraiment effacer
335: If iReponse = MsgBoxResult.Yes Then
					'Si c'est un projet
340: If m_eType = enumType.TYPE_PROJET Then
345: rstProjet = New ADODB.Recordset
						
350: Call rstProjet.Open("SELECT IDSoumission FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
						
355: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
						If Not IsDbNull(rstProjet.Fields("IDSoumission").Value) Then
360: sSoumission = rstProjet.Fields("IDSoumission").Value
365: Else
370: sSoumission = vbNullString
375: End If
						
380: Call rstProjet.Close()
385: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjet = Nothing
						
						'Efface les pièces
390: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Type = 'E'")
						
395: If IsNumeric(VB.Right(txtNoProjSoum.Text, 2)) Then
400: iExtension = CShort(VB.Right(txtNoProjSoum.Text, 2))
405: Else
410: iExtension = 0
415: End If
						
420: If (iExtension >= 60 And iExtension <= 79) Or (iExtension >= 80 And iExtension <= 98) Then
425: rstProjSoum = New ADODB.Recordset
							
430: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
							
435: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & rstProjSoum.Fields("LiaisonChargeable").Value & "' AND Provenance = '" & iExtension & "'")
							
440: Call CalculerTotalRecordset(VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & rstProjSoum.Fields("LiaisonChargeable").Value)
							
445: Call rstProjSoum.Close()
450: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
							rstProjSoum = Nothing
455: End If
						
						'Efface les modifications
460: Call g_connData.Execute("DELETE * FROM GRB_Projet_Modif WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Type = 'E'")
						
						'Efface la soumission
465: Call g_connData.Execute("DELETE * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'")
						
						'Efface la soumission dans la table GRB_ProjSoum
470: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'")
						
475: rstProjSoum = New ADODB.Recordset
						
480: Call rstProjSoum.Open("SELECT Ouvert FROM GRB_ProjSoum WHERE IDProjSoum = '" & sSoumission & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
485: If Not rstProjSoum.EOF Then
490: rstProjSoum.Fields("Ouvert").Value = True
							
495: Call rstProjSoum.Update()
500: End If
						
505: Call rstProjSoum.Close()
510: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstProjSoum = Nothing
515: Else
						'Efface les pièces
520: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "' AND Type = 'E'")
						
						'Efface les modifications
525: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Modif WHERE IDSoumission = '" & txtNoProjSoum.Text & "' AND Type = 'E'")
						
						'Efface la soumission
530: Call g_connData.Execute("DELETE * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'")
						
						'Efface la soumission dans la table GRB_ProjSoum
535: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & txtNoProjSoum.Text & "'")
540: End If
					
545: If m_eType = enumType.TYPE_PROJET Then
550: Call RecreerProjetCumulatif()
555: Else
560: Call RecreerSoumissionCumulatif()
565: End If
					
					'Affiche la premiere soumission
570: Call AfficherProjSoum(vbNullString)
575: End If
580: Else
585: If m_eType = enumType.TYPE_PROJET Then
590: Call MsgBox("Ce projet est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
595: Else
600: Call MsgBox("Cette soumission est en modification par " & sUser & "!", MsgBoxStyle.OKOnly, "Erreur")
605: End If
610: End If
615: End If
		
620: Exit Sub
		
AfficherErreur: 
		
625: Call AfficherErreur("frmProjSoumElec", "cmdSupprimer_Click", Err, Erl())
	End Sub
	
	Private Sub FrmProjSoumElec_Load(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles MyBase.Load
		
5: On Error GoTo AfficherErreur
		
10: Call frmChoixProjSoum.Close()
		
15: m_eLangage = enumLangage.FRANCAIS
		
20: cmdAnglaisFrancais.Text = "Anglais"
		
		'Initialise le tri à PIECE_GRB
25: cmbTri.SelectedIndex = I_CMB_PIECE
		
		'Donne accès aux boutons selon le groupe
30: Call ActiverBoutonsGroupe()
		
		'Initialisation au mode inactif
35: m_eMode = enumMode.MODE_INACTIF
		
		'Rempli le combo des clients
40: Call RemplirComboClients(vbNullString)
		
		'Rempli le combo des contacts
45: Call RemplirComboSections()
		
		'Rempli le combo des catégories de pièce
50: Call RemplirComboCategoriesPieces()
		
55: cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT
		
60: If m_eType = enumType.TYPE_PROJET Then
65: cmbChoix.SelectedIndex = I_IDX_PROJET
70: Else
75: cmbChoix.SelectedIndex = I_IDX_SOUMISSION
80: End If
		
85: Exit Sub
		
AfficherErreur: 
		
90: Call AfficherErreur("frmProjSoumElec", "Form_Load", Err, Erl())
	End Sub
	
	Private Sub RemplirColonnes()
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour afficher les colonnes selon le groupe de sécurité.
		
		'Ceux qui n'ont pas le droit de modifier les soumissions ou les projets, n'ont pas
		'le droit de voir les prix, donc il faut cacher les colonnes
10: Dim bModif As Boolean
15: Dim bCacherPrix As Boolean
		
		'Si le type d'affichage est "Projet"
20: If m_eType = enumType.TYPE_PROJET Then
			'Si l'utilisateur n'a pas le droit de modification sur les projets
25: If m_bModifProj = False Then
				'On cache les prix
30: bCacherPrix = True
35: End If
40: Else
			'Si l'utilisateur n'a pas le droit de modification sur les soumissions
45: If m_bModifSoum = False Then
				'On cache les prix
50: bCacherPrix = True
55: End If
60: End If
		
		'Si on cache les prix
65: If bCacherPrix = True Then
70: m_bDroitPrix = False
			
			'Si les bonnes colonnes sont déjà toutes affichées
75: If lvwSoumission.Columns.Count = 12 Then
80: Exit Sub
85: End If
90: Else
95: m_bDroitPrix = True
			
			'Si les colonnes sont déjà toute là
100: If lvwSoumission.Columns.Count = 18 Then
105: Exit Sub
110: End If
115: End If
		
		'Il faut enlever les colonnes avant d'en ajouter d'autres
120: Call lvwSoumission.Columns.Clear()
		
125: Call lvwSoumission.Columns.Add("", "Qté", CInt(VB6.TwipsToPixelsX(650.1418)))
130: Call lvwSoumission.Columns.Add("", "No. Item", CInt(VB6.TwipsToPixelsX(1830.0474)))
135: Call lvwSoumission.Columns.Add("", "Description", CInt(VB6.TwipsToPixelsX(3809.746)))
140: Call lvwSoumission.Columns.Add("", "Manufacturier", CInt(VB6.TwipsToPixelsX(1154.8348)))
		
145: If bCacherPrix = False Then
150: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Prix listé", CInt(VB6.TwipsToPixelsX(920.1261)), vbRightJustify)
155: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Escompte", CInt(VB6.TwipsToPixelsX(884.9765)), vbRightJustify)
160: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Prix net", CInt(VB6.TwipsToPixelsX(920.1261)), vbRightJustify)
165: End If
		
170: Call lvwSoumission.Columns.Add("", "Distributeur", CInt(VB6.TwipsToPixelsX(1005.1655)))
175: Call lvwSoumission.Columns.Add("", "Temps", CInt(VB6.TwipsToPixelsX(824.882)))
180: Call lvwSoumission.Columns.Add("", "Montage", CInt(VB6.TwipsToPixelsX(824.882)))
		
185: If bCacherPrix = False Then
190: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("TOTAL", CInt(VB6.TwipsToPixelsX(1099.8426)), vbRightJustify)
195: 'UPGRADE_ISSUE: Unable to determine which constant to upgrade vbRightJustify to. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="B3B44E51-B5F1-4FD7-AA29-CAD31B71F487"'
			Call lvwSoumission.Columns.Add("Profit", CInt(VB6.TwipsToPixelsX(920.1261)), vbRightJustify)
200: End If
		
205: Call lvwSoumission.Columns.Add("", "Commentaire", CInt(VB6.TwipsToPixelsX(1000)))
		
210: If m_eType = enumType.TYPE_PROJET Then
215: Call lvwSoumission.Columns.Add("", "ID", CInt(VB6.TwipsToPixelsX(1440)))
			
220: If bCacherPrix = False Then
225: Call lvwSoumission.Columns.Add("", "Facturation", CInt(VB6.TwipsToPixelsX(1440)))
230: End If
			
235: Call lvwSoumission.Columns.Add("", "Date Commande", CInt(VB6.TwipsToPixelsX(1440)))
240: Call lvwSoumission.Columns.Add("", "Date Requise", CInt(VB6.TwipsToPixelsX(1440)))
245: Call lvwSoumission.Columns.Add("", "Commandé par", CInt(VB6.TwipsToPixelsX(1440)))
250: Call lvwSoumission.Columns.Add("", "No Séquentiel", CInt(VB6.TwipsToPixelsX(1440)))
255: End If
		
260: Call lvwSoumission.Columns.Add("", "Provenance", CInt(VB6.TwipsToPixelsX(1440)))
		
265: Exit Sub
		
AfficherErreur: 
		
270: Call AfficherErreur("frmProjSoumElec", "RemplirColonnes", Err, Erl())
	End Sub
	
	Private Sub BarrerChamps(ByVal bBarrer As Boolean)
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui barre ou débarre les champs d'après la variable bBarrer
10: txtProjet.ReadOnly = bBarrer
15: txtNbreManuel.ReadOnly = bBarrer
20: txtPrixManuel.ReadOnly = bBarrer
25: picApprob.Enabled = Not bBarrer
30: txtCheminPhotos.ReadOnly = bBarrer
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "BarrerChamps", Err, Erl())
	End Sub
	
	Private Sub ViderChamps()
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui initialise les champs
10: txtClient.Text = vbNullString
15: txtcontact.Text = vbNullString
20: txtProjet.Text = vbNullString
25: txtNbreManuel.Text = CStr(0)
30: txtPrixManuel.Text = CStr(0)
35: txtTransport.Text = vbNullString
40: txtPrixReception.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
45: txtPrixSoumission.Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT)
50: chkCSA.CheckState = System.Windows.Forms.CheckState.Unchecked
55: chkCUL.CheckState = System.Windows.Forms.CheckState.Unchecked
60: chkUL.CheckState = System.Windows.Forms.CheckState.Unchecked
65: chkCUR.CheckState = System.Windows.Forms.CheckState.Unchecked
70: chkUR.CheckState = System.Windows.Forms.CheckState.Unchecked
75: chkCE.CheckState = System.Windows.Forms.CheckState.Unchecked
80: txtPrixTotal.Text = CStr(0)
85: txtProfit.Text = CStr(0)
90: txtDelais.Text = vbNullString
95: txtCommission.Text = CStr(0)
100: txtNoSoumission.Text = vbNullString
105: txtCheminPhotos.Text = vbNullString
110: txtForfait.Text = vbNullString
115: lblForfaitInitiale.Text = vbNullString
		
120: cmbtransport.SelectedIndex = I_TRANS_FAB_GRANBY
		
125: cmbclient.SelectedIndex = -1
		
130: m_bSansTemps = False
135: lblPasTemps.Visible = False
140: tmrTemps.Enabled = False
		
145: Call lvwSoumission.Items.Clear()
		
150: Exit Sub
		
AfficherErreur: 
		
155: Call AfficherErreur("frmProjSoumElec", "ViderChamps", Err, Erl())
	End Sub
	
	Private Sub RemplirComboProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Rempli le combo des soumissions
10: Dim rstProjSoum As ADODB.Recordset
		
		'Il faut vider le combo avant de le remplir
15: Call cmbProjSoum.Items.Clear()
		
20: rstProjSoum = New ADODB.Recordset
		
		'Ouvre le recordset selon le type
25: If m_eType = enumType.TYPE_PROJET Then
30: If cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT Then
35: Call rstProjSoum.Open("SELECT IDProjet FROM GRB_ProjetElec INNER JOIN GRB_ProjSoum ON GRB_ProjetElec.IDProjet = GRB_ProjSoum.IDProjSoum WHERE Ouvert = True ORDER BY IDProjet DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
40: Else
45: Call rstProjSoum.Open("SELECT IDProjet FROM GRB_ProjetElec ORDER BY IDProjet DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
50: End If
55: Else
60: If cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT Then
65: Call rstProjSoum.Open("SELECT IDSoumission FROM GRB_SoumissionElec INNER JOIN GRB_ProjSoum ON GRB_SoumissionElec.IDSoumission = GRB_ProjSoum.IDProjSoum WHERE Ouvert = True ORDER BY IDSoumission DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
70: Else
75: Call rstProjSoum.Open("SELECT IDSoumission FROM GRB_SoumissionElec ORDER BY IDSoumission DESC", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
80: End If
85: End If
		
		'Tant que ce n'est pas la fin des enregistrements
90: Do While Not rstProjSoum.EOF
			'On met le numéro de la soumission dans le combo des soumissions
95: If m_eType = enumType.TYPE_PROJET Then
100: Call cmbProjSoum.Items.Add(rstProjSoum.Fields("IDProjet").Value)
105: Else
110: Call cmbProjSoum.Items.Add(rstProjSoum.Fields("IDSoumission").Value)
115: End If
			
120: Call rstProjSoum.MoveNext()
125: Loop 
		
130: Call rstProjSoum.Close()
135: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
		'Si le combo n'est pas vide, on sélectionne l'item voulu ou le premier
140: If cmbProjSoum.Items.Count > 0 Then
			'Si il y a un numéro de projet
145: If sNoProjSoum <> vbNullString Then
				'On le sélectionne dans le combo
150: Call RechercherProjSoum(sNoProjSoum)
155: Else
				'Sinon, on sélectionne le premier
160: cmbProjSoum.SelectedIndex = 0
165: End If
170: End If
		
175: Exit Sub
		
AfficherErreur: 
		
180: Call AfficherErreur("frmProjSoumElec", "RemplirComboProjSoum", Err, Erl())
	End Sub
	
	Private Sub CalculerPrixReel(ByVal sNoItem As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPieceFRS As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim sPrixCalcul As String
25: Dim sTauxUSA As String
30: Dim sTauxSPA As String
		
35: rstConfig = New ADODB.Recordset
		
40: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
45: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
50: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
55: Call rstConfig.Close()
60: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
65: rstPieceFRS = New ADODB.Recordset
		
70: rstPieceFRS.CursorLocation = ADODB.CursorLocationEnum.adUseServer
		
75: Call rstPieceFRS.Open("SELECT PrixReel, PRIX_NET, PRIX_SP, DeviseMonétaire FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(sNoItem, "'", "''") & "' AND Type = 'E'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
80: Do While Not rstPieceFRS.EOF
85: If rstPieceFRS.Fields("PRIX_NET").Value <> vbNullString Then
90: sPrixCalcul = rstPieceFRS.Fields("PRIX_NET").Value
95: Else
100: If rstPieceFRS.Fields("PRIX_SP").Value <> vbNullString Then
105: sPrixCalcul = rstPieceFRS.Fields("PRIX_SP").Value
110: End If
115: End If
			
120: sPrixCalcul = Replace(sPrixCalcul, ".", ",")
			
125: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
130: rstPieceFRS.Fields("PrixReel").Value = Conversion_Renamed(CStr(System.Math.Round(CDbl(sPrixCalcul) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_DECIMAL, 4)
135: Else
140: If rstPieceFRS.Fields("DeviseMonétaire").Value = "SPA" Then
145: rstPieceFRS.Fields("PrixReel").Value = Conversion_Renamed(CStr(System.Math.Round(CDbl(sPrixCalcul) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_DECIMAL, 4)
150: Else
155: rstPieceFRS.Fields("PrixReel").Value = sPrixCalcul
160: End If
165: End If
			
170: Call rstPieceFRS.Update()
			
175: Call rstPieceFRS.MoveNext()
180: Loop 
		
185: Call rstPieceFRS.Close()
190: 'UPGRADE_NOTE: Object rstPieceFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceFRS = Nothing
		
195: Exit Sub
		
AfficherErreur: 
		
200: Call AfficherErreur("frmProjSoumElec", "CalculerPrixReel", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewFournisseur()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le listview des distributeurs pour une pièce choisie
10: Dim rstPieceFRS As ADODB.Recordset
15: Dim rstContact As ADODB.Recordset
20: Dim rstFRS As ADODB.Recordset
25: Dim rstInv As ADODB.Recordset
30: Dim itmFRS As System.Windows.Forms.ListViewItem
35: Dim iCompteur As Short
40: Dim iNoClient As Short
45: Dim bAjouterDP As Boolean
50: Dim sDevise As String
55: Dim lColor As Integer
		
60: rstPieceFRS = New ADODB.Recordset
65: rstContact = New ADODB.Recordset
70: rstFRS = New ADODB.Recordset
		
		'vide le lister
75: Call lvwfournisseur.Items.Clear()
		
80: If m_bPieceInutile = True Or m_bChangementFRS = True Then
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call CalculerPrixReel(Trim(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text))
90: Else
95: If m_bRecherchePiece = True Then
100: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call CalculerPrixReel(Trim(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text))
105: Else
110: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call CalculerPrixReel(Trim(lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text))
115: End If
120: End If
		
125: Call rstFRS.Open("SELECT IDFRS FROM GRB_Fournisseur WHERE NomFournisseur = 'FOURNI PAR LE CLIENT'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
130: iNoClient = rstFRS.Fields("IDFRS").Value
		
135: Call rstFRS.Close()
140: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
		
145: If m_bPieceInutile = True Or m_bChangementFRS = True Then
150: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPieceFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Trim(Replace(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text, "'", "''")) & "' AND Type = 'E' ORDER BY CDbl(PrixReel)", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
155: Else
160: If m_bRecherchePiece = True Then
165: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstPieceFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Trim(Replace(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text, "'", "''")) & "' AND Type = 'E' ORDER BY CDbl(PrixReel)", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
170: Else
175: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstPieceFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Trim(Replace(lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text, "'", "''")) & "' AND Type = 'E' ORDER BY CDbl(PrixReel)", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
180: End If
185: End If
		
		'Tant qu'il y a des fournisseur de la pièce, on ajoute dans le ListView
190: Do While Not rstPieceFRS.EOF
195: If m_bPieceInutile = True Then
200: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Then
205: If rstPieceFRS.Fields("IDFRS").Value = iNoClient Then
210: Call rstPieceFRS.MoveNext()
						
215: If rstPieceFRS.EOF Then
220: Exit Do
225: End If
230: End If
235: End If
240: End If
			
			'on change la couleur de l'enregistrement selon la devise monétaire.
			'CAN = noir, USA ou ESP = bleu
245: If rstPieceFRS.Fields("DeviseMonétaire").Value = "CAN" Then
250: sDevise = "CAN"
255: lColor = COLOR_NOIR
260: Else
265: If rstPieceFRS.Fields("DeviseMonétaire").Value = "USA" Then
270: sDevise = "USA"
275: lColor = COLOR_BLEU
280: Else
285: sDevise = "SPA"
290: lColor = COLOR_BLEU
295: End If
300: End If
			
305: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwfournisseur.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmFRS = lvwfournisseur.Items.Add()
			
310: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
				itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
315: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_ESCOMPTE Then
				itmFRS.SubItems(I_COL_FRS_ESCOMPTE).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
320: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_NET Then
				itmFRS.SubItems(I_COL_FRS_PRIX_NET).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
325: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_SP Then
				itmFRS.SubItems(I_COL_FRS_PRIX_SP).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_SP, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
			
			'Nom du FRS
330: itmFRS.Text = rstPieceFRS.Fields("NomFournisseur").Value
			
335: itmFRS.Tag = rstPieceFRS.Fields("IDFRS").Value
			
340: itmFRS.ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Personne ressource
345: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPieceFRS.Fields("PERS_RESS").Value) Then
350: If Trim(rstPieceFRS.Fields("PERS_RESS").Value) <> vbNullString Then
355: Call rstContact.Open("SELECT NomContact FROM GRB_Contact WHERE IDContact = " & rstPieceFRS.Fields("PERS_RESS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
360: If Not rstContact.EOF Then
365: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmFRS.SubItems.Count > I_COL_FRS_PERS_RESS Then
							itmFRS.SubItems(I_COL_FRS_PERS_RESS).Text = rstContact.Fields("NomContact").Value
						Else
							itmFRS.SubItems.Insert(I_COL_FRS_PERS_RESS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstContact.Fields("NomContact").Value))
						End If
						
370: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmFRS.SubItems.Item(I_COL_FRS_PERS_RESS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
375: End If
					
380: Call rstContact.Close()
385: End If
390: End If
			
			'Date
395: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPieceFRS.Fields("Date").Value) Then
400: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_DATE Then
					itmFRS.SubItems(I_COL_FRS_DATE).Text = rstPieceFRS.Fields("Date").Value
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieceFRS.Fields("Date").Value))
				End If
405: Else
410: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_DATE Then
					itmFRS.SubItems(I_COL_FRS_DATE).Text = vbNullString
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_DATE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
415: End If
			
420: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_DATE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Entrer par
425: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPieceFRS.Fields("Entrer_Par").Value) Then
430: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ENTRER_PAR Then
					itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = rstPieceFRS.Fields("ENTRER_PAR").Value
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ENTRER_PAR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieceFRS.Fields("ENTRER_PAR").Value))
				End If
435: Else
440: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ENTRER_PAR Then
					itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = vbNullString
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ENTRER_PAR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
445: End If
			
450: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_ENTRER_PAR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Valide
455: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstPieceFRS.Fields("Valide").Value) Then
460: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_VALIDE Then
					itmFRS.SubItems(I_COL_FRS_VALIDE).Text = rstPieceFRS.Fields("Valide").Value
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_VALIDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstPieceFRS.Fields("Valide").Value))
				End If
465: Else
470: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_VALIDE Then
					itmFRS.SubItems(I_COL_FRS_VALIDE).Text = vbNullString
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_VALIDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
475: End If
			
480: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_VALIDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix listé
485: If rstPieceFRS.Fields("PRIX_LIST").Value <> vbNullString Then
490: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
					itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_LIST").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_LIST").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
495: End If
			
500: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Escompte
505: If rstPieceFRS.Fields("ESCOMPTE").Value <> vbNullString Then
510: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ESCOMPTE Then
					itmFRS.SubItems(I_COL_FRS_ESCOMPTE).Text = Conversion_Renamed(CDbl(Replace(Replace(rstPieceFRS.Fields("ESCOMPTE").Value, "_", vbNullString), ".", ",")) * 100, ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CDbl(Replace(Replace(rstPieceFRS.Fields("ESCOMPTE").Value, "_", vbNullString), ".", ",")) * 100, ModuleMain.enumConvert.MODE_POURCENT)))
				End If
515: End If
			
520: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix net
525: If rstPieceFRS.Fields("PRIX_NET").Value <> vbNullString Then
530: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_NET Then
					itmFRS.SubItems(I_COL_FRS_PRIX_NET).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_NET").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(rstPieceFRS.Fields("PRIX_NET").Value, ".", ",")), 4), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
535: End If
			
540: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix spécial
545: If rstPieceFRS.Fields("PRIX_SP").Value <> vbNullString Then
550: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_SP Then
					itmFRS.SubItems(I_COL_FRS_PRIX_SP).Text = Conversion_Renamed(System.Math.Round(rstPieceFRS.Fields("PRIX_SP").Value, 4), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_SP, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstPieceFRS.Fields("PRIX_SP").Value, 4), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
555: End If
			
560: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PRIX_SP).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Quoter
565: If rstPieceFRS.Fields("QUOTER").Value = True Then
570: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_QUOTER Then
					itmFRS.SubItems(I_COL_FRS_QUOTER).Text = "Oui"
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_QUOTER, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Oui"))
				End If
575: Else
580: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_QUOTER Then
					itmFRS.SubItems(I_COL_FRS_QUOTER).Text = "Non"
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_QUOTER, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Non"))
				End If
585: End If
			
590: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_QUOTER).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
595: If rstPieceFRS.Fields("IDFRS").Value = 717 Then 'Si le fournisseur est "SOLUTION GRB Inc."
600: rstInv = New ADODB.Recordset
				
605: Call rstInv.Open("SELECT * FROM GRB_InventaireElec WHERE TRIM(NoItem) = '" & Trim(rstPieceFRS.Fields("PIECE").Value) & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
610: If Not rstInv.EOF Then
615: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstInv.Fields("QuantitéStock").Value) Then
620: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmFRS.SubItems.Count > I_COL_FRS_STOCK Then
							itmFRS.SubItems(I_COL_FRS_STOCK).Text = rstInv.Fields("QuantitéStock").Value
						Else
							itmFRS.SubItems.Insert(I_COL_FRS_STOCK, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstInv.Fields("QuantitéStock").Value))
						End If
625: Else
630: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmFRS.SubItems.Count > I_COL_FRS_STOCK Then
							itmFRS.SubItems(I_COL_FRS_STOCK).Text = CStr(0)
						Else
							itmFRS.SubItems.Insert(I_COL_FRS_STOCK, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(0)))
						End If
635: End If
640: End If
				
645: Call rstInv.Close()
650: 'UPGRADE_NOTE: Object rstInv may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstInv = Nothing
655: End If
			
			'Pour garder en mémoire le prix d'origine, je le mets dans le
			'tag de la colonne Prix Listé
660: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = vbNullString Then
665: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
					itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = " "
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
670: End If
			
675: If rstPieceFRS.Fields("PRIX_NET").Value <> vbNullString Then
680: If rstPieceFRS.Fields("PRIX_LIST").Value = "0,00" Or rstPieceFRS.Fields("PRIX_LIST").Value = "0" Then
685: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag = Replace(rstPieceFRS.Fields("PRIX_NET").Value, ".", ",")
690: Else
695: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag = Replace(rstPieceFRS.Fields("PRIX_LIST").Value, ".", ",")
700: End If
705: Else
710: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmFRS.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag = Replace(rstPieceFRS.Fields("PRIX_SP").Value, ".", ",")
715: End If
			
720: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = vbNullString Then
725: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_ENTRER_PAR Then
					itmFRS.SubItems(I_COL_FRS_ENTRER_PAR).Text = " "
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_ENTRER_PAR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
730: End If
			
735: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_ENTRER_PAR).Tag = rstPieceFRS.Fields("NoEnreg").Value
			
740: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems(I_COL_FRS_PERS_RESS).Text = "" Then
745: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmFRS.SubItems.Count > I_COL_FRS_PERS_RESS Then
					itmFRS.SubItems(I_COL_FRS_PERS_RESS).Text = " "
				Else
					itmFRS.SubItems.Insert(I_COL_FRS_PERS_RESS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
750: End If
			
755: 'UPGRADE_WARNING: Lower bound of collection itmFRS.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmFRS.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = sDevise
			
760: Call rstPieceFRS.MoveNext()
765: Loop 
		
		'Ferme la table
770: Call rstPieceFRS.Close()
775: 'UPGRADE_NOTE: Object rstPieceFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieceFRS = Nothing
		
780: 'UPGRADE_NOTE: Object rstContact may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstContact = Nothing
		
785: If m_bPieceInutile = False Then
790: If lvwSoumission.Items.Count > 0 Then
795: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BRUN Then
800: bAjouterDP = True
805: Else
810: If m_bChangementFRS = False Then
815: bAjouterDP = True
820: End If
825: End If
830: Else
835: bAjouterDP = True
840: End If
845: Else
850: If m_bChangementFRS = True Then
855: If lvwSoumission.Items.Count > 0 Then
860: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BRUN Then
865: bAjouterDP = True
870: End If
875: Else
880: bAjouterDP = True
885: End If
890: End If
895: End If
		
900: If bAjouterDP = True Then
905: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwfournisseur.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmFRS = lvwfournisseur.Items.Add()
			
910: itmFRS.Text = "CHOISIR ULTÉRIEUREMENT"
			
915: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_LIST Then
				itmFRS.SubItems(I_COL_FRS_PRIX_LIST).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
920: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_ESCOMPTE Then
				itmFRS.SubItems(I_COL_FRS_ESCOMPTE).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
925: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_NET Then
				itmFRS.SubItems(I_COL_FRS_PRIX_NET).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
930: 'UPGRADE_WARNING: Lower bound of collection itmFRS has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmFRS.SubItems.Count > I_COL_FRS_PRIX_SP Then
				itmFRS.SubItems(I_COL_FRS_PRIX_SP).Text = " "
			Else
				itmFRS.SubItems.Insert(I_COL_FRS_PRIX_SP, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
935: End If
		
940: Exit Sub
		
AfficherErreur: 
		
945: Call AfficherErreur("frmProjSoumElec", "RemplirListViewFournisseur", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewPieces()
		
5: On Error GoTo AfficherErreur
		
		'Rempli le listview des pièces selon la catégorie de pièce choisit
10: Dim rstPieces As ADODB.Recordset
15: Dim itmPieces As System.Windows.Forms.ListViewItem
20: Dim sCategorie As String
25: Dim sTri As String
30: Dim sOrderBy As String
35: Dim bDebut As Boolean
40: Dim iIndex As Short
		
45: sTri = m_sTri
		
50: Select Case cmbTri.SelectedIndex
			Case I_CMB_PIECE_GRB : sOrderBy = "PIECE_GRB"
55: Case I_CMB_PIECE : sOrderBy = "PIECE"
60: Case I_CMB_FABRICANT : sOrderBy = "FABRICANT"
65: Case I_CMB_DESCR_FR : sOrderBy = "DESC_FR"
70: Case I_CMB_DESCR_EN : sOrderBy = "DESC_EN"
75: End Select
		
		'Il faut vider le ListView avant de le remplir
80: Call lvwPieces.Items.Clear()
		
85: sCategorie = Replace(cmbPieces.Text, "'", "''")
		
		'On ouvre un recordset selon la table choisie
90: rstPieces = New ADODB.Recordset
		
95: Call rstPieces.Open("SELECT * FROM GRB_CatalogueElec WHERE CATEGORIE = '" & sCategorie & "' ORDER BY " & sOrderBy, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
100: iIndex = 1
		
		'Tant que ce n'est pas la fin des enregistrements
105: Do While Not rstPieces.EOF
110: If rstPieces.Fields("PIECE").Value <> vbNullString And rstPieces.Fields("FABRICANT").Value <> vbNullString Then
				'Si il y a une recherche à faire
115: If sTri <> vbNullString Then
120: bDebut = False
					
					'Selon la colonne
125: Select Case m_iCol
						'Si c'est la colonne PIECE_GRB
						Case I_COL_PIECES_PIECE_GRB
							'Si la PIECE_GRB contient la recherche
130: If InStr(1, UCase(rstPieces.Fields("PIECE_GRB").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
135: bDebut = True
140: End If
							
							'Si c'est la colonne No. d'item
145: Case I_COL_PIECES_NO_ITEM
							'Si le no. d'item contient la recherche
150: If InStr(1, UCase(rstPieces.Fields("PIECE").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
155: bDebut = True
160: End If
							
							'Si c'est la colonne Manufacturier
165: Case I_COL_PIECES_MANUFACT
							'Si le manufacturier contient la recherche
170: If InStr(1, UCase(rstPieces.Fields("FABRICANT").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
175: bDebut = True
180: End If
							
							'Si c'est la colonne No. d'item
185: Case I_COL_PIECES_DESCR_FR
							'Si la description française contient la recherche
190: If InStr(1, UCase(rstPieces.Fields("DESC_FR").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
195: bDebut = True
200: End If
							
							'Si c'est la colonne No. d'item
205: Case I_COL_PIECES_DESCR_EN
							'Si la description anglaise contient la recherche
210: If InStr(1, UCase(rstPieces.Fields("DESC_EN").Value), UCase(sTri)) > 0 Then
								'On met la variable à true pour l'ajouter au début
215: bDebut = True
220: End If
225: End Select
					
230: If bDebut = True Then
235: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmPieces = lvwPieces.Items.Insert(iIndex, "")
						
240: iIndex = iIndex + 1
245: Else
250: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwPieces.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						itmPieces = lvwPieces.Items.Add()
255: End If
260: Else
265: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwPieces.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmPieces = lvwPieces.Items.Add()
270: End If
				
				'TEMPS
275: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("TEMPS").Value) Then
280: itmPieces.Tag = Trim(rstPieces.Fields("TEMPS").Value)
285: Else
290: itmPieces.Tag = vbNullString
295: End If
				
				'PIECE_GRB
300: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("PIECE_GRB").Value) Then
305: itmPieces.Text = Trim(rstPieces.Fields("PIECE_GRB").Value)
310: Else
315: itmPieces.Text = vbNullString
320: End If
				
				'PIECE
325: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("PIECE").Value) Then
330: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_NO_ITEM Then
						itmPieces.SubItems(I_COL_PIECES_NO_ITEM).Text = Trim(rstPieces.Fields("PIECE").Value)
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Trim(rstPieces.Fields("PIECE").Value)))
					End If
335: Else
340: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_NO_ITEM Then
						itmPieces.SubItems(I_COL_PIECES_NO_ITEM).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_NO_ITEM, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
345: End If
				
				'FABRICANT
350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("FABRICANT").Value) Then
355: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_MANUFACT Then
						itmPieces.SubItems(I_COL_PIECES_MANUFACT).Text = Trim(rstPieces.Fields("FABRICANT").Value)
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Trim(rstPieces.Fields("FABRICANT").Value)))
					End If
360: Else
365: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_MANUFACT Then
						itmPieces.SubItems(I_COL_PIECES_MANUFACT).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
370: End If
				
				'DESCR_FR
375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("DESC_FR").Value) Then
380: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_FR Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_FR).Text = Trim(rstPieces.Fields("DESC_FR").Value)
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Trim(rstPieces.Fields("DESC_FR").Value)))
					End If
385: Else
390: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_FR Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_FR).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_FR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
395: End If
				
				'DESCR_EN
400: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstPieces.Fields("DESC_EN").Value) Then
405: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_EN Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_EN).Text = Trim(rstPieces.Fields("DESC_EN").Value)
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Trim(rstPieces.Fields("DESC_EN").Value)))
					End If
410: Else
415: 'UPGRADE_WARNING: Lower bound of collection itmPieces has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmPieces.SubItems.Count > I_COL_PIECES_DESCR_EN Then
						itmPieces.SubItems(I_COL_PIECES_DESCR_EN).Text = vbNullString
					Else
						itmPieces.SubItems.Insert(I_COL_PIECES_DESCR_EN, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
420: End If
425: End If
			
430: Call rstPieces.MoveNext()
435: Loop 
		
440: Call rstPieces.Close()
445: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
		
450: Exit Sub
		
AfficherErreur: 
		
455: Call AfficherErreur("frmProjSoumElec", "RemplirListViewPieces", Err, Erl())
	End Sub
	
	Private Function TrouverIndexSection(ByVal sSousSection As String) As Short
		
5: On Error GoTo AfficherErreur
		
		'recherche la section et l'ajouter si elle n'a pas été trouvée
10: Dim iCompteur As Short
15: Dim iIndex As Short
20: Dim iTagSection As Short
25: Dim iIDSection As Short
30: Dim iIndexSect As Short
35: Dim bTrouverSect As Boolean
40: Dim bTrouverSSect As Boolean
45: Dim bTrouverIndexItem As Boolean
50: Dim iIndexSSection As Short
55: Dim sTagSousSection As String
60: Dim itmSoum As System.Windows.Forms.ListViewItem
		
		'Si la variable sSousSection = PAS DE SOUS-SECTION
65: If sSousSection = S_PAS_SOUS_SECTION Then
			'On l'initialise à rien
70: sSousSection = vbNullString
			'On met le tag à PAS DE SOUS-SECTION
75: sTagSousSection = S_PAS_SOUS_SECTION
80: Else
85: sTagSousSection = sSousSection
90: End If
		
		'Si le listview n'est pas vide
95: If lvwSoumission.Items.Count > 0 Then
			'Pour chaque élément du listview
100: For iCompteur = 1 To lvwSoumission.Items.Count
				'Si c'est écrit le nom de la section dans la colonne Piece
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text = cmbSections.Text Then
					'La section a été trouvée
110: bTrouverSect = True
					
					'On stock l'index de la section
115: iIndexSect = iCompteur
					
					'On commence à rechercher la sous-section à l'index suivant
120: iCompteur = iCompteur + 1
					
					'Tant que le tag du listItem est égal à l'index de la section
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					Do While lvwSoumission.Items.Item(iCompteur).Tag = VB6.GetItemData(cmbSections, cmbSections.SelectedIndex)
						'Si c'est écrit le nom de la sous-section dans la colonne Description
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_DESCR).Text = sSousSection Then
							'La sous-section a été trouvée
135: bTrouverSSect = True
							
							'On stock l'index du premier enregistrement de la section
140: iIndex = iCompteur + 1
							
145: Exit Do
150: End If
						
155: iCompteur = iCompteur + 1
						
						'Si le compteur est plus grand que le listItems.Count, il ne faut pas repasser
						'dans la boucle
160: If iCompteur > lvwSoumission.Items.Count Then
165: Exit Do
170: End If
175: Loop 
					
180: Exit For
185: End If
190: Next 
195: Else
200: bTrouverSect = False
205: End If
		
210: If bTrouverSect = False Then
			'Ajoute la section
			
			'Si il y a des enregistrements dans le listview
215: If lvwSoumission.Items.Count > 0 Then
				'Pour chaque élément du listview
220: For iCompteur = 1 To lvwSoumission.Items.Count
					'Si ce n'est pas une section
225: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
						'iTagSection est égal à l'ordre de la section du listitem
230: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						iTagSection = lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
						'iIDSection est égal à l'ordre de la section du combo
235: iIDSection = cmbSections.SelectedIndex + 1
						
						'Le premier enregistrement est 2 puisque 1 c'est une section
240: If iCompteur = 2 Then
							'Si l'index de la section du combo est plus petit que
							'l'index de la section du ListItem
245: If iIDSection < iTagSection Then
250: iIndex = 1
								
255: Exit For
260: End If
265: Else
270: If iCompteur = lvwSoumission.Items.Count Then
								'Si l'index de la section du combo est plus grand que l'index
								'de la section du ListItem
275: If iIDSection > iTagSection Then
280: iIndex = iCompteur + 1
									
285: Exit For
290: End If
295: Else
300: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.Items.Item(iCompteur + 1).Tag <> vbNullString Then
									'Si l'index de la section du combo est plus grand que l'index
									'de la section du ListItem et que l'index de la section du combo
									'est plus petit que l'index de la section du ListItem suivant
305: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If iIDSection > iTagSection And iIDSection < lvwSoumission.Items.Item(iCompteur + 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag Then
310: iIndex = iCompteur + 1
										
315: Exit For
320: End If
325: Else
									'Si l'index de la section du combo est plus grand que l'index
									'de la section du ListItem et que l'index de la section du combo
									'est plus petit que l'index de 2 ListItem plus loin
330: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If iIDSection > iTagSection And iIDSection < lvwSoumission.Items.Item(iCompteur + 2).SubItems.Item(I_COL_SOUM_MANUFACT).Tag Then
335: iIndex = iCompteur + 1
340: End If
345: End If
350: End If
355: End If
360: End If
365: Next 
370: Else
375: iIndex = 1
380: End If
			
			'On ajoute la section au bon index
385: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Insert(iIndex, "")
			
390: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = cmbSections.Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, cmbSections.Text))
			End If
395: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
			
400: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
405: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1)
			
410: Call ValeurParDefaut(itmSoum)
			
415: iIndex = iIndex + 1
			
			'On l'ajoute la sous-section à l'index suivant
420: iIndexSSection = AjouterSousSection(iIndex, sTagSousSection)
			
425: iIndex = iIndexSSection
430: Else
			'Si la sous-section n'a pas été trouvé dans le listview
435: If bTrouverSSect = False Then
				'On l'ajoute à l'index suivant la section
440: iIndexSSection = AjouterSousSection(iIndexSect + 1, sTagSousSection)
				
445: iIndex = iIndexSSection
450: End If
455: End If
		
		'Pour trouver le dernier élément de la sous-section
		
		'Pour chaque élément du listview à partir de l'index du premier élément de la sous-section
460: Dim counter As Short
		counter = iIndex
		For iCompteur = counter To lvwSoumission.Items.Count
			'Si on trouve une autre sous-section ou une autre section
465: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> VB6.GetItemData(cmbSections, cmbSections.SelectedIndex) Or lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).Tag <> sTagSousSection Then
470: bTrouverIndexItem = True
				
				'On l'ajoute à cette index
475: iIndex = iCompteur
				
480: Exit For
485: End If
490: Next 
		
		'Si la fin de la sous-section n'a pas été, il faut l'ajouter à la fin
495: If bTrouverIndexItem = False Then
500: iIndex = lvwSoumission.Items.Count + 1
505: End If
		
510: TrouverIndexSection = iIndex
		
515: Exit Function
		
AfficherErreur: 
		
520: Call AfficherErreur("frmProjSoumElec", "TrouverIndexSection", Err, Erl())
	End Function
	
	Private Function AjouterSousSection(ByVal iIndexSection As Short, ByVal sSousSection As String) As Short
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui sert à ajouter une sous-section
10: Dim itmSoum As System.Windows.Forms.ListViewItem
15: Dim iCompteur As Short
20: Dim bTrouverIndexSSection As Boolean
25: Dim iIndex As Short
30: Dim sTag As String
		
35: If sSousSection = S_PAS_SOUS_SECTION Then
40: sSousSection = vbNullString
45: sTag = S_PAS_SOUS_SECTION
50: Else
55: sTag = sSousSection
60: End If
		
65: If sTag <> S_PAS_SOUS_SECTION Then
			'Pour chaque élément du listview
70: For iCompteur = iIndexSection To lvwSoumission.Items.Count
				'Si le tag du ListItem est différent du IDSection de la section
75: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag <> VB6.GetItemData(cmbSections, cmbSections.SelectedIndex) Then
80: bTrouverIndexSSection = True
					
85: iIndex = iCompteur
					
90: Exit For
95: End If
100: Next 
			
			'Si l'emplacement de la sous-section n'a pas été trouvée
105: If bTrouverIndexSSection = False Then
				'On la place à la fin
110: iIndex = lvwSoumission.Items.Count + 1
115: End If
120: Else
125: iIndex = iIndexSection
130: End If
		
135: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum = lvwSoumission.Items.Insert(iIndex, "")
		
140: Call ValeurParDefaut(itmSoum)
		
		'On met le nom de la sous-section dans la colonne Description
145: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
			itmSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
		End If
150: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
		
		'On met le nom de la sous-section dans le tag de la colonne Piece
		'155     itmSoum.ListSubItems(I_COL_SOUM_PIECE).Tag = sTag
		
		'On met l'ID de la section dans le tag du listitem
155: itmSoum.Tag = CStr(VB6.GetItemData(cmbSections, cmbSections.SelectedIndex))
		
		'On ne peut pas écrire dans le tag si vide
160: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
			itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
		End If
		
		'Ordre de la section
165: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1)
		
170: AjouterSousSection = iIndex + 1
		
175: Exit Function
		
AfficherErreur: 
		
180: Call AfficherErreur("frmProjSoumElec", "AjouterSousSection", Err, Erl())
	End Function
	
	Private Sub AjouterNegatifDansListView(ByVal dblQuantite As Double, ByVal sSousSection As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim iIndex As Short
15: Dim itmSoum As System.Windows.Forms.ListViewItem
20: Dim iCompteur As Short
25: Dim iIDSection As Short
30: Dim iTagSection As Short
35: Dim bSelected As Boolean
40: Dim iIndexSel As Short
45: Dim dblTempsMec As Double
50: Dim lColor As Integer
55: Dim rstProjet As ADODB.Recordset
60: Dim bQteOK As Boolean
65: Dim sNoProjet As String
70: Dim sPrixList As String
75: Dim sEscompte As String
80: Dim sPrixNet As String
85: Dim sTemps As String
90: Dim dblTotalQte As Double
		
95: rstProjet = New ADODB.Recordset
		
100: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 Then
105: sNoProjet = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & m_sLiaison
			
110: If m_bRecherchePiece = True Then
115: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstProjet.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND NumItem = '" & Replace(lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text, "'", "''") & "' AND IDFRS = " & lvwfournisseur.FocusedItem.Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
120: Else
125: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call rstProjet.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' AND NumItem = '" & Replace(lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text, "'", "''") & "' AND IDFRS = " & lvwfournisseur.FocusedItem.Tag, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
130: End If
135: End If
		
140: If Not rstProjet.EOF Then
145: Do While Not rstProjet.EOF
150: dblTotalQte = dblTotalQte + rstProjet.Fields("Qté").Value
				
155: Call rstProjet.MoveNext()
160: Loop 
			
165: If dblTotalQte >= System.Math.Abs(dblQuantite) Then
170: bQteOK = True
175: End If
180: Else
185: Call MsgBox("La pièce n'existe pas dans le projet " & sNoProjet, MsgBoxStyle.OKOnly, "Erreur")
			
190: Call rstProjet.Close()
195: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjet = Nothing
			
200: Exit Sub
205: End If
		
210: If bQteOK = True Then
215: Call rstProjet.MovePrevious()
			
220: sPrixList = rstProjet.Fields("Prix_List").Value
225: sEscompte = rstProjet.Fields("Escompte").Value
230: sPrixNet = rstProjet.Fields("Prix_Net").Value
235: sTemps = rstProjet.Fields("Temps").Value
240: Else
245: If m_bRecherchePiece = True Then
250: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Il n'y a pas assez de " & lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text & " dans le projet " & sNoProjet & " pour en enlever " & System.Math.Abs(dblQuantite) & "!", MsgBoxStyle.OKOnly, "Erreur")
255: Else
260: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call MsgBox("Il n'y a pas assez de " & lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text & " dans le projet " & sNoProjet & " pour en enlever " & System.Math.Abs(dblQuantite) & "!", MsgBoxStyle.OKOnly, "Erreur")
265: End If
			
270: Call rstProjet.Close()
275: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjet = Nothing
			
280: Exit Sub
285: End If
		
290: Call rstProjet.Close()
295: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
300: bSelected = False
		
		'S'il y a des items dans le ListView
305: If lvwSoumission.Items.Count > 0 Then
			'Si ce n'est pas le premier qui est sélectionné
			'(le premier est sélectionné par défaut)
310: If lvwSoumission.FocusedItem.Index > 1 Then
315: bSelected = True
				
320: iIndexSel = lvwSoumission.FocusedItem.Index
325: End If
330: End If
		
		'si le premier est sélectionné, on le considère comme si aucun n'est sélectionné
335: If bSelected = False Then
340: iIndex = TrouverIndexSection(sSousSection)
345: Else
			'Sinon, on l'ajoute à l'endroit sélectionné
350: iIndex = iIndexSel
355: End If
		
360: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum = lvwSoumission.Items.Insert(iIndex, "")
		
365: itmSoum.Checked = True
		
		'Quantité
370: itmSoum.Text = CStr(dblQuantite)
		
375: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_QUOTER).Text = "Oui" Then
380: itmSoum.Text = itmSoum.Text & "*"
385: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
390: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, True)
395: Else
400: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
405: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, False)
410: End If
		
		'On met l'id de la section dans le tag du listItem
415: itmSoum.Tag = CStr(VB6.GetItemData(cmbSections, cmbSections.SelectedIndex)) 'IDSection
		
		'No d'item
420: If m_bRecherchePiece = True Then
425: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text))
			End If
430: Else
435: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text))
			End If
440: End If
		
445: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'On met le nom de la sous-section dans le tag du no d'item
450: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
		
		'On met la description en francais dans la colonne et la description en anglais
		'dans le tag
455: If m_eLangage = enumLangage.ANGLAIS Then
460: If m_bRecherchePiece = True Then
465: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text))
				End If
470: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
475: Else
480: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text))
				End If
485: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
490: End If
495: Else
500: If m_bRecherchePiece = True Then
505: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text))
				End If
510: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
515: Else
520: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text))
				End If
525: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
530: End If
535: End If
		
540: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'On met le nom du fabricant dans la colonne et l'ordre de la section dans le tag
545: If m_bRecherchePiece = True Then
550: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text))
			End If
555: Else
560: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text))
			End If
565: End If
		
570: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1) 'Ordre de la section
		
575: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Prix listé
580: If Trim(sPrixList) = vbNullString Then
585: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
590: Else
595: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(sPrixList, ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(sPrixList, ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
600: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = sPrixList
605: End If
		
610: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Si il y a un prix net, on le met l'escompte et le prix net sinon, on prend le prix
		'spécial pour mettre dans le prix net
615: If Trim(sEscompte) <> vbNullString Then
620: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = sEscompte
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sEscompte))
			End If
625: Else
630: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
			End If
635: End If
		
640: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
645: If Trim(sPrixNet) <> vbNullString Then
650: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(sPrixNet, ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(sPrixNet, ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
655: Else
660: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
665: End If
		
670: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
675: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
			itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = lvwfournisseur.FocusedItem.Text
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwfournisseur.FocusedItem.Text))
		End If
680: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
		
685: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Temps
690: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
			itmSoum.SubItems(I_COL_SOUM_TEMPS).Text = sTemps
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sTemps))
		End If
		
695: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Si le temps n'est pas vide
700: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If Trim(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text) <> vbNullString Then
			'On calcul le temps * quantité pour la colonne montage
705: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
				itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))))
			End If
710: Else
715: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
				itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
			End If
720: End If
		
725: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
730: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
			itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
		End If
		
735: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Pour le profit, c'est le prix total - (prix net * quantité)
740: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
			itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
		End If
		
745: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
750: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = vbNullString Then
755: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
760: End If
		
765: Call CalculerTempsFabrication()
		
770: Exit Sub
		
AfficherErreur: 
		
775: Call AfficherErreur("frmProjSoumElec", "AjouterNegatifDansListView", Err, Erl())
	End Sub
	
	Private Sub AjouterDansListViewSoumission(ByVal dblQuantite As Double, ByVal sSousSection As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstConfig As ADODB.Recordset
15: Dim iIndex As Short
20: Dim iCompteur As Short
25: Dim iIDSection As Short
30: Dim iTagSection As Short
35: Dim iIndexSel As Short
40: Dim itmSoum As System.Windows.Forms.ListViewItem
45: Dim bSelected As Boolean
50: Dim dblTempsMec As Double
55: Dim sDistrib As String
60: Dim sTauxUSA As String
65: Dim sTauxSPA As String
70: Dim lColor As Integer
		
75: bSelected = False
		
		'S'il y a des items dans le ListView
80: If lvwSoumission.Items.Count > 0 Then
			'Si ce n'est pas le premier qui est sélectionné
			'(le premier est sélectionné par défaut)
85: If lvwSoumission.FocusedItem.Index > 1 Then
90: bSelected = True
				
95: iIndexSel = lvwSoumission.FocusedItem.Index
100: End If
105: End If
		
		'Si le premier est sélectionné, on le considère comme si aucun n'est sélectionné
110: If bSelected = False Then
115: iIndex = TrouverIndexSection(sSousSection)
120: Else
			'Sinon, on l'ajoute à l'endroit sélectionné
125: iIndex = iIndexSel
130: End If
		
135: rstConfig = New ADODB.Recordset
		
140: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
145: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
150: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
155: Call rstConfig.Close()
160: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum = lvwSoumission.Items.Insert(iIndex, "")
		
170: itmSoum.Checked = True
		
		'Quantité
175: itmSoum.Text = CStr(dblQuantite)
		
180: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_QUOTER).Text = "Oui" Then
185: itmSoum.Text = itmSoum.Text & "*"
190: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
195: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, True)
200: Else
205: itmSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
210: itmSoum.Font = VB6.FontChangeBold(itmSoum.Font, False)
215: End If
		
220: If lvwfournisseur.FocusedItem.Text = "CHOISIR ULTÉRIEUREMENT" Then
225: lColor = COLOR_MAGENTA
230: Else
235: lColor = COLOR_NOIR
240: End If
		
		'On met l'id de la section dans le tag du listItem
245: itmSoum.Tag = CStr(VB6.GetItemData(cmbSections, cmbSections.SelectedIndex))
		
		'No d'item
250: If m_bRecherchePiece = True Then
255: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_NO_ITEM).Text))
			End If
260: Else
265: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text))
			End If
270: End If
		
275: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'On met le nom de la sous-section dans le tag du no d'item
280: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
		
		'On met la description en francais dans la colonne et la description en anglais
		'dans le tag
285: If m_eLangage = enumLangage.ANGLAIS Then
290: If m_bRecherchePiece = True Then
295: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text))
				End If
300: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
305: Else
310: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text))
				End If
315: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
320: End If
325: Else
330: If m_bRecherchePiece = True Then
335: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_FR).Text))
				End If
340: 'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_DESCR_EN).Text
345: Else
350: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmSoum.SubItems(I_COL_SOUM_DESCR).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_FR).Text))
				End If
355: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_DESCR_EN).Text
360: End If
365: End If
		
370: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'On met le nom du fabricant dans la colonne et l'ordre de la section dans le tag
375: If m_bRecherchePiece = True Then
380: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieceTrouve.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieceTrouve.FocusedItem.SubItems(I_COL_RECH_MANUFACT).Text))
			End If
385: Else
390: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text))
			End If
395: End If
		
400: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(cmbSections.SelectedIndex + 1) 'Ordre de la section
		
405: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Prix listé
410: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) = vbNullString Then
415: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
			End If
420: Else
425: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
430: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
435: Else
440: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
445: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
450: Else
455: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
460: End If
465: End If
470: End If
		
475: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag
		
480: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Si il y a un prix net, on le met l'escompte et le prix net sinon, on prend le prix
		'spécial pour mettre dans le prix net
485: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) <> vbNullString Then
490: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text) <> vbNullString Then
495: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)))
				End If
500: Else
505: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(0, ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(0, ModuleMain.enumConvert.MODE_POURCENT)))
				End If
510: End If
			
515: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
520: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
525: Else
530: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
535: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
540: Else
545: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
550: End If
555: End If
560: Else
565: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) <> vbNullString Then
570: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
575: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
580: Else
585: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
590: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
595: Else
600: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
605: End If
610: End If
615: Else
620: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
				End If
625: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
630: End If
635: End If
		
640: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
645: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'On met le fournisseur dans la colonne et l'id dans le tag
650: If lvwfournisseur.FocusedItem.Text = "CHOISIR ULTÉRIEUREMENT" Then
655: sDistrib = vbNullString
660: Else
665: sDistrib = lvwfournisseur.FocusedItem.Text
670: End If
		
675: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
			itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = sDistrib
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sDistrib))
		End If
680: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
		
685: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Temps
690: If m_bRecherchePiece = True Then
695: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
				itmSoum.SubItems(I_COL_SOUM_TEMPS).Text = Replace(lvwPieceTrouve.FocusedItem.Tag, ".", ",")
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Replace(lvwPieceTrouve.FocusedItem.Tag, ".", ",")))
			End If
700: Else
705: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
				itmSoum.SubItems(I_COL_SOUM_TEMPS).Text = Replace(lvwPieces.FocusedItem.Tag, ".", ",")
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Replace(lvwPieces.FocusedItem.Tag, ".", ",")))
			End If
710: End If
		
715: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Si le temps n'est pas vide
720: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If Trim(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text) <> vbNullString Then
			'On calcul le temps * quantité pour la colonne montage
725: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
				itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = CStr(CDbl(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(CDbl(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))))
			End If
730: Else
735: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
				itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
			End If
740: End If
		
745: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
		'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
750: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
			itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
		End If
		
755: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
760: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag
		
		'Pour le profit, c'est le prix total - (prix net * quantité)
765: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
			itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
		Else
			itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
		End If
		
770: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
		
775: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = vbNullString Then
780: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
785: End If
		
790: Call CalculerTempsFabrication()
		
795: 'UPGRADE_WARNING: MSComctlLib.ListItem method itmSoum.EnsureVisible has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		Call itmSoum.EnsureVisible()
		
800: Exit Sub
		
AfficherErreur: 
		
805: Call AfficherErreur("frmProjSoumElec", "AjouterDansListViewSoumission", Err, Erl())
	End Sub
	
	Private Sub CalculerTempsFabrication()
		
5: On Error GoTo AfficherErreur
		
10: Dim dblTempsFab As Double
15: Dim iCompteur As Short
		
		'Pour chaque élément du listView
20: For iCompteur = 1 To lvwSoumission.Items.Count
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_MONTAGE).Text) <> vbNullString Then
				'On additionne le temps
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				dblTempsFab = dblTempsFab + CDbl(Replace(Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_MONTAGE).Text), ".", ","))
35: End If
40: Next 
		
45: m_sTempsFabrication = Replace(CStr(dblTempsFab / 10), ".", ",")
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumElec", "CalculerTempsFabrication", Err, Erl())
	End Sub
	
	Private Function VerifierEmplacement(ByVal iIndexSelection As Short) As Boolean
		
5: On Error GoTo AfficherErreur
		
		'Vérifie si l'emplacement pour ajouter une pièce est valide
10: Dim itmSoum As System.Windows.Forms.ListViewItem
		
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmSoum = lvwSoumission.Items.Item(iIndexSelection)
		
20: If itmSoum.Tag = vbNullString Then
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Item(iIndexSelection - 1)
30: End If
		
		'Si la section est correcte
35: If itmSoum.Tag = VB6.GetItemData(cmbSections, cmbSections.SelectedIndex) Then
40: VerifierEmplacement = True
45: Else
50: VerifierEmplacement = False
55: End If
		
60: Exit Function
		
AfficherErreur: 
		
65: Call AfficherErreur("frmProjSoumElec", "VerifierEmplacement", Err, Erl())
	End Function
	
	Private Sub ValeurParDefaut(ByVal itmSoumission As System.Windows.Forms.ListViewItem)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour mettre une valeur par défaut dans quelques colonnes de lvwSoumission.
		'Si ces colonnes sont vides, elles restent blanches lors de la sélection
10: If m_bDroitPrix = True Then
15: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoumission.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
20: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoumission.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
25: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoumission.SubItems(I_COL_SOUM_PRIX_NET).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
30: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoumission.SubItems(I_COL_SOUM_TOTAL).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
35: 'UPGRADE_WARNING: Lower bound of collection itmSoumission has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoumission.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoumission.SubItems(I_COL_SOUM_PROFIT).Text = " "
			Else
				itmSoumission.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
			End If
40: End If
		
45: Exit Sub
		
AfficherErreur: 
		
50: Call AfficherErreur("frmProjSoumElec", "ValeurParDefaut", Err, Erl())
	End Sub
	
	Private Sub RemplirListViewProjSoum(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Remplis les pièces de la soumission avec la BD
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstSection As ADODB.Recordset
20: Dim rstFRS As ADODB.Recordset
25: Dim itmProjSoum As System.Windows.Forms.ListViewItem
30: Dim bPremierEnr As Boolean
35: Dim iOrdreSection As Short
40: Dim sSousSection As String
45: Dim sSection As String
50: Dim lColor As Integer
55: Dim bBold As Boolean
		
60: rstProjSoum = New ADODB.Recordset
65: rstSection = New ADODB.Recordset
70: rstFRS = New ADODB.Recordset
		
75: Call lvwSoumission.Items.Clear()
		
80: bPremierEnr = True
		
85: If m_eType = enumType.TYPE_PROJET Then
90: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjSoum & "' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
95: Else
100: Call rstProjSoum.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoProjSoum & "' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
105: End If
		
110: If m_eLangage = enumLangage.ANGLAIS Then
115: sSection = "NomSectionEN"
120: Else
125: sSection = "NomSectionFR"
130: End If
		
135: Do While Not rstProjSoum.EOF
140: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmProjSoum = lvwSoumission.Items.Add()
			
			'Si c'est le premier enregistrement, il faut ajouter la section et la sous-section
145: If bPremierEnr = True Then
150: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
155: sSousSection = rstProjSoum.Fields("SousSection").Value
				
				'Pour avoir le nom de la section
160: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajout du nom de la section
165: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSection.Fields(sSection).Value) Then
170: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
					End If
175: Else
180: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
185: End If
				
190: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
				
195: Call ValeurParDefaut(itmProjSoum)
				
200: Call rstSection.Close()
				
205: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
				'Ajout du nom de la sous-section
210: If sSousSection = S_PAS_SOUS_SECTION Then
215: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
220: Else
225: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
					End If
230: End If
				
				'Le tag ne peut pas être remplis si la colonne est vide
235: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
				
240: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
				
245: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
				
250: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
				
255: Call ValeurParDefaut(itmProjSoum)
				
260: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
265: bPremierEnr = False
270: Else
				'Si c'est pas le premier enregistrement, il faut vérifier avec l'ancienne section
275: If iOrdreSection <> rstProjSoum.Fields("OrdreSection").Value Then
280: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
					
285: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
290: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSection.Fields(sSection).Value) Then
295: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
						End If
300: Else
305: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
310: End If
					
315: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
					
320: Call ValeurParDefaut(itmProjSoum)
					
325: Call rstSection.Close()
					
330: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
					
335: sSousSection = rstProjSoum.Fields("SousSection").Value
					
340: If sSousSection = S_PAS_SOUS_SECTION Then
345: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
350: Else
355: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("SousSection").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("SousSection").Value))
						End If
360: End If
					
					'Le tag ne peut pas être remplis si la colonne est vide
365: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
						itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
					
370: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
					
375: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
					
380: Call ValeurParDefaut(itmProjSoum)
					
385: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
					
390: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
395: Else
					'il faut vérifier avec l'ancienne sous-section
400: If sSousSection <> rstProjSoum.Fields("SousSection").Value Then
405: sSousSection = rstProjSoum.Fields("SousSection").Value
						
410: If sSousSection = S_PAS_SOUS_SECTION Then
415: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
420: Else
425: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
							End If
430: End If
						
435: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
						
440: Call ValeurParDefaut(itmProjSoum)
						
445: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
						
						'Le tag ne peut pas être remplis si la colonne est vide
450: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
							itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
						
455: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
						
460: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						itmProjSoum = lvwSoumission.Items.Add()
465: End If
470: End If
475: End If
			
480: If rstProjSoum.Fields("PieceExtraChargeable").Value = True Then
485: lColor = COLOR_BLEU
490: bBold = True
495: Else
500: If rstProjSoum.Fields("PieceExtraNonChargeable").Value = True Then
505: lColor = COLOR_ROSE
510: bBold = True
515: Else
520: If rstProjSoum.Fields("CommandeAnnulée").Value = True Then
525: lColor = COLOR_VERT_FORET
530: bBold = True
535: Else
540: If rstProjSoum.Fields("Retour").Value = True Then
545: lColor = COLOR_ROUGE
550: bBold = False
555: Else
560: If rstProjSoum.Fields("Commandé").Value = True Then
565: lColor = COLOR_ORANGE 'COLOR_ORANGE
570: bBold = False
575: Else
580: If rstProjSoum.Fields("Recu").Value = True Then
585: lColor = COLOR_GRIS 'Gris
590: bBold = False
595: Else
600: If rstProjSoum.Fields("IDFRS").Value = 0 And rstProjSoum.Fields("NumItem").Value <> "Texte" And rstProjSoum.Fields("NumItem").Value <> "Text" Then
605: lColor = COLOR_MAGENTA
610: bBold = False
615: Else
620: If rstProjSoum.Fields("MatérielInutile").Value = True Then
625: lColor = COLOR_BRUN
630: bBold = False
635: Else
640: lColor = COLOR_NOIR
645: bBold = False
650: End If
655: End If
660: End If
665: End If
670: End If
675: End If
680: End If
685: End If
			
			'On met l'ID de la section dans le tag
690: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
			
695: If rstProjSoum.Fields("Visible").Value = True Then
700: itmProjSoum.Checked = True
705: Else
710: itmProjSoum.Checked = False
715: End If
			
			'Quantité
720: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Qté").Value) Then
725: itmProjSoum.Text = rstProjSoum.Fields("Qté").Value
730: Else
735: itmProjSoum.Text = vbNullString
740: End If
			
			'On met la quantité en vert avec un astérix si il est quoté
745: If rstProjSoum.Fields("Quoté").Value = True Then
750: itmProjSoum.Text = itmProjSoum.Text & "*"
755: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
760: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, True)
765: Else
770: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
775: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, False)
780: End If
			
			'Facturation
785: If m_eType = enumType.TYPE_PROJET Then
790: If g_bModificationProjetsElec = True Then
795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Facturation").Value) Then
800: If Trim(rstProjSoum.Fields("Facturation").Value) <> "" Then
805: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = rstProjSoum.Fields("Facturation").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Facturation").Value))
							End If
810: Else
815: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
								itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
820: End If
825: Else
830: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
							itmProjSoum.SubItems(I_COL_SOUM_FACTURATION).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
835: End If
840: End If
845: End If
			
			'Numéro d'item
850: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("NumItem").Value) Then
855: If rstProjSoum.Fields("NumItem").Value = "Texte" Or rstProjSoum.Fields("NumItem").Value = "Text" Then
860: If m_eLangage = enumLangage.ANGLAIS Then
865: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Text"))
						End If
870: Else
875: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Texte"))
						End If
880: End If
885: Else
890: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstProjSoum.Fields("NumItem").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NumItem").Value))
					End If
895: End If
900: Else
905: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
					itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
910: End If
			
915: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
920: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, bBold)
			
			'On met le nom de la sous-section dans le tag du numéro d'item
925: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = rstProjSoum.Fields("SousSection").Value
			
930: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
935: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
				End If
940: Else
945: If m_eLangage = enumLangage.ANGLAIS Then
					'Description en anglais
950: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_EN").Value) Then
955: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_EN").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_EN").Value))
						End If
960: Else
965: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
970: End If
					
					'On met la description en francais dans le tag de la description en anglais
975: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
980: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("DESC_FR").Value
985: Else
990: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
995: End If
1000: Else
					'Description en francais
1005: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
1010: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
						End If
1015: Else
1020: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1025: End If
					
					'On met la description en anglais dans le tag de la description en francais
1030: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_EN").Value) Then
1035: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("DESC_EN").Value
1040: Else
1045: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
1050: End If
1055: End If
1060: End If
			
1065: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
1070: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, bBold)
			
			'Fabricant
1075: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Manufact").Value) Then
1080: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = rstProjSoum.Fields("Manufact").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Manufact").Value))
				End If
1085: Else
1090: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
1095: End If
			
1100: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
1105: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Font, bBold)
			
			'On met l'ordre de la section dans le tag du fabricant
1110: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
			
			'Prix listé
1115: If m_bDroitPrix = True Then
1120: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("PRIX_LIST").Value) Then
1125: If rstProjSoum.Fields("PRIX_LIST").Value <> "" Then
1130: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(rstProjSoum.Fields("PRIX_LIST"), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("PRIX_LIST"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
1135: Else
1140: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1145: End If
1150: Else
1155: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1160: End If
				
1165: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
1170: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, bBold)
				
1175: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstProjSoum.Fields("PrixOrigine").Value
				
				'Escompte
1180: If Trim(rstProjSoum.Fields("Escompte").Value) <> vbNullString Then
1185: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)))
					End If
1190: Else
1195: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1200: End If
				
1205: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1210: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, bBold)
				
1215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("PRIX_NET").Value) Then
1220: If rstProjSoum.Fields("PRIX_NET").Value <> "" Then
1225: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstProjSoum.Fields("PRIX_NET"), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("PRIX_NET"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
1230: Else
1235: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1240: End If
1245: Else
1250: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("", ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("", ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
1255: End If
				
1260: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1265: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, bBold)
				
1270: If m_eType = enumType.TYPE_PROJET Then
1275: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = rstProjSoum.Fields("DateRéception").Value
1280: End If
				
				'Fournisseur
1285: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("IDFRS").Value) And rstProjSoum.Fields("IDFRS").Value > 0 Then
1290: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
1295: Call rstFRS.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstProjSoum.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
						'On affiche le nom dans la colonne
1300: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
							itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = rstFRS.Fields("NomFournisseur").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstFRS.Fields("NomFournisseur").Value))
						End If
						
1305: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
1310: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Font, bBold)
						
						'On affiche l'Id dans le tag
1315: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = rstProjSoum.Fields("IDFRS").Value
						
1320: Call rstFRS.Close()
1325: End If
1330: Else
1335: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1340: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(0)
1345: End If
				
				'Temps
1350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Temps").Value) Then
1355: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
						itmProjSoum.SubItems(I_COL_SOUM_TEMPS).Text = rstProjSoum.Fields("Temps").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Temps").Value))
					End If
1360: Else
1365: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
						itmProjSoum.SubItems(I_COL_SOUM_TEMPS).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1370: End If
				
1375: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1380: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_TEMPS).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_TEMPS).Font, bBold)
				
				'Montage
1385: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Temps_total").Value) Then
1390: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
						itmProjSoum.SubItems(I_COL_SOUM_MONTAGE).Text = rstProjSoum.Fields("Temps_total").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Temps_total").Value))
					End If
1395: Else
1400: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
						itmProjSoum.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1405: End If
				
1410: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1415: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_MONTAGE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_MONTAGE).Font, bBold)
				
				'Prix total
1420: If Trim(rstProjSoum.Fields("Prix_total").Value) <> vbNullString Then
1425: If IsNumeric(rstProjSoum.Fields("Prix_Total").Value) Then
1430: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
							itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
						End If
1435: Else
1440: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
							itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1445: End If
1450: Else
1455: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
						itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1460: End If
				
1465: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1470: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Font, bBold)
				
1475: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = rstProjSoum.Fields("Devise").Value
				
				'Profit
1480: If Trim(rstProjSoum.Fields("Profit_argent").Value) <> vbNullString Then
1485: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
1490: Else
1495: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
1500: End If
				
1505: If m_eType = enumType.TYPE_PROJET Then
1510: If rstProjSoum.Fields("PieceExtraChargeable").Value = True Or rstProjSoum.Fields("PieceExtraNonChargeable").Value = True Then
1515: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Tag = "EXTRA"
1520: End If
1525: End If
				
1530: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1535: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).Font, bBold)
				
1540: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Commentaire").Value) Then
1545: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = rstProjSoum.Fields("Commentaire").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Commentaire").Value))
					End If
1550: Else
1555: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1560: End If
				
1565: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
1570: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).Font, bBold)
				
1575: If m_eType = enumType.TYPE_PROJET Then
1580: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("ID").Value) Then
1585: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_ID Then
							itmProjSoum.SubItems(I_COL_SOUM_ID).Text = rstProjSoum.Fields("ID").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("ID").Value))
						End If
1590: Else
1595: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_ID Then
							itmProjSoum.SubItems(I_COL_SOUM_ID).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1600: End If
					
1605: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_ID).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1610: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_ID).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_ID).Font, bBold)
					
1615: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateCommande").Value) Then
1620: If Trim(rstProjSoum.Fields("DateCommande").Value) <> "" Then
1625: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = rstProjSoum.Fields("DateCommande").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateCommande").Value))
							End If
1630: Else
1635: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1640: End If
1645: Else
1650: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1655: End If
					
1660: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1665: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font, bBold)
					
1670: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Tag = rstProjSoum.Fields("NoRetour").Value
					
1675: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateRequise").Value) Then
1680: If Trim(rstProjSoum.Fields("DateRequise").Value) <> "" Then
1685: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = rstProjSoum.Fields("DateRequise").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateRequise").Value))
							End If
1690: Else
1695: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
1700: End If
1705: Else
1710: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
							itmProjSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
1715: End If
					
1720: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1725: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font, bBold)
					
1730: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Tag = rstProjSoum.Fields("DateRetour").Value
					
1735: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("NomCommande").Value) Then
1740: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = rstProjSoum.Fields("NomCommande").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NomCommande").Value))
						End If
1745: Else
1750: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1755: End If
					
1760: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1765: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font, bBold)
					
1770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("NoSéquentiel").Value) Then
1775: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
							itmProjSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = rstProjSoum.Fields("NoSéquentiel").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NoSéquentiel").Value))
						End If
1780: Else
1785: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
							itmProjSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1790: End If
					
1795: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
1800: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font, bBold)
					
1805: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
1810: If Trim(rstProjSoum.Fields("Provenance").Value) <> vbNullString Then
1815: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
1820: Else
1825: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
1830: End If
1835: Else
1840: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PROVENANCE Then
							itmProjSoum.SubItems(I_COL_SOUM_PROVENANCE).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1845: End If
					
1850: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
1855: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PROVENANCE).Font, bBold)
1860: Else
1865: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
1870: If Trim(rstProjSoum.Fields("Provenance").Value) <> vbNullString Then
1875: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
1880: Else
1885: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
1890: End If
1895: Else
1900: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_PROV Then
							itmProjSoum.SubItems(I_COL_SOUMISSION_PROV).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
1905: End If
					
1910: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
1915: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUMISSION_PROV).Font, bBold)
1920: End If
1925: Else
				'Fournisseur
1930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("IDFRS").Value) And rstProjSoum.Fields("IDFRS").Value > 0 Then
1935: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems(I_COL_SOUM_SP_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_SP_PIECE).Text <> "Text" Then
1940: Call rstFRS.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstProjSoum.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
						
						'On affiche le nom dans la colonne
1945: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DISTRIB Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_DISTRIB).Text = rstFRS.Fields("NomFournisseur").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstFRS.Fields("NomFournisseur").Value))
						End If
						
1950: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
						
1955: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).Font, bBold)
						
						'On affiche l'Id dans le tag
1960: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).Tag = rstProjSoum.Fields("IDFRS").Value
						
1965: Call rstFRS.Close()
1970: End If
1975: Else
1980: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_DISTRIB).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
1985: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DISTRIB).Tag = CStr(0)
1990: End If
				
				'Temps
1995: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Temps").Value) Then
2000: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_TEMPS Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_TEMPS).Text = rstProjSoum.Fields("Temps").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Temps").Value))
					End If
2005: Else
2010: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_TEMPS Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_TEMPS).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
2015: End If
				
2020: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
2025: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_TEMPS).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_TEMPS).Font, bBold)
				
				'Montage
2030: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Temps_total").Value) Then
2035: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_MONTAGE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_MONTAGE).Text = rstProjSoum.Fields("Temps_total").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Temps_total").Value))
					End If
2040: Else
2045: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_MONTAGE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_MONTAGE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
2050: End If
				
2055: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
2060: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_MONTAGE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_MONTAGE).Font, bBold)
				
2065: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("Commentaire").Value) Then
2070: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_COMMENTAIRE).Text = rstProjSoum.Fields("Commentaire").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Commentaire").Value))
					End If
2075: Else
2080: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_COMMENTAIRE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_COMMENTAIRE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
2085: End If
				
2090: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
2095: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_SP_COMMENTAIRE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_COMMENTAIRE).Font, bBold)
				
2100: If m_eType = enumType.TYPE_PROJET Then
2105: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("ID").Value) Then
2110: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_ID Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_ID).Text = rstProjSoum.Fields("ID").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("ID").Value))
						End If
2115: Else
2120: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_ID Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_ID).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
2125: End If
					
2130: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_ID).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2135: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_ID).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_ID).Font, bBold)
					
2140: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateCommande").Value) Then
2145: If Trim(rstProjSoum.Fields("DateCommande").Value) <> "" Then
2150: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_COMMANDE).Text = rstProjSoum.Fields("DateCommande").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateCommande").Value))
							End If
2155: Else
2160: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_COMMANDE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_COMMANDE).Text = " "
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
							End If
2165: End If
2170: Else
2175: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_COMMANDE Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_COMMANDE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
2180: End If
					
2185: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2190: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).Font, bBold)
					
2195: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_COMMANDE).Tag = rstProjSoum.Fields("DateCommande").Value
					
2200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DateRequise").Value) Then
2205: If Trim(rstProjSoum.Fields("DateRequise").Value) <> "" Then
2210: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_REQUISE).Text = rstProjSoum.Fields("DateRequise").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DateRequise").Value))
							End If
2215: Else
2220: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_REQUISE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_REQUISE).Text = ""
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
2225: End If
2230: Else
2235: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_DATE_REQUISE Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_DATE_REQUISE).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
2240: End If
					
2245: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2250: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).Font, bBold)
					
2255: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_DATE_REQUISE).Tag = rstProjSoum.Fields("DateRetour").Value
					
2260: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_NOM_COMMANDE Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_NOM_COMMANDE).Text = rstProjSoum.Fields("NomCommande").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NomCommande").Value))
					End If
					
2265: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2270: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NOM_COMMANDE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NOM_COMMANDE).Font, bBold)
					
2275: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_NO_SEQUENTIEL Then
						itmProjSoum.SubItems(I_COL_SOUM_SP_NO_SEQUENTIEL).Text = rstProjSoum.Fields("NoSéquentiel").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NoSéquentiel").Value))
					End If
					
2280: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
2285: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NO_SEQUENTIEL).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_NO_SEQUENTIEL).Font, bBold)
					
2290: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
2295: If Trim(rstProjSoum.Fields("Provenance").Value) <> "" Then
2300: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_PROVENANCE).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
2305: Else
2310: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_PROVENANCE Then
								itmProjSoum.SubItems(I_COL_SOUM_SP_PROVENANCE).Text = ""
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
2315: End If
2320: Else
2325: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_SP_PROVENANCE Then
							itmProjSoum.SubItems(I_COL_SOUM_SP_PROVENANCE).Text = ""
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_SP_PROVENANCE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
						End If
2330: End If
					
2335: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_PROVENANCE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
2340: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_SP_PROVENANCE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_SP_PROVENANCE).Font, bBold)
2345: Else
2350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("Provenance").Value) Then
2355: If Trim(rstProjSoum.Fields("Provenance").Value) <> "" Then
2360: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_SP_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_SP_PROV).Text = VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_SP_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 3) & "-" & rstProjSoum.Fields("Provenance").Value))
							End If
2365: Else
2370: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_SP_PROV Then
								itmProjSoum.SubItems(I_COL_SOUMISSION_SP_PROV).Text = ""
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_SP_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
2375: End If
2380: Else
2385: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUMISSION_SP_PROV Then
							itmProjSoum.SubItems(I_COL_SOUMISSION_SP_PROV).Text = ""
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUMISSION_SP_PROV, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
						End If
2390: End If
					
2395: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_SP_PROV).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
2400: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUMISSION_SP_PROV).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUMISSION_SP_PROV).Font, bBold)
2405: End If
2410: End If
			
2415: Call rstProjSoum.MoveNext()
			
2420: Call lvwSoumission.Refresh()
2425: Loop 
		
2430: If lvwSoumission.Items.Count > 0 Then
2435: Call Deselect()
			
2440: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.Items.Item(1).Selected = True
2445: End If
		
2450: Call CalculerPrix()
		
2455: Call rstProjSoum.Close()
2460: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
2465: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
2470: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
2475: Exit Sub
		
AfficherErreur: 
		
2480: Call AfficherErreur("frmProjSoumElec", "RemplirListViewProjSoum", Err, Erl(), sNoProjSoum)
	End Sub
	
	Private Sub RemplirListViewSoumissionProjet(ByVal sNoProjet As String)
		
5: On Error GoTo AfficherErreur
		
		'Remplis les pièces de la soumission avec la BD
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstSection As ADODB.Recordset
20: Dim rstFRS As ADODB.Recordset
25: Dim itmProjSoum As System.Windows.Forms.ListViewItem
30: Dim bPremierEnr As Boolean
35: Dim iOrdreSection As Short
40: Dim sSousSection As String
45: Dim sSection As String
50: Dim lColor As Integer
		
55: rstProjSoum = New ADODB.Recordset
60: rstSection = New ADODB.Recordset
65: rstFRS = New ADODB.Recordset
		
70: Call lvwSoumission.Items.Clear()
		
75: bPremierEnr = True
		
80: Call rstProjSoum.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjet & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
85: If m_eLangage = enumLangage.ANGLAIS Then
90: sSection = "NomSectionEN"
95: Else
100: sSection = "NomSectionFR"
105: End If
		
110: Do While Not rstProjSoum.EOF
115: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			itmProjSoum = lvwSoumission.Items.Add()
			
			'Si c'est le premier enregistrement, il faut ajouter la section et la sous-section
120: If bPremierEnr = True Then
125: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
130: sSousSection = rstProjSoum.Fields("SousSection").Value
				
				'Pour avoir le nom de la section
135: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
				'Ajout du nom de la section
140: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSection.Fields(sSection).Value) Then
145: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
					End If
150: Else
155: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
160: End If
				
165: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
				
170: Call ValeurParDefaut(itmProjSoum)
				
175: Call rstSection.Close()
				
180: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
				'Ajout du nom de la sous-section
185: If sSousSection = S_PAS_SOUS_SECTION Then
190: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
195: Else
200: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
						itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
					End If
205: End If
				
				'Le tag ne peut pas être remplis si la colonne est vide
210: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
				
215: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
				
220: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
				
225: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
				
230: Call ValeurParDefaut(itmProjSoum)
				
235: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
				itmProjSoum = lvwSoumission.Items.Add()
				
240: bPremierEnr = False
245: Else
				'Si c'est pas le premier enregistrement, il faut vérifier avec l'ancienne section
250: If iOrdreSection <> rstProjSoum.Fields("OrdreSection").Value Then
255: iOrdreSection = rstProjSoum.Fields("OrdreSection").Value
					
260: Call rstSection.Open("SELECT " & sSection & " FROM GRB_SoumProjSectionElec WHERE IDSection = " & rstProjSoum.Fields("IDSection").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
265: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSection.Fields(sSection).Value) Then
270: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstSection.Fields(sSection).Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstSection.Fields(sSection).Value))
						End If
275: Else
280: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
285: End If
					
290: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
					
295: Call ValeurParDefaut(itmProjSoum)
					
300: Call rstSection.Close()
					
305: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
					
310: sSousSection = rstProjSoum.Fields("SousSection").Value
					
315: If sSousSection = S_PAS_SOUS_SECTION Then
320: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
325: Else
330: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("SousSection").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("SousSection").Value))
						End If
335: End If
					
					'Le tag ne peut pas être remplis si la colonne est vide
340: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
						itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
					End If
					
345: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
					
350: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
					
355: Call ValeurParDefaut(itmProjSoum)
					
360: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
					
365: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
					itmProjSoum = lvwSoumission.Items.Add()
370: Else
					'il faut vérifier avec l'ancienne sous-section
375: If sSousSection <> rstProjSoum.Fields("SousSection").Value Then
380: sSousSection = rstProjSoum.Fields("SousSection").Value
						
385: If sSousSection = S_PAS_SOUS_SECTION Then
390: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
							End If
395: Else
400: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
								itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = sSousSection
							Else
								itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, sSousSection))
							End If
405: End If
						
410: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
						
415: Call ValeurParDefaut(itmProjSoum)
						
420: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
						
						'Le tag ne peut pas être remplis si la colonne est vide
425: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
							itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = " "
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
						End If
						
430: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
						
435: 'UPGRADE_ISSUE: MSComctlLib.ListItems method lvwSoumission.ListItems.Add was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
						itmProjSoum = lvwSoumission.Items.Add()
440: End If
445: End If
450: End If
			
455: If rstProjSoum.Fields("IDFRS").Value = 0 And rstProjSoum.Fields("NumItem").Value <> "Texte" And rstProjSoum.Fields("NumItem").Value <> "Text" Then
460: lColor = COLOR_MAGENTA
465: Else
470: lColor = COLOR_NOIR
475: End If
			
			'On met l'ID de la section dans le tag
480: itmProjSoum.Tag = rstProjSoum.Fields("IDSection").Value
			
485: If rstProjSoum.Fields("Visible").Value = True Then
490: itmProjSoum.Checked = True
495: Else
500: itmProjSoum.Checked = False
505: End If
			
			'Quantité
510: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Qté").Value) Then
515: itmProjSoum.Text = rstProjSoum.Fields("Qté").Value
520: Else
525: itmProjSoum.Text = vbNullString
530: End If
			
			'On met la quantité en vert avec un astérix si il est quoté
535: If rstProjSoum.Fields("Quoté").Value = True Then
540: itmProjSoum.Text = itmProjSoum.Text & "*"
545: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT)
550: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, True)
555: Else
560: itmProjSoum.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
565: itmProjSoum.Font = VB6.FontChangeBold(itmProjSoum.Font, False)
570: End If
			
			'Numéro d'item
575: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("NumItem").Value) Then
580: If rstProjSoum.Fields("NumItem").Value = "Texte" Or rstProjSoum.Fields("NumItem").Value = "Text" Then
585: If m_eLangage = enumLangage.ANGLAIS Then
590: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Text"))
						End If
595: Else
600: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
							itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte"
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "Texte"))
						End If
605: End If
610: Else
615: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
						itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = rstProjSoum.Fields("NumItem").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("NumItem").Value))
					End If
620: End If
625: Else
630: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PIECE Then
					itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
635: End If
			
640: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom de la sous-section dans le tag du numéro d'item
645: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = rstProjSoum.Fields("SousSection").Value
			
650: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Texte" Or itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text = "Text" Then
655: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
					itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
				End If
660: Else
665: If m_eLangage = enumLangage.ANGLAIS Then
					'Description en anglais
670: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_EN").Value) Then
675: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_EN").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_EN").Value))
						End If
680: Else
685: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
690: End If
					
					'On met la description en francais dans le tag de la description en anglais
695: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
700: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("DESC_FR").Value
705: Else
710: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
715: End If
720: Else
					'Description en francais
725: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_FR").Value) Then
730: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = rstProjSoum.Fields("DESC_FR").Value
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("DESC_FR").Value))
						End If
735: Else
740: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmProjSoum.SubItems.Count > I_COL_SOUM_DESCR Then
							itmProjSoum.SubItems(I_COL_SOUM_DESCR).Text = vbNullString
						Else
							itmProjSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
						End If
745: End If
					
					'On met la description en anglais dans le tag de la description en francais
750: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("DESC_EN").Value) Then
755: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = rstProjSoum.Fields("DESC_EN").Value
760: Else
765: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = vbNullString
770: End If
775: End If
780: End If
			
785: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Fabricant
790: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Manufact").Value) Then
795: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = rstProjSoum.Fields("Manufact").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Manufact").Value))
				End If
800: Else
805: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmProjSoum.SubItems(I_COL_SOUM_MANUFACT).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
810: End If
			
815: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met l'ordre de la section dans le tag du fabricant
820: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = CStr(iOrdreSection)
			
			'Prix listé
825: If Trim(rstProjSoum.Fields("Prix_List").Value) <> vbNullString Then
830: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(rstProjSoum.Fields("Prix_list"), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Prix_list"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
835: Else
840: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
845: End If
			
850: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
855: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = rstProjSoum.Fields("PrixOrigine").Value
			
			'Escompte
860: If Trim(rstProjSoum.Fields("Escompte").Value) <> vbNullString Then
865: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Escompte"), ModuleMain.enumConvert.MODE_POURCENT)))
				End If
870: Else
875: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmProjSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
880: End If
			
885: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix net
890: If Trim(rstProjSoum.Fields("Prix_net").Value) <> vbNullString Then
895: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(rstProjSoum.Fields("Prix_net"), ModuleMain.enumConvert.MODE_ARGENT, 4)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(rstProjSoum.Fields("Prix_net"), ModuleMain.enumConvert.MODE_ARGENT, 4)))
				End If
900: Else
905: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmProjSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
910: End If
			
915: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Fournisseur
920: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("IDFRS").Value) And rstProjSoum.Fields("IDFRS").Value > 0 Then
925: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And itmProjSoum.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
930: Call rstFRS.Open("SELECT NomFournisseur FROM GRB_Fournisseur WHERE IDFRS = " & rstProjSoum.Fields("IDFRS").Value, g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
					
					'On affiche le nom dans la colonne
935: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = rstFRS.Fields("NomFournisseur").Value
					Else
						itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstFRS.Fields("NomFournisseur").Value))
					End If
					
940: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
					
					'On affiche l'Id dans le tag
945: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = rstProjSoum.Fields("IDFRS").Value
					
950: Call rstFRS.Close()
955: End If
960: Else
965: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
					itmProjSoum.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
970: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmProjSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(0)
975: End If
			
			'Temps
980: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Temps").Value) Then
985: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
					itmProjSoum.SubItems(I_COL_SOUM_TEMPS).Text = rstProjSoum.Fields("Temps").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Temps").Value))
				End If
990: Else
995: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
					itmProjSoum.SubItems(I_COL_SOUM_TEMPS).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
1000: End If
			
1005: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Montage
1010: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Temps_total").Value) Then
1015: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmProjSoum.SubItems(I_COL_SOUM_MONTAGE).Text = rstProjSoum.Fields("Temps_total").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Temps_total").Value))
				End If
1020: Else
1025: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmProjSoum.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
1030: End If
			
1035: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Prix total
1040: If Trim(rstProjSoum.Fields("Prix_total").Value) <> vbNullString Then
1045: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
					itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Prix_total").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
1050: Else
1055: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
					itmProjSoum.SubItems(I_COL_SOUM_TOTAL).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
1060: End If
			
1065: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Profit
1070: If Trim(rstProjSoum.Fields("Profit_argent").Value) <> vbNullString Then
1075: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
					itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(rstProjSoum.Fields("Profit_Argent").Value, 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
1080: Else
1085: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
					itmProjSoum.SubItems(I_COL_SOUM_PROFIT).Text = " "
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
1090: End If
			
1095: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
1100: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
			If Not IsDbNull(rstProjSoum.Fields("Commentaire").Value) Then
1105: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
					itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = rstProjSoum.Fields("Commentaire").Value
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, rstProjSoum.Fields("Commentaire").Value))
				End If
1110: Else
1115: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmProjSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
					itmProjSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = vbNullString
				Else
					itmProjSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
1120: End If
			
1125: 'UPGRADE_WARNING: Lower bound of collection itmProjSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmProjSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
1130: Call rstProjSoum.MoveNext()
			
1135: Call lvwSoumission.Refresh()
1140: Loop 
		
1145: Call rstProjSoum.Close()
1150: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
1155: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
1160: 'UPGRADE_NOTE: Object rstSection may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSection = Nothing
		
1165: Exit Sub
		
AfficherErreur: 
		
1170: Call AfficherErreur("frmProjSoumElec", "RemplirListSoumissionProjet", Err, Erl())
	End Sub
	
	Private Sub CalculerPrix()
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour calculer le prix
10: Dim dblPrixPieces As Double
15: Dim dblPrixTotal As Double
20: Dim dblCommission As Double
25: Dim dblTotalTemps As Double
30: Dim dblProfit As Double
35: Dim dblTotalManuel As Double
40: Dim dblTotalImprevue As Double
45: Dim dblGrandTotal As Double
50: Dim dblTotalDessin As Double
55: Dim dblTotalFabrication As Double
60: Dim dblTotalAssemblage As Double
65: Dim dblTotalProgInterface As Double
70: Dim dblTotalProgAutomate As Double
75: Dim dblTotalProgRobot As Double
80: Dim dblTotalVision As Double
85: Dim dblTotalTest As Double
90: Dim dblTotalInstallation As Double
95: Dim dblTotalMiseService As Double
100: Dim dblTotalFormation As Double
105: Dim dblTotalGestion As Double
110: Dim dblTotalShipping As Double
115: Dim dblHebergement As Double
120: Dim dblRepas As Double
125: Dim dblTransport As Double
130: Dim dblUniteMobile As Double
135: Dim dblPrixEmballage As Double
140: Dim dblTotalResteTemps As Double
145: Dim bDemande As Boolean
150: Dim iNbrePersonne As Short
155: Dim iCompteur As Short
		
		'Si ce n'est pas en mode affichage
160: If m_bModeAffichage = False Then
			'Pour chaque élément du listview
165: For iCompteur = 1 To lvwSoumission.Items.Count
				'Si ce n'est pas une section
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
175: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
180: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_DISTRIB).Text <> vbNullString Then
							'On additionne le prix total
							
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If IsNumeric(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_TOTAL).Text) And IsNumeric(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text) Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								dblPrixPieces = dblPrixPieces + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_TOTAL).Text) - CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)
195: Else
200: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								Call MsgBox("La pièce " & lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text & " a un prix non numérique!", MsgBoxStyle.OKOnly, "Erreur")
205: End If
							
							'On additionne le profit
210: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If IsNumeric(Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)) = True Then
215: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								dblProfit = dblProfit + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)
220: End If
225: Else
230: bDemande = True
235: End If
240: End If
245: End If
250: Next 
			
			'Total des temps
255: dblTotalDessin = CDbl(m_sTempsDessin) * CDbl(m_sTauxDessin)
			
260: If m_bSansTemps = False Then
265: dblTotalFabrication = CDbl(m_sTempsFabrication) * CDbl(m_sTauxFabrication)
270: Else
275: dblTotalFabrication = 0
280: End If
			
285: dblTotalAssemblage = CDbl(m_sTempsAssemblage) * CDbl(m_sTauxAssemblage)
290: dblTotalProgInterface = CDbl(m_sTempsProgInterface) * CDbl(m_sTauxProgInterface)
295: dblTotalProgAutomate = CDbl(m_sTempsProgAutomate) * CDbl(m_sTauxProgAutomate)
300: dblTotalProgRobot = CDbl(m_sTempsProgRobot) * CDbl(m_sTauxProgRobot)
305: dblTotalVision = CDbl(m_sTempsVision) * CDbl(m_sTauxVision)
310: dblTotalTest = CDbl(m_sTempsTest) * CDbl(m_sTauxTest)
315: dblTotalInstallation = CDbl(m_sTempsInstallation) * CDbl(m_sTauxInstallation)
320: dblTotalMiseService = CDbl(m_sTempsMiseService) * CDbl(m_sTauxMiseService)
325: dblTotalFormation = CDbl(m_sTempsFormation) * CDbl(m_sTauxFormation)
330: dblTotalGestion = CDbl(m_sTempsGestion) * CDbl(m_sTauxGestion)
335: dblTotalShipping = CDbl(m_sTempsShipping) * CDbl(m_sTauxShipping)
			
340: dblTotalTemps = dblTotalDessin + dblTotalFabrication + dblTotalAssemblage + dblTotalProgInterface + dblTotalProgAutomate + dblTotalProgRobot + dblTotalVision + dblTotalTest + dblTotalInstallation + dblTotalMiseService + dblTotalFormation + dblTotalGestion + dblTotalShipping
			
345: If m_eType = enumType.TYPE_PROJET Then
350: dblHebergement = 0
355: dblRepas = 0
360: dblTransport = 0
365: dblUniteMobile = 0
370: Else
375: iNbrePersonne = Int(CDbl(m_sNbrePersonne))
				
380: Do While iNbrePersonne > 0
385: If iNbrePersonne >= 2 Then
390: dblHebergement = dblHebergement + CDbl(m_sTempsHebergement) * CDbl(m_sTauxHebergement2)
						
395: iNbrePersonne = iNbrePersonne - 2
400: Else
405: dblHebergement = dblHebergement + CDbl(m_sTempsHebergement) * CDbl(m_sTauxHebergement1)
						
410: iNbrePersonne = iNbrePersonne - 1
415: End If
420: Loop 
				
425: dblRepas = CDbl(m_sTempsRepas) * CDbl(m_sTauxRepas) * CDbl(m_sNbrePersonne)
430: dblTransport = CDbl(m_sTempsTransport) * CDbl(m_sTauxTransport)
435: dblUniteMobile = CDbl(m_sTempsUniteMobile) * CDbl(m_sTauxUniteMobile)
440: End If
			
445: If IsNumeric(m_sPrixEmballage) Then
450: dblPrixEmballage = CDbl(m_sPrixEmballage)
455: Else
460: dblPrixEmballage = 0
465: End If
			
470: dblTotalResteTemps = dblHebergement + dblRepas + dblTransport + dblUniteMobile + dblPrixEmballage
			
475: If IsNumeric(txtPrixManuel.Text) Then
480: dblTotalManuel = CDbl(txtPrixManuel.Text)
485: Else
490: dblTotalManuel = 0
495: End If
			
500: dblTotalImprevue = (dblPrixPieces + dblProfit) * CDbl(m_sImprevue)
			
505: dblPrixTotal = dblPrixPieces + dblProfit + dblTotalTemps + dblTotalImprevue + dblTotalManuel + dblTotalResteTemps
			
			'Le calcul de la commission est sur les manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps
510: dblCommission = dblPrixTotal * CDbl(m_sCommission)
			
			'Le prix total est le calcul des manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps + total de la commission
515: dblGrandTotal = dblPrixTotal + dblCommission
			
			'Format monétaires avec 2 chiffres après la virgule
520: txtTotalPieces.Text = Conversion_Renamed(CStr(System.Math.Round(dblPrixPieces, 2)), ModuleMain.enumConvert.MODE_ARGENT)
525: txtTotalTemps.Text = Conversion_Renamed(CStr(System.Math.Round(dblTotalTemps, 2)), ModuleMain.enumConvert.MODE_ARGENT)
530: txtPrixTotal.Text = Conversion_Renamed(CStr(System.Math.Round(dblGrandTotal, 2)), ModuleMain.enumConvert.MODE_ARGENT)
			
535: If bDemande = True Then
540: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_JAUNE)
545: Else
550: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_ROUGE)
555: End If
			
560: txtImprevus.Text = Conversion_Renamed(CStr(System.Math.Round(dblTotalImprevue, 2)), ModuleMain.enumConvert.MODE_ARGENT)
565: txtCommission.Text = Conversion_Renamed(CStr(System.Math.Round(dblCommission, 2)), ModuleMain.enumConvert.MODE_ARGENT)
570: txtProfit.Text = Conversion_Renamed(CStr(System.Math.Round(dblProfit, 2)), ModuleMain.enumConvert.MODE_ARGENT)
575: Else
580: For iCompteur = 1 To lvwSoumission.Items.Count
				'Si ce n'est pas une section
585: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
					'Si ce n'est pas une sous-section
590: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
595: If m_bDroitPrix = True Then
600: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString Then
605: bDemande = True
								
610: Exit For
615: End If
620: End If
625: End If
630: End If
635: Next 
			
640: If bDemande = True Then
645: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_JAUNE)
650: Else
655: txtPrixTotal.ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_ROUGE)
660: End If
665: End If
		
670: Exit Sub
		
AfficherErreur: 
		
675: Call AfficherErreur("frmProjSoumElec", "CalculerPrix", Err, Erl())
	End Sub
	
	Private Sub CalculerTempsFabricationRecordset(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjet As ADODB.Recordset
15: Dim rstPiece As ADODB.Recordset
20: Dim dblTempsFab As Double
		
		'Ouverture des tables
25: rstProjet = New ADODB.Recordset
30: rstPiece = New ADODB.Recordset
		
35: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
40: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet ='" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Pour chaque enregistrement du recordset
45: Do While Not rstPiece.EOF
			'Si le temps total n'est pas vide
50: If Trim(rstPiece.Fields("Temps_total").Value) <> vbNullString Then
				'On additionne le temps
55: dblTempsFab = dblTempsFab + CDbl(Replace(Trim(rstPiece.Fields("Temps_total").Value), ".", ","))
60: End If
			
65: Call rstPiece.MoveNext()
70: Loop 
		
75: rstProjet.Fields("TempsFabrication").Value = Replace(CStr(dblTempsFab / 10), ".", ",")
		
80: Call rstProjet.Update()
		
85: Call rstPiece.Close()
90: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiece = Nothing
		
95: Call rstProjet.Close()
100: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjet = Nothing
		
105: Exit Sub
		
AfficherErreur: 
		
110: Call AfficherErreur("frmProjSoumElec", "CalculerTempsFabricationRecordset", Err, Erl())
	End Sub
	
	Private Sub CalculerTotalRecordset(ByVal sNoProjSoum As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour calculer le prix
10: Dim rstProjSoum As ADODB.Recordset
15: Dim rstPiece As ADODB.Recordset
20: Dim rstPunch As ADODB.Recordset
25: Dim dblTotalDessin As Double
30: Dim dblTotalFabrication As Double
35: Dim dblTotalAssemblage As Double
40: Dim dblTotalProgInterface As Double
45: Dim dblTotalProgAutomate As Double
50: Dim dblTotalProgRobot As Double
55: Dim dblTotalVision As Double
60: Dim dblTotalTest As Double
65: Dim dblTotalInstallation As Double
70: Dim dblTotalMiseService As Double
75: Dim dblTotalFormation As Double
80: Dim dblTotalGestion As Double
85: Dim dblTotalShipping As Double
90: Dim dblHebergement As Double
95: Dim dblRepas As Double
100: Dim dblTransport As Double
105: Dim dblUniteMobile As Double
110: Dim dblPrixEmballage As Double
115: Dim dblTotalResteTemps As Double
120: Dim dblPrixPieces As Double
125: Dim dblPrixTotal As Double
130: Dim dblCommission As Double
135: Dim dblTotalTemps As Double
140: Dim dblProfit As Double
145: Dim dblTotalManuel As Double
150: Dim dblTotalPieceImprevue As Double
155: Dim dblGrandTotal As Double
160: Dim sDateDebut As String
165: Dim sDateFin As String
170: Dim sTotal As String
175: Dim sFilterNoProjet As String
		
180: rstProjSoum = New ADODB.Recordset
		
185: If m_eType = enumType.TYPE_PROJET Then
190: Call rstProjSoum.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
195: Else
200: Call rstProjSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoProjSoum & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
205: End If
		
210: If Not rstProjSoum.EOF Then
215: If m_eType = enumType.TYPE_PROJET Then
220: If VB.Right(sNoProjSoum, 2) = "99" Then
225: sFilterNoProjet = "LEFT(NoProjet, 6) = '" & VB.Left(sNoProjSoum, 6) & "'"
230: Else
235: sFilterNoProjet = "NoProjet = '" & sNoProjSoum & "'"
240: End If
				
245: sDateDebut = "TIMESERIAL(Left(GRB_Punch.HeureDébut,2),RIGHT(GRB_Punch.HeureDébut,2),0)"
				
250: sDateFin = "TIMESERIAL(Left(GRB_Punch.HeureFin,2),RIGHT(GRB_Punch.HeureFin,2),0)"
				
255: sTotal = "(SUM(" & sDateFin & " - " & sDateDebut & ")* 24) As Total"
				
260: rstPunch = New ADODB.Recordset
				
265: Call rstPunch.Open("SELECT Type, " & sTotal & " FROM GRB_Punch WHERE " & sFilterNoProjet & " And HeureFin is not null AND HeureDébut is not null GROUP BY Type", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
270: dblTotalDessin = 0
275: dblTotalFabrication = 0
280: dblTotalAssemblage = 0
285: dblTotalProgInterface = 0
290: dblTotalProgAutomate = 0
295: dblTotalProgRobot = 0
300: dblTotalVision = 0
305: dblTotalTest = 0
310: dblTotalInstallation = 0
315: dblTotalMiseService = 0
320: dblTotalFormation = 0
325: dblTotalGestion = 0
330: dblTotalShipping = 0
				
335: Do While Not rstPunch.EOF
340: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstPunch.Fields("Total").Value) Then
345: Select Case rstPunch.Fields("Type").Value
							Case "Dessin"
350: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
355: dblTotalDessin = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxDessin").Value)
360: Else
365: dblTotalDessin = 0
370: End If
								
375: Case "Fabrication"
380: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxFabrication").Value) Then
385: dblTotalFabrication = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxFabrication").Value)
390: Else
395: dblTotalFabrication = 0
400: End If
								
405: Case "Assemblage"
410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
415: dblTotalAssemblage = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxAssemblage").Value)
420: Else
425: dblTotalAssemblage = 0
430: End If
								
435: Case "ProgInterface"
440: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxProgInterface").Value) Then
445: dblTotalProgInterface = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxProgInterface").Value)
450: Else
455: dblTotalProgInterface = 0
460: End If
								
465: Case "ProgAutomate"
470: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxProgAutomate").Value) Then
475: dblTotalProgAutomate = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxProgAutomate").Value)
480: Else
485: dblTotalProgAutomate = 0
490: End If
								
495: Case "ProgRobot"
500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxProgRobot").Value) Then
505: dblTotalProgRobot = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxProgRobot").Value)
510: Else
515: dblTotalProgRobot = 0
520: End If
								
525: Case "Vision"
530: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxVision").Value) Then
535: dblTotalVision = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxVision").Value)
540: Else
545: dblTotalVision = 0
550: End If
								
555: Case "Test"
560: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
565: dblTotalTest = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxTest").Value)
570: Else
575: dblTotalTest = 0
580: End If
								
585: Case "Installation"
590: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
595: dblTotalInstallation = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxInstallation").Value)
600: Else
605: dblTotalInstallation = 0
610: End If
								
615: Case "MiseService"
620: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxMiseService").Value) Then
625: dblTotalMiseService = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxMiseService").Value)
630: Else
635: dblTotalMiseService = 0
640: End If
								
645: Case "Formation"
650: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
655: dblTotalFormation = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxFormation").Value)
660: Else
665: dblTotalFormation = 0
670: End If
								
675: Case "Gestion"
680: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
685: dblTotalGestion = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxGestion").Value)
690: Else
695: dblTotalGestion = 0
700: End If
								
705: Case "Shipping"
710: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
								If Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
715: dblTotalShipping = CDbl(rstPunch.Fields("Total").Value) * CDbl(rstProjSoum.Fields("TauxShipping").Value)
720: Else
725: dblTotalShipping = 0
730: End If
735: End Select
740: End If
					
745: Call rstPunch.MoveNext()
750: Loop 
				
755: Call rstPunch.Close()
760: 'UPGRADE_NOTE: Object rstPunch may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstPunch = Nothing
765: Else
770: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsDessin").Value) And Not IsDbNull(rstProjSoum.Fields("TauxDessin").Value) Then
775: dblTotalDessin = CDbl(rstProjSoum.Fields("TempsDessin").Value) * CDbl(rstProjSoum.Fields("TauxDessin").Value)
780: Else
785: dblTotalDessin = 0
790: End If
				
795: If rstProjSoum.Fields("SansTemps").Value = False Then
800: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProjSoum.Fields("TempsFabrication").Value) And Not IsDbNull(rstProjSoum.Fields("TauxFabrication").Value) Then
805: dblTotalFabrication = CDbl(rstProjSoum.Fields("TempsFabrication").Value) * CDbl(rstProjSoum.Fields("TauxFabrication").Value)
810: Else
815: dblTotalFabrication = 0
820: End If
825: Else
830: dblTotalFabrication = 0
835: End If
				
840: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsAssemblage").Value) And Not IsDbNull(rstProjSoum.Fields("TauxAssemblage").Value) Then
845: dblTotalAssemblage = CDbl(rstProjSoum.Fields("TempsAssemblage").Value) * CDbl(rstProjSoum.Fields("TauxAssemblage").Value)
850: Else
855: dblTotalAssemblage = 0
860: End If
				
865: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsProgInterface").Value) And Not IsDbNull(rstProjSoum.Fields("TauxProgInterface").Value) Then
870: dblTotalProgInterface = CDbl(rstProjSoum.Fields("TempsProgInterface").Value) * CDbl(rstProjSoum.Fields("TauxProgInterface").Value)
875: Else
880: dblTotalProgInterface = 0
885: End If
				
890: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsProgAutomate").Value) And Not IsDbNull(rstProjSoum.Fields("TauxProgAutomate").Value) Then
895: dblTotalProgAutomate = CDbl(rstProjSoum.Fields("TempsProgAutomate").Value) * CDbl(rstProjSoum.Fields("TauxProgAutomate").Value)
900: Else
905: dblTotalProgAutomate = 0
910: End If
				
915: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsProgRobot").Value) And Not IsDbNull(rstProjSoum.Fields("TauxProgRobot").Value) Then
920: dblTotalProgRobot = CDbl(rstProjSoum.Fields("TempsProgRobot").Value) * CDbl(rstProjSoum.Fields("TauxProgRobot").Value)
925: Else
930: dblTotalProgRobot = 0
935: End If
				
940: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsVision").Value) And Not IsDbNull(rstProjSoum.Fields("TauxVision").Value) Then
945: dblTotalVision = CDbl(rstProjSoum.Fields("TempsVision").Value) * CDbl(rstProjSoum.Fields("TauxVision").Value)
950: Else
955: dblTotalVision = 0
960: End If
				
965: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTest").Value) And Not IsDbNull(rstProjSoum.Fields("TauxTest").Value) Then
970: dblTotalTest = CDbl(rstProjSoum.Fields("TempsTest").Value) * CDbl(rstProjSoum.Fields("TauxTest").Value)
975: Else
980: dblTotalTest = 0
985: End If
				
990: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsInstallation").Value) And Not IsDbNull(rstProjSoum.Fields("TauxInstallation").Value) Then
995: dblTotalInstallation = CDbl(rstProjSoum.Fields("TempsInstallation").Value) * CDbl(rstProjSoum.Fields("TauxInstallation").Value)
1000: Else
1005: dblTotalInstallation = 0
1010: End If
				
1015: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsMiseService").Value) And Not IsDbNull(rstProjSoum.Fields("TauxMiseService").Value) Then
1020: dblTotalMiseService = CDbl(rstProjSoum.Fields("TempsMiseService").Value) * CDbl(rstProjSoum.Fields("TauxMiseService").Value)
1025: Else
1030: dblTotalMiseService = 0
1035: End If
				
1040: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsFormation").Value) And Not IsDbNull(rstProjSoum.Fields("TauxFormation").Value) Then
1045: dblTotalFormation = CDbl(rstProjSoum.Fields("TempsFormation").Value) * CDbl(rstProjSoum.Fields("TauxFormation").Value)
1050: Else
1055: dblTotalFormation = 0
1060: End If
				
1065: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsGestion").Value) And Not IsDbNull(rstProjSoum.Fields("TauxGestion").Value) Then
1070: dblTotalGestion = CDbl(rstProjSoum.Fields("TempsGestion").Value) * CDbl(rstProjSoum.Fields("TauxGestion").Value)
1075: Else
1080: dblTotalGestion = 0
1085: End If
				
1090: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsShipping").Value) And Not IsDbNull(rstProjSoum.Fields("TauxShipping").Value) Then
1095: dblTotalShipping = CDbl(rstProjSoum.Fields("TempsShipping").Value) * CDbl(rstProjSoum.Fields("TauxShipping").Value)
1100: Else
1105: dblTotalShipping = 0
1110: End If
1115: End If
			
1120: dblTotalTemps = dblTotalDessin + dblTotalFabrication + dblTotalAssemblage + dblTotalProgInterface + dblTotalProgAutomate + dblTotalProgRobot + dblTotalVision + dblTotalTest + dblTotalInstallation + dblTotalMiseService + dblTotalFormation + dblTotalGestion + dblTotalShipping
			
1125: rstPiece = New ADODB.Recordset
			
1130: If m_eType = enumType.TYPE_PROJET Then
1135: Call rstPiece.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoProjSoum & "' AND Type = 'E'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
1140: Else
1145: Call rstPiece.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoProjSoum & "' AND Type = 'E'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
1150: End If
			
			'Pour chaque élément du recordset
1155: Do While Not rstPiece.EOF
1160: If Trim(rstPiece.Fields("Prix_total").Value) <> vbNullString Then
					'On additionne le prix total
1165: dblPrixPieces = dblPrixPieces + CDbl(rstPiece.Fields("Prix_total").Value) - CDbl(rstPiece.Fields("Profit_Argent").Value)
					
					'On additionne le profit
1170: dblProfit = dblProfit + CDbl(rstPiece.Fields("Profit_Argent").Value)
1175: End If
				
1180: Call rstPiece.MoveNext()
1185: Loop 
			
1190: Call rstPiece.Close()
1195: 'UPGRADE_NOTE: Object rstPiece may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstPiece = Nothing
			
1200: If m_eType = enumType.TYPE_PROJET Then
1205: dblHebergement = 0
1210: dblRepas = 0
1215: dblTransport = 0
1220: dblUniteMobile = 0
1225: Else
1230: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TotalHebergement").Value) Then
1235: dblHebergement = CDbl(rstProjSoum.Fields("TotalHebergement").Value)
1240: Else
1245: dblHebergement = 0
1250: End If
				
1255: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TotalRepas").Value) Then
1260: dblRepas = CDbl(rstProjSoum.Fields("TotalRepas").Value)
1265: Else
1270: dblRepas = 0
1275: End If
				
1280: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsTransport").Value) Then
1285: dblTransport = CDbl(rstProjSoum.Fields("TempsTransport").Value) * CDbl(rstProjSoum.Fields("TauxTransport").Value)
1290: Else
1295: dblTransport = 0
1300: End If
				
1305: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProjSoum.Fields("TempsUniteMobile").Value) Then
1310: dblUniteMobile = CDbl(rstProjSoum.Fields("TempsUniteMobile").Value) * CDbl(rstProjSoum.Fields("TauxUniteMobile").Value)
1315: Else
1320: dblUniteMobile = 0
1325: End If
1330: End If
			
1335: If IsNumeric(rstProjSoum.Fields("PrixEmballage").Value) Then
1340: dblPrixEmballage = CDbl(rstProjSoum.Fields("PrixEmballage").Value)
1345: Else
1350: dblPrixEmballage = 0
1355: End If
			
1360: dblTotalResteTemps = dblHebergement + dblRepas + dblTransport + dblUniteMobile + dblPrixEmballage
			
1365: If IsNumeric(rstProjSoum.Fields("total_manuel").Value) Then
1370: dblTotalManuel = CDbl(rstProjSoum.Fields("total_manuel").Value)
1375: Else
1380: dblTotalManuel = 0
1385: End If
			
1390: dblTotalPieceImprevue = (dblPrixPieces + dblProfit) * (1 + CDbl(rstProjSoum.Fields("Imprevue").Value))
			
1395: dblPrixTotal = dblTotalTemps + dblTotalManuel + dblTotalPieceImprevue + dblTotalResteTemps
			
			'Le calcul de la commission est sur les manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps
1400: dblCommission = dblPrixTotal * CDbl(rstProjSoum.Fields("Commission").Value)
			
			'Le prix total est le calcul des manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps + total de la commission
1405: dblGrandTotal = dblPrixTotal + dblCommission
			
			'Format monétaire avec 2 chiffres après la virgule
1410: rstProjSoum.Fields("total_commission").Value = dblCommission
1415: rstProjSoum.Fields("Total_manuel").Value = dblTotalManuel
1420: rstProjSoum.Fields("Total_temps").Value = dblTotalTemps
1425: rstProjSoum.Fields("total_imprevue").Value = dblTotalPieceImprevue - (dblPrixPieces + dblProfit)
1430: rstProjSoum.Fields("total_piece").Value = dblPrixPieces
1435: rstProjSoum.Fields("Total_Commission").Value = Conversion_Renamed(CStr(System.Math.Round(dblCommission, 2)), ModuleMain.enumConvert.MODE_ARGENT)
1440: rstProjSoum.Fields("PrixTotal").Value = Conversion_Renamed(CStr(System.Math.Round(dblGrandTotal, 2)), ModuleMain.enumConvert.MODE_ARGENT)
1445: rstProjSoum.Fields("Total_Profit").Value = Conversion_Renamed(CStr(System.Math.Round(dblProfit, 2)), ModuleMain.enumConvert.MODE_ARGENT)
			
1450: Call rstProjSoum.Update()
1455: Else
1460: If m_eType = enumType.TYPE_PROJET Then
1465: Call MsgBox("Le projet " & sNoProjSoum & " est inexistant!", MsgBoxStyle.OKOnly, "Erreur")
1470: Else
1475: Call MsgBox("La soumission " & sNoProjSoum & " est inexistant!", MsgBoxStyle.OKOnly, "Erreur")
1480: End If
1485: End If
		
1490: Call rstProjSoum.Close()
1495: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
1500: Exit Sub
		
AfficherErreur: 
		
1505: Call AfficherErreur("frmProjSoumElec", "CalculerTotalRecordset", Err, Erl(), sNoProjSoum)
	End Sub
	
	Private Sub CalculerPrixFacturation(ByVal sNoFacturation As String, ByRef sCommission As String, ByRef sPrixTotal As String, ByRef sProfit As String, ByRef sTempsFabrication As String, ByRef sTotalPiece As String, ByRef sImprevue As String, ByRef sTotalTemps As String, ByRef sManuel As String)
		
5: On Error GoTo AfficherErreur
		
		'Méthode pour calculer le prix
10: Dim iCompteur As Short
15: Dim dblTotalDessin As Double
20: Dim dblTotalFabrication As Double
25: Dim dblTotalAssemblage As Double
30: Dim dblTotalProgInterface As Double
35: Dim dblTotalProgAutomate As Double
40: Dim dblTotalProgRobot As Double
45: Dim dblTotalVision As Double
50: Dim dblTotalTest As Double
55: Dim dblTotalInstallation As Double
60: Dim dblTotalMiseService As Double
65: Dim dblTotalFormation As Double
70: Dim dblTotalGestion As Double
75: Dim dblTotalShipping As Double
80: Dim dblPrixPieces As Double
85: Dim dblPrixTotal As Double
90: Dim dblCommission As Double
95: Dim dblTotalTemps As Double
100: Dim dblProfit As Double
105: Dim dblTotalManuel As Double
110: Dim dblTotalPieceImprevue As Double
115: Dim dblGrandTotal As Double
120: Dim dblTempsFabrication As Double
		
125: dblTotalDessin = CDbl(m_sTempsDessin) * CDbl(m_sTauxDessin)
		
130: If m_bSansTemps = False Then
135: dblTotalFabrication = CDbl(m_sTempsFabrication) * CDbl(m_sTauxFabrication)
140: Else
145: dblTotalFabrication = 0
150: End If
		
155: dblTotalAssemblage = CDbl(m_sTempsAssemblage) * CDbl(m_sTauxAssemblage)
160: dblTotalProgInterface = CDbl(m_sTempsProgInterface) * CDbl(m_sTauxProgInterface)
165: dblTotalProgAutomate = CDbl(m_sTempsProgAutomate) * CDbl(m_sTauxProgAutomate)
170: dblTotalProgRobot = CDbl(m_sTempsProgRobot) * CDbl(m_sTauxProgRobot)
175: dblTotalVision = CDbl(m_sTempsVision) * CDbl(m_sTauxVision)
180: dblTotalTest = CDbl(m_sTempsTest) * CDbl(m_sTauxTest)
185: dblTotalInstallation = CDbl(m_sTempsInstallation) * CDbl(m_sTauxInstallation)
190: dblTotalMiseService = CDbl(m_sTempsMiseService) * CDbl(m_sTauxMiseService)
195: dblTotalFormation = CDbl(m_sTempsFormation) * CDbl(m_sTauxFormation)
200: dblTotalGestion = CDbl(m_sTempsGestion) * CDbl(m_sTauxGestion)
205: dblTotalShipping = CDbl(m_sTempsShipping) * CDbl(m_sTauxShipping)
		
210: dblTotalTemps = dblTotalDessin + dblTotalFabrication + dblTotalAssemblage + dblTotalProgInterface + dblTotalProgAutomate + dblTotalProgRobot + dblTotalVision + dblTotalTest + dblTotalInstallation + dblTotalMiseService + dblTotalFormation + dblTotalGestion + dblTotalShipping
		
		
		'Pour chaque élément du listview
215: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si ce n'est pas une section
220: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
				'Si ce n'est pas une sous-section
225: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
230: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = sNoFacturation Then
235: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_TOTAL).Text) <> vbNullString Then
							'On additionne le prix total
240: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							dblPrixPieces = dblPrixPieces + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_TOTAL).Text)
							
							'On additionne le profit
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							dblProfit = dblProfit + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text)
							
							'Calcul des heures de fabrication
250: If m_bSansTemps = False Then
255: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_MONTAGE).Text) <> vbNullString Then
260: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									dblTempsFabrication = dblTempsFabrication + CDbl(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_MONTAGE).Text)
265: End If
270: End If
275: End If
280: End If
285: End If
290: End If
295: Next 
		
300: If IsNumeric(txtPrixManuel.Text) Then
305: dblTotalManuel = CDbl(txtPrixManuel.Text)
310: Else
315: dblTotalManuel = 0
320: End If
		
325: dblTotalPieceImprevue = dblPrixPieces * (1 + CDbl(m_sImprevue))
		
330: dblPrixTotal = dblTotalTemps + dblTotalManuel + dblTotalPieceImprevue
		
		'Le calcul de la commission est sur les manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps
335: dblCommission = dblPrixTotal * CDbl(m_sCommission)
		
		'Le prix total est le calcul des manuels (Nbre de page * prix par pages * nbre de copies) + (prix des pièces * pourcentage d'imprévus) + total des temps + total de la commission
340: dblGrandTotal = dblPrixTotal + dblCommission
		
		'Format monétaires avec 2 chiffres après la virgule
345: sCommission = Conversion_Renamed(CStr(System.Math.Round(dblCommission, 2)), ModuleMain.enumConvert.MODE_ARGENT)
350: sPrixTotal = Conversion_Renamed(CStr(System.Math.Round(dblGrandTotal, 2)), ModuleMain.enumConvert.MODE_ARGENT)
355: sProfit = Conversion_Renamed(CStr(System.Math.Round(dblProfit, 2)), ModuleMain.enumConvert.MODE_ARGENT)
360: sTempsFabrication = CStr(dblTempsFabrication)
365: sImprevue = Conversion_Renamed(CStr(System.Math.Round(dblPrixPieces * CDbl(m_sImprevue), 2)), ModuleMain.enumConvert.MODE_ARGENT)
370: sManuel = Conversion_Renamed(CStr(System.Math.Round(dblTotalManuel, 2)), ModuleMain.enumConvert.MODE_ARGENT)
375: sTotalPiece = Conversion_Renamed(CStr(System.Math.Round(dblPrixPieces, 2)), ModuleMain.enumConvert.MODE_ARGENT)
380: sTotalTemps = Conversion_Renamed(CStr(System.Math.Round(dblTotalTemps, 2)), ModuleMain.enumConvert.MODE_ARGENT)
		
385: Exit Sub
		
AfficherErreur: 
		
390: Call AfficherErreur("frmProjSoumElec", "CalculerPrix", Err, Erl())
	End Sub
	
	Private Sub ChoisirFournisseur()
		
5: On Error GoTo AfficherErreur
		
		'On ajoute la pièce dans lvwSoumission
10: Dim sQuantite As String
15: Dim sSousSection As String
20: Dim bDemanderSS As Boolean
25: Dim sParams As String
		
		'Si l'utilisateur a déjà choisi un emplacement, il ne faut pas
		'lui demander dans quelle sous-section
		
		'Si il y a des enregistrements dans le listview
30: If lvwSoumission.Items.Count > 0 Then
			'Si le premier n'est pas sélectionné.. celui-ci est sélectionné par défaut
35: If lvwSoumission.FocusedItem.Index > 1 Then
				'Si l'emplacement est valide
40: If VerifierEmplacement(lvwSoumission.FocusedItem.Index) = True Then
					'Si c'est une sous-section
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).Tag = vbNullString Then
						'Si l'autre d'au dessus est une section
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).Tag = vbNullString Then
							'Message d'erreur
55: Call MsgBox("Vous ne pouvez pas mettre une pièce entre une section et une sous-section", MsgBoxStyle.OKOnly, "Erreur")
							
60: frafournisseur.Visible = False
							
							'Il faut resélectionné le premier pour faire comme s'il n'était plus
							'sélectionné
65: Call Deselect()
							
70: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							lvwSoumission.Items.Item(1).Selected = True
							
75: Exit Sub
80: Else
							'Sinon, on prend le tag de la section d'en haut
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
							sSousSection = lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_PIECE).Tag
90: End If
95: Else
						'On prend le tag de l'élément sélectionné
100: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.SelectedItem.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
						sSousSection = lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).Tag
105: End If
110: Else
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag <> "" Then
120: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If MsgBox("Vous essayez d'ajouter une pièce de la section " & cmbSections.Text & " dans la section " & VB6.GetItemString(cmbSections, lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag - 1) & vbNewLine & "Voulez-vous ajouter la pièce dans la section " & VB6.GetItemString(cmbSections, lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag - 1), MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							cmbSections.SelectedIndex = lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag - 1
							
130: Call ChoisirFournisseur()
135: End If
						
140: frafournisseur.Visible = False
						
						'Il faut resélectionné le premier pour faire comme si il n'était plus
						'sélectionné
145: Call Deselect()
						
150: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.Items.Item(1).Selected = True
						
155: Exit Sub
160: Else
165: Call MsgBox("Impossible d'ajouter entre une section et une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
						
170: Exit Sub
175: End If
180: End If
185: Else
190: bDemanderSS = True
195: End If
200: Else
			'Sinon, on demande la section
205: bDemanderSS = True
210: End If
		
		'Saisie de la quantité
215: sQuantite = InputBox("Quelle est la quantité?")
		
220: sQuantite = Replace(sQuantite, ".", ",")
		
225: If sQuantite <> vbNullString Then
230: If Not IsNumeric(sQuantite) Then
235: Call MsgBox("Quantité non numérique!", MsgBoxStyle.OKOnly, "Erreur")
				
240: Exit Sub
245: Else
250: If CDbl(sQuantite) < 0 Then
255: If lvwfournisseur.FocusedItem.Text = "CHOISIR ULTÉRIEUREMENT" Then
260: Call MsgBox("Impossible de faire une demande de prix sur une pièce négative!", MsgBoxStyle.OKOnly, "Erreur")
						
265: Exit Sub
270: End If
275: End If
280: End If
285: Else
290: Exit Sub
295: End If
		
300: If bDemanderSS = True Then
305: If m_sSousSection <> S_PAS_SOUS_SECTION Then
310: sSousSection = InputBox("Quelle est la sous-section?",  , m_sSousSection)
315: Else
320: sSousSection = InputBox("Quelle est la sous-section?")
325: End If
330: End If
		
		'Si la sous-section est vide
335: If sSousSection = vbNullString Then
			'On initialise la sous-section à "PAS DE SOUS-SECTIONS"
340: sSousSection = S_PAS_SOUS_SECTION
345: m_sSousSection = vbNullString
350: Else
355: m_sSousSection = sSousSection
360: End If
		
365: If CDbl(sQuantite) < 0 Then
370: If m_eType = enumType.TYPE_PROJET Then
375: If CDbl(VB.Right(txtNoProjSoum.Text, 2)) >= 60 And CDbl(VB.Right(txtNoProjSoum.Text, 2)) <= 98 Then
380: Call AjouterNegatifDansListView(CDbl(sQuantite), sSousSection)
385: Else
390: Call AjouterDansListViewSoumission(CDbl(sQuantite), sSousSection)
395: End If
400: Else
405: Call AjouterDansListViewSoumission(CDbl(sQuantite), sSousSection)
410: End If
415: Else
420: Call AjouterDansListViewSoumission(CDbl(sQuantite), sSousSection)
425: End If
		
		'Calcul des prix
430: Call CalculerPrix()
		
		'On cache le listview
435: frafournisseur.Visible = False
		
		'Resélectionne le premier élément du listview
440: If lvwSoumission.Items.Count > 0 Then
445: Call Deselect()
			
450: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lvwSoumission.Items.Item(1).Selected = True
455: End If
		
460: Exit Sub
		
AfficherErreur: 
		
465: If Err.Number = 13 And Erl() = 110 Then
470: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			sParams = "cmbSections.Text : " & cmbSections.Text & "   " & "No Proj/Soum : " & txtNoProjSoum.Text & "   " & "lvwSoumission.SelectedItem.Index - 1 : " & lvwSoumission.FocusedItem.Index - 1 & "   " & "lvwSoumission.ListItems(lvwSoumission.SelectedItem.Index - 1).ListSubItems(I_COL_SOUM_MANUFACT).Tag : " & lvwSoumission.Items.Item(lvwSoumission.FocusedItem.Index - 1).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
			
475: Call AfficherErreur("frmProjSoumElec", "ChoisirFournisseur", Err, Erl(), sParams)
480: Else
485: Call AfficherErreur("frmProjSoumElec", "ChoisirFournisseur", Err, Erl())
490: End If
	End Sub
	
	Private Sub ChoisirFournisseurMateriel()
		
5: On Error GoTo AfficherErreur
		
		'On ajoute la pièce en négatif dans le ListView
10: Dim rstProjet As ADODB.Recordset
15: Dim rstConfig As ADODB.Recordset
20: Dim itmAncien As System.Windows.Forms.ListViewItem
25: Dim itmNouveau As System.Windows.Forms.ListViewItem
30: Dim sQuantite As String
35: Dim sExtra As String
40: Dim sTauxUSA As String
45: Dim sTauxSPA As String
		
50: If m_bChangementFRS = True Then
55: If lvwfournisseur.FocusedItem.Text <> "CHOISIR ULTÉRIEUREMENT" Then
60: rstConfig = New ADODB.Recordset
				
65: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
				
70: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
75: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
				
80: Call rstConfig.Close()
85: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstConfig = Nothing
				
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DISTRIB Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DISTRIB).Text = lvwfournisseur.FocusedItem.Text
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwfournisseur.FocusedItem.Text))
				End If
95: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
				
100: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) <> COLOR_BRUN Then
					'Prix listé
105: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) = vbNullString Then
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
115: Else
120: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
125: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
130: Else
135: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
140: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
145: Else
150: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_LIST).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
155: End If
160: End If
165: End If
					
170: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PRIX_LIST).Tag
					
					'Si il y a un prix net, on le met l'escompte et le prix net sinon, on prend le prix
					'spécial pour mettre dans le prix net
175: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) <> vbNullString Then
180: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
							lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)
						Else
							lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_ESCOMPTE).Text, ModuleMain.enumConvert.MODE_POURCENT)))
						End If
						
185: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
195: Else
200: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
205: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
210: Else
215: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_NET).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
220: End If
225: End If
230: Else
235: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If Trim(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) <> vbNullString Then
240: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "USA" Then
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
250: Else
255: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag = "SPA" Then
260: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
265: Else
270: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
										lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
									Else
										lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(lvwfournisseur.FocusedItem.SubItems(I_COL_FRS_PRIX_SP).Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
									End If
275: End If
280: End If
285: Else
290: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
							End If
295: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
300: End If
305: End If
					
310: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_TOTAL Then
						lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
					Else
						lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
					End If
					
315: 'UPGRADE_WARNING: Lower bound of collection lvwfournisseur.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TOTAL).Tag = lvwfournisseur.FocusedItem.SubItems.Item(I_COL_FRS_PERS_RESS).Tag
					
					'Pour le profit, c'est le prix total - (prix net * quantité)
320: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PROFIT Then
						lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
325: End If
330: Else
335: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_DISTRIB Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_DISTRIB).Text = vbNullString
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
340: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(0)
				
345: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)))
				End If
350: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
				End If
355: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_ARGENT, 2)))
				End If
				
360: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_TOTAL Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) * CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT, 2)))
				End If
				
365: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_PROFIT Then
					lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
				
370: If m_eType = enumType.TYPE_PROJET Then
375: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_COMMENTAIRE).Text <> "" Then
380: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
385: End If
					
390: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_FACTURATION).Text <> "" Then
395: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_FACTURATION).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
400: End If
					
405: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ID).Text <> "" Then
410: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_ID).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
415: End If
420: End If
				
425: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
430: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
435: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
440: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
445: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
450: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
455: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
460: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
465: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
470: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_MAGENTA)
				
475: Call lvwSoumission.Refresh()
480: End If
			
485: Call CalculerPrix()
			
			'On cache le listview
490: frafournisseur.Visible = False
			
495: m_bPieceInutile = False
500: m_bChangementFRS = False
505: Else
510: If VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
515: sExtra = InputBox("Dans quel extra le retour doit être fait ? (2 chiffres seulement)")
				
520: If Len(sExtra) <> 2 Then
525: Call MsgBox("Format incorrect!", MsgBoxStyle.OKOnly, "Erreur")
					
530: Exit Sub
535: End If
				
540: If Not IsNumeric(sExtra) Then
545: Call MsgBox("L'extra doit être numérique!", MsgBoxStyle.OKOnly, "Erreur")
					
550: Exit Sub
555: End If
				
560: If CDbl(sExtra) < 60 Or CDbl(sExtra) > 98 Then
565: Call MsgBox("L'extra doit être entre 60 et 98!", MsgBoxStyle.OKOnly, "Erreur")
					
570: Exit Sub
575: End If
				
580: rstProjet = New ADODB.Recordset
				
585: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
				
590: If rstProjet.EOF Then
595: Call MsgBox("Le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & " n'existe pas!", MsgBoxStyle.OKOnly, "Erreur")
					
600: Call rstProjet.Close()
605: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjet = Nothing
					
610: Exit Sub
615: Else
620: Call rstProjet.Close()
625: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
					rstProjet = Nothing
630: End If
635: End If
			
			'Saisie de la quantité
640: sQuantite = InputBox("Quelle est la quantité?")
			
645: sQuantite = Replace(sQuantite, ".", ",")
			
650: sQuantite = Replace(sQuantite, "-", "")
			
655: If sQuantite <> vbNullString Then
660: If Not IsNumeric(sQuantite) Then
665: Call MsgBox("Quantité non numérique!", MsgBoxStyle.OKOnly, "Erreur")
					
670: Exit Sub
675: End If
680: Else
685: Exit Sub
690: End If
			
695: If CDbl(sQuantite) <= CDbl(Replace(lvwSoumission.FocusedItem.Text, "*", vbNullString)) Then
700: itmAncien = lvwSoumission.FocusedItem
705: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau = lvwSoumission.Items.Insert(itmAncien.Index + 1, "")
				
710: itmNouveau.Checked = itmAncien.Checked
				
				'Quantité
715: itmNouveau.Text = "-" & sQuantite
				
				'On met l'id de la section dans le tag du listItem
720: itmNouveau.Tag = itmAncien.Tag
				
				'No d'item
725: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PIECE Then
					itmNouveau.SubItems(I_COL_SOUM_PIECE).Text = itmAncien.SubItems(I_COL_SOUM_PIECE).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_PIECE).Text))
				End If
				
				'On met le nom de la sous-section dans le tag du no d'item
730: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAncien.SubItems.Item(I_COL_SOUM_PIECE).Tag
				
				'On met la description en francais dans la colonne et la description en anglais
				'dans le tag
735: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DESCR Then
					itmNouveau.SubItems(I_COL_SOUM_DESCR).Text = itmAncien.SubItems(I_COL_SOUM_DESCR).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_DESCR).Text))
				End If
740: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAncien.SubItems.Item(I_COL_SOUM_DESCR).Tag
				
				'On met le nom du fabricant dans la colonne et l'ordre de la section dans le tag
745: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_MANUFACT Then
					itmNouveau.SubItems(I_COL_SOUM_MANUFACT).Text = itmAncien.SubItems(I_COL_SOUM_MANUFACT).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_MANUFACT).Text))
				End If
750: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAncien.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
				
				'Prix listé
755: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
					itmNouveau.SubItems(I_COL_SOUM_PRIX_LIST).Text = itmAncien.SubItems(I_COL_SOUM_PRIX_LIST).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_PRIX_LIST).Text))
				End If
				
760: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = itmAncien.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
				
765: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmNouveau.SubItems(I_COL_SOUM_ESCOMPTE).Text = itmAncien.SubItems(I_COL_SOUM_ESCOMPTE).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_ESCOMPTE).Text))
				End If
				
770: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PRIX_NET Then
					itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text = itmAncien.SubItems(I_COL_SOUM_PRIX_NET).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_PRIX_NET).Text))
				End If
				
				'On met le fournisseur dans la colonne et l'id dans le tag
775: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DISTRIB Then
					itmNouveau.SubItems(I_COL_SOUM_DISTRIB).Text = lvwfournisseur.FocusedItem.Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, lvwfournisseur.FocusedItem.Text))
				End If
780: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmNouveau.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = lvwfournisseur.FocusedItem.Tag
				
				'Temps
785: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAncien has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_TEMPS Then
					itmNouveau.SubItems(I_COL_SOUM_TEMPS).Text = itmAncien.SubItems(I_COL_SOUM_TEMPS).Text
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAncien.SubItems(I_COL_SOUM_TEMPS).Text))
				End If
				
				'Si le temps n'est pas vide
790: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If Trim(itmNouveau.SubItems(I_COL_SOUM_TEMPS).Text) <> vbNullString Then
					'On calcul le temps * quantité pour la colonne montage
795: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmNouveau.SubItems.Count > I_COL_SOUM_MONTAGE Then
						itmNouveau.SubItems(I_COL_SOUM_MONTAGE).Text = CStr(CDbl(Replace(itmNouveau.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmNouveau.Text, "*", vbNullString)))
					Else
						itmNouveau.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(CDbl(Replace(itmNouveau.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmNouveau.Text, "*", vbNullString)))))
					End If
800: Else
805: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmNouveau.SubItems.Count > I_COL_SOUM_MONTAGE Then
						itmNouveau.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
					Else
						itmNouveau.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
					End If
810: End If
				
				'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
815: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_TOTAL Then
					itmNouveau.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(System.Math.Round(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(m_sProfit), 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
				
				'Pour le profit, c'est le prix total - (prix net * quantité)
820: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_PROFIT Then
					itmNouveau.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(System.Math.Round(CDbl(itmNouveau.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text))), 2), ModuleMain.enumConvert.MODE_ARGENT)
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(System.Math.Round(CDbl(itmNouveau.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(CDbl(Replace(itmNouveau.Text, "*", "")) * CDbl(itmNouveau.SubItems(I_COL_SOUM_PRIX_NET).Text))), 2), ModuleMain.enumConvert.MODE_ARGENT)))
				End If
				
825: If VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
					'Pour savoir lors de l'enregistrement qu'il faut le lier avec un extra
830: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PROFIT).Tag = "RETOUR " & sExtra
835: End If
				
840: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
					itmNouveau.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
845: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
					itmNouveau.SubItems(I_COL_SOUM_DATE_REQUISE).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
850: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
					itmNouveau.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
855: 'UPGRADE_WARNING: Lower bound of collection itmNouveau has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmNouveau.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
					itmNouveau.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = " "
				Else
					itmNouveau.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
				End If
				
860: 'UPGRADE_WARNING: Lower bound of collection itmAncien.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(itmAncien.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Then
865: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
870: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
875: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
880: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
885: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
890: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_ID).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
895: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
900: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
905: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
910: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
915: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
920: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
925: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
930: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
935: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
940: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
945: Else
950: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
955: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
960: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
965: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
970: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
975: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_ID).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
980: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
985: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
990: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
995: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
1000: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
1005: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
1010: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
1015: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
1020: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
1025: 'UPGRADE_WARNING: Lower bound of collection itmNouveau.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmNouveau.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_BRUN)
1030: End If
				
1035: Call CalculerTempsFabrication()
				
				'Calcul des prix
1040: Call CalculerPrix()
				
				'On cache le ListView
1045: frafournisseur.Visible = False
				
1050: m_bPieceInutile = False
				
				'Resélectionne le premier élément du listview
1055: If lvwSoumission.Items.Count > 0 Then
1060: Call Deselect()
					
1065: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.Items.Item(1).Selected = True
1070: End If
1075: Else
1080: Call MsgBox("Quantité trop grande!", MsgBoxStyle.OKOnly, "Erreur")
1085: End If
1090: End If
		
1095: Exit Sub
		
AfficherErreur: 
		
1100: Call AfficherErreur("frmProjSoumElec", "ChoisirFournisseurMateriel", Err, Erl())
	End Sub
	
	Private Sub lvwFournisseur_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwFournisseur.DoubleClick
		
5: On Error GoTo AfficherErreur
		
10: If m_bPieceInutile = True Or m_bChangementFRS = True Then
15: Call ChoisirFournisseurMateriel()
20: Else
25: Call ChoisirFournisseur()
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "lvwFournisseur_DblClick", Err, Erl())
	End Sub
	
	Private Sub lvwPieces_DoubleClick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles lvwPieces.DoubleClick
		
5: On Error GoTo AfficherErreur
		
10: m_bPieceInutile = False
15: m_bRecherchePiece = False
20: m_bChangementFRS = False
		'On affiche lvwFournisseur selon la pièce choisie
		'Rempli les fournisseurs de la pièce choisie
25: Call AfficherListeFournisseurs()
		
		'si le listview n'est pas vide
30: If lvwfournisseur.Items.Count = 1 Then
35: If MsgBox("Il n'y a aucun fournisseur pour cette pièce!" & vbNewLine & "Voulez-vous en ajouter?", MsgBoxStyle.YesNo, "Erreur") = MsgBoxResult.Yes Then
40: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
				
				'On ouvre le catalogue sur cet enregistrement
45: 'UPGRADE_WARNING: Lower bound of collection lvwPieces.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				Call FrmCatalogueElec.AfficherForm(cmbPieces.Text, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_MANUFACT).Text, lvwPieces.FocusedItem.SubItems(I_COL_PIECES_NO_ITEM).Text)
				
50: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
55: End If
60: End If
		
65: Exit Sub
		
AfficherErreur: 
		
70: Call AfficherErreur("frmProjSoumElec", "lvwPieces_DblClick", Err, Erl())
	End Sub
	
	Private Sub AfficherListeFournisseurs()
		
5: On Error GoTo AfficherErreur
		
		'Méthode qui sert à afficher la liste des fournisseurs
		'Affiche le frame seulement s'il y a des items dans le ListView
10: Call RemplirListViewFournisseur()
		
15: If lvwfournisseur.Items.Count > 1 Then
20: If m_bRecherchePiece = True Then
25: fraPieceTrouve.Visible = False
30: End If
			
35: frafournisseur.Visible = True
40: Call lvwfournisseur.Focus()
45: End If
		
50: Exit Sub
		
AfficherErreur: 
		
55: Call AfficherErreur("frmProjSoumElec", "AfficherListeFournisseurs", Err, Erl())
	End Sub
	
	Private Sub lvwSoumission_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles lvwSoumission.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
		'Si le ListView n'est pas vide
10: If lvwSoumission.Items.Count > 0 Then
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If System.Drawing.ColorTranslator.ToOle(lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = -2147483640 Then
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.Color.Black
25: End If
			
30: If Shift = VB6.ShiftConstants.CtrlMask Then
35: If KeyCode = System.Windows.Forms.Keys.F Then
40: m_sTexteRecherche = InputBox("Quel est la pièce à rechercher?")
					
45: If Trim(m_sTexteRecherche) <> vbNullString Then
50: Call RechercherPieceListViewSoumission(m_sTexteRecherche)
55: End If
60: Else
65: If KeyCode = System.Windows.Forms.Keys.N Then
70: If Trim(m_sTexteRecherche) <> "" Then
75: Call RechercherPieceListViewSoumission(m_sTexteRecherche)
80: End If
85: Else
						'S'il n'est pas en mode affichage
90: If m_bModeAffichage = False Then
							'Si ce n'est pas une sous-section
95: If KeyCode = System.Windows.Forms.Keys.C Then
100: Call CopierPiece()
105: Else
110: If KeyCode = System.Windows.Forms.Keys.V Then
115: Call CollerPiece()
120: End If
125: End If
130: End If
135: End If
140: End If
145: Else
				'S'il n'est pas en mode affichage
150: If m_bModeAffichage = False Then
					'Si ce n'est pas une section
155: If lvwSoumission.FocusedItem.Tag <> vbNullString Then
						'Si ce n'est pas une sous-section
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
							'Si la touche pesée est Delete
165: If KeyCode = System.Windows.Forms.Keys.Delete Then
170: Call EffacerItemListViewSoumission()
175: Else
180: If KeyCode = System.Windows.Forms.Keys.Return Or KeyCode = System.Windows.Forms.Keys.N Then
185: If m_eType = enumType.TYPE_PROJET Then
190: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
195: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
200: If KeyCode = System.Windows.Forms.Keys.Return Then
205: Call FacturerDate()
210: Else
215: Call FacturerNC()
220: End If
225: Else
230: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
235: End If
240: End If
245: End If
250: Else
255: If KeyCode = System.Windows.Forms.Keys.I Then
260: If m_eType = enumType.TYPE_PROJET Then
265: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If lvwSoumission.FocusedItem.SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
270: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												If lvwSoumission.FocusedItem.SubItems.Count > I_COL_SOUM_ID Then
													lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ID).Text = InputBox("Quel est l'ID",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ID).Text)
												Else
													lvwSoumission.FocusedItem.SubItems.Insert(I_COL_SOUM_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, InputBox("Quel est l'ID",  , lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_ID).Text)))
												End If
275: Else
280: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												Call MsgBox("Cette commande doit être faite dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
285: End If
290: End If
295: End If
300: End If
305: End If
310: End If
315: End If
320: End If
325: End If
330: End If
		
335: Exit Sub
		
AfficherErreur: 
		
340: Call AfficherErreur("frmProjSoumElec", "lvwSoumission_KeyDown", Err, Erl())
	End Sub
	
	Private Sub FacturerDate()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si c'est pas une section
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> "" Then
				'Si c'est pas une sous-section
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "" Then
					'Si la pièce est sélectionnée
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
						'Si il y a une date d'écrit
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If VB.Left(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text, 2) = "F-" Then
							'On l'enlève
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
								lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = ""
							Else
								lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
45: Else
							'Si il n'y a rien
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text) = "" Then
								'On ajoute la date de facturation
55: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
									lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = "F-" & txtDateFacturation.Text
								Else
									lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "F-" & txtDateFacturation.Text))
								End If
60: End If
65: End If
70: End If
75: End If
80: End If
85: Next 
		
90: Exit Sub
		
AfficherErreur: 
		
95: Call AfficherErreur("frmProjSoumElec", "FacturerDate", Err, Erl())
	End Sub
	
	Private Sub FacturerNC()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: For iCompteur = 1 To lvwSoumission.Items.Count
			'Si c'est pas une section
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Tag <> "" Then
				'Si c'est pas une sous-section
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> "" Then
					'Si la pièce est sélectionnée
30: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
						'Si il y a NC d'écrit
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = "NC" Then
							'On l'enlève
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
								lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = ""
							Else
								lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, ""))
							End If
45: Else
							'Si il n'y a rien
50: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If Trim(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text) = "" Then
								'On ajoute la date de facturation
55: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_FACTURATION Then
									lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_FACTURATION).Text = "NC"
								Else
									lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "NC"))
								End If
60: End If
65: End If
70: End If
75: End If
80: End If
85: Next 
		
90: Exit Sub
		
AfficherErreur: 
		
95: Call AfficherErreur("frmProjSoumElec", "FacturerNC", Err, Erl())
	End Sub
	
	Private Sub RechercherPieceListViewSoumission(ByVal sTexte As String)
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
15: Dim iSelected As Short
20: Dim bTrouve As Boolean
		
25: If lvwSoumission.FocusedItem.Index = 1 Then
30: iSelected = 1
35: Else
40: If lvwSoumission.FocusedItem.Index + 1 > lvwSoumission.Items.Count Then
45: iSelected = 1
50: Else
55: iSelected = lvwSoumission.FocusedItem.Index + 1
60: End If
65: End If
		
70: For iCompteur = iSelected To lvwSoumission.Items.Count
75: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If InStr(1, UCase(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text), UCase(sTexte)) > 0 Then
80: Call lvwSoumission.Focus()
				
85: Call Deselect()
				
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(iCompteur).Selected = True
				
95: 'UPGRADE_WARNING: MSComctlLib.IListItem method lvwSoumission.SelectedItem.EnsureVisible has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
				Call lvwSoumission.FocusedItem.EnsureVisible()
				
100: bTrouve = True
				
105: Exit For
110: End If
115: Next 
		
120: If bTrouve = False Then
125: For iCompteur = 1 To iSelected - 1
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If InStr(1, UCase(lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text), UCase(sTexte)) > 0 Then
135: Call lvwSoumission.Focus()
					
140: Call Deselect()
					
145: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					lvwSoumission.Items.Item(iCompteur).Selected = True
					
150: 'UPGRADE_WARNING: MSComctlLib.IListItem method lvwSoumission.SelectedItem.EnsureVisible has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
					Call lvwSoumission.FocusedItem.EnsureVisible()
					
155: bTrouve = True
					
160: Exit For
165: End If
170: Next 
175: End If
		
180: If bTrouve = False Then
185: Call MsgBox("Aucun enregistrement trouvé!", MsgBoxStyle.OKOnly, "Erreur")
190: End If
		
195: Exit Sub
		
AfficherErreur: 
		
200: Call AfficherErreur("frmProjSoumElec", "RechercherPieceListViewSoumission", Err, Erl())
	End Sub
	
	Private Sub EffacerItemListViewSoumission()
		
5: On Error GoTo AfficherErreur
		
10: Dim bSeulSS As Boolean 'Pour savoir si c'est le seul enr. dans la sous-section
15: Dim bSeulS As Boolean 'Pour savoir si c'est le seul enr. dans la section
20: Dim iIndex As Short
25: Dim itmPrecedent As System.Windows.Forms.ListViewItem
30: Dim itmSuivant As System.Windows.Forms.ListViewItem
35: Dim iCompteur As Short
40: Dim sMessage As String
45: Dim iNbreSelected As Short
50: Dim bSupprimer As Boolean
55: Dim bPermission As Boolean
		
60: For iCompteur = 1 To lvwSoumission.Items.Count
65: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Selected = True Then
70: iNbreSelected = iNbreSelected + 1
				
75: If iNbreSelected > 1 Then
80: Exit For
85: End If
90: End If
95: Next 
		
100: If iNbreSelected > 1 Then
105: sMessage = "Voulez-vous vraiment effacer ces pièces?"
110: Else
115: sMessage = "Voulez-vous vraiment effacer cette pièce?"
120: End If
		
125: If m_eType = enumType.TYPE_SOUMISSION Then
130: bPermission = True
135: Else
140: If iNbreSelected > 1 Then
145: bPermission = True
150: Else
155: For iCompteur = 1 To lvwSoumission.Items.Count
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
165: Exit For
170: End If
175: Next 
				
180: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_MAGENTA Then
185: bPermission = True
190: End If
195: End If
200: End If
		
205: iCompteur = 1
		
210: If bPermission = True Then
215: If MsgBox(sMessage, MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then
220: Do While iCompteur <= lvwSoumission.Items.Count
225: bSupprimer = False
230: bSeulS = False
235: bSeulSS = False
					
240: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iCompteur).Selected = True Then
						'Si ce n'est pas une section
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If lvwSoumission.Items.Item(iCompteur).Tag <> vbNullString Then
250: 'Si c'est une sous-section
255: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text <> vbNullString Then
260: If m_eType = enumType.TYPE_SOUMISSION Then
265: bSupprimer = True
270: Else
275: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_NOIR Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_BRUN Or System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_MAGENTA Then
280: bSupprimer = True
285: End If
290: End If
								
295: If bSupprimer = True Then
300: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text = "" Then
305: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										If lvwSoumission.Items.Item(iCompteur).SubItems.Count > I_COL_SOUM_PROFIT Then
											lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PROFIT).Text = " "
										Else
											lvwSoumission.Items.Item(iCompteur).SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, " "))
										End If
310: End If
									
315: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									If lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PROFIT).Tag <> "EXTRA" Then
320: If m_bModeAjout = False Then
325: Call AjouterSuppressionCollection(iCompteur)
330: End If
										
335: iIndex = iCompteur
										
										'Il faut vérifier si c'est le seul enregistrement de la section. Si c'est le cas
										'Il faut effacer la section en meme temps
										'Si l'item sélectionné est le dernier enregistrement
340: If iIndex = lvwSoumission.Items.Count Then
											'Si l'élément d'en haut est une sous-section
345: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If lvwSoumission.Items.Item(iIndex - 1).SubItems.Item(I_COL_SOUM_PIECE).Text = vbNullString Then
												'Il est le seul dans la sous-section
350: bSeulSS = True
												
												'Il faut maintenant vérifier si il est le seul dans la section
355: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												If lvwSoumission.Items.Item(iIndex - 2).Tag = vbNullString Then
													'Il est le seul enr. dans la section
360: bSeulS = True
365: End If
370: End If
375: Else
380: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											itmPrecedent = lvwSoumission.Items.Item(iIndex - 1)
385: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											itmSuivant = lvwSoumission.Items.Item(iIndex + 1)
											
											'Si l'élément précedent est une sous-section et le suivant est une sous-section ou une section
390: 'UPGRADE_WARNING: Lower bound of collection itmSuivant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											'UPGRADE_WARNING: Lower bound of collection itmPrecedent.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
											If itmPrecedent.SubItems.Item(I_COL_SOUM_PIECE).Tag = vbNullString And (itmSuivant.Tag = vbNullString Or (itmSuivant.Tag <> vbNullString And itmSuivant.SubItems.Item(I_COL_SOUM_PIECE).Tag = vbNullString)) Then
												'C'est le seul dans la sous-section
395: bSeulSS = True
												
												'Si les éléments avant et après sont des sections
400: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
												If lvwSoumission.Items.Item(iIndex - 2).Tag = vbNullString And itmSuivant.Tag = vbNullString Then
405: bSeulS = True
410: End If
415: End If
420: End If
										
425: Call lvwSoumission.Items.RemoveAt(iIndex)
										
										'Si c'est le seul dans la sous-section, on efface la sous-section
430: If bSeulSS = True Then
435: Call lvwSoumission.Items.RemoveAt(iIndex - 1)
											
440: iCompteur = iCompteur - 1
445: End If
										
										'Si c'est le seul dans la section, on efface la section
450: If bSeulS = True Then
455: Call lvwSoumission.Items.RemoveAt(iIndex - 2)
											
460: iCompteur = iCompteur - 1
465: End If
										
										'On recalcule le temps mécanique
470: Call CalculerTempsFabrication()
										
										'On recalcule les prix
475: Call CalculerPrix()
480: Else
485: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
										Call MsgBox("La pièce " & lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text & " doit être effacée dans le projet " & lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PROVENANCE).Text, MsgBoxStyle.OKOnly, "Erreur")
										
490: iCompteur = iCompteur + 1
495: End If
500: Else
505: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
									Call MsgBox("La pièce " & lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text & " ne peut pas être supprimée!", MsgBoxStyle.OKOnly, "Erreur")
									
510: iCompteur = iCompteur + 1
515: End If
520: Else
525: iCompteur = iCompteur + 1
530: End If
535: Else
540: iCompteur = iCompteur + 1
545: End If
550: Else
555: iCompteur = iCompteur + 1
560: End If
565: Loop 
570: Else
				'Cette ligne sert seulement à ne pas déselectionner et repositionner à la ligne 1 si l'utilisateur
				'décide de ne pas supprimer.
				'Le nom de la variable n'est pas significatif dans ce cas, mais c'est celle-ci qui est utilisé pour
				'désélectionner et remettre à la ligne 1
575: bPermission = False
580: End If
585: End If
		
		'Il faut resélectionner le premier à la fin
590: If lvwSoumission.Items.Count > 0 Then
595: If bPermission = True Then
600: Call Deselect()
				
605: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(1).Selected = True
610: End If
615: End If
		
620: Exit Sub
		
AfficherErreur: 
		
625: Call AfficherErreur("frmProjSoumElec", "EffacerItemListViewSoumission", Err, Erl())
	End Sub
	
	Private Sub AjouterSuppressionCollection(ByVal iIndex As Short)
		
5: On Error GoTo AfficherErreur
		
10: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text <> "Texte" And lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text <> "Text" Then
15: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call m_collQteSupp.Add(Replace(lvwSoumission.Items.Item(iIndex).Text, "*", ""))
20: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call m_collNoItemSupp.Add(lvwSoumission.Items.Item(iIndex).SubItems(I_COL_SOUM_PIECE).Text)
25: Call m_collDateSupp.Add(ConvertDate(Today))
30: Call m_collHeureSupp.Add(TimeOfDay)
35: End If
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumElec", "AjouterSuppressionCollection", Err, Erl())
	End Sub
	
	Private Sub EnregistrerSuppression()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstBavard As ADODB.Recordset
15: Dim rstEmploye As ADODB.Recordset
20: Dim iNoEmploye As Short
25: Dim iCompteur As Short
		
30: rstBavard = New ADODB.Recordset
35: rstEmploye = New ADODB.Recordset
		
40: Call rstBavard.Open("SELECT * FROM GRB_BavardSuppression", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
45: Call rstEmploye.Open("SELECT noEmploye FROM GRB_Employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
50: iNoEmploye = rstEmploye.Fields("noEmploye").Value
		
55: Call rstEmploye.Close()
60: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstEmploye = Nothing
		
65: For iCompteur = 1 To m_collNoItemSupp.Count()
70: Call rstBavard.AddNew()
			
75: rstBavard.Fields("IDUser").Value = iNoEmploye
80: rstBavard.Fields("NoProjsoum").Value = txtNoProjSoum.Text
85: rstBavard.Fields("Type").Value = "E"
90: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collQteSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstBavard.Fields("Qté").Value = m_collQteSupp.Item(iCompteur)
95: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collNoItemSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstBavard.Fields("No Item").Value = m_collNoItemSupp.Item(iCompteur)
100: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collDateSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstBavard.Fields("Date").Value = m_collDateSupp.Item(iCompteur)
105: 'UPGRADE_WARNING: Couldn't resolve default property of object m_collHeureSupp(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
			rstBavard.Fields("Heure").Value = m_collHeureSupp.Item(iCompteur)
			
110: Call rstBavard.Update()
115: Next 
		
120: Call rstBavard.Close()
125: 'UPGRADE_NOTE: Object rstBavard may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstBavard = Nothing
		
130: Exit Sub
		
AfficherErreur: 
		
135: Call AfficherErreur("frmProjSoumElec", "EnregistrerSuppression", Err, Erl())
	End Sub
	
	Private Sub mvwDateRequise_Enter(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mvwDateRequise.Enter
		
5: On Error GoTo AfficherErreur
		
10: m_bMonthViewHasFocus = True
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "mvwDateRequise_GotFocus", Err, Erl())
	End Sub
	
	Private Sub tmrTemps_Tick(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles tmrTemps.Tick
		
5: On Error GoTo AfficherErreur
		
10: If lblPasTemps.Visible = True Then
15: lblPasTemps.Visible = False
20: Else
25: lblPasTemps.Visible = True
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "tmrTemps_Timer", Err, Erl())
	End Sub
	
	Private Sub txtCheminPhotos_KeyDown(ByVal eventSender As System.Object, ByVal eventArgs As System.Windows.Forms.KeyEventArgs) Handles txtCheminPhotos.KeyDown
		Dim KeyCode As Short = eventArgs.KeyCode
		Dim Shift As Short = eventArgs.KeyData \ &H10000
		
5: On Error GoTo AfficherErreur
		
10: If m_eMode = enumMode.MODE_AJOUT_MODIF Then
15: If KeyCode <> System.Windows.Forms.Keys.Back And KeyCode <> System.Windows.Forms.Keys.Delete Then
20: KeyCode = 0
25: End If
30: End If
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "txtCheminPhotos_KeyDown", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event txtPrixManuel.TextChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub txtPrixManuel_TextChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixManuel.TextChanged
		
5: On Error GoTo AfficherErreur
		
		'Si le texte change, il faut recalculer les prix
10: Call CalculerPrix()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "txtManuel_Change", Err, Erl())
	End Sub
	
	Private Sub cmdAnnulerPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdAnnulerPrix.Click
		
5: On Error GoTo AfficherErreur
		
10: fraPrixPiece.Visible = False
		
15: m_bMauvaisPrix = False
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "cmdAnnulerPrix_Click", Err, Erl())
	End Sub
	
	Private Sub cmdOKPrix_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdOKPrix.Click
		'Écrit les prix dans le ListView
5: On Error GoTo AfficherErreur
		
10: Dim rstConfig As ADODB.Recordset
15: Dim itmSoum As System.Windows.Forms.ListViewItem
20: Dim itmAvant As System.Windows.Forms.ListViewItem
25: Dim bPrixSpecial As Boolean
30: Dim iCompteur As Short
35: Dim lColor As Integer
40: Dim sQuantite As String
45: Dim sPiece As String
50: Dim sTauxUSA As String
55: Dim sTauxSPA As String
		
60: rstConfig = New ADODB.Recordset
		
65: Call rstConfig.Open("SELECT TauxAmericain, TauxEspagnol FROM GRB_Config", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
70: sTauxUSA = rstConfig.Fields("TauxAmericain").Value
75: sTauxSPA = rstConfig.Fields("TauxEspagnol").Value
		
80: Call rstConfig.Close()
85: 'UPGRADE_NOTE: Object rstConfig may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstConfig = Nothing
		
90: If m_bMauvaisPrix = False Then
95: If cmbfrs.SelectedIndex = -1 Then
100: Call MsgBox("Vous devez choisir un fournisseur!", MsgBoxStyle.OKOnly, "Erreur")
				
105: Exit Sub
110: End If
115: End If
		
120: If Trim(txtPrixList.Text) = vbNullString Then
125: If Trim(txtPrixSpecial.Text) = vbNullString Then
130: Call MsgBox("Vous devez remplir le prix listé!", MsgBoxStyle.OKOnly, "Erreur")
				
135: Exit Sub
140: End If
145: End If
		
150: If Trim(txtPrixNet.Text) = vbNullString And Trim(txtPrixSpecial.Text) = vbNullString Then
155: Call MsgBox("Vous devez choisir un prix!", MsgBoxStyle.OKOnly, "Erreur")
			
160: Exit Sub
165: Else
170: If Trim(txtPrixNet.Text) <> vbNullString Then
175: bPrixSpecial = False
180: Else
185: bPrixSpecial = True
190: End If
195: End If
		
200: If m_bMauvaisPrix = True Then
205: sQuantite = InputBox("Quelle est la quantité!")
			
210: If sQuantite <> "" Then
215: If Not IsNumeric(sQuantite) Then
220: Exit Sub
225: End If
230: Else
235: Exit Sub
240: End If
			
245: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant = lvwSoumission.Items.Item(CShort(fraPrixPiece.Tag))
250: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Insert(CShort(fraPrixPiece.Tag) + 1, "")
			
255: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			lColor = System.Drawing.ColorTranslator.ToOle(itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor)
			
260: itmSoum.Checked = itmAvant.Checked
			
			'Quantité
265: itmSoum.Text = "-" & itmAvant.Text
			
			'On met l'id de la section dans le tag du listItem
270: itmSoum.Tag = itmAvant.Tag
			
			'No d'item
275: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = itmAvant.SubItems(I_COL_SOUM_PIECE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PIECE).Text))
			End If
			
			'On met le nom de la sous-section dans le tag du no d'item
280: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
			'On met la description en francais dans la colonne et la description en anglais
			'dans le tag
285: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
				itmSoum.SubItems(I_COL_SOUM_DESCR).Text = itmAvant.SubItems(I_COL_SOUM_DESCR).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DESCR).Text))
			End If
290: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Tag
			
			'On met le nom du fabricant dans la col-nne et l'ordre de la section dans le tag
295: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text))
			End If
300: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
			
			'Prix listé
305: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text))
			End If
			
310: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
			
315: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text))
			End If
			
320: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text))
			End If
			
325: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
			
			'On met le fournisseur dans la colonne et l'id dans le tag
330: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
				itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text))
			End If
335: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
			
			'Temps
340: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
				itmSoum.SubItems(I_COL_SOUM_TEMPS).Text = itmAvant.SubItems(I_COL_SOUM_TEMPS).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_TEMPS).Text))
			End If
			
			'Si le temps n'est pas vide
345: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text) <> vbNullString Then
				'On calcul le temps * quantité pour la colonne montage
350: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))))
				End If
355: Else
360: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
365: End If
			
			'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
370: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text))
			End If
			
			'Pour le profit, c'est le prix total - (prix net * quantité)
375: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text))
			End If
			
			'Ajout de l'enregistrement avec le nouveau prix
380: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum = lvwSoumission.Items.Insert(CShort(fraPrixPiece.Tag) + 2, "")
			
385: itmSoum.Checked = itmAvant.Checked
			
			'Quantité
390: itmSoum.Text = sQuantite
			
			'On met l'id de la section dans le tag du listItem
395: itmSoum.Tag = itmAvant.Tag
			
			'No d'item
400: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PIECE Then
				itmSoum.SubItems(I_COL_SOUM_PIECE).Text = itmAvant.SubItems(I_COL_SOUM_PIECE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PIECE).Text))
			End If
			
405: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom de la sous-section dans le tag du no d'item
410: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Tag
			
			'On met la description en francais dans la colonne et la description en anglais
			'dans le tag
415: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DESCR Then
				itmSoum.SubItems(I_COL_SOUM_DESCR).Text = itmAvant.SubItems(I_COL_SOUM_DESCR).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DESCR).Text))
			End If
420: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Tag
			
425: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'On met le nom du fabricant dans la col-nne et l'ordre de la section dans le tag
430: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmSoum.SubItems(I_COL_SOUM_MANUFACT).Text = itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text))
			End If
435: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
			
440: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
445: If bPrixSpecial = False Then
450: If optUSA.Checked = True Then
455: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
460: Else
465: If optSpain.Checked = True Then
470: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
475: Else
480: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
485: End If
490: End If
				
495: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = txtPrixList.Text
				
500: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
				'Escompte
505: If mskEscompte.Text <> vbNullString Then
510: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)))
					End If
515: Else
520: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
						itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
					End If
525: End If
				
530: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
				'Prix net
535: If optUSA.Checked = True Then
540: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
545: Else
550: If optSpain.Checked = True Then
555: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
560: Else
565: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
570: End If
575: End If
				
580: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
				
585: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
590: Else
595: If optUSA.Checked = True Then
600: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
605: Else
610: If optSpain.Checked = True Then
615: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
620: Else
625: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
630: End If
635: End If
				
640: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = txtPrixSpecial.Text
				
645: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
650: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
					itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
				End If
				
655: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
660: If optUSA.Checked = True Then
665: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
						itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
					End If
670: Else
675: If optSpain.Checked = True Then
680: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
685: Else
690: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
							itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
						End If
695: End If
700: End If
				
705: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Tag
				
710: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
715: End If
			
			'On met le fournisseur dans la colonne et l'id dans le tag
720: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
				itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text))
			End If
725: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
			
730: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Temps
735: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TEMPS Then
				itmSoum.SubItems(I_COL_SOUM_TEMPS).Text = itmAvant.SubItems(I_COL_SOUM_TEMPS).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_TEMPS).Text))
			End If
			
740: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Si le temps n'est pas vide
745: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If Trim(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text) <> vbNullString Then
				'On calcul le temps * quantité pour la colonne montage
750: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(CDbl(Replace(itmSoum.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmSoum.Text, "*", vbNullString)))))
				End If
755: Else
760: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_MONTAGE Then
					itmSoum.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
				End If
765: End If
			
770: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
			'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
775: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", vbNullString)) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
780: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
785: If optUSA.Checked = True Then
790: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "USA"
795: Else
800: If optSpain.Checked = True Then
805: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "SPA"
810: Else
815: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "CAN"
820: End If
825: End If
			
			'Pour le profit, c'est le prix total - (prix net * quantité)
830: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", vbNullString))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
			End If
			
835: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
840: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmSoum.SubItems.Count > I_COL_SOUM_COMMENTAIRE Then
				itmSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text = itmAvant.SubItems(I_COL_SOUM_COMMENTAIRE).Text
			Else
				itmSoum.SubItems.Insert(I_COL_SOUM_COMMENTAIRE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_COMMENTAIRE).Text))
			End If
845: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
			
850: If m_eType = enumType.TYPE_PROJET Then
855: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DATE_COMMANDE Then
					itmSoum.SubItems(I_COL_SOUM_DATE_COMMANDE).Text = itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DATE_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text))
				End If
860: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
865: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_DATE_REQUISE Then
					itmSoum.SubItems(I_COL_SOUM_DATE_REQUISE).Text = itmAvant.SubItems(I_COL_SOUM_DATE_REQUISE).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_DATE_REQUISE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DATE_REQUISE).Text))
				End If
870: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
875: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_NOM_COMMANDE Then
					itmSoum.SubItems(I_COL_SOUM_NOM_COMMANDE).Text = itmAvant.SubItems(I_COL_SOUM_NOM_COMMANDE).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_NOM_COMMANDE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_NOM_COMMANDE).Text))
				End If
880: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
885: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_NO_SEQUENTIEL Then
					itmSoum.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text = itmAvant.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_NO_SEQUENTIEL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text))
				End If
890: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
895: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_ID Then
					itmSoum.SubItems(I_COL_SOUM_ID).Text = itmAvant.SubItems(I_COL_SOUM_ID).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_ID, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_ID).Text))
				End If
900: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_ID).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
				
905: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems.Count > I_COL_SOUM_FACTURATION Then
					itmSoum.SubItems(I_COL_SOUM_FACTURATION).Text = itmAvant.SubItems(I_COL_SOUM_FACTURATION).Text
				Else
					itmSoum.SubItems.Insert(I_COL_SOUM_FACTURATION, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_FACTURATION).Text))
				End If
				
910: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmSoum.SubItems(I_COL_SOUM_FACTURATION).Text <> "" Then
915: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_FACTURATION).Tag = itmAvant.SubItems.Item(I_COL_SOUM_FACTURATION).Text
920: End If
				
925: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_FACTURATION).ForeColor = System.Drawing.ColorTranslator.FromOle(lColor)
930: End If
			
935: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmAvant.SubItems(I_COL_SOUM_COMMENTAIRE).Text <> "" Then
940: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor
				
945: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmAvant.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.Color.Black
950: End If
			
955: If m_eType = enumType.TYPE_PROJET Then
960: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_DATE_COMMANDE).Text <> "" Then
965: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.Color.Black
970: End If
				
975: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_DATE_REQUISE).Text <> "" Then
980: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.Color.Black
985: End If
				
990: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_NOM_COMMANDE).Text <> "" Then
995: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.Color.Black
1000: End If
				
1005: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_NO_SEQUENTIEL).Text <> "" Then
1010: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.Color.Black
1015: End If
				
1020: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_FACTURATION).Text <> "" Then
1025: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_FACTURATION).ForeColor = System.Drawing.Color.Black
1030: End If
				
1035: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_ID).Text <> "" Then
1040: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_ID).ForeColor = System.Drawing.Color.Black
1045: End If
				
1050: 'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If itmAvant.SubItems(I_COL_SOUM_PROVENANCE).Text <> "" Then
1055: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmAvant.SubItems.Item(I_COL_SOUM_PROVENANCE).ForeColor = System.Drawing.Color.Black
1060: End If
1065: End If
			
1070: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).ForeColor
1075: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor
1080: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor
1085: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor
1090: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor
1095: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor
1100: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor
1105: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor
1110: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor
1115: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor
1120: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor
			
1125: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.Color.Black
1130: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.Color.Black
1135: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.Color.Black
1140: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.Color.Black
1145: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.Color.Black
1150: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.Color.Black
1155: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.Color.Black
1160: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.Color.Black
1165: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.Color.Black
1170: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.Color.Black
1175: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.Color.Black
			
1180: Call CalculerTempsFabrication()
			
			'Resélectionne le premier élément du listview
1185: If lvwSoumission.Items.Count > 0 Then
1190: Call Deselect()
				
1195: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(1).Selected = True
1200: End If
			
1205: m_bMauvaisPrix = False
			
1210: 'UPGRADE_ISSUE: ComboBox property cmbfrs.Locked was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="CC4C7EC0-C903-48FC-ACCC-81861D12DA4A"'
			cmbfrs.Locked = False
			
1215: Call lvwSoumission.Refresh()
1220: Else
1225: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			sPiece = lvwSoumission.Items.Item(CShort(fraPrixPiece.Tag)).SubItems(I_COL_SOUM_PIECE).Text
			
1230: For iCompteur = 1 To lvwSoumission.Items.Count
1235: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text = sPiece And System.Drawing.ColorTranslator.ToOle(lvwSoumission.Items.Item(iCompteur).SubItems.Item(I_COL_SOUM_PIECE).ForeColor) = COLOR_MAGENTA Then
1240: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum = lvwSoumission.Items.Item(iCompteur)
					
1245: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1250: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1255: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1260: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1265: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1270: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1275: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1280: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1285: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1290: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1295: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
					
1300: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems(I_COL_SOUM_COMMENTAIRE).Text <> "" Then
1305: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_COMMENTAIRE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
1310: End If
					
1315: Call lvwSoumission.Refresh()
					
1320: If bPrixSpecial = False Then
						'Prix listé
1325: If optUSA.Checked = True Then
1330: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1335: Else
1340: If optSpain.Checked = True Then
1345: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixList.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1350: Else
1355: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixList.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1360: End If
1365: End If
						
1370: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = txtPrixList.Text
						
						'Escompte
1375: If mskEscompte.Text <> vbNullString Then
1380: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
								itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(mskEscompte.Text, ModuleMain.enumConvert.MODE_POURCENT)))
							End If
1385: Else
1390: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
								itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
							End If
1395: End If
						
						'Prix net
1400: If optUSA.Checked = True Then
1405: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1410: Else
1415: If optSpain.Checked = True Then
1420: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixNet.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1425: Else
1430: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixNet.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1435: End If
1440: End If
1445: Else
1450: If optUSA.Checked = True Then
1455: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1460: Else
1465: If optSpain.Checked = True Then
1470: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1475: Else
1480: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_LIST).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1485: End If
1490: End If
						
1495: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = txtPrixSpecial.Text
						
1500: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						If itmSoum.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
							itmSoum.SubItems(I_COL_SOUM_ESCOMPTE).Text = Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)
						Else
							itmSoum.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed("0", ModuleMain.enumConvert.MODE_POURCENT)))
						End If
						
1505: If optUSA.Checked = True Then
1510: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
								itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
							Else
								itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxUSA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
							End If
1515: Else
1520: If optSpain.Checked = True Then
1525: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(txtPrixSpecial.Text) / CDbl(sTauxSPA), 4)), ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1530: Else
1535: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
								If itmSoum.SubItems.Count > I_COL_SOUM_PRIX_NET Then
									itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text = Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)
								Else
									itmSoum.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(txtPrixSpecial.Text, ModuleMain.enumConvert.MODE_ARGENT, 4)))
								End If
1540: End If
1545: End If
1550: End If
					
					'On met le fournisseur dans la colonne et l'id dans le tag
1555: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_DISTRIB Then
						itmSoum.SubItems(I_COL_SOUM_DISTRIB).Text = VB6.GetItemString(cmbfrs, cmbfrs.SelectedIndex)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, VB6.GetItemString(cmbfrs, cmbfrs.SelectedIndex)))
					End If
					
1560: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					itmSoum.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = CStr(VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex))
					
					'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
1565: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_TOTAL Then
						itmSoum.SubItems(I_COL_SOUM_TOTAL).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", "")) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(Replace(itmSoum.Text, "*", "")) * CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CSng(m_sProfit), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
					
1570: If optUSA.Checked = True Then
1575: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
						itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "USA"
1580: Else
1585: If optSpain.Checked = True Then
1590: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "SPA"
1595: Else
1600: 'UPGRADE_WARNING: Lower bound of collection itmSoum.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
							itmSoum.SubItems.Item(I_COL_SOUM_TOTAL).Tag = "CAN"
1605: End If
1610: End If
					
					'Pour le profit, c'est le prix total - (prix net * quantité)
1615: 'UPGRADE_WARNING: Lower bound of collection itmSoum has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If itmSoum.SubItems.Count > I_COL_SOUM_PROFIT Then
						itmSoum.SubItems(I_COL_SOUM_PROFIT).Text = Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", ""))), 2)), ModuleMain.enumConvert.MODE_ARGENT)
					Else
						itmSoum.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, Conversion_Renamed(CStr(System.Math.Round(CDbl(itmSoum.SubItems(I_COL_SOUM_TOTAL).Text) - (CDbl(itmSoum.SubItems(I_COL_SOUM_PRIX_NET).Text) * CDbl(Replace(itmSoum.Text, "*", ""))), 2)), ModuleMain.enumConvert.MODE_ARGENT)))
					End If
1620: End If
1625: Next 
1630: End If
		
1635: Call ModifierPrixCatalogue()
		
1640: fraPrixPiece.Visible = False
		
1645: Call CalculerPrix()
		
1650: Exit Sub
		
AfficherErreur: 
		
1655: Call AfficherErreur("frmProjSoumElec", "cmdOKPrix_Click", Err, Erl())
	End Sub
	
	Private Sub RemplirComboFournisseur()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstFRS As ADODB.Recordset
15: Dim iCompteur As Short
20: Dim bExiste As Boolean
		
25: rstFRS = New ADODB.Recordset
		
		'Il faut vider le combo avant de le remplir
30: Call cmbfrs.Items.Clear()
		
35: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		Call rstFRS.Open("SELECT GRB_PiecesFRS.*, GRB_Fournisseur.NomFournisseur FROM GRB_PiecesFRS INNER JOIN GRB_Fournisseur ON GRB_PiecesFRS.IDFRS = GRB_Fournisseur.IDFRS WHERE PIECE = '" & Replace(lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' ORDER BY NomFournisseur", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
		'Tant que ce n'est pas la fin des enregistrements
40: Do While Not rstFRS.EOF
45: bExiste = False
			
50: For iCompteur = 0 To cmbfrs.Items.Count - 1
55: If VB6.GetItemData(cmbfrs, iCompteur) = rstFRS.Fields("IDFRS").Value Then
60: bExiste = True
					
65: Exit For
70: End If
75: Next 
			
80: If bExiste = False Then
85: Call cmbfrs.Items.Add(rstFRS.Fields("NomFournisseur").Value)
				
90: 'UPGRADE_ISSUE: ComboBox property cmbfrs.NewIndex was not upgraded. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="F649E068-7137-45E5-AC20-4D80A3CC70AC"'
				VB6.SetItemData(cmbfrs, cmbfrs.NewIndex, rstFRS.Fields("IDFRS").Value)
95: End If
			
100: Call rstFRS.MoveNext()
105: Loop 
		
110: Call rstFRS.Close()
115: 'UPGRADE_NOTE: Object rstFRS may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstFRS = Nothing
		
120: Exit Sub
		
AfficherErreur: 
		
125: Call AfficherErreur("frmProjSoumElec", "RemplirComboFournisseur", Err, Erl())
	End Sub
	
	Private Sub txtPrixList_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixList.Leave
		
5: On Error GoTo AfficherErreur
		
10: If txtPrixList.Text <> vbNullString Then
15: txtPrixList.Text = Replace(txtPrixList.Text, ".", ",")
			
20: If IsNumeric(txtPrixList.Text) Then
25: Call CalculerPrixNet()
30: Else
35: Call MsgBox("Valeur non numérique!", MsgBoxStyle.OKOnly, "Erreur")
40: txtPrixList.Text = vbNullString
45: End If
50: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumElec", "txtPrixList_LostFocus", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event txtPrixNet.TextChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub txtPrixNet_TextChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixNet.TextChanged
		
5: On Error GoTo AfficherErreur
		
		'Quand le contenu du prix net change
		
		'Si la longueur du texte écrit est plus grand que 0
10: If Len(txtPrixNet.Text) > 0 Then
			'On vide le prix spécial et on le désactive
15: txtPrixSpecial.Text = vbNullString
20: txtPrixSpecial.Enabled = False
25: Else
			'Sinon, on active le prix spécial
30: txtPrixSpecial.Enabled = True
35: End If
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumElec", "txtPrixNet_Change", Err, Erl())
		
	End Sub
	
	Private Sub txtPrixNet_Enter(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixNet.Enter
		
5: On Error GoTo AfficherErreur
		
		'Si le prix net prend le focus
10: Call CalculerPrixNet()
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "txtPrixNet_GotFocus", Err, Erl())
	End Sub
	
	Private Sub CalculerPrixNet()
		
5: On Error GoTo AfficherErreur
		
10: Dim dblEscompte As Double
15: Dim dblPrix As Double
		
		'Si le prix net n'est pas barré.. ie.. si le prix spécial est vide
20: If txtPrixNet.ReadOnly = False Then
25: mskEscompte.Text = Replace(mskEscompte.Text, "_", vbNullString)
			
30: mskEscompte.Text = Replace(mskEscompte.Text, ".", ",")
			
35: If mskEscompte.Text <> vbNullString Then
40: dblEscompte = CDbl(mskEscompte.Text)
45: Else
50: dblEscompte = 0
55: End If
			
60: If txtPrixList.Text <> vbNullString Then
65: dblPrix = CDbl(Replace(txtPrixList.Text, ".", ","))
70: Else
75: dblPrix = 0
80: End If
			
			'Calcul du prix net
85: txtPrixNet.Text = CStr(System.Math.Round((dblPrix) * (1 - dblEscompte), 4))
			
90: txtPrixNet.Text = Replace(txtPrixNet.Text, ".", ",")
95: End If
		
100: Exit Sub
		
AfficherErreur: 
		
105: Call AfficherErreur("frmProjSoumElec", "CalculerPrixNet", Err, Erl())
	End Sub
	
	Private Sub txtPrixNet_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixNet.Leave
		
5: On Error GoTo AfficherErreur
		
10: txtPrixNet.Text = Replace(txtPrixNet.Text, ".", ",")
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "txtPrixNet_LostFocus", Err, Erl())
	End Sub
	
	Private Sub ViderChamps_frs()
		
5: On Error GoTo AfficherErreur
		
		'Vide les champs pieces
10: txtPrixList.Text = vbNullString
15: mskEscompte.Text = vbNullString
20: txtPrixNet.Text = vbNullString
25: txtPrixSpecial.Text = vbNullString
		
30: optCAN.Checked = True
		
35: Call AfficherDrapeau()
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumElec", "ViderChamps_frs", Err, Erl())
	End Sub
	
	Private Sub ModifierPrixCatalogue()
		'Enregistrement du prix de la pièce
		
5: On Error GoTo AfficherErreur
		
10: Dim rstPrix As ADODB.Recordset
15: Dim dblPrixList As Double
20: Dim dblEscompte As Double
25: Dim dblPrixNet As Double
		
30: If Trim(txtPrixList.Text) <> "" Then
35: dblPrixList = CDbl(txtPrixList.Text)
40: Else
45: dblPrixList = 0
50: End If
		
55: If mskEscompte.Text <> vbNullString Then
60: dblEscompte = CDbl(mskEscompte.Text)
65: Else
70: dblEscompte = 0
75: End If
		
80: If Trim(txtPrixNet.Text) <> "" Then
85: dblPrixNet = CDbl(txtPrixNet.Text)
90: Else
95: dblPrixNet = CDbl(txtPrixSpecial.Text)
100: End If
		
105: rstPrix = New ADODB.Recordset
		
110: If txtPrixNet.Enabled = True Then
			'Ouverture du recordset
115: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPrix.Open("SELECT * FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(lvwSoumission.Items.Item(CShort(fraPrixPiece.Tag)).SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' AND IDFRS = " & VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex) & " AND PRIX_NET <> ''", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
120: If rstPrix.EOF Then
125: Call rstPrix.AddNew()
				
130: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPrix.Fields("PIECE").Value = lvwSoumission.Items.Item(CShort(fraPrixPiece.Tag)).SubItems(I_COL_SOUM_PIECE).Text
135: rstPrix.Fields("IDFRS").Value = VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex)
140: End If
			
145: rstPrix.Fields("PRIX_LIST").Value = dblPrixList
150: rstPrix.Fields("ESCOMPTE").Value = dblEscompte
155: rstPrix.Fields("PRIX_NET").Value = dblPrixNet
160: rstPrix.Fields("PRIX_SP").Value = ""
165: Else
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			Call rstPrix.Open("SELECT * FROM GRB_PiecesFRS WHERE PIECE = '" & Replace(lvwSoumission.Items.Item(CShort(fraPrixPiece.Tag)).SubItems(I_COL_SOUM_PIECE).Text, "'", "''") & "' AND IDFRS = " & VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex) & " AND PRIX_SP <> ''", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
175: If rstPrix.EOF Then
180: Call rstPrix.AddNew()
				
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				rstPrix.Fields("PIECE").Value = lvwSoumission.Items.Item(CShort(fraPrixPiece.Tag)).SubItems(I_COL_SOUM_PIECE).Text
190: rstPrix.Fields("IDFRS").Value = VB6.GetItemData(cmbfrs, cmbfrs.SelectedIndex)
195: End If
			
200: rstPrix.Fields("PRIX_SP").Value = dblPrixNet
205: rstPrix.Fields("PRIX_LIST").Value = ""
210: rstPrix.Fields("ESCOMPTE").Value = ""
215: rstPrix.Fields("PRIX_NET").Value = ""
220: End If
		
225: If optCAN.Checked = True Then
230: rstPrix.Fields("DeviseMonétaire").Value = "CAN"
235: Else
240: If optUSA.Checked = True Then
245: rstPrix.Fields("DeviseMonétaire").Value = "USA"
250: Else
255: rstPrix.Fields("DeviseMonétaire").Value = "SPA"
260: End If
265: End If
		
270: rstPrix.Fields("Type").Value = "E"
		
275: rstPrix.Fields("ENTRER_PAR").Value = g_sInitiale
		
280: rstPrix.Fields("Date").Value = ConvertDate(Today)
		
285: Call rstPrix.Update()
		
290: Call rstPrix.Close()
295: 'UPGRADE_NOTE: Object rstPrix may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPrix = Nothing
		
300: Exit Sub
		
AfficherErreur: 
		
305: Call AfficherErreur("frmProjSoumElec", "ModifierPrixCatalogue", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event optCAN.CheckedChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub optCAN_CheckedChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles optCAN.CheckedChanged
		If eventSender.Checked Then
			
5: On Error GoTo AfficherErreur
			
			'dependant la devise, affiche le drapeau
10: Call AfficherDrapeau()
			
15: Exit Sub
			
AfficherErreur: 
			
20: Call AfficherErreur("frmProjSoumElec", "optCAN_Click", Err, Erl())
		End If
	End Sub
	
	Private Sub AfficherDrapeau()
		
5: On Error GoTo AfficherErreur
		
		'''''''''''''''''''''''''''''
		'dependant la devise, affiche le drapeau
		'''''''''''''''''''''''''''''''''''''
10: If optCAN.Checked = True Then
15: imgCanada.Visible = True
20: imgEU.Visible = False
25: imgSpain.Visible = False
30: Else
35: If optUSA.Checked = True Then
40: imgEU.Visible = True
45: imgCanada.Visible = False
50: imgSpain.Visible = False
55: Else
60: imgSpain.Visible = True
65: imgCanada.Visible = False
70: imgEU.Visible = False
75: End If
80: End If
		
85: Exit Sub
		
AfficherErreur: 
		
90: Call AfficherErreur("frmProjSoumElec", "AfficherDrapeau", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event optSpain.CheckedChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub optSpain_CheckedChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles optSpain.CheckedChanged
		If eventSender.Checked Then
			
5: On Error GoTo AfficherErreur
			
			'dependant la devise, affiche le drapeau
10: Call AfficherDrapeau()
			
15: Exit Sub
			
AfficherErreur: 
			
20: Call AfficherErreur("frmProjSoumElec", "optSpain_Click", Err, Erl())
		End If
	End Sub
	
	'UPGRADE_WARNING: Event optUSA.CheckedChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub optUSA_CheckedChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles optUSA.CheckedChanged
		If eventSender.Checked Then
			
5: On Error GoTo AfficherErreur
			
			'Dépendant la devise, affiche le drapeau
10: Call AfficherDrapeau()
			
15: Exit Sub
			
AfficherErreur: 
			
20: Call AfficherErreur("frmProjSoumElec", "optUSA_Click", Err, Erl())
		End If
	End Sub
	
	Private Sub mskEscompte_Enter(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mskEscompte.Enter
		
5: On Error GoTo AfficherErreur
		
		'Quand le maskEdit prend le focus, on set le masque
10: If mskEscompte.Enabled = True Then
15: mskEscompte.Mask = "0,####"
20: End If
		
25: Exit Sub
		
AfficherErreur: 
		
30: Call AfficherErreur("frmProjSoumElec", "mskEscompte_GotFocus", Err, Erl())
	End Sub
	
	Private Sub mskEscompte_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles mskEscompte.Leave
		
5: On Error GoTo AfficherErreur
		
		'Quand le maskEdit perd le focus, on enlève le mask
10: mskEscompte.Mask = vbNullString
		
		'Si le champs contient 0,____, c'est parce que rien n'a été entré
15: If mskEscompte.Text = "0,____" Then
			'Donc, on le vide
20: mskEscompte.Text = vbNullString
25: End If
		
30: Call CalculerPrixNet()
		
35: Exit Sub
		
AfficherErreur: 
		
40: Call AfficherErreur("frmProjSoumElec", "mskEscompte_LostFocus", Err, Erl())
	End Sub
	
	Private Function VerifierSiOuvert(ByRef sUser As String) As Boolean
		'Vérifie si le projet ou la soumission n'est pas en modification
		'par un autre utilisateur sur un autre ordinateur
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
15: Dim bModification As Boolean
		
20: rstProjSoum = New ADODB.Recordset
		
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
		
50: If rstProjSoum.Fields("Modification").Value = True Then
55: sUser = rstProjSoum.Fields("Par").Value
60: bModification = True
65: Else
70: sUser = ""
75: bModification = False
80: End If
		
85: Call rstProjSoum.Close()
90: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
95: VerifierSiOuvert = bModification
		
100: Exit Function
		
AfficherErreur: 
		
105: Call AfficherErreur("frmProjSoumElec", "VerifierSiOuvert", Err, Erl())
	End Function
	
	Private Sub OuvrirProjSoum(ByVal bOuvrir As Boolean)
		'Remplis ou vide les champs Modification et Par
5: On Error GoTo AfficherErreur
		
10: Dim rstProjSoum As ADODB.Recordset
		
15: rstProjSoum = New ADODB.Recordset
		
20: rstProjSoum.CursorLocation = ADODB.CursorLocationEnum.adUseServer
		
25: If m_eType = enumType.TYPE_PROJET Then
30: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
35: Else
40: Call rstProjSoum.Open("SELECT Modification, Par FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
45: End If
		
50: Do While Not rstProjSoum.EOF
55: If bOuvrir = True Then
60: rstProjSoum.Fields("Modification").Value = True
65: rstProjSoum.Fields("Par").Value = g_sEmploye
70: Else
75: rstProjSoum.Fields("Modification").Value = False
80: rstProjSoum.Fields("Par").Value = ""
85: End If
			
90: Call rstProjSoum.Update()
			
95: Call rstProjSoum.MoveNext()
100: Loop 
		
105: Call rstProjSoum.Close()
110: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjSoum = Nothing
		
115: Exit Sub
		
AfficherErreur: 
		
120: Call AfficherErreur("frmProjSoumElec", "OuvrirProjSoum", Err, Erl())
	End Sub
	
	Private Sub AnnulerCommande()
		
5: On Error GoTo AfficherErreur
		
10: Dim rstProjet As ADODB.Recordset
15: Dim itmAvant As System.Windows.Forms.ListViewItem
20: Dim itmAnnulation As System.Windows.Forms.ListViewItem
25: Dim sExtra As String
		
30: If VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
35: sExtra = InputBox("Dans quel extra l'annulation de commande doit être faite ? (2 chiffres seulement)")
			
40: If Len(sExtra) <> 2 Then
45: Call MsgBox("Format incorrect!", MsgBoxStyle.OKOnly, "Erreur")
				
50: Exit Sub
55: End If
			
60: If Not IsNumeric(sExtra) Then
65: Call MsgBox("L'extra doit être numérique!", MsgBoxStyle.OKOnly, "Erreur")
				
70: Exit Sub
75: End If
			
80: If CDbl(sExtra) < 60 Or CDbl(sExtra) > 98 Then
85: Call MsgBox("L'extra doit être entre 60 et 98!", MsgBoxStyle.OKOnly, "Erreur")
				
90: Exit Sub
95: End If
			
100: rstProjet = New ADODB.Recordset
			
105: Call rstProjet.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
110: If rstProjet.EOF Then
115: Call MsgBox("Le projet " & VB.Left(txtNoProjSoum.Text, Len(txtNoProjSoum.Text) - 2) & sExtra & " n'existe pas!", MsgBoxStyle.OKOnly, "Erreur")
				
120: Call rstProjet.Close()
125: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjet = Nothing
				
130: Exit Sub
135: Else
140: Call rstProjet.Close()
145: 'UPGRADE_NOTE: Object rstProjet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
				rstProjet = Nothing
150: End If
155: End If
		
160: itmAvant = lvwSoumission.FocusedItem
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation = lvwSoumission.Items.Insert(itmAvant.Index + 1, "")
		
170: itmAnnulation.Checked = itmAvant.Checked
		
		'Quantité
175: itmAnnulation.Text = "-" & itmAvant.Text
		
		'On met l'id de la section dans le tag du listItem
180: itmAnnulation.Tag = itmAvant.Tag
		
		'No d'item
185: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PIECE Then
			itmAnnulation.SubItems(I_COL_SOUM_PIECE).Text = itmAvant.SubItems(I_COL_SOUM_PIECE).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PIECE).Text))
		End If
		
		'On met le nom de la sous-section dans le tag du no d'item
190: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Tag
		
		'On met la description en francais dans la colonne et la description en anglais
		'dans le tag
195: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_DESCR Then
			itmAnnulation.SubItems(I_COL_SOUM_DESCR).Text = itmAvant.SubItems(I_COL_SOUM_DESCR).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DESCR).Text))
		End If
200: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Tag
		
		'On met le nom du fabricant dans la col-nne et l'ordre de la section dans le tag
205: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_MANUFACT Then
			itmAnnulation.SubItems(I_COL_SOUM_MANUFACT).Text = itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_MANUFACT).Text))
		End If
210: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Tag
		
		'Prix listé
215: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
			itmAnnulation.SubItems(I_COL_SOUM_PRIX_LIST).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_LIST).Text))
		End If
		
220: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
		
225: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
			itmAnnulation.SubItems(I_COL_SOUM_ESCOMPTE).Text = itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_ESCOMPTE).Text))
		End If
		
230: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PRIX_NET Then
			itmAnnulation.SubItems(I_COL_SOUM_PRIX_NET).Text = itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_PRIX_NET).Text))
		End If
		
		'On met le fournisseur dans la colonne et l'id dans le tag
235: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_DISTRIB Then
			itmAnnulation.SubItems(I_COL_SOUM_DISTRIB).Text = itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_DISTRIB).Text))
		End If
240: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
		
		'Temps
245: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_TEMPS Then
			itmAnnulation.SubItems(I_COL_SOUM_TEMPS).Text = itmAvant.SubItems(I_COL_SOUM_TEMPS).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, itmAvant.SubItems(I_COL_SOUM_TEMPS).Text))
		End If
		
		'Si le temps n'est pas vide
250: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If Trim(itmAnnulation.SubItems(I_COL_SOUM_TEMPS).Text) <> vbNullString Then
			'On calcul le temps * quantité pour la colonne montage
255: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmAnnulation.SubItems.Count > I_COL_SOUM_MONTAGE Then
				itmAnnulation.SubItems(I_COL_SOUM_MONTAGE).Text = CStr(CDbl(Replace(itmAnnulation.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmAnnulation.Text, "*", vbNullString)))
			Else
				itmAnnulation.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, CStr(CDbl(Replace(itmAnnulation.SubItems(I_COL_SOUM_TEMPS).Text, ".", ",")) * CDbl(Replace(itmAnnulation.Text, "*", vbNullString)))))
			End If
260: Else
265: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmAnnulation.SubItems.Count > I_COL_SOUM_MONTAGE Then
				itmAnnulation.SubItems(I_COL_SOUM_MONTAGE).Text = vbNullString
			Else
				itmAnnulation.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, vbNullString))
			End If
270: End If
		
		'Pour le prix total, il faut faire la quantité * prix net * pourcentage de profit
275: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_TOTAL Then
			itmAnnulation.SubItems(I_COL_SOUM_TOTAL).Text = "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_TOTAL).Text))
		End If
		
		'Pour le profit, c'est le prix total - (prix net * quantité)
280: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection itmAvant has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		If itmAnnulation.SubItems.Count > I_COL_SOUM_PROFIT Then
			itmAnnulation.SubItems(I_COL_SOUM_PROFIT).Text = "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text
		Else
			itmAnnulation.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, "-" & itmAvant.SubItems(I_COL_SOUM_PROFIT).Text))
		End If
		
285: If VB.Right(txtNoProjSoum.Text, 2) >= "00" And VB.Right(txtNoProjSoum.Text, 2) <= "19" Then
			'Pour savoir lors de l'enregistremenet qu'il faut le lier avec un extra
290: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).Tag = "ANNULATION " & sExtra
295: End If
		
300: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
305: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
310: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
315: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
320: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
325: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
330: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
335: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
340: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
345: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
350: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
		
355: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
360: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
365: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_DISTRIB).Font, True)
370: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, True)
375: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_MANUFACT).Font, True)
380: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_MONTAGE).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_MONTAGE).Font, True)
385: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, True)
390: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, True)
395: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_PROFIT).Font, True)
400: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_TEMPS).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_TEMPS).Font, True)
405: 'UPGRADE_WARNING: Lower bound of collection itmAnnulation.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAnnulation.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmAnnulation.SubItems.Item(I_COL_SOUM_TOTAL).Font, True)
		
410: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
415: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
420: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
425: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
430: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
435: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
440: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
445: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
450: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
455: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
460: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
465: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
470: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
475: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
480: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_VERT_FORET)
		
485: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PIECE).Font, True)
490: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DESCR).Font, True)
495: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DISTRIB).Font, True)
500: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_ESCOMPTE).Font, True)
505: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_MANUFACT).Font, True)
510: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_MONTAGE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_MONTAGE).Font, True)
515: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PRIX_LIST).Font, True)
520: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PRIX_NET).Font, True)
525: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_PROFIT).Font, True)
530: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_TEMPS).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_TEMPS).Font, True)
535: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_TOTAL).Font, True)
540: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DATE_COMMANDE).Font, True)
545: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_DATE_REQUISE).Font, True)
550: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_NOM_COMMANDE).Font, True)
555: 'UPGRADE_WARNING: Lower bound of collection itmAvant.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		itmAvant.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font = VB6.FontChangeBold(itmAvant.SubItems.Item(I_COL_SOUM_NO_SEQUENTIEL).Font, True)
		
560: Call lvwSoumission.Refresh()
		
565: Call CalculerPrix()
		
570: Exit Sub
		
AfficherErreur: 
		
575: Call AfficherErreur("frmProjSoumElec", "AnnulerCommande", Err, Erl())
	End Sub
	
	Private Sub cmdEffacerForfait_Click(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles cmdEffacerForfait.Click
		
5: On Error GoTo AfficherErreur
		
10: txtForfait.Text = ""
15: lblForfaitInitiale.Text = ""
		
20: Exit Sub
		
AfficherErreur: 
		
25: Call AfficherErreur("frmProjSoumElec", "cmdEffacerForfait_Click", Err, Erl())
	End Sub
	
	Private Sub CopierPiece()
		
5: On Error GoTo AfficherErreur
		
10: Dim itmCopier As System.Windows.Forms.ListViewItem
15: Dim iNbreSelect As Short
20: Dim iCompteur As Short
25: Dim iNbreSelected As Short
30: Dim iIndex As Short
		
35: For iCompteur = 1 To lvwSoumission.Items.Count
40: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Selected = True Then
45: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems() has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.Items.Item(iCompteur).Tag = "" Or lvwSoumission.Items.Item(iCompteur).SubItems(I_COL_SOUM_PIECE).Text = "" Then
50: Call MsgBox("Impossible de copier, la sélection contient une section ou une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
					
55: Exit Sub
60: Else
65: iNbreSelected = iNbreSelected + 1
70: End If
75: End If
80: Next 
		
85: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
90: m_iNbreCopie = iNbreSelected
		
95: ReDim m_arr_tyCopie(iNbreSelected - 1)
		
100: For iCompteur = 1 To lvwSoumission.Items.Count
105: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If lvwSoumission.Items.Item(iCompteur).Selected = True Then
110: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmCopier = lvwSoumission.Items.Item(iCompteur)
				
115: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).lColor = System.Drawing.ColorTranslator.ToOle(itmCopier.SubItems.Item(I_COL_SOUM_PIECE).ForeColor)
				
120: m_arr_tyCopie(iIndex).bChecked = itmCopier.Checked
				
125: m_arr_tyCopie(iIndex).sQuantite = itmCopier.Text
				
130: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sPiece = itmCopier.SubItems(I_COL_SOUM_PIECE).Text
				
135: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sDescr = itmCopier.SubItems(I_COL_SOUM_DESCR).Text
140: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmCopier.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				m_arr_tyCopie(iIndex).sDescrTag = itmCopier.SubItems.Item(I_COL_SOUM_DESCR).Tag
				
145: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sManufact = itmCopier.SubItems(I_COL_SOUM_MANUFACT).Text
				
150: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sPrixList = itmCopier.SubItems(I_COL_SOUM_PRIX_LIST).Text
155: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmCopier.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				m_arr_tyCopie(iIndex).sPrixListTag = itmCopier.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag
				
160: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sEscompte = itmCopier.SubItems(I_COL_SOUM_ESCOMPTE).Text
				
165: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sPrixNet = itmCopier.SubItems(I_COL_SOUM_PRIX_NET).Text
				
170: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sFRS = itmCopier.SubItems(I_COL_SOUM_DISTRIB).Text
175: 'UPGRADE_WARNING: Lower bound of collection itmCopier.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				'UPGRADE_WARNING: Couldn't resolve default property of object itmCopier.ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				m_arr_tyCopie(iIndex).sFRSTag = itmCopier.SubItems.Item(I_COL_SOUM_DISTRIB).Tag
				
180: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sTemps = itmCopier.SubItems(I_COL_SOUM_TEMPS).Text
				
185: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sMontage = itmCopier.SubItems(I_COL_SOUM_MONTAGE).Text
				
190: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sTotal = itmCopier.SubItems(I_COL_SOUM_TOTAL).Text
				
195: 'UPGRADE_WARNING: Lower bound of collection itmCopier has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				m_arr_tyCopie(iIndex).sProfit = itmCopier.SubItems(I_COL_SOUM_PROFIT).Text
				
200: iIndex = iIndex + 1
205: End If
210: Next 
		
215: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
220: Exit Sub
		
AfficherErreur: 
		
225: Call AfficherErreur("frmProjSoumElec", "CopierPiece", Err, Erl())
	End Sub
	
	Private Sub CollerPiece()
		
5: On Error GoTo AfficherErreur
		
10: Dim sIDSection As String
15: Dim sOrdreSection As String
20: Dim sSousSection As String
25: Dim itmColler As System.Windows.Forms.ListViewItem
30: Dim iCompteur As Short
35: Dim iIndexSelected As Short
40: Dim iIndex As Short
		
		'Pour savoir s'il y a quelque chose à coller
45: If m_iNbreCopie = 0 Then
50: Exit Sub
55: End If
		
60: iIndexSelected = lvwSoumission.FocusedItem.Index
		
65: If iIndexSelected >= 3 Then
70: If lvwSoumission.FocusedItem.Tag = vbNullString Then
75: iIndex = iIndexSelected - 1
80: Else
85: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.SelectedItem has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				If lvwSoumission.FocusedItem.SubItems(I_COL_SOUM_PIECE).Text = vbNullString Then
90: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
					If lvwSoumission.Items.Item(iIndexSelected - 1).Tag = "" Then
95: Call MsgBox("Impossible de coller la pièce entre une section et une sous-section!", MsgBoxStyle.OKOnly, "Erreur")
						
100: Exit Sub
105: Else
110: iIndex = iIndexSelected - 1
115: End If
120: Else
125: iIndex = iIndexSelected
130: End If
135: End If
140: Else
145: Call MsgBox("Emplacement incorrect!", MsgBoxStyle.OKOnly, "Erreur")
			
150: Exit Sub
155: End If
		
160: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sIDSection = lvwSoumission.Items.Item(iIndex).Tag
165: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sOrdreSection = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_MANUFACT).Tag
170: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems().ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
		'UPGRADE_WARNING: Couldn't resolve default property of object lvwSoumission.ListItems().ListSubItems().Tag. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		sSousSection = lvwSoumission.Items.Item(iIndex).SubItems.Item(I_COL_SOUM_PIECE).Tag
		
175: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.WaitCursor
		
180: For iCompteur = 0 To UBound(m_arr_tyCopie)
185: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler = lvwSoumission.Items.Insert(iIndexSelected + iCompteur, "")
			
190: itmColler.Checked = m_arr_tyCopie(iCompteur).bChecked
			
195: itmColler.Text = m_arr_tyCopie(iCompteur).sQuantite
200: itmColler.Tag = sIDSection
			
205: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PIECE Then
				itmColler.SubItems(I_COL_SOUM_PIECE).Text = m_arr_tyCopie(iCompteur).sPiece
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PIECE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sPiece))
			End If
210: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_PIECE).Tag = sSousSection
			
215: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_DESCR Then
				itmColler.SubItems(I_COL_SOUM_DESCR).Text = m_arr_tyCopie(iCompteur).sDescr
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_DESCR, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sDescr))
			End If
220: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_DESCR).Tag = m_arr_tyCopie(iCompteur).sDescrTag
			
225: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_MANUFACT Then
				itmColler.SubItems(I_COL_SOUM_MANUFACT).Text = m_arr_tyCopie(iCompteur).sManufact
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_MANUFACT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sManufact))
			End If
230: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_MANUFACT).Tag = sOrdreSection
			
235: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PRIX_LIST Then
				itmColler.SubItems(I_COL_SOUM_PRIX_LIST).Text = m_arr_tyCopie(iCompteur).sPrixList
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PRIX_LIST, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sPrixList))
			End If
240: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_PRIX_LIST).Tag = m_arr_tyCopie(iCompteur).sPrixListTag
			
245: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_ESCOMPTE Then
				itmColler.SubItems(I_COL_SOUM_ESCOMPTE).Text = m_arr_tyCopie(iCompteur).sEscompte
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_ESCOMPTE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sEscompte))
			End If
			
250: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PRIX_NET Then
				itmColler.SubItems(I_COL_SOUM_PRIX_NET).Text = m_arr_tyCopie(iCompteur).sPrixNet
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PRIX_NET, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sPrixNet))
			End If
			
255: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_DISTRIB Then
				itmColler.SubItems(I_COL_SOUM_DISTRIB).Text = m_arr_tyCopie(iCompteur).sFRS
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_DISTRIB, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sFRS))
			End If
260: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			itmColler.SubItems.Item(I_COL_SOUM_DISTRIB).Tag = m_arr_tyCopie(iCompteur).sFRSTag
			
265: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_TEMPS Then
				itmColler.SubItems(I_COL_SOUM_TEMPS).Text = m_arr_tyCopie(iCompteur).sTemps
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_TEMPS, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sTemps))
			End If
			
270: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_MONTAGE Then
				itmColler.SubItems(I_COL_SOUM_MONTAGE).Text = m_arr_tyCopie(iCompteur).sMontage
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_MONTAGE, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sMontage))
			End If
			
275: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_TOTAL Then
				itmColler.SubItems(I_COL_SOUM_TOTAL).Text = m_arr_tyCopie(iCompteur).sTotal
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_TOTAL, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sTotal))
			End If
			
280: 'UPGRADE_WARNING: Lower bound of collection itmColler has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
			If itmColler.SubItems.Count > I_COL_SOUM_PROFIT Then
				itmColler.SubItems(I_COL_SOUM_PROFIT).Text = m_arr_tyCopie(iCompteur).sProfit
			Else
				itmColler.SubItems.Insert(I_COL_SOUM_PROFIT, New System.Windows.Forms.ListViewItem.ListViewSubItem(Nothing, m_arr_tyCopie(iCompteur).sProfit))
			End If
			
285: If m_eType = enumType.TYPE_PROJET Then
290: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
295: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
300: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
305: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
310: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
315: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
320: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
325: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
330: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
335: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
340: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(m_arr_tyCopie(iCompteur).lColor)
345: Else
350: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PROFIT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
355: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_TOTAL).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
360: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_MONTAGE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
365: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_TEMPS).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
370: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DISTRIB).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
375: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_NET).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
380: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_ESCOMPTE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
385: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_DESCR).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
390: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PIECE).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
395: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_MANUFACT).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
400: 'UPGRADE_WARNING: Lower bound of collection itmColler.ListSubItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				itmColler.SubItems.Item(I_COL_SOUM_PRIX_LIST).ForeColor = System.Drawing.ColorTranslator.FromOle(COLOR_NOIR)
405: End If
			
410: Call lvwSoumission.Refresh()
415: Next 
		
420: Call CalculerTempsFabrication()
		
425: Call CalculerPrix()
		
430: 'UPGRADE_WARNING: Screen property Screen.MousePointer has a new behavior. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6BA9B8D2-2A32-4B6E-8D36-44949974A5B4"'
		System.Windows.Forms.Cursor.Current = System.Windows.Forms.Cursors.Default
		
435: Exit Sub
		
AfficherErreur: 
		
440: Call AfficherErreur("frmProjSoumElec", "CollerPiece", Err, Erl())
	End Sub
	
	Private Sub Deselect()
		
5: On Error GoTo AfficherErreur
		
10: Dim iCompteur As Short
		
15: If lvwSoumission.Items.Count > 0 Then
20: For iCompteur = 1 To lvwSoumission.Items.Count
25: 'UPGRADE_WARNING: Lower bound of collection lvwSoumission.ListItems has changed from 1 to 0. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="A3B628A0-A810-4AE2-BFA2-9E7A29EB9AD0"'
				lvwSoumission.Items.Item(iCompteur).Selected = False
30: Next 
35: End If
		
40: Exit Sub
		
AfficherErreur: 
		
45: Call AfficherErreur("frmProjSoumElec", "Deselect", Err, Erl())
	End Sub
	
	'UPGRADE_WARNING: Event txtPrixSpecial.TextChanged may fire when form is initialized. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="88B12AE1-6DE0-48A0-86F1-60C0686C026A"'
	Private Sub txtPrixSpecial_TextChanged(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixSpecial.TextChanged
		
5: On Error GoTo AfficherErreur
		'Quand le contenu du prix spécial change
		
		'Si la longueur du texte écrit est plus grand que 0
10: If Len(txtPrixSpecial.Text) > 0 Then
			'On vide l'escompte, le prix net et on les désactive
15: mskEscompte.Text = vbNullString
20: txtPrixNet.Text = vbNullString
			
25: mskEscompte.Enabled = False
30: txtPrixNet.Enabled = False
35: Else
			'Sinon, on active escompte et prix net
40: mskEscompte.Enabled = True
45: txtPrixNet.Enabled = True
50: End If
		
55: Exit Sub
		
AfficherErreur: 
		
60: Call AfficherErreur("frmProjSoumElec", "txtPrixSpecial_Change", Err, Erl())
	End Sub
	
	Private Sub txtPrixSpecial_Leave(ByVal eventSender As System.Object, ByVal eventArgs As System.EventArgs) Handles txtPrixSpecial.Leave
		
5: On Error GoTo AfficherErreur
		
10: txtPrixSpecial.Text = Replace(txtPrixSpecial.Text, ".", ",")
		
15: Exit Sub
		
AfficherErreur: 
		
20: Call AfficherErreur("frmProjSoumElec", "txtPrixSpecial_LostFocus", Err, Erl())
	End Sub
	
	Private Function ValiderFormatElectrique(ByVal sNoProjSoum As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If UCase(VB.Left(sNoProjSoum, 1)) = "E" Then
15: ValiderFormatElectrique = True
20: Else
25: Call MsgBox("Un numéro électrique doit absolument commencé par 'E' !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatElectrique = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumElec", "ValiderFormatElectrique", Err, Erl())
	End Function
	
	Private Function ValiderFormatSoumission(ByVal sNoSoumission As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If Mid(sNoSoumission, 3, 1) = "1" Then
15: ValiderFormatSoumission = True
20: Else
25: Call MsgBox("Une soumission doit absolument avoir un '1' comme 3e caractère !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatSoumission = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumElec", "ValiderFormatSoumission", Err, Erl())
	End Function
	
	Private Function ValiderFormatJobSansSoum(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If Mid(sNoProjet, 3, 1) <> "3" And Mid(sNoProjet, 3, 1) <> "1" Then
15: ValiderFormatJobSansSoum = True
20: Else
25: Call MsgBox("Un projet créé sans soumission ne peut pas être un '" & Mid(sNoProjet, 2, 2) & "' !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatJobSansSoum = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumElec", "ValiderFormatJobSansSoum", Err, Erl())
	End Function
	
	Private Function ValiderFormatJobAvecSoum(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If Mid(sNoProjet, 3, 1) = "3" Then
15: ValiderFormatJobAvecSoum = True
20: Else
25: Call MsgBox("Un projet créé à partir d'une soumission doit absolument avec un '3' comme 3e caractère!", MsgBoxStyle.OKOnly, "Errreu")
			
30: ValiderFormatJobAvecSoum = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumElec", "ValiderFormatJobAvecSoum", Err, Erl())
	End Function
	
	Private Function ValiderFormatJobExtra(ByVal sNoProjet As String) As Boolean
		
5: On Error GoTo AfficherErreur
		
10: If CShort(VB.Right(sNoProjet, 2)) >= 50 And CShort(VB.Right(sNoProjet, 2)) <= 98 Then
15: ValiderFormatJobExtra = True
20: Else
25: Call MsgBox("L'entension d'un extra doit être compris entre 50 et 98 !", MsgBoxStyle.OKOnly, "Erreur")
			
30: ValiderFormatJobExtra = False
35: End If
		
40: Exit Function
		
AfficherErreur: 
		
45: Call AfficherErreur("FrmProjSoumElec", "ValiderFormatJobExtra", Err, Erl())
	End Function
	
	Private Sub AjouterProjetAuCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstProj As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstProjCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim rstEmploye As ADODB.Recordset
45: Dim rstSoum As ADODB.Recordset
50: Dim bCumulatifExiste As Boolean
55: Dim dblNbreManuel As Double
60: Dim dblPrixEmballage As Double
65: Dim dblTotalManuel As Double
70: Dim dblForfait As Double
		
75: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
80: rstProj = New ADODB.Recordset
85: rstPieces = New ADODB.Recordset
90: rstProjCumulatif = New ADODB.Recordset
95: rstPiecesCumulatif = New ADODB.Recordset
		
100: Call rstProjCumulatif.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
105: If rstProjCumulatif.EOF Then
110: bCumulatifExiste = False
			
115: Call rstProjCumulatif.AddNew()
			
120: rstProjCumulatif.Fields("IDProjet").Value = sNoCumulatif
			
			'Ouverture du projet -01 pour voir la soumission reliée pour ensuite assigner
			'la soumission -99 avec le projet -99
125: Call rstProj.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & VB.Left(txtNoProjSoum.Text, 6) & "-01'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
130: If Not rstProj.EOF Then
135: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("IDSoumission").Value) Then
140: If Len(rstProj.Fields("IDSoumission").Value) >= 6 Then
145: rstSoum = New ADODB.Recordset
						
150: Call rstSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & VB.Left(rstProj.Fields("IDSoumission").Value, 6) & "-99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
						
155: If Not rstSoum.EOF Then
160: rstProjCumulatif.Fields("IDSoumission").Value = rstSoum.Fields("IDSoumission").Value
165: End If
						
170: Call rstSoum.Close()
175: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
						rstSoum = Nothing
180: End If
185: End If
190: End If
			
195: Call rstProj.Close()
			
200: Call rstProj.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
205: rstProjCumulatif.Fields("IDClient").Value = rstProj.Fields("IDClient").Value
210: rstProjCumulatif.Fields("IDContact").Value = rstProj.Fields("IDContact").Value
			
215: rstProjCumulatif.Fields("TauxDessin").Value = rstProj.Fields("TauxDessin").Value
220: rstProjCumulatif.Fields("TauxFabrication").Value = rstProj.Fields("TauxFabrication").Value
225: rstProjCumulatif.Fields("TauxAssemblage").Value = rstProj.Fields("TauxAssemblage").Value
230: rstProjCumulatif.Fields("TauxProgInterface").Value = rstProj.Fields("TauxProgInterface").Value
235: rstProjCumulatif.Fields("TauxProgAutomate").Value = rstProj.Fields("TauxProgAutomate").Value
240: rstProjCumulatif.Fields("TauxProgRobot").Value = rstProj.Fields("TauxProgRobot").Value
245: rstProjCumulatif.Fields("TauxVision").Value = rstProj.Fields("TauxVision").Value
250: rstProjCumulatif.Fields("TauxTest").Value = rstProj.Fields("TauxTest").Value
255: rstProjCumulatif.Fields("TauxInstallation").Value = rstProj.Fields("TauxInstallation").Value
260: rstProjCumulatif.Fields("TauxMiseService").Value = rstProj.Fields("TauxMiseService").Value
265: rstProjCumulatif.Fields("TauxFormation").Value = rstProj.Fields("TauxFormation").Value
270: rstProjCumulatif.Fields("TauxGestion").Value = rstProj.Fields("TauxGestion").Value
275: rstProjCumulatif.Fields("TauxShipping").Value = rstProj.Fields("TauxShipping").Value
			
280: rstProjCumulatif.Fields("Transport").Value = rstProj.Fields("Transport").Value
			
285: rstProjCumulatif.Fields("Profit").Value = rstProj.Fields("Profit").Value
290: rstProjCumulatif.Fields("imprevue").Value = rstProj.Fields("imprevue").Value
295: rstProjCumulatif.Fields("commission").Value = rstProj.Fields("commission").Value
			
300: Call rstProj.Close()
			
305: rstProjCumulatif.Fields("Description").Value = "Cumulatif de " & VB.Left(txtNoProjSoum.Text, 6)
			
310: rstEmploye = New ADODB.Recordset
			
315: Call rstEmploye.Open("SELECT * FROM GRB_employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
320: rstProjCumulatif.Fields("creer").Value = ConvertDate(Today)
			
325: rstProjCumulatif.Fields("creer_par").Value = rstEmploye.Fields("NoEmploye").Value
			
330: Call rstEmploye.Close()
335: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstEmploye = Nothing
			
340: Call rstProjCumulatif.Update()
			
345: rstProjSoum = New ADODB.Recordset
			
350: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
355: Call rstProjSoum.AddNew()
			
360: rstProjSoum.Fields("IDProjSoum").Value = sNoCumulatif
365: rstProjSoum.Fields("NoClient").Value = rstProjCumulatif.Fields("IDClient").Value
370: rstProjSoum.Fields("Description").Value = rstProjCumulatif.Fields("Description").Value
375: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
380: rstProjSoum.Fields("Ouvert").Value = True
385: rstProjSoum.Fields("Verrouillé").Value = True
390: rstProjSoum.Fields("Type").Value = "P"
			
395: Call rstProjSoum.Update()
			
400: Call rstProjSoum.Close()
405: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
410: Else
415: bCumulatifExiste = True
420: End If
		
425: rstProj.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
430: Call rstProj.Open("SELECT * FROM GRB_ProjetElec WHERE LEFT(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDProjet, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
435: If rstProj.RecordCount = 1 Then
440: rstProjCumulatif.Fields("NbreManuel").Value = rstProj.Fields("NbreManuel").Value
			
445: rstProjCumulatif.Fields("PrixEmballage").Value = rstProj.Fields("PrixEmballage").Value
			
450: rstProjCumulatif.Fields("total_manuel").Value = rstProj.Fields("total_manuel").Value
			
455: rstProjCumulatif.Fields("MontantForfait").Value = rstProj.Fields("MontantForfait").Value
460: Else
465: Do While Not rstProj.EOF
470: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("NbreManuel").Value) Then
475: dblNbreManuel = dblNbreManuel + CDbl(rstProj.Fields("NbreManuel").Value)
480: End If
				
485: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("PrixEmballage").Value) Then
490: dblPrixEmballage = dblPrixEmballage + CDbl(rstProj.Fields("PrixEmballage").Value)
495: End If
				
500: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("total_manuel").Value) Then
505: dblTotalManuel = dblTotalManuel + CDbl(rstProj.Fields("total_manuel").Value)
510: End If
				
515: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstProj.Fields("MontantForfait").Value) Then
520: If IsNumeric(rstProj.Fields("MontantForfait").Value) Then
525: dblForfait = dblForfait + CDbl(rstProj.Fields("MontantForfait").Value)
530: End If
535: End If
				
540: Call rstProj.MoveNext()
545: Loop 
			
550: rstProjCumulatif.Fields("NbreManuel").Value = dblNbreManuel
555: rstProjCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
560: rstProjCumulatif.Fields("total_manuel").Value = dblTotalManuel
565: rstProjCumulatif.Fields("MontantForfait").Value = dblForfait
570: End If
		
575: Call rstProj.Close()
		
580: Call rstProjCumulatif.Update()
		
585: Call rstProjCumulatif.Close()
		
		'AJOUT DES PIÈCES
590: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
595: If bCumulatifExiste = True Then
600: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "' AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
			
605: Call rstPieces.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Provenance Is Null OR Provenance = '' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
610: Else
615: Call rstPieces.Open("SELECT * FROM GRB_Projet_Pieces WHERE LEFT(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDProjet, 2) <> '99' AND Provenance Is Null OR Provenance = '' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
620: End If
		
625: Do While Not rstPieces.EOF
630: Call rstPiecesCumulatif.AddNew()
			
635: rstPiecesCumulatif.Fields("IDProjet").Value = sNoCumulatif
640: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
645: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
650: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
655: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
660: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
665: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
670: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
675: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
680: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
685: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
690: rstPiecesCumulatif.Fields("Temps").Value = rstPieces.Fields("Temps").Value
695: rstPiecesCumulatif.Fields("Temps_Total").Value = rstPieces.Fields("Temps_Total").Value
700: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
705: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
710: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
715: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
720: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
725: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
730: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
735: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
740: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
745: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
750: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDProjet").Value, 2)
			
755: Call rstPiecesCumulatif.Update()
			
760: Call rstPieces.MoveNext()
765: Loop 
		
770: Call rstPiecesCumulatif.Close()
775: Call rstPieces.Close()
		
780: 'UPGRADE_NOTE: Object rstProj may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProj = Nothing
785: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
790: 'UPGRADE_NOTE: Object rstProjCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjCumulatif = Nothing
795: 'UPGRADE_NOTE: Object rstPiecesCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiecesCumulatif = Nothing
		
800: Call CalculerTotalRecordset(sNoCumulatif)
		
805: If bCumulatifExiste = False Then
810: If cmbOuvertFerme.SelectedIndex = I_CMB_OUVERT Then
815: Call RemplirComboProjSoum(txtNoProjSoum.Text)
820: End If
825: End If
		
830: Exit Sub
		
AfficherErreur: 
		
835: Call AfficherErreur("FrmProjSoumElec", "AjouterProjetAuCumulatif", Err, Erl())
	End Sub
	
	Private Sub AjouterSoumissionAuCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstSoum As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstSoumCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim rstEmploye As ADODB.Recordset
45: Dim bCumulatifExiste As Boolean
50: Dim dblNbreManuel As Double
55: Dim dblTempsDessin As Double
60: Dim dblTempsFabrication As Double
65: Dim dblTempsAssemblage As Double
70: Dim dblTempsProgInterface As Double
75: Dim dblTempsProgAutomate As Double
80: Dim dblTempsProgRobot As Double
85: Dim dblTempsVision As Double
90: Dim dblTempsTest As Double
95: Dim dblTempsInstallation As Double
100: Dim dblTempsMiseService As Double
105: Dim dblTempsFormation As Double
110: Dim dblTempsGestion As Double
115: Dim dblTempsShipping As Double
120: Dim dblTempsTransport As Double
125: Dim dblTempsUniteMobile As Double
130: Dim dblTotalHebergement As Double
135: Dim dblTotalRepas As Double
140: Dim dblPrixEmballage As Double
145: Dim dblTotalManuel As Double
150: Dim dblForfait As Double
		
155: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
160: rstSoum = New ADODB.Recordset
165: rstPieces = New ADODB.Recordset
170: rstSoumCumulatif = New ADODB.Recordset
175: rstPiecesCumulatif = New ADODB.Recordset
		
180: Call rstSoumCumulatif.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
185: If rstSoumCumulatif.EOF Then
190: bCumulatifExiste = False
			
195: Call rstSoumCumulatif.AddNew()
			
200: rstSoumCumulatif.Fields("IDSoumission").Value = sNoCumulatif
			
205: Call rstSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & txtNoProjSoum.Text & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
210: rstSoumCumulatif.Fields("IDClient").Value = rstSoum.Fields("IDClient").Value
215: rstSoumCumulatif.Fields("IDContact").Value = rstSoum.Fields("IDContact").Value
			
220: rstSoumCumulatif.Fields("TauxDessin").Value = rstSoum.Fields("TauxDessin").Value
225: rstSoumCumulatif.Fields("TauxFabrication").Value = rstSoum.Fields("TauxFabrication").Value
230: rstSoumCumulatif.Fields("TauxAssemblage").Value = rstSoum.Fields("TauxAssemblage").Value
235: rstSoumCumulatif.Fields("TauxProgInterface").Value = rstSoum.Fields("TauxProgInterface").Value
240: rstSoumCumulatif.Fields("TauxProgAutomate").Value = rstSoum.Fields("TauxProgAutomate").Value
245: rstSoumCumulatif.Fields("TauxProgRobot").Value = rstSoum.Fields("TauxProgRobot").Value
250: rstSoumCumulatif.Fields("TauxVision").Value = rstSoum.Fields("TauxVision").Value
255: rstSoumCumulatif.Fields("TauxTest").Value = rstSoum.Fields("TauxTest").Value
260: rstSoumCumulatif.Fields("TauxInstallation").Value = rstSoum.Fields("TauxInstallation").Value
265: rstSoumCumulatif.Fields("TauxMiseService").Value = rstSoum.Fields("TauxMiseService").Value
270: rstSoumCumulatif.Fields("TauxFormation").Value = rstSoum.Fields("TauxFormation").Value
275: rstSoumCumulatif.Fields("TauxGestion").Value = rstSoum.Fields("TauxGestion").Value
280: rstSoumCumulatif.Fields("TauxShipping").Value = rstSoum.Fields("TauxShipping").Value
			
285: rstSoumCumulatif.Fields("TauxHebergement1").Value = rstSoum.Fields("TauxHebergement1").Value
290: rstSoumCumulatif.Fields("TauxHebergement2").Value = rstSoum.Fields("TauxHebergement2").Value
295: rstSoumCumulatif.Fields("TauxRepas").Value = rstSoum.Fields("TauxRepas").Value
300: rstSoumCumulatif.Fields("TauxTransport").Value = rstSoum.Fields("TauxTransport").Value
305: rstSoumCumulatif.Fields("TauxUniteMobile").Value = rstSoum.Fields("TauxUniteMobile").Value
			
310: rstSoumCumulatif.Fields("Transport").Value = rstSoum.Fields("Transport").Value
			
315: rstSoumCumulatif.Fields("Profit").Value = rstSoum.Fields("Profit").Value
320: rstSoumCumulatif.Fields("imprevue").Value = rstSoum.Fields("imprevue").Value
325: rstSoumCumulatif.Fields("commission").Value = rstSoum.Fields("commission").Value
			
330: Call rstSoum.Close()
			
335: rstSoumCumulatif.Fields("Description").Value = "Cumulatif de " & VB.Left(txtNoProjSoum.Text, 6)
			
340: rstEmploye = New ADODB.Recordset
			
345: Call rstEmploye.Open("SELECT * FROM GRB_employés WHERE loginname = '" & g_sUserID & "'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
			
350: rstSoumCumulatif.Fields("creer").Value = ConvertDate(Today)
			
355: rstSoumCumulatif.Fields("creer_par").Value = rstEmploye.Fields("NoEmploye").Value
			
360: Call rstEmploye.Close()
365: 'UPGRADE_NOTE: Object rstEmploye may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstEmploye = Nothing
			
370: Call rstSoumCumulatif.Update()
			
375: rstProjSoum = New ADODB.Recordset
			
380: Call rstProjSoum.Open("SELECT * FROM GRB_ProjSoum", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
385: Call rstProjSoum.AddNew()
			
390: rstProjSoum.Fields("IDProjSoum").Value = sNoCumulatif
395: rstProjSoum.Fields("NoClient").Value = rstSoumCumulatif.Fields("IDClient").Value
400: rstProjSoum.Fields("Description").Value = rstSoumCumulatif.Fields("Description").Value
405: rstProjSoum.Fields("DateOuverture").Value = ConvertDate(Today)
410: rstProjSoum.Fields("Ouvert").Value = True
415: rstProjSoum.Fields("Verrouillé").Value = True
420: rstProjSoum.Fields("Type").Value = "S"
			
425: Call rstProjSoum.Update()
			
430: Call rstProjSoum.Close()
435: 'UPGRADE_NOTE: Object rstProjSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
			rstProjSoum = Nothing
440: Else
445: bCumulatifExiste = True
450: End If
		
455: rstSoum.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
460: Call rstSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
465: If rstSoum.RecordCount = 1 Then
470: rstSoumCumulatif.Fields("NbreManuel").Value = rstSoum.Fields("NbreManuel").Value
			
475: rstSoumCumulatif.Fields("TempsDessin").Value = rstSoum.Fields("TempsDessin").Value
			
480: If rstSoum.Fields("SansTemps").Value = False Then
485: rstSoumCumulatif.Fields("TempsFabrication").Value = rstSoum.Fields("TempsFabrication").Value
490: Else
495: rstSoumCumulatif.Fields("TempsFabrication").Value = 0
500: End If
			
505: rstSoumCumulatif.Fields("TempsAssemblage").Value = rstSoum.Fields("TempsAssemblage").Value
510: rstSoumCumulatif.Fields("TempsProgInterface").Value = rstSoum.Fields("TempsProgInterface").Value
515: rstSoumCumulatif.Fields("TempsProgAutomate").Value = rstSoum.Fields("TempsProgAutomate").Value
520: rstSoumCumulatif.Fields("TempsProgRobot").Value = rstSoum.Fields("TempsProgRobot").Value
525: rstSoumCumulatif.Fields("TempsVision").Value = rstSoum.Fields("TempsVision").Value
530: rstSoumCumulatif.Fields("TempsTest").Value = rstSoum.Fields("TempsTest").Value
535: rstSoumCumulatif.Fields("TempsInstallation").Value = rstSoum.Fields("TempsInstallation").Value
540: rstSoumCumulatif.Fields("TempsMiseService").Value = rstSoum.Fields("TempsMiseService").Value
545: rstSoumCumulatif.Fields("TempsFormation").Value = rstSoum.Fields("TempsFormation").Value
550: rstSoumCumulatif.Fields("TempsGestion").Value = rstSoum.Fields("TempsGestion").Value
555: rstSoumCumulatif.Fields("TempsShipping").Value = rstSoum.Fields("TempsShipping").Value
			
560: rstSoumCumulatif.Fields("NbrePersonne").Value = rstSoum.Fields("NbrePersonne").Value
565: rstSoumCumulatif.Fields("TempsHebergement").Value = rstSoum.Fields("TempsHebergement").Value
570: rstSoumCumulatif.Fields("TempsRepas").Value = rstSoum.Fields("TempsRepas").Value
575: rstSoumCumulatif.Fields("TempsTransport").Value = rstSoum.Fields("TempsTransport").Value
580: rstSoumCumulatif.Fields("TempsUniteMobile").Value = rstSoum.Fields("TempsUniteMobile").Value
			
585: rstSoumCumulatif.Fields("TotalHebergement").Value = rstSoum.Fields("TotalHebergement").Value
590: rstSoumCumulatif.Fields("TotalRepas").Value = rstSoum.Fields("TotalRepas").Value
595: rstSoumCumulatif.Fields("PrixEmballage").Value = rstSoum.Fields("PrixEmballage").Value
			
600: rstSoumCumulatif.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
			
605: rstSoumCumulatif.Fields("MontantForfait").Value = rstSoum.Fields("MontantForfait").Value
610: Else
615: Do While Not rstSoum.EOF
620: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("NbreManuel").Value) Then
625: dblNbreManuel = dblNbreManuel + CDbl(rstSoum.Fields("NbreManuel").Value)
630: End If
				
635: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
640: dblTempsDessin = dblTempsDessin + CDbl(rstSoum.Fields("TempsDessin").Value)
645: End If
				
650: If rstSoum.Fields("SansTemps").Value = False Then
655: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsFabrication").Value) Then
660: dblTempsFabrication = dblTempsFabrication + CDbl(rstSoum.Fields("TempsFabrication").Value)
665: End If
670: End If
				
675: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
680: dblTempsAssemblage = dblTempsAssemblage + CDbl(rstSoum.Fields("TempsAssemblage").Value)
685: End If
				
690: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsProgInterface").Value) Then
695: dblTempsProgInterface = dblTempsProgInterface + CDbl(rstSoum.Fields("TempsProgInterface").Value)
700: End If
				
705: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsProgAutomate").Value) Then
710: dblTempsProgAutomate = dblTempsProgAutomate + CDbl(rstSoum.Fields("TempsProgAutomate").Value)
715: End If
				
720: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsProgRobot").Value) Then
725: dblTempsProgRobot = dblTempsProgRobot + CDbl(rstSoum.Fields("TempsProgRobot").Value)
730: End If
				
735: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsVision").Value) Then
740: dblTempsVision = dblTempsVision + CDbl(rstSoum.Fields("TempsVision").Value)
745: End If
				
750: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
755: dblTempsTest = dblTempsTest + CDbl(rstSoum.Fields("TempsTest").Value)
760: End If
				
765: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
770: dblTempsInstallation = dblTempsInstallation + CDbl(rstSoum.Fields("TempsInstallation").Value)
775: End If
				
780: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsMiseService").Value) Then
785: dblTempsMiseService = dblTempsMiseService + CDbl(rstSoum.Fields("TempsMiseService").Value)
790: End If
				
795: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
800: dblTempsFormation = dblTempsFormation + CDbl(rstSoum.Fields("TempsFormation").Value)
805: End If
				
810: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
815: dblTempsGestion = dblTempsGestion + CDbl(rstSoum.Fields("TempsGestion").Value)
820: End If
				
825: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
830: dblTempsShipping = dblTempsShipping + CDbl(rstSoum.Fields("TempsShipping").Value)
835: End If
				
840: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsTransport").Value) Then
845: dblTempsTransport = dblTempsTransport + CDbl(rstSoum.Fields("TempsTransport").Value)
850: End If
				
855: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TempsUniteMobile").Value) Then
860: dblTempsUniteMobile = dblTempsUniteMobile + CDbl(rstSoum.Fields("TempsUniteMobile").Value)
865: End If
				
870: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TotalHebergement").Value) Then
875: dblTotalHebergement = dblTotalHebergement + CDbl(rstSoum.Fields("TotalHebergement").Value)
880: End If
				
885: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("TotalRepas").Value) Then
890: dblTotalRepas = dblTotalRepas + CDbl(rstSoum.Fields("TotalRepas").Value)
895: End If
				
900: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("PrixEmballage").Value) Then
905: dblPrixEmballage = dblPrixEmballage + CDbl(rstSoum.Fields("PrixEmballage").Value)
910: End If
				
915: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("total_manuel").Value) Then
920: dblTotalManuel = dblTotalManuel + CDbl(rstSoum.Fields("total_manuel").Value)
925: End If
				
930: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
				If Not IsDbNull(rstSoum.Fields("MontantForfait").Value) Then
935: If IsNumeric(rstSoum.Fields("MontantForfait").Value) Then
940: dblForfait = dblForfait + CDbl(rstSoum.Fields("MontantForfait").Value)
945: End If
950: End If
				
955: Call rstSoum.MoveNext()
960: Loop 
			
965: rstSoumCumulatif.Fields("NbreManuel").Value = dblNbreManuel
			
970: rstSoumCumulatif.Fields("TempsDessin").Value = dblTempsDessin
975: rstSoumCumulatif.Fields("TempsFabrication").Value = dblTempsFabrication
980: rstSoumCumulatif.Fields("TempsAssemblage").Value = dblTempsAssemblage
985: rstSoumCumulatif.Fields("TempsProgInterface").Value = dblTempsProgInterface
990: rstSoumCumulatif.Fields("TempsProgAutomate").Value = dblTempsProgAutomate
995: rstSoumCumulatif.Fields("TempsProgRobot").Value = dblTempsProgRobot
1000: rstSoumCumulatif.Fields("TempsVision").Value = dblTempsVision
1005: rstSoumCumulatif.Fields("TempsTest").Value = dblTempsTest
1010: rstSoumCumulatif.Fields("TempsInstallation").Value = dblTempsInstallation
1015: rstSoumCumulatif.Fields("TempsMiseService").Value = dblTempsMiseService
1020: rstSoumCumulatif.Fields("TempsFormation").Value = dblTempsFormation
1025: rstSoumCumulatif.Fields("TempsGestion").Value = dblTempsGestion
1030: rstSoumCumulatif.Fields("TempsShipping").Value = dblTempsShipping
			
1035: rstSoumCumulatif.Fields("TempsTransport").Value = dblTempsTransport
1040: rstSoumCumulatif.Fields("TempsUniteMobile").Value = dblTempsUniteMobile
			
1045: rstSoumCumulatif.Fields("TotalHebergement").Value = dblTotalHebergement
1050: rstSoumCumulatif.Fields("TotalRepas").Value = dblTotalRepas
1055: rstSoumCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
			
1060: rstSoumCumulatif.Fields("total_manuel").Value = dblTotalManuel
			
1065: rstSoumCumulatif.Fields("MontantForfait").Value = dblForfait
1070: End If
		
1075: Call rstSoumCumulatif.Update()
		
1080: Call rstSoumCumulatif.Close()
		
1085: Call rstSoum.Close()
		
		'AJOUT DES PIÈCES
1090: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
1095: If bCumulatifExiste = True Then
1100: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "' AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
			
1105: Call rstPieces.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & txtNoProjSoum.Text & "' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
1110: Else
1115: Call rstPieces.Open("SELECT * FROM GRB_Soumission_Pieces WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
1120: End If
		
1125: Do While Not rstPieces.EOF
1130: Call rstPiecesCumulatif.AddNew()
			
1135: rstPiecesCumulatif.Fields("IDSoumission").Value = sNoCumulatif
1140: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
1145: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
1150: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
1155: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
1160: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
1165: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
1170: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
1175: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
1180: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
1185: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
1190: rstPiecesCumulatif.Fields("Temps").Value = rstPieces.Fields("Temps").Value
1195: rstPiecesCumulatif.Fields("Temps_Total").Value = rstPieces.Fields("Temps_Total").Value
1200: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
1205: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
1210: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
1215: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
1220: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
1225: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
1230: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
1235: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
1240: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
1245: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
1250: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDSoumission").Value, 2)
			
1255: Call rstPiecesCumulatif.Update()
			
1260: Call rstPieces.MoveNext()
1265: Loop 
		
1270: Call rstPiecesCumulatif.Close()
1275: Call rstPieces.Close()
		
1280: 'UPGRADE_NOTE: Object rstSoum may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoum = Nothing
1285: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
1290: 'UPGRADE_NOTE: Object rstSoumCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstSoumCumulatif = Nothing
1295: 'UPGRADE_NOTE: Object rstPiecesCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiecesCumulatif = Nothing
		
1300: Call CalculerTotalRecordset(sNoCumulatif)
		
1305: Exit Sub
		
AfficherErreur: 
		
1310: Call AfficherErreur("FrmProjSoumElec", "AjouterSoumissionAuCumulatif", Err, Erl())
	End Sub
	
	Private Sub RecreerProjetCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstProj As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstProjCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim dblNbreManuel As Double
45: Dim dblPrixEmballage As Double
50: Dim dblTotalManuel As Double
55: Dim dblForfait As Double
60: Dim bSupprimer As Boolean
		
65: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
70: rstProj = New ADODB.Recordset
75: rstPieces = New ADODB.Recordset
80: rstProjCumulatif = New ADODB.Recordset
85: rstPiecesCumulatif = New ADODB.Recordset
		
90: rstProj.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
95: Call rstProj.Open("SELECT * FROM GRB_ProjetElec WHERE LEFT(IDProjet, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDProjet, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
100: If rstProj.EOF Then
105: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoCumulatif & "'")
			
110: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "' AND Type = 'E'")
			
			'Efface le projet
115: Call g_connData.Execute("DELETE * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoCumulatif & "'")
			
120: bSupprimer = True
125: Else
130: Call rstProjCumulatif.Open("SELECT * FROM GRB_ProjetElec WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
135: If rstProj.RecordCount = 1 Then
140: rstProjCumulatif.Fields("NbreManuel").Value = rstProj.Fields("NbreManuel").Value
				
145: rstProjCumulatif.Fields("PrixEmballage").Value = rstProj.Fields("PrixEmballage").Value
				
150: rstProjCumulatif.Fields("total_manuel").Value = rstProj.Fields("total_manuel").Value
				
155: rstProjCumulatif.Fields("MontantForfait").Value = rstProj.Fields("MontantForfait").Value
160: Else
165: Do While Not rstProj.EOF
170: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("NbreManuel").Value) Then
175: dblNbreManuel = dblNbreManuel + CDbl(rstProj.Fields("NbreManuel").Value)
180: End If
					
185: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("PrixEmballage").Value) Then
190: dblPrixEmballage = dblPrixEmballage + CDbl(rstProj.Fields("PrixEmballage").Value)
195: End If
					
200: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("total_manuel").Value) Then
205: dblTotalManuel = dblTotalManuel + CDbl(rstProj.Fields("total_manuel").Value)
210: End If
					
215: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstProj.Fields("MontantForfait").Value) Then
220: If IsNumeric(rstProj.Fields("MontantForfait").Value) Then
225: dblForfait = dblForfait + CDbl(rstProj.Fields("MontantForfait").Value)
230: End If
235: End If
					
240: Call rstProj.MoveNext()
245: Loop 
				
250: rstProjCumulatif.Fields("NbreManuel").Value = dblNbreManuel
255: rstProjCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
260: rstProjCumulatif.Fields("total_manuel").Value = dblTotalManuel
265: rstProjCumulatif.Fields("MontantForfait").Value = dblForfait
270: End If
			
275: Call rstProj.Close()
			
280: Call rstProjCumulatif.Update()
			
285: Call rstProjCumulatif.Close()
290: End If
		
		'AJOUT DES PIÈCES
295: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
300: Call g_connData.Execute("DELETE * FROM GRB_Projet_Pieces WHERE IDProjet = '" & sNoCumulatif & "' AND Provenance = '" & VB.Right(txtNoProjSoum.Text, 2) & "'")
		
305: Call rstPieces.Open("SELECT * FROM GRB_Projet_Pieces WHERE IDProjet = '" & txtNoProjSoum.Text & "' AND Provenance Is Null OR Provenance = '' ORDER BY NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
310: Do While Not rstPieces.EOF
315: Call rstPiecesCumulatif.AddNew()
			
320: rstPiecesCumulatif.Fields("IDProjet").Value = sNoCumulatif
325: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
330: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
335: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
340: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
345: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
350: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
355: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
360: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
365: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
370: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
375: rstPiecesCumulatif.Fields("Temps").Value = rstPieces.Fields("Temps").Value
380: rstPiecesCumulatif.Fields("Temps_Total").Value = rstPieces.Fields("Temps_Total").Value
385: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
390: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
395: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
400: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
405: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
410: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
415: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
420: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
425: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
430: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
435: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDProjet").Value, 2)
			
440: Call rstPiecesCumulatif.Update()
			
445: Call rstPieces.MoveNext()
450: Loop 
		
455: Call rstPiecesCumulatif.Close()
460: Call rstPieces.Close()
		
465: 'UPGRADE_NOTE: Object rstProj may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProj = Nothing
470: 'UPGRADE_NOTE: Object rstPieces may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPieces = Nothing
475: 'UPGRADE_NOTE: Object rstProjCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstProjCumulatif = Nothing
480: 'UPGRADE_NOTE: Object rstPiecesCumulatif may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		rstPiecesCumulatif = Nothing
		
485: If bSupprimer = False Then
490: Call CalculerTotalRecordset(sNoCumulatif)
495: End If
		
500: Exit Sub
		
AfficherErreur: 
		
505: Call AfficherErreur("FrmProjSoumElec", "AjouterProjetAuCumulatif", Err, Erl())
	End Sub
	
	Private Sub RecreerSoumissionCumulatif()
		
5: On Error GoTo AfficherErreur
		
10: Dim sNoCumulatif As String
15: Dim rstSoum As ADODB.Recordset
20: Dim rstPieces As ADODB.Recordset
25: Dim rstSoumCumulatif As ADODB.Recordset
30: Dim rstPiecesCumulatif As ADODB.Recordset
35: Dim rstProjSoum As ADODB.Recordset
40: Dim dblNbreManuel As Double
45: Dim dblTempsDessin As Double
50: Dim dblTempsFabrication As Double
55: Dim dblTempsAssemblage As Double
60: Dim dblTempsProgInterface As Double
65: Dim dblTempsProgAutomate As Double
70: Dim dblTempsProgRobot As Double
75: Dim dblTempsVision As Double
80: Dim dblTempsTest As Double
85: Dim dblTempsInstallation As Double
90: Dim dblTempsMiseService As Double
95: Dim dblTempsFormation As Double
100: Dim dblTempsGestion As Double
105: Dim dblTempsShipping As Double
110: Dim dblTempsTransport As Double
115: Dim dblTempsUniteMobile As Double
120: Dim dblTotalHebergement As Double
125: Dim dblTotalRepas As Double
130: Dim dblPrixEmballage As Double
135: Dim dblTotalManuel As Double
140: Dim dblForfait As Double
145: Dim bSupprimer As Boolean
		
150: sNoCumulatif = VB.Left(txtNoProjSoum.Text, 7) & "99"
		
155: rstSoum = New ADODB.Recordset
160: rstPieces = New ADODB.Recordset
165: rstSoumCumulatif = New ADODB.Recordset
170: rstPiecesCumulatif = New ADODB.Recordset
		
175: rstSoum.CursorLocation = ADODB.CursorLocationEnum.adUseClient
		
180: Call rstSoum.Open("SELECT * FROM GRB_SoumissionElec WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99'", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
185: If rstSoum.EOF Then
190: Call g_connData.Execute("DELETE * FROM GRB_ProjSoum WHERE IDProjSoum = '" & sNoCumulatif & "'")
			
195: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "' AND Type = 'E'")
			
			'Efface la soumission
200: Call g_connData.Execute("DELETE * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoCumulatif & "'")
			
205: bSupprimer = True
210: Else
215: Call rstSoumCumulatif.Open("SELECT * FROM GRB_SoumissionElec WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
			
220: If rstSoum.RecordCount = 1 Then
225: rstSoumCumulatif.Fields("NbreManuel").Value = rstSoum.Fields("NbreManuel").Value
				
230: rstSoumCumulatif.Fields("TempsDessin").Value = rstSoum.Fields("TempsDessin").Value
				
235: If rstSoum.Fields("SansTemps").Value = False Then
240: rstSoumCumulatif.Fields("TempsFabrication").Value = rstSoum.Fields("TempsFabrication").Value
245: Else
250: rstSoumCumulatif.Fields("TempsFabrication").Value = 0
255: End If
				
260: rstSoumCumulatif.Fields("TempsAssemblage").Value = rstSoum.Fields("TempsAssemblage").Value
265: rstSoumCumulatif.Fields("TempsProgInterface").Value = rstSoum.Fields("TempsProgInterface").Value
270: rstSoumCumulatif.Fields("TempsProgAutomate").Value = rstSoum.Fields("TempsProgAutomate").Value
275: rstSoumCumulatif.Fields("TempsProgRobot").Value = rstSoum.Fields("TempsProgRobot").Value
280: rstSoumCumulatif.Fields("TempsVision").Value = rstSoum.Fields("TempsVision").Value
285: rstSoumCumulatif.Fields("TempsTest").Value = rstSoum.Fields("TempsTest").Value
290: rstSoumCumulatif.Fields("TempsInstallation").Value = rstSoum.Fields("TempsInstallation").Value
295: rstSoumCumulatif.Fields("TempsMiseService").Value = rstSoum.Fields("TempsMiseService").Value
300: rstSoumCumulatif.Fields("TempsFormation").Value = rstSoum.Fields("TempsFormation").Value
305: rstSoumCumulatif.Fields("TempsGestion").Value = rstSoum.Fields("TempsGestion").Value
310: rstSoumCumulatif.Fields("TempsShipping").Value = rstSoum.Fields("TempsShipping").Value
				
315: rstSoumCumulatif.Fields("NbrePersonne").Value = rstSoum.Fields("NbrePersonne").Value
320: rstSoumCumulatif.Fields("TempsHebergement").Value = rstSoum.Fields("TempsHebergement").Value
325: rstSoumCumulatif.Fields("TempsRepas").Value = rstSoum.Fields("TempsRepas").Value
330: rstSoumCumulatif.Fields("TempsTransport").Value = rstSoum.Fields("TempsTransport").Value
335: rstSoumCumulatif.Fields("TempsUniteMobile").Value = rstSoum.Fields("TempsUniteMobile").Value
				
340: rstSoumCumulatif.Fields("TotalHebergement").Value = rstSoum.Fields("TotalHebergement").Value
345: rstSoumCumulatif.Fields("TotalRepas").Value = rstSoum.Fields("TotalRepas").Value
350: rstSoumCumulatif.Fields("PrixEmballage").Value = rstSoum.Fields("PrixEmballage").Value
				
355: rstSoumCumulatif.Fields("total_manuel").Value = rstSoum.Fields("total_manuel").Value
				
360: rstSoumCumulatif.Fields("MontantForfait").Value = rstSoum.Fields("MontantForfait").Value
365: Else
370: Do While Not rstSoum.EOF
375: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("NbreManuel").Value) Then
380: dblNbreManuel = dblNbreManuel + CDbl(rstSoum.Fields("NbreManuel").Value)
385: End If
					
390: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsDessin").Value) Then
395: dblTempsDessin = dblTempsDessin + CDbl(rstSoum.Fields("TempsDessin").Value)
400: End If
					
405: If rstSoum.Fields("SansTemps").Value = False Then
410: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
						If Not IsDbNull(rstSoum.Fields("TempsFabrication").Value) Then
415: dblTempsFabrication = dblTempsFabrication + CDbl(rstSoum.Fields("TempsFabrication").Value)
420: End If
425: End If
					
430: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsAssemblage").Value) Then
435: dblTempsAssemblage = dblTempsAssemblage + CDbl(rstSoum.Fields("TempsAssemblage").Value)
440: End If
					
445: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsProgInterface").Value) Then
450: dblTempsProgInterface = dblTempsProgInterface + CDbl(rstSoum.Fields("TempsProgInterface").Value)
455: End If
					
460: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsProgAutomate").Value) Then
465: dblTempsProgAutomate = dblTempsProgAutomate + CDbl(rstSoum.Fields("TempsProgAutomate").Value)
470: End If
					
475: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsProgRobot").Value) Then
480: dblTempsProgRobot = dblTempsProgRobot + CDbl(rstSoum.Fields("TempsProgRobot").Value)
485: End If
					
490: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsVision").Value) Then
495: dblTempsVision = dblTempsVision + CDbl(rstSoum.Fields("TempsVision").Value)
500: End If
					
505: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTest").Value) Then
510: dblTempsTest = dblTempsTest + CDbl(rstSoum.Fields("TempsTest").Value)
515: End If
					
520: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsInstallation").Value) Then
525: dblTempsInstallation = dblTempsInstallation + CDbl(rstSoum.Fields("TempsInstallation").Value)
530: End If
					
535: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsMiseService").Value) Then
540: dblTempsMiseService = dblTempsMiseService + CDbl(rstSoum.Fields("TempsMiseService").Value)
545: End If
					
550: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsFormation").Value) Then
555: dblTempsFormation = dblTempsFormation + CDbl(rstSoum.Fields("TempsFormation").Value)
560: End If
					
565: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsGestion").Value) Then
570: dblTempsGestion = dblTempsGestion + CDbl(rstSoum.Fields("TempsGestion").Value)
575: End If
					
580: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsShipping").Value) Then
585: dblTempsShipping = dblTempsShipping + CDbl(rstSoum.Fields("TempsShipping").Value)
590: End If
					
595: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsTransport").Value) Then
600: dblTempsTransport = dblTempsTransport + CDbl(rstSoum.Fields("TempsTransport").Value)
605: End If
					
610: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TempsUniteMobile").Value) Then
615: dblTempsUniteMobile = dblTempsUniteMobile + CDbl(rstSoum.Fields("TempsUniteMobile").Value)
620: End If
					
625: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TotalHebergement").Value) Then
630: dblTotalHebergement = dblTotalHebergement + CDbl(rstSoum.Fields("TotalHebergement").Value)
635: End If
					
640: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("TotalRepas").Value) Then
645: dblTotalRepas = dblTotalRepas + CDbl(rstSoum.Fields("TotalRepas").Value)
650: End If
					
655: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("PrixEmballage").Value) Then
660: dblPrixEmballage = dblPrixEmballage + CDbl(rstSoum.Fields("PrixEmballage").Value)
665: End If
					
670: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("total_manuel").Value) Then
675: dblTotalManuel = dblTotalManuel + CDbl(rstSoum.Fields("total_manuel").Value)
680: End If
					
685: 'UPGRADE_WARNING: Use of Null/IsNull() detected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="2EED02CB-5C0E-4DC1-AE94-4FAA3A30F51A"'
					If Not IsDbNull(rstSoum.Fields("MontantForfait").Value) Then
690: If IsNumeric(rstSoum.Fields("MontantForfait").Value) Then
695: dblForfait = dblForfait + CDbl(rstSoum.Fields("MontantForfait").Value)
700: End If
705: End If
					
710: Call rstSoum.MoveNext()
715: Loop 
				
720: rstSoumCumulatif.Fields("NbreManuel").Value = dblNbreManuel
				
725: rstSoumCumulatif.Fields("TempsDessin").Value = dblTempsDessin
730: rstSoumCumulatif.Fields("TempsFabrication").Value = dblTempsFabrication
735: rstSoumCumulatif.Fields("TempsAssemblage").Value = dblTempsAssemblage
740: rstSoumCumulatif.Fields("TempsProgInterface").Value = dblTempsProgInterface
745: rstSoumCumulatif.Fields("TempsProgAutomate").Value = dblTempsProgAutomate
750: rstSoumCumulatif.Fields("TempsProgRobot").Value = dblTempsProgRobot
755: rstSoumCumulatif.Fields("TempsVision").Value = dblTempsVision
760: rstSoumCumulatif.Fields("TempsTest").Value = dblTempsTest
765: rstSoumCumulatif.Fields("TempsInstallation").Value = dblTempsInstallation
770: rstSoumCumulatif.Fields("TempsMiseService").Value = dblTempsMiseService
775: rstSoumCumulatif.Fields("TempsFormation").Value = dblTempsFormation
780: rstSoumCumulatif.Fields("TempsGestion").Value = dblTempsGestion
785: rstSoumCumulatif.Fields("TempsShipping").Value = dblTempsShipping
				
790: rstSoumCumulatif.Fields("TempsTransport").Value = dblTempsTransport
795: rstSoumCumulatif.Fields("TempsUniteMobile").Value = dblTempsUniteMobile
				
800: rstSoumCumulatif.Fields("TotalHebergement").Value = dblTotalHebergement
805: rstSoumCumulatif.Fields("TotalRepas").Value = dblTotalRepas
810: rstSoumCumulatif.Fields("PrixEmballage").Value = dblPrixEmballage
				
815: rstSoumCumulatif.Fields("total_manuel").Value = dblTotalManuel
				
820: rstSoumCumulatif.Fields("MontantForfait").Value = dblForfait
825: End If
			
830: Call rstSoum.Close()
			
835: Call rstSoumCumulatif.Update()
			
840: Call rstSoumCumulatif.Close()
845: End If
		
		'AJOUT DES PIÈCES
850: Call rstPiecesCumulatif.Open("SELECT * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "'", g_connData, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
		
855: Call g_connData.Execute("DELETE * FROM GRB_Soumission_Pieces WHERE IDSoumission = '" & sNoCumulatif & "'")
		
860: Call rstPieces.Open("SELECT * FROM GRB_Soumission_Pieces WHERE LEFT(IDSoumission, 6) = '" & VB.Left(txtNoProjSoum.Text, 6) & "' AND RIGHT(IDSoumission, 2) <> '99' ORDER BY CInt(OrdreSection), NuméroLigne", g_connData, ADODB.CursorTypeEnum.adOpenForwardOnly, ADODB.LockTypeEnum.adLockReadOnly)
		
865: Do While Not rstPieces.EOF
870: Call rstPiecesCumulatif.AddNew()
			
875: rstPiecesCumulatif.Fields("IDSoumission").Value = sNoCumulatif
880: rstPiecesCumulatif.Fields("IDSection").Value = rstPieces.Fields("IDSection").Value
885: rstPiecesCumulatif.Fields("NumItem").Value = rstPieces.Fields("NumItem").Value
890: rstPiecesCumulatif.Fields("Qté").Value = rstPieces.Fields("Qté").Value
895: rstPiecesCumulatif.Fields("Desc_FR").Value = rstPieces.Fields("Desc_FR").Value
900: rstPiecesCumulatif.Fields("Desc_EN").Value = rstPieces.Fields("Desc_EN").Value
905: rstPiecesCumulatif.Fields("Manufact").Value = rstPieces.Fields("Manufact").Value
910: rstPiecesCumulatif.Fields("Prix_list").Value = rstPieces.Fields("Prix_list").Value
915: rstPiecesCumulatif.Fields("Escompte").Value = rstPieces.Fields("Escompte").Value
920: rstPiecesCumulatif.Fields("Prix_net").Value = rstPieces.Fields("Prix_net").Value
925: rstPiecesCumulatif.Fields("IDFRS").Value = rstPieces.Fields("IDFRS").Value
930: rstPiecesCumulatif.Fields("Temps").Value = rstPieces.Fields("Temps").Value
935: rstPiecesCumulatif.Fields("Temps_Total").Value = rstPieces.Fields("Temps_Total").Value
940: rstPiecesCumulatif.Fields("Prix_total").Value = rstPieces.Fields("Prix_total").Value
945: rstPiecesCumulatif.Fields("Profit_Argent").Value = rstPieces.Fields("Profit_Argent").Value
950: rstPiecesCumulatif.Fields("SousSection").Value = rstPieces.Fields("SousSection").Value
955: rstPiecesCumulatif.Fields("OrdreSection").Value = rstPieces.Fields("OrdreSection").Value
960: rstPiecesCumulatif.Fields("NuméroLigne").Value = rstPieces.Fields("NuméroLigne").Value
965: rstPiecesCumulatif.Fields("PrixOrigine").Value = rstPieces.Fields("PrixOrigine").Value
970: rstPiecesCumulatif.Fields("Type").Value = rstPieces.Fields("Type").Value
975: rstPiecesCumulatif.Fields("Visible").Value = rstPieces.Fields("Visible").Value
980: rstPiecesCumulatif.Fields("Commentaire").Value = rstPieces.Fields("Commentaire").Value
985: rstPiecesCumulatif.Fields("Devise").Value = rstPieces.Fields("Devise").Value
990: rstPiecesCumulatif.Fields("Provenance").Value = VB.Right(rstPieces.Fields("IDSoumission").Value, 2)
			
995: Call rstPiecesCumulatif.Update()
			
1000: Call rstPieces.MoveNext()
1005: Loop 
		
1010: Call rstPiecesCumulatif.Close()
1015: Call rstPieces.Close()
		
1020: rstSoum = New ADODB.Recordset
1025: rstPieces = New ADODB.Recordset
1030: rstSoumCumulatif = New ADODB.Recordset
1035: rstPiecesCumulatif = New ADODB.Recordset
		
1040: If bSupprimer = False Then
1045: Call CalculerTotalRecordset(sNoCumulatif)
1050: End If
		
1055: Exit Sub
		
AfficherErreur: 
		
1060: Call AfficherErreur("FrmProjSoumElec", "RecreerSoumissionCumulatif", Err, Erl())
	End Sub
	Private Function ExportdansExcel(ByVal oRecordset As ADODB.Recordset) As Object
		
5: On Error GoTo AfficherErreur
		
6: Dim iCount As Short
10: Dim oXLApp As Excel.Application 'Declare the object variables
15: Dim oXLBook As Excel.Workbook
20: Dim oXLSheet As Excel.Worksheet
		
25: oXLApp = New Excel.Application 'Create a new instance of Excel
30: oXLBook = oXLApp.Workbooks.Add 'Add a new workbook
35: oXLSheet = oXLBook.Worksheets(1) 'Work with the first worksheet
		
		' ajustement largeur des colonne
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(1).ColumnWidth = 10
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(2).ColumnWidth = 8
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(3).ColumnWidth = 20
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(4).ColumnWidth = 45
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(5).ColumnWidth = 20
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(6).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(7).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(8).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(9).ColumnWidth = 12
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(10).ColumnWidth = 30
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(11).ColumnWidth = 20
		'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Columns().ColumnWidth. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
		oXLSheet.Columns._Default(12).ColumnWidth = 20
		
		oXLSheet.Range("A1: N1").Font.Bold = True
		
		
40: With oXLSheet 'Fill with data
45: For iCount = 0 To (oRecordset.Fields.Count - 1)
50: 'UPGRADE_WARNING: Couldn't resolve default property of object oXLSheet.Cells(). Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
				.Cells._Default(1, iCount + 1) = oRecordset.Fields(iCount).Name
55: Next iCount
60: 'create and fill a recordset here, called oRecordset
65: .Range("A2").CopyFromRecordset(oRecordset)
70: End With
		
75: oXLApp.Visible = True 'Show it to the user
80: 'UPGRADE_NOTE: Object oXLSheet may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		oXLSheet = Nothing 'Disconnect from all Excel objects (let the user take over)
85: 'UPGRADE_NOTE: Object oXLBook may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		oXLBook = Nothing
90: 'UPGRADE_NOTE: Object oXLApp may not be destroyed until it is garbage collected. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6E35BFF6-CD74-4B09-9689-3E1A43DF8969"'
		oXLApp = Nothing
		
95: Exit Function
		
AfficherErreur: 
		
960: Call AfficherErreur("FrmProjSoumMec", "ExportdansExcel", Err, Erl())
	End Function
End Class